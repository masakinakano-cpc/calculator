(function(){const p=document.createElement("link").relList;if(p&&p.supports&&p.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))a(_);new MutationObserver(_=>{for(const E of _)if(E.type==="childList")for(const C of E.addedNodes)C.tagName==="LINK"&&C.rel==="modulepreload"&&a(C)}).observe(document,{childList:!0,subtree:!0});function l(_){const E={};return _.integrity&&(E.integrity=_.integrity),_.referrerPolicy&&(E.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?E.credentials="include":_.crossOrigin==="anonymous"?E.credentials="omit":E.credentials="same-origin",E}function a(_){if(_.ep)return;_.ep=!0;const E=l(_);fetch(_.href,E)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(h){return h&&h.__esModule&&Object.prototype.hasOwnProperty.call(h,"default")?h.default:h}var jsxRuntime={exports:{}},reactJsxRuntime_production={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production;function requireReactJsxRuntime_production(){if(hasRequiredReactJsxRuntime_production)return reactJsxRuntime_production;hasRequiredReactJsxRuntime_production=1;var h=Symbol.for("react.transitional.element"),p=Symbol.for("react.fragment");function l(a,_,E){var C=null;if(E!==void 0&&(C=""+E),_.key!==void 0&&(C=""+_.key),"key"in _){E={};for(var A in _)A!=="key"&&(E[A]=_[A])}else E=_;return _=E.ref,{$$typeof:h,type:a,key:C,ref:_!==void 0?_:null,props:E}}return reactJsxRuntime_production.Fragment=p,reactJsxRuntime_production.jsx=l,reactJsxRuntime_production.jsxs=l,reactJsxRuntime_production}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),react={exports:{}},react_production={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production;function requireReact_production(){if(hasRequiredReact_production)return react_production;hasRequiredReact_production=1;var h=Symbol.for("react.transitional.element"),p=Symbol.for("react.portal"),l=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),E=Symbol.for("react.consumer"),C=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),O=Symbol.for("react.memo"),H=Symbol.for("react.lazy"),D=Symbol.for("react.activity"),j=Symbol.iterator;function be(J){return J===null||typeof J!="object"?null:(J=j&&J[j]||J["@@iterator"],typeof J=="function"?J:null)}var Oe={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},ve=Object.assign,Xe={};function Ke(J,Ce,He){this.props=J,this.context=Ce,this.refs=Xe,this.updater=He||Oe}Ke.prototype.isReactComponent={},Ke.prototype.setState=function(J,Ce){if(typeof J!="object"&&typeof J!="function"&&J!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,J,Ce,"setState")},Ke.prototype.forceUpdate=function(J){this.updater.enqueueForceUpdate(this,J,"forceUpdate")};function _e(){}_e.prototype=Ke.prototype;function Le(J,Ce,He){this.props=J,this.context=Ce,this.refs=Xe,this.updater=He||Oe}var Ae=Le.prototype=new _e;Ae.constructor=Le,ve(Ae,Ke.prototype),Ae.isPureReactComponent=!0;var rt=Array.isArray;function De(){}var xe={H:null,A:null,T:null,S:null},at=Object.prototype.hasOwnProperty;function ht(J,Ce,He){var it=He.ref;return{$$typeof:h,type:J,key:Ce,ref:it!==void 0?it:null,props:He}}function ot(J,Ce){return ht(J.type,Ce,J.props)}function Je(J){return typeof J=="object"&&J!==null&&J.$$typeof===h}function Rt(J){var Ce={"=":"=0",":":"=2"};return"$"+J.replace(/[=:]/g,function(He){return Ce[He]})}var Bt=/\/+/g;function Yt(J,Ce){return typeof J=="object"&&J!==null&&J.key!=null?Rt(""+J.key):Ce.toString(36)}function kt(J){switch(J.status){case"fulfilled":return J.value;case"rejected":throw J.reason;default:switch(typeof J.status=="string"?J.then(De,De):(J.status="pending",J.then(function(Ce){J.status==="pending"&&(J.status="fulfilled",J.value=Ce)},function(Ce){J.status==="pending"&&(J.status="rejected",J.reason=Ce)})),J.status){case"fulfilled":return J.value;case"rejected":throw J.reason}}throw J}function de(J,Ce,He,it,Et){var Ze=typeof J;(Ze==="undefined"||Ze==="boolean")&&(J=null);var Pt=!1;if(J===null)Pt=!0;else switch(Ze){case"bigint":case"string":case"number":Pt=!0;break;case"object":switch(J.$$typeof){case h:case p:Pt=!0;break;case H:return Pt=J._init,de(Pt(J._payload),Ce,He,it,Et)}}if(Pt)return Et=Et(J),Pt=it===""?"."+Yt(J,0):it,rt(Et)?(He="",Pt!=null&&(He=Pt.replace(Bt,"$&/")+"/"),de(Et,Ce,He,"",function(Qe){return Qe})):Et!=null&&(Je(Et)&&(Et=ot(Et,He+(Et.key==null||J&&J.key===Et.key?"":(""+Et.key).replace(Bt,"$&/")+"/")+Pt)),Ce.push(Et)),1;Pt=0;var An=it===""?".":it+":";if(rt(J))for(var tt=0;tt<J.length;tt++)it=J[tt],Ze=An+Yt(it,tt),Pt+=de(it,Ce,He,Ze,Et);else if(tt=be(J),typeof tt=="function")for(J=tt.call(J),tt=0;!(it=J.next()).done;)it=it.value,Ze=An+Yt(it,tt++),Pt+=de(it,Ce,He,Ze,Et);else if(Ze==="object"){if(typeof J.then=="function")return de(kt(J),Ce,He,it,Et);throw Ce=String(J),Error("Objects are not valid as a React child (found: "+(Ce==="[object Object]"?"object with keys {"+Object.keys(J).join(", ")+"}":Ce)+"). If you meant to render a collection of children, use an array instead.")}return Pt}function Ve(J,Ce,He){if(J==null)return J;var it=[],Et=0;return de(J,it,"","",function(Ze){return Ce.call(He,Ze,Et++)}),it}function ft(J){if(J._status===-1){var Ce=J._result;Ce=Ce(),Ce.then(function(He){(J._status===0||J._status===-1)&&(J._status=1,J._result=He)},function(He){(J._status===0||J._status===-1)&&(J._status=2,J._result=He)}),J._status===-1&&(J._status=0,J._result=Ce)}if(J._status===1)return J._result.default;throw J._result}var _t=typeof reportError=="function"?reportError:function(J){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Ce=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof J=="object"&&J!==null&&typeof J.message=="string"?String(J.message):String(J),error:J});if(!window.dispatchEvent(Ce))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",J);return}console.error(J)},Be={map:Ve,forEach:function(J,Ce,He){Ve(J,function(){Ce.apply(this,arguments)},He)},count:function(J){var Ce=0;return Ve(J,function(){Ce++}),Ce},toArray:function(J){return Ve(J,function(Ce){return Ce})||[]},only:function(J){if(!Je(J))throw Error("React.Children.only expected to receive a single React element child.");return J}};return react_production.Activity=D,react_production.Children=Be,react_production.Component=Ke,react_production.Fragment=l,react_production.Profiler=_,react_production.PureComponent=Le,react_production.StrictMode=a,react_production.Suspense=N,react_production.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=xe,react_production.__COMPILER_RUNTIME={__proto__:null,c:function(J){return xe.H.useMemoCache(J)}},react_production.cache=function(J){return function(){return J.apply(null,arguments)}},react_production.cacheSignal=function(){return null},react_production.cloneElement=function(J,Ce,He){if(J==null)throw Error("The argument must be a React element, but you passed "+J+".");var it=ve({},J.props),Et=J.key;if(Ce!=null)for(Ze in Ce.key!==void 0&&(Et=""+Ce.key),Ce)!at.call(Ce,Ze)||Ze==="key"||Ze==="__self"||Ze==="__source"||Ze==="ref"&&Ce.ref===void 0||(it[Ze]=Ce[Ze]);var Ze=arguments.length-2;if(Ze===1)it.children=He;else if(1<Ze){for(var Pt=Array(Ze),An=0;An<Ze;An++)Pt[An]=arguments[An+2];it.children=Pt}return ht(J.type,Et,it)},react_production.createContext=function(J){return J={$$typeof:C,_currentValue:J,_currentValue2:J,_threadCount:0,Provider:null,Consumer:null},J.Provider=J,J.Consumer={$$typeof:E,_context:J},J},react_production.createElement=function(J,Ce,He){var it,Et={},Ze=null;if(Ce!=null)for(it in Ce.key!==void 0&&(Ze=""+Ce.key),Ce)at.call(Ce,it)&&it!=="key"&&it!=="__self"&&it!=="__source"&&(Et[it]=Ce[it]);var Pt=arguments.length-2;if(Pt===1)Et.children=He;else if(1<Pt){for(var An=Array(Pt),tt=0;tt<Pt;tt++)An[tt]=arguments[tt+2];Et.children=An}if(J&&J.defaultProps)for(it in Pt=J.defaultProps,Pt)Et[it]===void 0&&(Et[it]=Pt[it]);return ht(J,Ze,Et)},react_production.createRef=function(){return{current:null}},react_production.forwardRef=function(J){return{$$typeof:A,render:J}},react_production.isValidElement=Je,react_production.lazy=function(J){return{$$typeof:H,_payload:{_status:-1,_result:J},_init:ft}},react_production.memo=function(J,Ce){return{$$typeof:O,type:J,compare:Ce===void 0?null:Ce}},react_production.startTransition=function(J){var Ce=xe.T,He={};xe.T=He;try{var it=J(),Et=xe.S;Et!==null&&Et(He,it),typeof it=="object"&&it!==null&&typeof it.then=="function"&&it.then(De,_t)}catch(Ze){_t(Ze)}finally{Ce!==null&&He.types!==null&&(Ce.types=He.types),xe.T=Ce}},react_production.unstable_useCacheRefresh=function(){return xe.H.useCacheRefresh()},react_production.use=function(J){return xe.H.use(J)},react_production.useActionState=function(J,Ce,He){return xe.H.useActionState(J,Ce,He)},react_production.useCallback=function(J,Ce){return xe.H.useCallback(J,Ce)},react_production.useContext=function(J){return xe.H.useContext(J)},react_production.useDebugValue=function(){},react_production.useDeferredValue=function(J,Ce){return xe.H.useDeferredValue(J,Ce)},react_production.useEffect=function(J,Ce){return xe.H.useEffect(J,Ce)},react_production.useEffectEvent=function(J){return xe.H.useEffectEvent(J)},react_production.useId=function(){return xe.H.useId()},react_production.useImperativeHandle=function(J,Ce,He){return xe.H.useImperativeHandle(J,Ce,He)},react_production.useInsertionEffect=function(J,Ce){return xe.H.useInsertionEffect(J,Ce)},react_production.useLayoutEffect=function(J,Ce){return xe.H.useLayoutEffect(J,Ce)},react_production.useMemo=function(J,Ce){return xe.H.useMemo(J,Ce)},react_production.useOptimistic=function(J,Ce){return xe.H.useOptimistic(J,Ce)},react_production.useReducer=function(J,Ce,He){return xe.H.useReducer(J,Ce,He)},react_production.useRef=function(J){return xe.H.useRef(J)},react_production.useState=function(J){return xe.H.useState(J)},react_production.useSyncExternalStore=function(J,Ce,He){return xe.H.useSyncExternalStore(J,Ce,He)},react_production.useTransition=function(){return xe.H.useTransition()},react_production.version="19.2.0",react_production}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production()),react.exports}var reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports);var client={exports:{}},reactDomClient_production={},scheduler={exports:{}},scheduler_production={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production;function requireScheduler_production(){return hasRequiredScheduler_production||(hasRequiredScheduler_production=1,(function(h){function p(de,Ve){var ft=de.length;de.push(Ve);e:for(;0<ft;){var _t=ft-1>>>1,Be=de[_t];if(0<_(Be,Ve))de[_t]=Ve,de[ft]=Be,ft=_t;else break e}}function l(de){return de.length===0?null:de[0]}function a(de){if(de.length===0)return null;var Ve=de[0],ft=de.pop();if(ft!==Ve){de[0]=ft;e:for(var _t=0,Be=de.length,J=Be>>>1;_t<J;){var Ce=2*(_t+1)-1,He=de[Ce],it=Ce+1,Et=de[it];if(0>_(He,ft))it<Be&&0>_(Et,He)?(de[_t]=Et,de[it]=ft,_t=it):(de[_t]=He,de[Ce]=ft,_t=Ce);else if(it<Be&&0>_(Et,ft))de[_t]=Et,de[it]=ft,_t=it;else break e}}return Ve}function _(de,Ve){var ft=de.sortIndex-Ve.sortIndex;return ft!==0?ft:de.id-Ve.id}if(h.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var E=performance;h.unstable_now=function(){return E.now()}}else{var C=Date,A=C.now();h.unstable_now=function(){return C.now()-A}}var N=[],O=[],H=1,D=null,j=3,be=!1,Oe=!1,ve=!1,Xe=!1,Ke=typeof setTimeout=="function"?setTimeout:null,_e=typeof clearTimeout=="function"?clearTimeout:null,Le=typeof setImmediate<"u"?setImmediate:null;function Ae(de){for(var Ve=l(O);Ve!==null;){if(Ve.callback===null)a(O);else if(Ve.startTime<=de)a(O),Ve.sortIndex=Ve.expirationTime,p(N,Ve);else break;Ve=l(O)}}function rt(de){if(ve=!1,Ae(de),!Oe)if(l(N)!==null)Oe=!0,De||(De=!0,Rt());else{var Ve=l(O);Ve!==null&&kt(rt,Ve.startTime-de)}}var De=!1,xe=-1,at=5,ht=-1;function ot(){return Xe?!0:!(h.unstable_now()-ht<at)}function Je(){if(Xe=!1,De){var de=h.unstable_now();ht=de;var Ve=!0;try{e:{Oe=!1,ve&&(ve=!1,_e(xe),xe=-1),be=!0;var ft=j;try{t:{for(Ae(de),D=l(N);D!==null&&!(D.expirationTime>de&&ot());){var _t=D.callback;if(typeof _t=="function"){D.callback=null,j=D.priorityLevel;var Be=_t(D.expirationTime<=de);if(de=h.unstable_now(),typeof Be=="function"){D.callback=Be,Ae(de),Ve=!0;break t}D===l(N)&&a(N),Ae(de)}else a(N);D=l(N)}if(D!==null)Ve=!0;else{var J=l(O);J!==null&&kt(rt,J.startTime-de),Ve=!1}}break e}finally{D=null,j=ft,be=!1}Ve=void 0}}finally{Ve?Rt():De=!1}}}var Rt;if(typeof Le=="function")Rt=function(){Le(Je)};else if(typeof MessageChannel<"u"){var Bt=new MessageChannel,Yt=Bt.port2;Bt.port1.onmessage=Je,Rt=function(){Yt.postMessage(null)}}else Rt=function(){Ke(Je,0)};function kt(de,Ve){xe=Ke(function(){de(h.unstable_now())},Ve)}h.unstable_IdlePriority=5,h.unstable_ImmediatePriority=1,h.unstable_LowPriority=4,h.unstable_NormalPriority=3,h.unstable_Profiling=null,h.unstable_UserBlockingPriority=2,h.unstable_cancelCallback=function(de){de.callback=null},h.unstable_forceFrameRate=function(de){0>de||125<de?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):at=0<de?Math.floor(1e3/de):5},h.unstable_getCurrentPriorityLevel=function(){return j},h.unstable_next=function(de){switch(j){case 1:case 2:case 3:var Ve=3;break;default:Ve=j}var ft=j;j=Ve;try{return de()}finally{j=ft}},h.unstable_requestPaint=function(){Xe=!0},h.unstable_runWithPriority=function(de,Ve){switch(de){case 1:case 2:case 3:case 4:case 5:break;default:de=3}var ft=j;j=de;try{return Ve()}finally{j=ft}},h.unstable_scheduleCallback=function(de,Ve,ft){var _t=h.unstable_now();switch(typeof ft=="object"&&ft!==null?(ft=ft.delay,ft=typeof ft=="number"&&0<ft?_t+ft:_t):ft=_t,de){case 1:var Be=-1;break;case 2:Be=250;break;case 5:Be=1073741823;break;case 4:Be=1e4;break;default:Be=5e3}return Be=ft+Be,de={id:H++,callback:Ve,priorityLevel:de,startTime:ft,expirationTime:Be,sortIndex:-1},ft>_t?(de.sortIndex=ft,p(O,de),l(N)===null&&de===l(O)&&(ve?(_e(xe),xe=-1):ve=!0,kt(rt,ft-_t))):(de.sortIndex=Be,p(N,de),Oe||be||(Oe=!0,De||(De=!0,Rt()))),de},h.unstable_shouldYield=ot,h.unstable_wrapCallback=function(de){var Ve=j;return function(){var ft=j;j=Ve;try{return de.apply(this,arguments)}finally{j=ft}}}})(scheduler_production)),scheduler_production}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production()),scheduler.exports}var reactDom={exports:{}},reactDom_production={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production;function requireReactDom_production(){if(hasRequiredReactDom_production)return reactDom_production;hasRequiredReactDom_production=1;var h=requireReact();function p(N){var O="https://react.dev/errors/"+N;if(1<arguments.length){O+="?args[]="+encodeURIComponent(arguments[1]);for(var H=2;H<arguments.length;H++)O+="&args[]="+encodeURIComponent(arguments[H])}return"Minified React error #"+N+"; visit "+O+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(){}var a={d:{f:l,r:function(){throw Error(p(522))},D:l,C:l,L:l,m:l,X:l,S:l,M:l},p:0,findDOMNode:null},_=Symbol.for("react.portal");function E(N,O,H){var D=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:_,key:D==null?null:""+D,children:N,containerInfo:O,implementation:H}}var C=h.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function A(N,O){if(N==="font")return"";if(typeof O=="string")return O==="use-credentials"?O:""}return reactDom_production.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,reactDom_production.createPortal=function(N,O){var H=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!O||O.nodeType!==1&&O.nodeType!==9&&O.nodeType!==11)throw Error(p(299));return E(N,O,null,H)},reactDom_production.flushSync=function(N){var O=C.T,H=a.p;try{if(C.T=null,a.p=2,N)return N()}finally{C.T=O,a.p=H,a.d.f()}},reactDom_production.preconnect=function(N,O){typeof N=="string"&&(O?(O=O.crossOrigin,O=typeof O=="string"?O==="use-credentials"?O:"":void 0):O=null,a.d.C(N,O))},reactDom_production.prefetchDNS=function(N){typeof N=="string"&&a.d.D(N)},reactDom_production.preinit=function(N,O){if(typeof N=="string"&&O&&typeof O.as=="string"){var H=O.as,D=A(H,O.crossOrigin),j=typeof O.integrity=="string"?O.integrity:void 0,be=typeof O.fetchPriority=="string"?O.fetchPriority:void 0;H==="style"?a.d.S(N,typeof O.precedence=="string"?O.precedence:void 0,{crossOrigin:D,integrity:j,fetchPriority:be}):H==="script"&&a.d.X(N,{crossOrigin:D,integrity:j,fetchPriority:be,nonce:typeof O.nonce=="string"?O.nonce:void 0})}},reactDom_production.preinitModule=function(N,O){if(typeof N=="string")if(typeof O=="object"&&O!==null){if(O.as==null||O.as==="script"){var H=A(O.as,O.crossOrigin);a.d.M(N,{crossOrigin:H,integrity:typeof O.integrity=="string"?O.integrity:void 0,nonce:typeof O.nonce=="string"?O.nonce:void 0})}}else O==null&&a.d.M(N)},reactDom_production.preload=function(N,O){if(typeof N=="string"&&typeof O=="object"&&O!==null&&typeof O.as=="string"){var H=O.as,D=A(H,O.crossOrigin);a.d.L(N,H,{crossOrigin:D,integrity:typeof O.integrity=="string"?O.integrity:void 0,nonce:typeof O.nonce=="string"?O.nonce:void 0,type:typeof O.type=="string"?O.type:void 0,fetchPriority:typeof O.fetchPriority=="string"?O.fetchPriority:void 0,referrerPolicy:typeof O.referrerPolicy=="string"?O.referrerPolicy:void 0,imageSrcSet:typeof O.imageSrcSet=="string"?O.imageSrcSet:void 0,imageSizes:typeof O.imageSizes=="string"?O.imageSizes:void 0,media:typeof O.media=="string"?O.media:void 0})}},reactDom_production.preloadModule=function(N,O){if(typeof N=="string")if(O){var H=A(O.as,O.crossOrigin);a.d.m(N,{as:typeof O.as=="string"&&O.as!=="script"?O.as:void 0,crossOrigin:H,integrity:typeof O.integrity=="string"?O.integrity:void 0})}else a.d.m(N)},reactDom_production.requestFormReset=function(N){a.d.r(N)},reactDom_production.unstable_batchedUpdates=function(N,O){return N(O)},reactDom_production.useFormState=function(N,O,H){return C.H.useFormState(N,O,H)},reactDom_production.useFormStatus=function(){return C.H.useHostTransitionStatus()},reactDom_production.version="19.2.0",reactDom_production}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function h(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(h)}catch(p){console.error(p)}}return h(),reactDom.exports=requireReactDom_production(),reactDom.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDomClient_production;function requireReactDomClient_production(){if(hasRequiredReactDomClient_production)return reactDomClient_production;hasRequiredReactDomClient_production=1;var h=requireScheduler(),p=requireReact(),l=requireReactDom();function a(n){var o="https://react.dev/errors/"+n;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var r=2;r<arguments.length;r++)o+="&args[]="+encodeURIComponent(arguments[r])}return"Minified React error #"+n+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function _(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function E(n){var o=n,r=n;if(n.alternate)for(;o.return;)o=o.return;else{n=o;do o=n,(o.flags&4098)!==0&&(r=o.return),n=o.return;while(n)}return o.tag===3?r:null}function C(n){if(n.tag===13){var o=n.memoizedState;if(o===null&&(n=n.alternate,n!==null&&(o=n.memoizedState)),o!==null)return o.dehydrated}return null}function A(n){if(n.tag===31){var o=n.memoizedState;if(o===null&&(n=n.alternate,n!==null&&(o=n.memoizedState)),o!==null)return o.dehydrated}return null}function N(n){if(E(n)!==n)throw Error(a(188))}function O(n){var o=n.alternate;if(!o){if(o=E(n),o===null)throw Error(a(188));return o!==n?null:n}for(var r=n,u=o;;){var f=r.return;if(f===null)break;var $=f.alternate;if($===null){if(u=f.return,u!==null){r=u;continue}break}if(f.child===$.child){for($=f.child;$;){if($===r)return N(f),n;if($===u)return N(f),o;$=$.sibling}throw Error(a(188))}if(r.return!==u.return)r=f,u=$;else{for(var S=!1,k=f.child;k;){if(k===r){S=!0,r=f,u=$;break}if(k===u){S=!0,u=f,r=$;break}k=k.sibling}if(!S){for(k=$.child;k;){if(k===r){S=!0,r=$,u=f;break}if(k===u){S=!0,u=$,r=f;break}k=k.sibling}if(!S)throw Error(a(189))}}if(r.alternate!==u)throw Error(a(190))}if(r.tag!==3)throw Error(a(188));return r.stateNode.current===r?n:o}function H(n){var o=n.tag;if(o===5||o===26||o===27||o===6)return n;for(n=n.child;n!==null;){if(o=H(n),o!==null)return o;n=n.sibling}return null}var D=Object.assign,j=Symbol.for("react.element"),be=Symbol.for("react.transitional.element"),Oe=Symbol.for("react.portal"),ve=Symbol.for("react.fragment"),Xe=Symbol.for("react.strict_mode"),Ke=Symbol.for("react.profiler"),_e=Symbol.for("react.consumer"),Le=Symbol.for("react.context"),Ae=Symbol.for("react.forward_ref"),rt=Symbol.for("react.suspense"),De=Symbol.for("react.suspense_list"),xe=Symbol.for("react.memo"),at=Symbol.for("react.lazy"),ht=Symbol.for("react.activity"),ot=Symbol.for("react.memo_cache_sentinel"),Je=Symbol.iterator;function Rt(n){return n===null||typeof n!="object"?null:(n=Je&&n[Je]||n["@@iterator"],typeof n=="function"?n:null)}var Bt=Symbol.for("react.client.reference");function Yt(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===Bt?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case ve:return"Fragment";case Ke:return"Profiler";case Xe:return"StrictMode";case rt:return"Suspense";case De:return"SuspenseList";case ht:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case Oe:return"Portal";case Le:return n.displayName||"Context";case _e:return(n._context.displayName||"Context")+".Consumer";case Ae:var o=n.render;return n=n.displayName,n||(n=o.displayName||o.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case xe:return o=n.displayName||null,o!==null?o:Yt(n.type)||"Memo";case at:o=n._payload,n=n._init;try{return Yt(n(o))}catch{}}return null}var kt=Array.isArray,de=p.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ve=l.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ft={pending:!1,data:null,method:null,action:null},_t=[],Be=-1;function J(n){return{current:n}}function Ce(n){0>Be||(n.current=_t[Be],_t[Be]=null,Be--)}function He(n,o){Be++,_t[Be]=n.current,n.current=o}var it=J(null),Et=J(null),Ze=J(null),Pt=J(null);function An(n,o){switch(He(Ze,o),He(Et,n),He(it,null),o.nodeType){case 9:case 11:n=(n=o.documentElement)&&(n=n.namespaceURI)?no(n):0;break;default:if(n=o.tagName,o=o.namespaceURI)o=no(o),n=Jd(o,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}Ce(it),He(it,n)}function tt(){Ce(it),Ce(Et),Ce(Ze)}function Qe(n){n.memoizedState!==null&&He(Pt,n);var o=it.current,r=Jd(o,n.type);o!==r&&(He(Et,n),He(it,r))}function Ni(n){Et.current===n&&(Ce(it),Ce(Et)),Pt.current===n&&(Ce(Pt),bc._currentValue=ft)}var ae,We;function Mn(n){if(ae===void 0)try{throw Error()}catch(r){var o=r.stack.trim().match(/\n( *(at )?)/);ae=o&&o[1]||"",We=-1<r.stack.indexOf(`
    at`)?" (<anonymous>)":-1<r.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ae+n+We}var vt=!1;function Si(n,o){if(!n||vt)return"";vt=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(o){var Me=function(){throw Error()};if(Object.defineProperty(Me.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Me,[])}catch(Ee){var me=Ee}Reflect.construct(n,[],Me)}else{try{Me.call()}catch(Ee){me=Ee}n.call(Me.prototype)}}else{try{throw Error()}catch(Ee){me=Ee}(Me=n())&&typeof Me.catch=="function"&&Me.catch(function(){})}}catch(Ee){if(Ee&&me&&typeof Ee.stack=="string")return[Ee.stack,me.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var $=u.DetermineComponentFrameRoot(),S=$[0],k=$[1];if(S&&k){var V=S.split(`
`),fe=k.split(`
`);for(f=u=0;u<V.length&&!V[u].includes("DetermineComponentFrameRoot");)u++;for(;f<fe.length&&!fe[f].includes("DetermineComponentFrameRoot");)f++;if(u===V.length||f===fe.length)for(u=V.length-1,f=fe.length-1;1<=u&&0<=f&&V[u]!==fe[f];)f--;for(;1<=u&&0<=f;u--,f--)if(V[u]!==fe[f]){if(u!==1||f!==1)do if(u--,f--,0>f||V[u]!==fe[f]){var Ie=`
`+V[u].replace(" at new "," at ");return n.displayName&&Ie.includes("<anonymous>")&&(Ie=Ie.replace("<anonymous>",n.displayName)),Ie}while(1<=u&&0<=f);break}}}finally{vt=!1,Error.prepareStackTrace=r}return(r=n?n.displayName||n.name:"")?Mn(r):""}function Wt(n,o){switch(n.tag){case 26:case 27:case 5:return Mn(n.type);case 16:return Mn("Lazy");case 13:return n.child!==o&&o!==null?Mn("Suspense Fallback"):Mn("Suspense");case 19:return Mn("SuspenseList");case 0:case 15:return Si(n.type,!1);case 11:return Si(n.type.render,!1);case 1:return Si(n.type,!0);case 31:return Mn("Activity");default:return""}}function Yi(n){try{var o="",r=null;do o+=Wt(n,r),r=n,n=n.return;while(n);return o}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}var Ki=Object.prototype.hasOwnProperty,Ln=h.unstable_scheduleCallback,_n=h.unstable_cancelCallback,bn=h.unstable_shouldYield,so=h.unstable_requestPaint,In=h.unstable_now,X=h.unstable_getCurrentPriorityLevel,Zn=h.unstable_ImmediatePriority,Hn=h.unstable_UserBlockingPriority,Ht=h.unstable_NormalPriority,sn=h.unstable_LowPriority,Xn=h.unstable_IdlePriority,qt=h.log,Yn=h.unstable_setDisableYieldValue,v=null,L=null;function Y(n){if(typeof qt=="function"&&Yn(n),L&&typeof L.setStrictMode=="function")try{L.setStrictMode(v,n)}catch{}}var F=Math.clz32?Math.clz32:ki,Fe=Math.log,Ft=Math.LN2;function ki(n){return n>>>=0,n===0?32:31-(Fe(n)/Ft|0)|0}var je=256,$i=262144,T=4194304;function M(n){var o=n&42;if(o!==0)return o;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function G(n,o,r){var u=n.pendingLanes;if(u===0)return 0;var f=0,$=n.suspendedLanes,S=n.pingedLanes;n=n.warmLanes;var k=u&134217727;return k!==0?(u=k&~$,u!==0?f=M(u):(S&=k,S!==0?f=M(S):r||(r=k&~n,r!==0&&(f=M(r))))):(k=u&~$,k!==0?f=M(k):S!==0?f=M(S):r||(r=u&~n,r!==0&&(f=M(r)))),f===0?0:o!==0&&o!==f&&(o&$)===0&&($=f&-f,r=o&-o,$>=r||$===32&&(r&4194048)!==0)?o:f}function ee(n,o){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&o)===0}function Te(n,o){switch(n){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qe(){var n=T;return T<<=1,(T&62914560)===0&&(T=4194304),n}function dt(n){for(var o=[],r=0;31>r;r++)o.push(n);return o}function Qt(n,o){n.pendingLanes|=o,o!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function En(n,o,r,u,f,$){var S=n.pendingLanes;n.pendingLanes=r,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=r,n.entangledLanes&=r,n.errorRecoveryDisabledLanes&=r,n.shellSuspendCounter=0;var k=n.entanglements,V=n.expirationTimes,fe=n.hiddenUpdates;for(r=S&~r;0<r;){var Ie=31-F(r),Me=1<<Ie;k[Ie]=0,V[Ie]=-1;var me=fe[Ie];if(me!==null)for(fe[Ie]=null,Ie=0;Ie<me.length;Ie++){var Ee=me[Ie];Ee!==null&&(Ee.lane&=-536870913)}r&=~Me}u!==0&&hi(n,u,0),$!==0&&f===0&&n.tag!==0&&(n.suspendedLanes|=$&~(S&~o))}function hi(n,o,r){n.pendingLanes|=o,n.suspendedLanes&=~o;var u=31-F(o);n.entangledLanes|=o,n.entanglements[u]=n.entanglements[u]|1073741824|r&261930}function St(n,o){var r=n.entangledLanes|=o;for(n=n.entanglements;r;){var u=31-F(r),f=1<<u;f&o|n[u]&o&&(n[u]|=o),r&=~f}}function jt(n,o){var r=o&-o;return r=(r&42)!==0?1:qo(r),(r&(n.suspendedLanes|o))!==0?0:r}function qo(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function ro(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Mi(){var n=Ve.p;return n!==0?n:(n=window.event,n===void 0?32:Ip(n.type))}function mo(n,o){var r=Ve.p;try{return Ve.p=n,o()}finally{Ve.p=r}}var Li=Math.random().toString(36).slice(2),Tn="__reactFiber$"+Li,Qn="__reactProps$"+Li,qi="__reactContainer$"+Li,fs="__reactEvents$"+Li,vl="__reactListeners$"+Li,Ns="__reactHandles$"+Li,Qs="__reactResources$"+Li,wo="__reactMarker$"+Li;function zr(n){delete n[Tn],delete n[Qn],delete n[fs],delete n[vl],delete n[Ns]}function ks(n){var o=n[Tn];if(o)return o;for(var r=n.parentNode;r;){if(o=r[qi]||r[Tn]){if(r=o.alternate,o.child!==null||r!==null&&r.child!==null)for(n=pn(n);n!==null;){if(r=n[Tn])return r;n=pn(n)}return o}n=r,r=n.parentNode}return null}function rn(n){if(n=n[Tn]||n[qi]){var o=n.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return n}return null}function lo(n){var o=n.tag;if(o===5||o===26||o===27||o===6)return n.stateNode;throw Error(a(33))}function Ji(n){var o=n[Qs];return o||(o=n[Qs]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function Kn(n){n[wo]=!0}var er=new Set,tr={};function Jo(n,o){ps(n,o),ps(n+"Capture",o)}function ps(n,o){for(tr[n]=o,n=0;n<o.length;n++)er.add(o[n])}var gs=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),yl={},nr={};function Sl(n){return Ki.call(nr,n)?!0:Ki.call(yl,n)?!1:gs.test(n)?nr[n]=!0:(yl[n]=!0,!1)}function Ut(n,o,r){if(Sl(o))if(r===null)n.removeAttribute(o);else{switch(typeof r){case"undefined":case"function":case"symbol":n.removeAttribute(o);return;case"boolean":var u=o.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){n.removeAttribute(o);return}}n.setAttribute(o,""+r)}}function $s(n,o,r){if(r===null)n.removeAttribute(o);else{switch(typeof r){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttribute(o,""+r)}}function uo(n,o,r,u){if(u===null)n.removeAttribute(r);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttributeNS(o,r,""+u)}}function mi(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Wr(n){var o=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Ic(n,o,r){var u=Object.getOwnPropertyDescriptor(n.constructor.prototype,o);if(!n.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var f=u.get,$=u.set;return Object.defineProperty(n,o,{configurable:!0,get:function(){return f.call(this)},set:function(S){r=""+S,$.call(this,S)}}),Object.defineProperty(n,o,{enumerable:u.enumerable}),{getValue:function(){return r},setValue:function(S){r=""+S},stopTracking:function(){n._valueTracker=null,delete n[o]}}}}function _u(n){if(!n._valueTracker){var o=Wr(n)?"checked":"value";n._valueTracker=Ic(n,o,""+n[o])}}function No(n){if(!n)return!1;var o=n._valueTracker;if(!o)return!0;var r=o.getValue(),u="";return n&&(u=Wr(n)?n.checked?"true":"false":n.value),n=u,n!==r?(o.setValue(n),!0):!1}function It(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Ms=/[\n"\\]/g;function _i(n){return n.replace(Ms,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function Ci(n,o,r,u,f,$,S,k){n.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?n.type=S:n.removeAttribute("type"),o!=null?S==="number"?(o===0&&n.value===""||n.value!=o)&&(n.value=""+mi(o)):n.value!==""+mi(o)&&(n.value=""+mi(o)):S!=="submit"&&S!=="reset"||n.removeAttribute("value"),o!=null?Cl(n,S,mi(o)):r!=null?Cl(n,S,mi(r)):u!=null&&n.removeAttribute("value"),f==null&&$!=null&&(n.defaultChecked=!!$),f!=null&&(n.checked=f&&typeof f!="function"&&typeof f!="symbol"),k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"?n.name=""+mi(k):n.removeAttribute("name")}function Zo(n,o,r,u,f,$,S,k){if($!=null&&typeof $!="function"&&typeof $!="symbol"&&typeof $!="boolean"&&(n.type=$),o!=null||r!=null){if(!($!=="submit"&&$!=="reset"||o!=null)){_u(n);return}r=r!=null?""+mi(r):"",o=o!=null?""+mi(o):r,k||o===n.value||(n.value=o),n.defaultValue=o}u=u??f,u=typeof u!="function"&&typeof u!="symbol"&&!!u,n.checked=k?n.checked:!!u,n.defaultChecked=!!u,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(n.name=S),_u(n)}function Cl(n,o,r){o==="number"&&It(n.ownerDocument)===n||n.defaultValue===""+r||(n.defaultValue=""+r)}function Qo(n,o,r,u){if(n=n.options,o){o={};for(var f=0;f<r.length;f++)o["$"+r[f]]=!0;for(r=0;r<n.length;r++)f=o.hasOwnProperty("$"+n[r].value),n[r].selected!==f&&(n[r].selected=f),f&&u&&(n[r].defaultSelected=!0)}else{for(r=""+mi(r),o=null,f=0;f<n.length;f++){if(n[f].value===r){n[f].selected=!0,u&&(n[f].defaultSelected=!0);return}o!==null||n[f].disabled||(o=n[f])}o!==null&&(o.selected=!0)}}function Rl(n,o,r){if(o!=null&&(o=""+mi(o),o!==n.value&&(n.value=o),r==null)){n.defaultValue!==o&&(n.defaultValue=o);return}n.defaultValue=r!=null?""+mi(r):""}function jr(n,o,r,u){if(o==null){if(u!=null){if(r!=null)throw Error(a(92));if(kt(u)){if(1<u.length)throw Error(a(93));u=u[0]}r=u}r==null&&(r=""),o=r}r=mi(o),n.defaultValue=r,u=n.textContent,u===r&&u!==""&&u!==null&&(n.value=u),_u(n)}function ir(n,o){if(o){var r=n.firstChild;if(r&&r===n.lastChild&&r.nodeType===3){r.nodeValue=o;return}}n.textContent=o}var Oc=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function zt(n,o,r){var u=o.indexOf("--")===0;r==null||typeof r=="boolean"||r===""?u?n.setProperty(o,""):o==="float"?n.cssFloat="":n[o]="":u?n.setProperty(o,r):typeof r!="number"||r===0||Oc.has(o)?o==="float"?n.cssFloat=r:n[o]=(""+r).trim():n[o]=r+"px"}function pa(n,o,r){if(o!=null&&typeof o!="object")throw Error(a(62));if(n=n.style,r!=null){for(var u in r)!r.hasOwnProperty(u)||o!=null&&o.hasOwnProperty(u)||(u.indexOf("--")===0?n.setProperty(u,""):u==="float"?n.cssFloat="":n[u]="");for(var f in o)u=o[f],o.hasOwnProperty(f)&&r[f]!==u&&zt(n,f,u)}else for(var $ in o)o.hasOwnProperty($)&&zt(n,$,o[$])}function Il(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xh=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Di=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ms(n){return Di.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function _o(){}var es=null;function Ls(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var or=null,wn=null;function gn(n){var o=rn(n);if(o&&(n=o.stateNode)){var r=n[Qn]||null;e:switch(n=o.stateNode,o.type){case"input":if(Ci(n,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name),o=r.name,r.type==="radio"&&o!=null){for(r=n;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll('input[name="'+_i(""+o)+'"][type="radio"]'),o=0;o<r.length;o++){var u=r[o];if(u!==n&&u.form===n.form){var f=u[Qn]||null;if(!f)throw Error(a(90));Ci(u,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(o=0;o<r.length;o++)u=r[o],u.form===n.form&&No(u)}break e;case"textarea":Rl(n,r.value,r.defaultValue);break e;case"select":o=r.value,o!=null&&Qo(n,!!r.multiple,o,!1)}}}var _s=!1;function sr(n,o,r){if(_s)return n(o,r);_s=!0;try{var u=n(o);return u}finally{if(_s=!1,(or!==null||wn!==null)&&($h(),or&&(o=or,n=wn,wn=or=null,gn(o),n)))for(o=0;o<n.length;o++)gn(n[o])}}function bs(n,o){var r=n.stateNode;if(r===null)return null;var u=r[Qn]||null;if(u===null)return null;r=u[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(n=n.type,u=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!u;break e;default:n=!1}if(n)return null;if(r&&typeof r!="function")throw Error(a(231,o,typeof r));return r}var di=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ga=!1;if(di)try{var xi={};Object.defineProperty(xi,"passive",{get:function(){ga=!0}}),window.addEventListener("test",xi,xi),window.removeEventListener("test",xi,xi)}catch{ga=!1}var ko=null,bu=null,Ds=null;function Mo(){if(Ds)return Ds;var n,o=bu,r=o.length,u,f="value"in ko?ko.value:ko.textContent,$=f.length;for(n=0;n<r&&o[n]===f[n];n++);var S=r-n;for(u=1;u<=S&&o[r-u]===f[$-u];u++);return Ds=f.slice(n,1<u?1-u:void 0)}function xs(n){var o=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&o===13&&(n=13)):n=o,n===10&&(n=13),32<=n||n===13?n:0}function Ol(){return!0}function $a(){return!1}function oi(n){function o(r,u,f,$,S){this._reactName=r,this._targetInst=f,this.type=u,this.nativeEvent=$,this.target=S,this.currentTarget=null;for(var k in n)n.hasOwnProperty(k)&&(r=n[k],this[k]=r?r($):$[k]);return this.isDefaultPrevented=($.defaultPrevented!=null?$.defaultPrevented:$.returnValue===!1)?Ol:$a,this.isPropagationStopped=$a,this}return D(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Ol)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Ol)},persist:function(){},isPersistent:Ol}),o}var rr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Eu=oi(rr),ao=D({},rr,{view:0,detail:0}),Tu=oi(ao),Bs,lr,Es,Zi=D({},ao,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ar,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Es&&(Es&&n.type==="mousemove"?(Bs=n.screenX-Es.screenX,lr=n.screenY-Es.screenY):lr=Bs=0,Es=n),Bs)},movementY:function(n){return"movementY"in n?n.movementY:lr}}),vu=oi(Zi),ma=D({},Zi,{dataTransfer:0}),Ac=oi(ma),yu=D({},ao,{relatedTarget:0}),Xr=oi(yu),Su=D({},rr,{animationName:0,elapsedTime:0,pseudoElement:0}),wc=oi(Su),Nc=D({},rr,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),bo=oi(Nc),ur=D({},rr,{data:0}),Al=oi(ur),_a={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ba={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ri={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wl(n){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(n):(n=Ri[n])?!!o[n]:!1}function ar(){return wl}var kc=D({},ao,{key:function(n){if(n.key){var o=_a[n.key]||n.key;if(o!=="Unidentified")return o}return n.type==="keypress"?(n=xs(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?ba[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ar,charCode:function(n){return n.type==="keypress"?xs(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?xs(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Cu=oi(kc),Mc=D({},Zi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ea=oi(Mc),Nl=D({},ao,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ar}),Ta=oi(Nl),Eo=D({},rr,{propertyName:0,elapsedTime:0,pseudoElement:0}),kl=oi(Eo),va=D({},Zi,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Ps=oi(va),Ml=D({},rr,{newState:0,oldState:0}),ya=oi(Ml),Lc=[9,13,27,32],cr=di&&"CompositionEvent"in window,ts=null;di&&"documentMode"in document&&(ts=document.documentMode);var Dc=di&&"TextEvent"in window&&!ts,Ru=di&&(!cr||ts&&8<ts&&11>=ts),Ll=" ",Sa=!1;function Iu(n,o){switch(n){case"keyup":return Lc.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ca(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Fs=!1;function Ra(n,o){switch(n){case"compositionend":return Ca(o);case"keypress":return o.which!==32?null:(Sa=!0,Ll);case"textInput":return n=o.data,n===Ll&&Sa?null:n;default:return null}}function xc(n,o){if(Fs)return n==="compositionend"||!cr&&Iu(n,o)?(n=Mo(),Ds=bu=ko=null,Fs=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Ru&&o.locale!=="ko"?null:o.data;default:return null}}var Bc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hr(n){var o=n&&n.nodeName&&n.nodeName.toLowerCase();return o==="input"?!!Bc[n.type]:o==="textarea"}function Ou(n,o,r,u){or?wn?wn.push(u):wn=[u]:or=u,o=hc(o,"onChange"),0<o.length&&(r=new Eu("onChange","change",null,r,u),n.push({event:r,listeners:o}))}var Us=null,dr=null;function Ts(n){Xo(n,0)}function Dl(n){var o=lo(n);if(No(o))return n}function Yr(n,o){if(n==="change")return o}var co=!1;if(di){var Nn;if(di){var fr="oninput"in document;if(!fr){var ho=document.createElement("div");ho.setAttribute("oninput","return;"),fr=typeof ho.oninput=="function"}Nn=fr}else Nn=!1;co=Nn&&(!document.documentMode||9<document.documentMode)}function Au(){Us&&(Us.detachEvent("onpropertychange",xl),dr=Us=null)}function xl(n){if(n.propertyName==="value"&&Dl(dr)){var o=[];Ou(o,dr,n,Ls(n)),sr(Ts,o)}}function Pc(n,o,r){n==="focusin"?(Au(),Us=o,dr=r,Us.attachEvent("onpropertychange",xl)):n==="focusout"&&Au()}function pr(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Dl(dr)}function Ia(n,o){if(n==="click")return Dl(o)}function Kr(n,o){if(n==="input"||n==="change")return Dl(o)}function Hs(n,o){return n===o&&(n!==0||1/n===1/o)||n!==n&&o!==o}var fi=typeof Object.is=="function"?Object.is:Hs;function d(n,o){if(fi(n,o))return!0;if(typeof n!="object"||n===null||typeof o!="object"||o===null)return!1;var r=Object.keys(n),u=Object.keys(o);if(r.length!==u.length)return!1;for(u=0;u<r.length;u++){var f=r[u];if(!Ki.call(o,f)||!fi(n[f],o[f]))return!1}return!0}function g(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function b(n,o){var r=g(n);n=0;for(var u;r;){if(r.nodeType===3){if(u=n+r.textContent.length,n<=o&&u>=o)return{node:r,offset:o-n};n=u}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=g(r)}}function y(n,o){return n&&o?n===o?!0:n&&n.nodeType===3?!1:o&&o.nodeType===3?y(n,o.parentNode):"contains"in n?n.contains(o):n.compareDocumentPosition?!!(n.compareDocumentPosition(o)&16):!1:!1}function R(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var o=It(n.document);o instanceof n.HTMLIFrameElement;){try{var r=typeof o.contentWindow.location.href=="string"}catch{r=!1}if(r)n=o.contentWindow;else break;o=It(n.document)}return o}function w(n){var o=n&&n.nodeName&&n.nodeName.toLowerCase();return o&&(o==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||o==="textarea"||n.contentEditable==="true")}var x=di&&"documentMode"in document&&11>=document.documentMode,U=null,W=null,q=null,ie=!1;function z(n,o,r){var u=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;ie||U==null||U!==It(u)||(u=U,"selectionStart"in u&&w(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),q&&d(q,u)||(q=u,u=hc(W,"onSelect"),0<u.length&&(o=new Eu("onSelect","select",null,o,r),n.push({event:o,listeners:u}),o.target=U)))}function se(n,o){var r={};return r[n.toLowerCase()]=o.toLowerCase(),r["Webkit"+n]="webkit"+o,r["Moz"+n]="moz"+o,r}var Z={animationend:se("Animation","AnimationEnd"),animationiteration:se("Animation","AnimationIteration"),animationstart:se("Animation","AnimationStart"),transitionrun:se("Transition","TransitionRun"),transitionstart:se("Transition","TransitionStart"),transitioncancel:se("Transition","TransitionCancel"),transitionend:se("Transition","TransitionEnd")},te={},ne={};di&&(ne=document.createElement("div").style,"AnimationEvent"in window||(delete Z.animationend.animation,delete Z.animationiteration.animation,delete Z.animationstart.animation),"TransitionEvent"in window||delete Z.transitionend.transition);function oe(n){if(te[n])return te[n];if(!Z[n])return n;var o=Z[n],r;for(r in o)if(o.hasOwnProperty(r)&&r in ne)return te[n]=o[r];return n}var ue=oe("animationend"),$e=oe("animationiteration"),ye=oe("animationstart"),ke=oe("transitionrun"),ze=oe("transitionstart"),nt=oe("transitioncancel"),Pe=oe("transitionend"),Ye=new Map,et="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");et.push("scrollEnd");function Ue(n,o){Ye.set(n,o),Jo(o,[n])}var Ge=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},Tt=[],Ct=0,At=0;function Ii(){for(var n=Ct,o=At=Ct=0;o<n;){var r=Tt[o];Tt[o++]=null;var u=Tt[o];Tt[o++]=null;var f=Tt[o];Tt[o++]=null;var $=Tt[o];if(Tt[o++]=null,u!==null&&f!==null){var S=u.pending;S===null?f.next=f:(f.next=S.next,S.next=f),u.pending=f}$!==0&&qr(r,f,$)}}function Ot(n,o,r,u){Tt[Ct++]=n,Tt[Ct++]=o,Tt[Ct++]=r,Tt[Ct++]=u,At|=u,n.lanes|=u,n=n.alternate,n!==null&&(n.lanes|=u)}function ei(n,o,r,u){return Ot(n,o,r,u),Dn(n)}function vn(n,o){return Ot(n,null,null,o),Dn(n)}function qr(n,o,r){n.lanes|=r;var u=n.alternate;u!==null&&(u.lanes|=r);for(var f=!1,$=n.return;$!==null;)$.childLanes|=r,u=$.alternate,u!==null&&(u.childLanes|=r),$.tag===22&&(n=$.stateNode,n===null||n._visibility&1||(f=!0)),n=$,$=$.return;return n.tag===3?($=n.stateNode,f&&o!==null&&(f=31-F(r),n=$.hiddenUpdates,u=n[f],u===null?n[f]=[o]:u.push(o),o.lane=r|536870912),$):null}function Dn(n){if(50<oc)throw oc=0,Jn=null,Error(a(185));for(var o=n.return;o!==null;)n=o,o=n.return;return n.tag===3?n.stateNode:null}var Bi={};function wu(n,o,r,u){this.tag=n,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function To(n,o,r,u){return new wu(n,o,r,u)}function Bh(n){return n=n.prototype,!(!n||!n.isReactComponent)}function gr(n,o){var r=n.alternate;return r===null?(r=To(n.tag,o,n.key,n.mode),r.elementType=n.elementType,r.type=n.type,r.stateNode=n.stateNode,r.alternate=n,n.alternate=r):(r.pendingProps=o,r.type=n.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=n.flags&65011712,r.childLanes=n.childLanes,r.lanes=n.lanes,r.child=n.child,r.memoizedProps=n.memoizedProps,r.memoizedState=n.memoizedState,r.updateQueue=n.updateQueue,o=n.dependencies,r.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},r.sibling=n.sibling,r.index=n.index,r.ref=n.ref,r.refCleanup=n.refCleanup,r}function pf(n,o){n.flags&=65011714;var r=n.alternate;return r===null?(n.childLanes=0,n.lanes=o,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=r.childLanes,n.lanes=r.lanes,n.child=r.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=r.memoizedProps,n.memoizedState=r.memoizedState,n.updateQueue=r.updateQueue,n.type=r.type,o=r.dependencies,n.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),n}function Oa(n,o,r,u,f,$){var S=0;if(u=n,typeof n=="function")Bh(n)&&(S=1);else if(typeof n=="string")S=Hr(n,r,it.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case ht:return n=To(31,r,o,f),n.elementType=ht,n.lanes=$,n;case ve:return Bl(r.children,f,$,o);case Xe:S=8,f|=24;break;case Ke:return n=To(12,r,o,f|2),n.elementType=Ke,n.lanes=$,n;case rt:return n=To(13,r,o,f),n.elementType=rt,n.lanes=$,n;case De:return n=To(19,r,o,f),n.elementType=De,n.lanes=$,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case Le:S=10;break e;case _e:S=9;break e;case Ae:S=11;break e;case xe:S=14;break e;case at:S=16,u=null;break e}S=29,r=Error(a(130,n===null?"null":typeof n,"")),u=null}return o=To(S,r,o,f),o.elementType=n,o.type=u,o.lanes=$,o}function Bl(n,o,r,u){return n=To(7,n,u,o),n.lanes=r,n}function Fc(n,o,r){return n=To(6,n,null,o),n.lanes=r,n}function Nu(n){var o=To(18,null,null,0);return o.stateNode=n,o}function Ph(n,o,r){return o=To(4,n.children!==null?n.children:[],n.key,o),o.lanes=r,o.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},o}var gf=new WeakMap;function ns(n,o){if(typeof n=="object"&&n!==null){var r=gf.get(n);return r!==void 0?r:(o={value:n,source:o,stack:Yi(o)},gf.set(n,o),o)}return{value:n,source:o,stack:Yi(o)}}var ku=[],$r=0,Aa=null,Mu=0,vo=[],yo=0,Jr=null,Lo=1,vs="";function is(n,o){ku[$r++]=Mu,ku[$r++]=Aa,Aa=n,Mu=o}function $f(n,o,r){vo[yo++]=Lo,vo[yo++]=vs,vo[yo++]=Jr,Jr=n;var u=Lo;n=vs;var f=32-F(u)-1;u&=~(1<<f),r+=1;var $=32-F(o)+f;if(30<$){var S=f-f%5;$=(u&(1<<S)-1).toString(32),u>>=S,f-=S,Lo=1<<32-F(o)+f|r<<f|u,vs=$+n}else Lo=1<<$|r<<f|u,vs=n}function Fh(n){n.return!==null&&(is(n,1),$f(n,1,0))}function mr(n){for(;n===Aa;)Aa=ku[--$r],ku[$r]=null,Mu=ku[--$r],ku[$r]=null;for(;n===Jr;)Jr=vo[--yo],vo[yo]=null,vs=vo[--yo],vo[yo]=null,Lo=vo[--yo],vo[yo]=null}function Uh(n,o){vo[yo++]=Lo,vo[yo++]=vs,vo[yo++]=Jr,Lo=o.id,vs=o.overflow,Jr=n}var xn=null,Bn=null,Kt=!1,_r=null,os=!1,Zr=Error(a(519));function br(n){var o=Error(a(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Du(ns(o,n)),Zr}function mf(n){var o=n.stateNode,r=n.type,u=n.memoizedProps;switch(o[Tn]=n,o[Qn]=u,r){case"dialog":Vt("cancel",o),Vt("close",o);break;case"iframe":case"object":case"embed":Vt("load",o);break;case"video":case"audio":for(r=0;r<Pr.length;r++)Vt(Pr[r],o);break;case"source":Vt("error",o);break;case"img":case"image":case"link":Vt("error",o),Vt("load",o);break;case"details":Vt("toggle",o);break;case"input":Vt("invalid",o),Zo(o,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0);break;case"select":Vt("invalid",o);break;case"textarea":Vt("invalid",o),jr(o,u.value,u.defaultValue,u.children)}r=u.children,typeof r!="string"&&typeof r!="number"&&typeof r!="bigint"||o.textContent===""+r||u.suppressHydrationWarning===!0||Ch(o.textContent,r)?(u.popover!=null&&(Vt("beforetoggle",o),Vt("toggle",o)),u.onScroll!=null&&Vt("scroll",o),u.onScrollEnd!=null&&Vt("scrollend",o),u.onClick!=null&&(o.onclick=_o),o=!0):o=!1,o||br(n,!0)}function _f(n){for(xn=n.return;xn;)switch(xn.tag){case 5:case 31:case 13:os=!1;return;case 27:case 3:os=!0;return;default:xn=xn.return}}function Lu(n){if(n!==xn)return!1;if(!Kt)return _f(n),Kt=!0,!1;var o=n.tag,r;if((r=o!==3&&o!==27)&&((r=o===5)&&(r=n.type,r=!(r!=="form"&&r!=="button")||hp(n.type,n.memoizedProps)),r=!r),r&&Bn&&br(n),_f(n),o===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));Bn=ws(n)}else if(o===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(317));Bn=ws(n)}else o===27?(o=Bn,lu(n.type)?(n=pp,pp=null,Bn=n):Bn=o):Bn=xn?io(n.stateNode.nextSibling):null;return!0}function Pl(){Bn=xn=null,Kt=!1}function Hh(){var n=_r;return n!==null&&(vi===null?vi=n:vi.push.apply(vi,n),_r=null),n}function Du(n){_r===null?_r=[n]:_r.push(n)}var Gh=J(null),Fl=null,ys=null;function Qr(n,o,r){He(Gh,o._currentValue),o._currentValue=r}function Er(n){n._currentValue=Gh.current,Ce(Gh)}function Uc(n,o,r){for(;n!==null;){var u=n.alternate;if((n.childLanes&o)!==o?(n.childLanes|=o,u!==null&&(u.childLanes|=o)):u!==null&&(u.childLanes&o)!==o&&(u.childLanes|=o),n===r)break;n=n.return}}function Ss(n,o,r,u){var f=n.child;for(f!==null&&(f.return=n);f!==null;){var $=f.dependencies;if($!==null){var S=f.child;$=$.firstContext;e:for(;$!==null;){var k=$;$=f;for(var V=0;V<o.length;V++)if(k.context===o[V]){$.lanes|=r,k=$.alternate,k!==null&&(k.lanes|=r),Uc($.return,r,n),u||(S=null);break e}$=k.next}}else if(f.tag===18){if(S=f.return,S===null)throw Error(a(341));S.lanes|=r,$=S.alternate,$!==null&&($.lanes|=r),Uc(S,r,n),S=null}else S=f.child;if(S!==null)S.return=f;else for(S=f;S!==null;){if(S===n){S=null;break}if(f=S.sibling,f!==null){f.return=S.return,S=f;break}S=S.return}f=S}}function xu(n,o,r,u){n=null;for(var f=o,$=!1;f!==null;){if(!$){if((f.flags&524288)!==0)$=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var S=f.alternate;if(S===null)throw Error(a(387));if(S=S.memoizedProps,S!==null){var k=f.type;fi(f.pendingProps.value,S.value)||(n!==null?n.push(k):n=[k])}}else if(f===Pt.current){if(S=f.alternate,S===null)throw Error(a(387));S.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(n!==null?n.push(bc):n=[bc])}f=f.return}n!==null&&Ss(o,n,r,u),o.flags|=262144}function Hc(n){for(n=n.firstContext;n!==null;){if(!fi(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Cs(n){Fl=n,ys=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Pi(n){return Gc(Fl,n)}function wa(n,o){return Fl===null&&Cs(n),Gc(n,o)}function Gc(n,o){var r=o._currentValue;if(o={context:o,memoizedValue:r,next:null},ys===null){if(n===null)throw Error(a(308));ys=o,n.dependencies={lanes:0,firstContext:o},n.flags|=524288}else ys=ys.next=o;return r}var Dp=typeof AbortController<"u"?AbortController:function(){var n=[],o=this.signal={aborted:!1,addEventListener:function(r,u){n.push(u)}};this.abort=function(){o.aborted=!0,n.forEach(function(r){return r()})}},xp=h.unstable_scheduleCallback,Bp=h.unstable_NormalPriority,si={$$typeof:Le,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Na(){return{controller:new Dp,data:new Map,refCount:0}}function Bu(n){n.refCount--,n.refCount===0&&xp(Bp,function(){n.controller.abort()})}var Ul=null,Vh=0,Pu=0,Fu=null;function Pp(n,o){if(Ul===null){var r=Ul=[];Vh=0,Pu=jo(),Fu={status:"pending",value:void 0,then:function(u){r.push(u)}}}return Vh++,o.then(pt,pt),o}function pt(){if(--Vh===0&&Ul!==null){Fu!==null&&(Fu.status="fulfilled");var n=Ul;Ul=null,Pu=0,Fu=null;for(var o=0;o<n.length;o++)(0,n[o])()}}function Do(n,o){var r=[],u={status:"pending",value:null,reason:null,then:function(f){r.push(f)}};return n.then(function(){u.status="fulfilled",u.value=o;for(var f=0;f<r.length;f++)(0,r[f])(o)},function(f){for(u.status="rejected",u.reason=f,f=0;f<r.length;f++)(0,r[f])(void 0)}),u}var Oi=de.S;de.S=function(n,o){ep=In(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&Pp(n,o),Oi!==null&&Oi(n,o)};var yn=J(null);function Rs(){var n=yn.current;return n!==null?n:hn.pooledCache}function el(n,o){o===null?He(yn,yn.current):He(yn,o.pool)}function $t(){var n=Rs();return n===null?null:{parent:si._currentValue,pool:n}}var kn=Error(a(460)),zh=Error(a(474)),Vc=Error(a(542)),zc={then:function(){}};function Wh(n){return n=n.status,n==="fulfilled"||n==="rejected"}function bf(n,o,r){switch(r=n[r],r===void 0?n.push(o):r!==o&&(o.then(_o,_o),o=r),o.status){case"fulfilled":return o.value;case"rejected":throw n=o.reason,Xh(n),n;default:if(typeof o.status=="string")o.then(_o,_o);else{if(n=hn,n!==null&&100<n.shellSuspendCounter)throw Error(a(482));n=o,n.status="pending",n.then(function(u){if(o.status==="pending"){var f=o;f.status="fulfilled",f.value=u}},function(u){if(o.status==="pending"){var f=o;f.status="rejected",f.reason=u}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw n=o.reason,Xh(n),n}throw tl=o,kn}}function Tr(n){try{var o=n._init;return o(n._payload)}catch(r){throw r!==null&&typeof r=="object"&&typeof r.then=="function"?(tl=r,kn):r}}var tl=null;function jh(){if(tl===null)throw Error(a(459));var n=tl;return tl=null,n}function Xh(n){if(n===kn||n===Vc)throw Error(a(483))}var Hl=null,vr=0;function Wc(n){var o=vr;return vr+=1,Hl===null&&(Hl=[]),bf(Hl,n,o)}function ka(n,o){o=o.props.ref,n.ref=o!==void 0?o:null}function jc(n,o){throw o.$$typeof===j?Error(a(525)):(n=Object.prototype.toString.call(o),Error(a(31,n==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":n)))}function Uu(n){function o(re,Q){if(n){var he=re.deletions;he===null?(re.deletions=[Q],re.flags|=16):he.push(Q)}}function r(re,Q){if(!n)return null;for(;Q!==null;)o(re,Q),Q=Q.sibling;return null}function u(re){for(var Q=new Map;re!==null;)re.key!==null?Q.set(re.key,re):Q.set(re.index,re),re=re.sibling;return Q}function f(re,Q){return re=gr(re,Q),re.index=0,re.sibling=null,re}function $(re,Q,he){return re.index=he,n?(he=re.alternate,he!==null?(he=he.index,he<Q?(re.flags|=67108866,Q):he):(re.flags|=67108866,Q)):(re.flags|=1048576,Q)}function S(re){return n&&re.alternate===null&&(re.flags|=67108866),re}function k(re,Q,he,we){return Q===null||Q.tag!==6?(Q=Fc(he,re.mode,we),Q.return=re,Q):(Q=f(Q,he),Q.return=re,Q)}function V(re,Q,he,we){var bt=he.type;return bt===ve?Ie(re,Q,he.props.children,we,he.key):Q!==null&&(Q.elementType===bt||typeof bt=="object"&&bt!==null&&bt.$$typeof===at&&Tr(bt)===Q.type)?(Q=f(Q,he.props),ka(Q,he),Q.return=re,Q):(Q=Oa(he.type,he.key,he.props,null,re.mode,we),ka(Q,he),Q.return=re,Q)}function fe(re,Q,he,we){return Q===null||Q.tag!==4||Q.stateNode.containerInfo!==he.containerInfo||Q.stateNode.implementation!==he.implementation?(Q=Ph(he,re.mode,we),Q.return=re,Q):(Q=f(Q,he.children||[]),Q.return=re,Q)}function Ie(re,Q,he,we,bt){return Q===null||Q.tag!==7?(Q=Bl(he,re.mode,we,bt),Q.return=re,Q):(Q=f(Q,he),Q.return=re,Q)}function Me(re,Q,he){if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return Q=Fc(""+Q,re.mode,he),Q.return=re,Q;if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case be:return he=Oa(Q.type,Q.key,Q.props,null,re.mode,he),ka(he,Q),he.return=re,he;case Oe:return Q=Ph(Q,re.mode,he),Q.return=re,Q;case at:return Q=Tr(Q),Me(re,Q,he)}if(kt(Q)||Rt(Q))return Q=Bl(Q,re.mode,he,null),Q.return=re,Q;if(typeof Q.then=="function")return Me(re,Wc(Q),he);if(Q.$$typeof===Le)return Me(re,wa(re,Q),he);jc(re,Q)}return null}function me(re,Q,he,we){var bt=Q!==null?Q.key:null;if(typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint")return bt!==null?null:k(re,Q,""+he,we);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case be:return he.key===bt?V(re,Q,he,we):null;case Oe:return he.key===bt?fe(re,Q,he,we):null;case at:return he=Tr(he),me(re,Q,he,we)}if(kt(he)||Rt(he))return bt!==null?null:Ie(re,Q,he,we,null);if(typeof he.then=="function")return me(re,Q,Wc(he),we);if(he.$$typeof===Le)return me(re,Q,wa(re,he),we);jc(re,he)}return null}function Ee(re,Q,he,we,bt){if(typeof we=="string"&&we!==""||typeof we=="number"||typeof we=="bigint")return re=re.get(he)||null,k(Q,re,""+we,bt);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case be:return re=re.get(we.key===null?he:we.key)||null,V(Q,re,we,bt);case Oe:return re=re.get(we.key===null?he:we.key)||null,fe(Q,re,we,bt);case at:return we=Tr(we),Ee(re,Q,he,we,bt)}if(kt(we)||Rt(we))return re=re.get(he)||null,Ie(Q,re,we,bt,null);if(typeof we.then=="function")return Ee(re,Q,he,Wc(we),bt);if(we.$$typeof===Le)return Ee(re,Q,he,wa(Q,we),bt);jc(Q,we)}return null}function ct(re,Q,he,we){for(var bt=null,Zt=null,gt=Q,ut=Q=0,Xt=null;gt!==null&&ut<he.length;ut++){gt.index>ut?(Xt=gt,gt=null):Xt=gt.sibling;var on=me(re,gt,he[ut],we);if(on===null){gt===null&&(gt=Xt);break}n&&gt&&on.alternate===null&&o(re,gt),Q=$(on,Q,ut),Zt===null?bt=on:Zt.sibling=on,Zt=on,gt=Xt}if(ut===he.length)return r(re,gt),Kt&&is(re,ut),bt;if(gt===null){for(;ut<he.length;ut++)gt=Me(re,he[ut],we),gt!==null&&(Q=$(gt,Q,ut),Zt===null?bt=gt:Zt.sibling=gt,Zt=gt);return Kt&&is(re,ut),bt}for(gt=u(gt);ut<he.length;ut++)Xt=Ee(gt,re,ut,he[ut],we),Xt!==null&&(n&&Xt.alternate!==null&&gt.delete(Xt.key===null?ut:Xt.key),Q=$(Xt,Q,ut),Zt===null?bt=Xt:Zt.sibling=Xt,Zt=Xt);return n&&gt.forEach(function(Oo){return o(re,Oo)}),Kt&&is(re,ut),bt}function yt(re,Q,he,we){if(he==null)throw Error(a(151));for(var bt=null,Zt=null,gt=Q,ut=Q=0,Xt=null,on=he.next();gt!==null&&!on.done;ut++,on=he.next()){gt.index>ut?(Xt=gt,gt=null):Xt=gt.sibling;var Oo=me(re,gt,on.value,we);if(Oo===null){gt===null&&(gt=Xt);break}n&&gt&&Oo.alternate===null&&o(re,gt),Q=$(Oo,Q,ut),Zt===null?bt=Oo:Zt.sibling=Oo,Zt=Oo,gt=Xt}if(on.done)return r(re,gt),Kt&&is(re,ut),bt;if(gt===null){for(;!on.done;ut++,on=he.next())on=Me(re,on.value,we),on!==null&&(Q=$(on,Q,ut),Zt===null?bt=on:Zt.sibling=on,Zt=on);return Kt&&is(re,ut),bt}for(gt=u(gt);!on.done;ut++,on=he.next())on=Ee(gt,re,ut,on.value,we),on!==null&&(n&&on.alternate!==null&&gt.delete(on.key===null?ut:on.key),Q=$(on,Q,ut),Zt===null?bt=on:Zt.sibling=on,Zt=on);return n&&gt.forEach(function(hg){return o(re,hg)}),Kt&&is(re,ut),bt}function cn(re,Q,he,we){if(typeof he=="object"&&he!==null&&he.type===ve&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case be:e:{for(var bt=he.key;Q!==null;){if(Q.key===bt){if(bt=he.type,bt===ve){if(Q.tag===7){r(re,Q.sibling),we=f(Q,he.props.children),we.return=re,re=we;break e}}else if(Q.elementType===bt||typeof bt=="object"&&bt!==null&&bt.$$typeof===at&&Tr(bt)===Q.type){r(re,Q.sibling),we=f(Q,he.props),ka(we,he),we.return=re,re=we;break e}r(re,Q);break}else o(re,Q);Q=Q.sibling}he.type===ve?(we=Bl(he.props.children,re.mode,we,he.key),we.return=re,re=we):(we=Oa(he.type,he.key,he.props,null,re.mode,we),ka(we,he),we.return=re,re=we)}return S(re);case Oe:e:{for(bt=he.key;Q!==null;){if(Q.key===bt)if(Q.tag===4&&Q.stateNode.containerInfo===he.containerInfo&&Q.stateNode.implementation===he.implementation){r(re,Q.sibling),we=f(Q,he.children||[]),we.return=re,re=we;break e}else{r(re,Q);break}else o(re,Q);Q=Q.sibling}we=Ph(he,re.mode,we),we.return=re,re=we}return S(re);case at:return he=Tr(he),cn(re,Q,he,we)}if(kt(he))return ct(re,Q,he,we);if(Rt(he)){if(bt=Rt(he),typeof bt!="function")throw Error(a(150));return he=bt.call(he),yt(re,Q,he,we)}if(typeof he.then=="function")return cn(re,Q,Wc(he),we);if(he.$$typeof===Le)return cn(re,Q,wa(re,he),we);jc(re,he)}return typeof he=="string"&&he!==""||typeof he=="number"||typeof he=="bigint"?(he=""+he,Q!==null&&Q.tag===6?(r(re,Q.sibling),we=f(Q,he),we.return=re,re=we):(r(re,Q),we=Fc(he,re.mode,we),we.return=re,re=we),S(re)):r(re,Q)}return function(re,Q,he,we){try{vr=0;var bt=cn(re,Q,he,we);return Hl=null,bt}catch(gt){if(gt===kn||gt===Vc)throw gt;var Zt=To(29,gt,null,re.mode);return Zt.lanes=we,Zt.return=re,Zt}finally{}}}var nl=Uu(!0),Ef=Uu(!1),Gs=!1;function xo(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Xc(n,o){n=n.updateQueue,o.updateQueue===n&&(o.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function ss(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Fi(n,o,r){var u=n.updateQueue;if(u===null)return null;if(u=u.shared,(an&2)!==0){var f=u.pending;return f===null?o.next=o:(o.next=f.next,f.next=o),u.pending=o,o=Dn(n),qr(n,null,r),o}return Ot(n,u,o,r),Dn(n)}function Hu(n,o,r){if(o=o.updateQueue,o!==null&&(o=o.shared,(r&4194048)!==0)){var u=o.lanes;u&=n.pendingLanes,r|=u,o.lanes=r,St(n,r)}}function Yh(n,o){var r=n.updateQueue,u=n.alternate;if(u!==null&&(u=u.updateQueue,r===u)){var f=null,$=null;if(r=r.firstBaseUpdate,r!==null){do{var S={lane:r.lane,tag:r.tag,payload:r.payload,callback:null,next:null};$===null?f=$=S:$=$.next=S,r=r.next}while(r!==null);$===null?f=$=o:$=$.next=o}else f=$=o;r={baseState:u.baseState,firstBaseUpdate:f,lastBaseUpdate:$,shared:u.shared,callbacks:u.callbacks},n.updateQueue=r;return}n=r.lastBaseUpdate,n===null?r.firstBaseUpdate=o:n.next=o,r.lastBaseUpdate=o}var Gl=!1;function Ma(){if(Gl){var n=Fu;if(n!==null)throw n}}function Is(n,o,r,u){Gl=!1;var f=n.updateQueue;Gs=!1;var $=f.firstBaseUpdate,S=f.lastBaseUpdate,k=f.shared.pending;if(k!==null){f.shared.pending=null;var V=k,fe=V.next;V.next=null,S===null?$=fe:S.next=fe,S=V;var Ie=n.alternate;Ie!==null&&(Ie=Ie.updateQueue,k=Ie.lastBaseUpdate,k!==S&&(k===null?Ie.firstBaseUpdate=fe:k.next=fe,Ie.lastBaseUpdate=V))}if($!==null){var Me=f.baseState;S=0,Ie=fe=V=null,k=$;do{var me=k.lane&-536870913,Ee=me!==k.lane;if(Ee?(wt&me)===me:(u&me)===me){me!==0&&me===Pu&&(Gl=!0),Ie!==null&&(Ie=Ie.next={lane:0,tag:k.tag,payload:k.payload,callback:null,next:null});e:{var ct=n,yt=k;me=o;var cn=r;switch(yt.tag){case 1:if(ct=yt.payload,typeof ct=="function"){Me=ct.call(cn,Me,me);break e}Me=ct;break e;case 3:ct.flags=ct.flags&-65537|128;case 0:if(ct=yt.payload,me=typeof ct=="function"?ct.call(cn,Me,me):ct,me==null)break e;Me=D({},Me,me);break e;case 2:Gs=!0}}me=k.callback,me!==null&&(n.flags|=64,Ee&&(n.flags|=8192),Ee=f.callbacks,Ee===null?f.callbacks=[me]:Ee.push(me))}else Ee={lane:me,tag:k.tag,payload:k.payload,callback:k.callback,next:null},Ie===null?(fe=Ie=Ee,V=Me):Ie=Ie.next=Ee,S|=me;if(k=k.next,k===null){if(k=f.shared.pending,k===null)break;Ee=k,k=Ee.next,Ee.next=null,f.lastBaseUpdate=Ee,f.shared.pending=null}}while(!0);Ie===null&&(V=Me),f.baseState=V,f.firstBaseUpdate=fe,f.lastBaseUpdate=Ie,$===null&&(f.shared.lanes=0),Ys|=S,n.lanes=S,n.memoizedState=Me}}function Yc(n,o){if(typeof n!="function")throw Error(a(191,n));n.call(o)}function La(n,o){var r=n.callbacks;if(r!==null)for(n.callbacks=null,n=0;n<r.length;n++)Yc(r[n],o)}var Vl=J(null),Kc=J(0);function Kh(n,o){n=Xs,He(Kc,n),He(Vl,o),Xs=n|o.baseLanes}function qh(){He(Kc,Xs),He(Vl,Vl.current)}function Da(){Xs=Kc.current,Ce(Vl),Ce(Kc)}var So=J(null),Bo=null;function yr(n){var o=n.alternate;He(ri,ri.current&1),He(So,n),Bo===null&&(o===null||Vl.current!==null||o.memoizedState!==null)&&(Bo=n)}function Jh(n){He(ri,ri.current),He(So,n),Bo===null&&(Bo=n)}function Zh(n){n.tag===22?(He(ri,ri.current),He(So,n),Bo===null&&(Bo=n)):il()}function il(){He(ri,ri.current),He(So,So.current)}function fo(n){Ce(So),Bo===n&&(Bo=null),Ce(ri)}var ri=J(0);function qc(n){for(var o=n;o!==null;){if(o.tag===13){var r=o.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||ra(r)||fc(r)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var rs=0,xt=null,$n=null,ti=null,Gu=!1,ol=!1,Sr=!1,xa=0,Ba=0,zl=null,Qh=0;function Gn(){throw Error(a(321))}function ed(n,o){if(o===null)return!1;for(var r=0;r<o.length&&r<n.length;r++)if(!fi(n[r],o[r]))return!1;return!0}function Pa(n,o,r,u,f,$){return rs=$,xt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,de.H=n===null||n.memoizedState===null?Lf:Td,Sr=!1,$=r(u,f),Sr=!1,ol&&($=td(o,r,u,f)),Tf(n),$}function Tf(n){de.H=ju;var o=$n!==null&&$n.next!==null;if(rs=0,ti=$n=xt=null,Gu=!1,Ba=0,zl=null,o)throw Error(a(300));n===null||pi||(n=n.dependencies,n!==null&&Hc(n)&&(pi=!0))}function td(n,o,r,u){xt=n;var f=0;do{if(ol&&(zl=null),Ba=0,ol=!1,25<=f)throw Error(a(301));if(f+=1,ti=$n=null,n.updateQueue!=null){var $=n.updateQueue;$.lastEffect=null,$.events=null,$.stores=null,$.memoCache!=null&&($.memoCache.index=0)}de.H=Df,$=o(r,u)}while(ol);return $}function Fp(){var n=de.H,o=n.useState()[0];return o=typeof o.then=="function"?Wu(o):o,n=n.useState()[0],($n!==null?$n.memoizedState:null)!==n&&(xt.flags|=1024),o}function Cr(){var n=xa!==0;return xa=0,n}function Jc(n,o,r){o.updateQueue=n.updateQueue,o.flags&=-2053,n.lanes&=~r}function Vu(n){if(Gu){for(n=n.memoizedState;n!==null;){var o=n.queue;o!==null&&(o.pending=null),n=n.next}Gu=!1}rs=0,ti=$n=xt=null,ol=!1,Ba=xa=0,zl=null}function Qi(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ti===null?xt.memoizedState=ti=n:ti=ti.next=n,ti}function ni(){if($n===null){var n=xt.alternate;n=n!==null?n.memoizedState:null}else n=$n.next;var o=ti===null?xt.memoizedState:ti.next;if(o!==null)ti=o,$n=n;else{if(n===null)throw xt.alternate===null?Error(a(467)):Error(a(310));$n=n,n={memoizedState:$n.memoizedState,baseState:$n.baseState,baseQueue:$n.baseQueue,queue:$n.queue,next:null},ti===null?xt.memoizedState=ti=n:ti=ti.next=n}return ti}function zu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Wu(n){var o=Ba;return Ba+=1,zl===null&&(zl=[]),n=bf(zl,n,o),o=xt,(ti===null?o.memoizedState:ti.next)===null&&(o=o.alternate,de.H=o===null||o.memoizedState===null?Lf:Td),n}function Fa(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Wu(n);if(n.$$typeof===Le)return Pi(n)}throw Error(a(438,String(n)))}function Zc(n){var o=null,r=xt.updateQueue;if(r!==null&&(o=r.memoCache),o==null){var u=xt.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(o={data:u.data.map(function(f){return f.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),r===null&&(r=zu(),xt.updateQueue=r),r.memoCache=o,r=o.data[o.index],r===void 0)for(r=o.data[o.index]=Array(n),u=0;u<n;u++)r[u]=ot;return o.index++,r}function Vs(n,o){return typeof o=="function"?o(n):o}function Ua(n){var o=ni();return Qc(o,$n,n)}function Qc(n,o,r){var u=n.queue;if(u===null)throw Error(a(311));u.lastRenderedReducer=r;var f=n.baseQueue,$=u.pending;if($!==null){if(f!==null){var S=f.next;f.next=$.next,$.next=S}o.baseQueue=f=$,u.pending=null}if($=n.baseState,f===null)n.memoizedState=$;else{o=f.next;var k=S=null,V=null,fe=o,Ie=!1;do{var Me=fe.lane&-536870913;if(Me!==fe.lane?(wt&Me)===Me:(rs&Me)===Me){var me=fe.revertLane;if(me===0)V!==null&&(V=V.next={lane:0,revertLane:0,gesture:null,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null}),Me===Pu&&(Ie=!0);else if((rs&me)===me){fe=fe.next,me===Pu&&(Ie=!0);continue}else Me={lane:0,revertLane:fe.revertLane,gesture:null,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null},V===null?(k=V=Me,S=$):V=V.next=Me,xt.lanes|=me,Ys|=me;Me=fe.action,Sr&&r($,Me),$=fe.hasEagerState?fe.eagerState:r($,Me)}else me={lane:Me,revertLane:fe.revertLane,gesture:fe.gesture,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null},V===null?(k=V=me,S=$):V=V.next=me,xt.lanes|=Me,Ys|=Me;fe=fe.next}while(fe!==null&&fe!==o);if(V===null?S=$:V.next=k,!fi($,n.memoizedState)&&(pi=!0,Ie&&(r=Fu,r!==null)))throw r;n.memoizedState=$,n.baseState=S,n.baseQueue=V,u.lastRenderedState=$}return f===null&&(u.lanes=0),[n.memoizedState,u.dispatch]}function eh(n){var o=ni(),r=o.queue;if(r===null)throw Error(a(311));r.lastRenderedReducer=n;var u=r.dispatch,f=r.pending,$=o.memoizedState;if(f!==null){r.pending=null;var S=f=f.next;do $=n($,S.action),S=S.next;while(S!==f);fi($,o.memoizedState)||(pi=!0),o.memoizedState=$,o.baseQueue===null&&(o.baseState=$),r.lastRenderedState=$}return[$,u]}function nd(n,o,r){var u=xt,f=ni(),$=Kt;if($){if(r===void 0)throw Error(a(407));r=r()}else r=o();var S=!fi(($n||f).memoizedState,r);if(S&&(f.memoizedState=r,pi=!0),f=f.queue,nh(yf.bind(null,u,f,n),[n]),f.getSnapshot!==o||S||ti!==null&&ti.memoizedState.tag&1){if(u.flags|=2048,Wl(9,{destroy:void 0},vf.bind(null,u,f,r,o),null),hn===null)throw Error(a(349));$||(rs&127)!==0||id(u,o,r)}return r}function id(n,o,r){n.flags|=16384,n={getSnapshot:o,value:r},o=xt.updateQueue,o===null?(o=zu(),xt.updateQueue=o,o.stores=[n]):(r=o.stores,r===null?o.stores=[n]:r.push(n))}function vf(n,o,r,u){o.value=r,o.getSnapshot=u,Sf(o)&&Cf(n)}function yf(n,o,r){return r(function(){Sf(o)&&Cf(n)})}function Sf(n){var o=n.getSnapshot;n=n.value;try{var r=o();return!fi(n,r)}catch{return!0}}function Cf(n){var o=vn(n,2);o!==null&&Vi(o,n,2)}function od(n){var o=Qi();if(typeof n=="function"){var r=n;if(n=r(),Sr){Y(!0);try{r()}finally{Y(!1)}}}return o.memoizedState=o.baseState=n,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vs,lastRenderedState:n},o}function Rf(n,o,r,u){return n.baseState=r,Qc(n,$n,typeof u=="function"?u:Vs)}function Up(n,o,r,u,f){if(Rr(n))throw Error(a(485));if(n=o.action,n!==null){var $={payload:f,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){$.listeners.push(S)}};de.T!==null?r(!0):$.isTransition=!1,u($),r=o.pending,r===null?($.next=o.pending=$,If(o,$)):($.next=r.next,o.pending=r.next=$)}}function If(n,o){var r=o.action,u=o.payload,f=n.state;if(o.isTransition){var $=de.T,S={};de.T=S;try{var k=r(f,u),V=de.S;V!==null&&V(S,k),Of(n,o,k)}catch(fe){th(n,o,fe)}finally{$!==null&&S.types!==null&&($.types=S.types),de.T=$}}else try{$=r(f,u),Of(n,o,$)}catch(fe){th(n,o,fe)}}function Of(n,o,r){r!==null&&typeof r=="object"&&typeof r.then=="function"?r.then(function(u){sd(n,o,u)},function(u){return th(n,o,u)}):sd(n,o,r)}function sd(n,o,r){o.status="fulfilled",o.value=r,rd(o),n.state=r,o=n.pending,o!==null&&(r=o.next,r===o?n.pending=null:(r=r.next,o.next=r,If(n,r)))}function th(n,o,r){var u=n.pending;if(n.pending=null,u!==null){u=u.next;do o.status="rejected",o.reason=r,rd(o),o=o.next;while(o!==u)}n.action=null}function rd(n){n=n.listeners;for(var o=0;o<n.length;o++)(0,n[o])()}function ld(n,o){return o}function ud(n,o){if(Kt){var r=hn.formState;if(r!==null){e:{var u=xt;if(Kt){if(Bn){t:{for(var f=Bn,$=os;f.nodeType!==8;){if(!$){f=null;break t}if(f=io(f.nextSibling),f===null){f=null;break t}}$=f.data,f=$==="F!"||$==="F"?f:null}if(f){Bn=io(f.nextSibling),u=f.data==="F!";break e}}br(u)}u=!1}u&&(o=r[0])}}return r=Qi(),r.memoizedState=r.baseState=o,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ld,lastRenderedState:o},r.queue=u,r=Vp.bind(null,xt,u),u.dispatch=r,u=od(!1),$=ja.bind(null,xt,!1,u.queue),u=Qi(),f={state:o,dispatch:null,action:n,pending:null},u.queue=f,r=Up.bind(null,xt,f,$,r),f.dispatch=r,u.memoizedState=n,[o,r,!1]}function ad(n){var o=ni();return cd(o,$n,n)}function cd(n,o,r){if(o=Qc(n,o,ld)[0],n=Ua(Vs)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var u=Wu(o)}catch(S){throw S===kn?Vc:S}else u=o;o=ni();var f=o.queue,$=f.dispatch;return r!==o.memoizedState&&(xt.flags|=2048,Wl(9,{destroy:void 0},hd.bind(null,f,r),null)),[u,$,n]}function hd(n,o){n.action=o}function Ha(n){var o=ni(),r=$n;if(r!==null)return cd(o,r,n);ni(),o=o.memoizedState,r=ni();var u=r.queue.dispatch;return r.memoizedState=n,[o,u,!1]}function Wl(n,o,r,u){return n={tag:n,create:r,deps:u,inst:o,next:null},o=xt.updateQueue,o===null&&(o=zu(),xt.updateQueue=o),r=o.lastEffect,r===null?o.lastEffect=n.next=n:(u=r.next,r.next=n,n.next=u,o.lastEffect=n),n}function Af(){return ni().memoizedState}function Ga(n,o,r,u){var f=Qi();xt.flags|=n,f.memoizedState=Wl(1|o,{destroy:void 0},r,u===void 0?null:u)}function Va(n,o,r,u){var f=ni();u=u===void 0?null:u;var $=f.memoizedState.inst;$n!==null&&u!==null&&ed(u,$n.memoizedState.deps)?f.memoizedState=Wl(o,$,r,u):(xt.flags|=n,f.memoizedState=Wl(1|o,$,r,u))}function dd(n,o){Ga(8390656,8,n,o)}function nh(n,o){Va(2048,8,n,o)}function wf(n){xt.flags|=4;var o=xt.updateQueue;if(o===null)o=zu(),xt.updateQueue=o,o.events=[n];else{var r=o.events;r===null?o.events=[n]:r.push(n)}}function fd(n){var o=ni().memoizedState;return wf({ref:o,nextImpl:n}),function(){if((an&2)!==0)throw Error(a(440));return o.impl.apply(void 0,arguments)}}function pd(n,o){return Va(4,2,n,o)}function gd(n,o){return Va(4,4,n,o)}function $d(n,o){if(typeof o=="function"){n=n();var r=o(n);return function(){typeof r=="function"?r():o(null)}}if(o!=null)return n=n(),o.current=n,function(){o.current=null}}function md(n,o,r){r=r!=null?r.concat([n]):null,Va(4,4,$d.bind(null,o,n),r)}function _d(){}function Nf(n,o){var r=ni();o=o===void 0?null:o;var u=r.memoizedState;return o!==null&&ed(o,u[1])?u[0]:(r.memoizedState=[n,o],n)}function bd(n,o){var r=ni();o=o===void 0?null:o;var u=r.memoizedState;if(o!==null&&ed(o,u[1]))return u[0];if(u=n(),Sr){Y(!0);try{n()}finally{Y(!1)}}return r.memoizedState=[u,o],u}function Ed(n,o,r){return r===void 0||(rs&1073741824)!==0&&(wt&261930)===0?n.memoizedState=o:(n.memoizedState=r,n=tp(),xt.lanes|=n,Ys|=n,r)}function kf(n,o,r,u){return fi(r,o)?r:Vl.current!==null?(n=Ed(n,r,u),fi(n,o)||(pi=!0),n):(rs&42)===0||(rs&1073741824)!==0&&(wt&261930)===0?(pi=!0,n.memoizedState=r):(n=tp(),xt.lanes|=n,Ys|=n,o)}function Mf(n,o,r,u,f){var $=Ve.p;Ve.p=$!==0&&8>$?$:8;var S=de.T,k={};de.T=k,ja(n,!1,o,r);try{var V=f(),fe=de.S;if(fe!==null&&fe(k,V),V!==null&&typeof V=="object"&&typeof V.then=="function"){var Ie=Do(V,u);Wa(n,o,Ie,Gi(n))}else Wa(n,o,u,Gi(n))}catch(Me){Wa(n,o,{then:function(){},status:"rejected",reason:Me},Gi())}finally{Ve.p=$,S!==null&&k.types!==null&&(S.types=k.types),de.T=S}}function Hp(){}function ge(n,o,r,u){if(n.tag!==5)throw Error(a(476));var f=sl(n).queue;Mf(n,f,o,ft,r===null?Hp:function(){return Gp(n),r(u)})}function sl(n){var o=n.memoizedState;if(o!==null)return o;o={memoizedState:ft,baseState:ft,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vs,lastRenderedState:ft},next:null};var r={};return o.next={memoizedState:r,baseState:r,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Vs,lastRenderedState:r},next:null},n.memoizedState=o,n=n.alternate,n!==null&&(n.memoizedState=o),o}function Gp(n){var o=sl(n);o.next===null&&(o=n.alternate.memoizedState),Wa(n,o.next.queue,{},Gi())}function za(){return Pi(bc)}function Po(){return ni().memoizedState}function Re(){return ni().memoizedState}function rl(n){for(var o=n.return;o!==null;){switch(o.tag){case 24:case 3:var r=Gi();n=ss(r);var u=Fi(o,n,r);u!==null&&(Vi(u,o,r),Hu(u,o,r)),o={cache:Na()},n.payload=o;return}o=o.return}}function Vn(n,o,r){var u=Gi();r={lane:u,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},Rr(n)?ih(o,r):(r=ei(n,o,r,u),r!==null&&(Vi(r,n,u),jl(r,o,u)))}function Vp(n,o,r){var u=Gi();Wa(n,o,r,u)}function Wa(n,o,r,u){var f={lane:u,revertLane:0,gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null};if(Rr(n))ih(o,f);else{var $=n.alternate;if(n.lanes===0&&($===null||$.lanes===0)&&($=o.lastRenderedReducer,$!==null))try{var S=o.lastRenderedState,k=$(S,r);if(f.hasEagerState=!0,f.eagerState=k,fi(k,S))return Ot(n,o,f,0),hn===null&&Ii(),!1}catch{}finally{}if(r=ei(n,o,f,u),r!==null)return Vi(r,n,u),jl(r,o,u),!0}return!1}function ja(n,o,r,u){if(u={lane:2,revertLane:jo(),gesture:null,action:u,hasEagerState:!1,eagerState:null,next:null},Rr(n)){if(o)throw Error(a(479))}else o=ei(n,r,u,2),o!==null&&Vi(o,n,2)}function Rr(n){var o=n.alternate;return n===xt||o!==null&&o===xt}function ih(n,o){ol=Gu=!0;var r=n.pending;r===null?o.next=o:(o.next=r.next,r.next=o),n.pending=o}function jl(n,o,r){if((r&4194048)!==0){var u=o.lanes;u&=n.pendingLanes,r|=u,o.lanes=r,St(n,r)}}var ju={readContext:Pi,use:Fa,useCallback:Gn,useContext:Gn,useEffect:Gn,useImperativeHandle:Gn,useLayoutEffect:Gn,useInsertionEffect:Gn,useMemo:Gn,useReducer:Gn,useRef:Gn,useState:Gn,useDebugValue:Gn,useDeferredValue:Gn,useTransition:Gn,useSyncExternalStore:Gn,useId:Gn,useHostTransitionStatus:Gn,useFormState:Gn,useActionState:Gn,useOptimistic:Gn,useMemoCache:Gn,useCacheRefresh:Gn};ju.useEffectEvent=Gn;var Lf={readContext:Pi,use:Fa,useCallback:function(n,o){return Qi().memoizedState=[n,o===void 0?null:o],n},useContext:Pi,useEffect:dd,useImperativeHandle:function(n,o,r){r=r!=null?r.concat([n]):null,Ga(4194308,4,$d.bind(null,o,n),r)},useLayoutEffect:function(n,o){return Ga(4194308,4,n,o)},useInsertionEffect:function(n,o){Ga(4,2,n,o)},useMemo:function(n,o){var r=Qi();o=o===void 0?null:o;var u=n();if(Sr){Y(!0);try{n()}finally{Y(!1)}}return r.memoizedState=[u,o],u},useReducer:function(n,o,r){var u=Qi();if(r!==void 0){var f=r(o);if(Sr){Y(!0);try{r(o)}finally{Y(!1)}}}else f=o;return u.memoizedState=u.baseState=f,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:f},u.queue=n,n=n.dispatch=Vn.bind(null,xt,n),[u.memoizedState,n]},useRef:function(n){var o=Qi();return n={current:n},o.memoizedState=n},useState:function(n){n=od(n);var o=n.queue,r=Vp.bind(null,xt,o);return o.dispatch=r,[n.memoizedState,r]},useDebugValue:_d,useDeferredValue:function(n,o){var r=Qi();return Ed(r,n,o)},useTransition:function(){var n=od(!1);return n=Mf.bind(null,xt,n.queue,!0,!1),Qi().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,o,r){var u=xt,f=Qi();if(Kt){if(r===void 0)throw Error(a(407));r=r()}else{if(r=o(),hn===null)throw Error(a(349));(wt&127)!==0||id(u,o,r)}f.memoizedState=r;var $={value:r,getSnapshot:o};return f.queue=$,dd(yf.bind(null,u,$,n),[n]),u.flags|=2048,Wl(9,{destroy:void 0},vf.bind(null,u,$,r,o),null),r},useId:function(){var n=Qi(),o=hn.identifierPrefix;if(Kt){var r=vs,u=Lo;r=(u&~(1<<32-F(u)-1)).toString(32)+r,o="_"+o+"R_"+r,r=xa++,0<r&&(o+="H"+r.toString(32)),o+="_"}else r=Qh++,o="_"+o+"r_"+r.toString(32)+"_";return n.memoizedState=o},useHostTransitionStatus:za,useFormState:ud,useActionState:ud,useOptimistic:function(n){var o=Qi();o.memoizedState=o.baseState=n;var r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=r,o=ja.bind(null,xt,!0,r),r.dispatch=o,[n,o]},useMemoCache:Zc,useCacheRefresh:function(){return Qi().memoizedState=rl.bind(null,xt)},useEffectEvent:function(n){var o=Qi(),r={impl:n};return o.memoizedState=r,function(){if((an&2)!==0)throw Error(a(440));return r.impl.apply(void 0,arguments)}}},Td={readContext:Pi,use:Fa,useCallback:Nf,useContext:Pi,useEffect:nh,useImperativeHandle:md,useInsertionEffect:pd,useLayoutEffect:gd,useMemo:bd,useReducer:Ua,useRef:Af,useState:function(){return Ua(Vs)},useDebugValue:_d,useDeferredValue:function(n,o){var r=ni();return kf(r,$n.memoizedState,n,o)},useTransition:function(){var n=Ua(Vs)[0],o=ni().memoizedState;return[typeof n=="boolean"?n:Wu(n),o]},useSyncExternalStore:nd,useId:Po,useHostTransitionStatus:za,useFormState:ad,useActionState:ad,useOptimistic:function(n,o){var r=ni();return Rf(r,$n,n,o)},useMemoCache:Zc,useCacheRefresh:Re};Td.useEffectEvent=fd;var Df={readContext:Pi,use:Fa,useCallback:Nf,useContext:Pi,useEffect:nh,useImperativeHandle:md,useInsertionEffect:pd,useLayoutEffect:gd,useMemo:bd,useReducer:eh,useRef:Af,useState:function(){return eh(Vs)},useDebugValue:_d,useDeferredValue:function(n,o){var r=ni();return $n===null?Ed(r,n,o):kf(r,$n.memoizedState,n,o)},useTransition:function(){var n=eh(Vs)[0],o=ni().memoizedState;return[typeof n=="boolean"?n:Wu(n),o]},useSyncExternalStore:nd,useId:Po,useHostTransitionStatus:za,useFormState:Ha,useActionState:Ha,useOptimistic:function(n,o){var r=ni();return $n!==null?Rf(r,$n,n,o):(r.baseState=n,[n,r.queue.dispatch])},useMemoCache:Zc,useCacheRefresh:Re};Df.useEffectEvent=fd;function Xa(n,o,r,u){o=n.memoizedState,r=r(u,o),r=r==null?o:D({},o,r),n.memoizedState=r,n.lanes===0&&(n.updateQueue.baseState=r)}var Ya={enqueueSetState:function(n,o,r){n=n._reactInternals;var u=Gi(),f=ss(u);f.payload=o,r!=null&&(f.callback=r),o=Fi(n,f,u),o!==null&&(Vi(o,n,u),Hu(o,n,u))},enqueueReplaceState:function(n,o,r){n=n._reactInternals;var u=Gi(),f=ss(u);f.tag=1,f.payload=o,r!=null&&(f.callback=r),o=Fi(n,f,u),o!==null&&(Vi(o,n,u),Hu(o,n,u))},enqueueForceUpdate:function(n,o){n=n._reactInternals;var r=Gi(),u=ss(r);u.tag=2,o!=null&&(u.callback=o),o=Fi(n,u,r),o!==null&&(Vi(o,n,r),Hu(o,n,r))}};function vd(n,o,r,u,f,$,S){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(u,$,S):o.prototype&&o.prototype.isPureReactComponent?!d(r,u)||!d(f,$):!0}function xf(n,o,r,u){n=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(r,u),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(r,u),o.state!==n&&Ya.enqueueReplaceState(o,o.state,null)}function Xl(n,o){var r=o;if("ref"in o){r={};for(var u in o)u!=="ref"&&(r[u]=o[u])}if(n=n.defaultProps){r===o&&(r=D({},r));for(var f in n)r[f]===void 0&&(r[f]=n[f])}return r}function Bf(n){Ge(n)}function zp(n){console.error(n)}function Pf(n){Ge(n)}function oh(n,o){try{var r=n.onUncaughtError;r(o.value,{componentStack:o.stack})}catch(u){setTimeout(function(){throw u})}}function yd(n,o,r){try{var u=n.onCaughtError;u(r.value,{componentStack:r.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function Ka(n,o,r){return r=ss(r),r.tag=3,r.payload={element:null},r.callback=function(){oh(n,o)},r}function Ff(n){return n=ss(n),n.tag=3,n}function Sd(n,o,r,u){var f=r.type.getDerivedStateFromError;if(typeof f=="function"){var $=u.value;n.payload=function(){return f($)},n.callback=function(){yd(o,r,u)}}var S=r.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(n.callback=function(){yd(o,r,u),typeof f!="function"&&(dl===null?dl=new Set([this]):dl.add(this));var k=u.stack;this.componentDidCatch(u.value,{componentStack:k!==null?k:""})})}function Wp(n,o,r,u,f){if(r.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(o=r.alternate,o!==null&&xu(o,r,f,!0),r=So.current,r!==null){switch(r.tag){case 31:case 13:return Bo===null?bh():r.alternate===null&&ii===0&&(ii=3),r.flags&=-257,r.flags|=65536,r.lanes=f,u===zc?r.flags|=16384:(o=r.updateQueue,o===null?r.updateQueue=new Set([u]):o.add(u),rc(n,u,f)),!1;case 22:return r.flags|=65536,u===zc?r.flags|=16384:(o=r.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([u])},r.updateQueue=o):(r=o.retryQueue,r===null?o.retryQueue=new Set([u]):r.add(u)),rc(n,u,f)),!1}throw Error(a(435,r.tag))}return rc(n,u,f),bh(),!1}if(Kt)return o=So.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=f,u!==Zr&&(n=Error(a(422),{cause:u}),Du(ns(n,r)))):(u!==Zr&&(o=Error(a(423),{cause:u}),Du(ns(o,r))),n=n.current.alternate,n.flags|=65536,f&=-f,n.lanes|=f,u=ns(u,r),f=Ka(n.stateNode,u,f),Yh(n,f),ii!==4&&(ii=2)),!1;var $=Error(a(520),{cause:u});if($=ns($,r),ic===null?ic=[$]:ic.push($),ii!==4&&(ii=2),o===null)return!0;u=ns(u,r),r=o;do{switch(r.tag){case 3:return r.flags|=65536,n=f&-f,r.lanes|=n,n=Ka(r.stateNode,u,n),Yh(r,n),!1;case 1:if(o=r.type,$=r.stateNode,(r.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||$!==null&&typeof $.componentDidCatch=="function"&&(dl===null||!dl.has($))))return r.flags|=65536,f&=-f,r.lanes|=f,f=Ff(f),Sd(f,n,r,u),Yh(r,f),!1}r=r.return}while(r!==null);return!1}var Uf=Error(a(461)),pi=!1;function Ui(n,o,r,u){o.child=n===null?Ef(o,null,r,u):nl(o,n.child,r,u)}function Ir(n,o,r,u,f){r=r.render;var $=o.ref;if("ref"in u){var S={};for(var k in u)k!=="ref"&&(S[k]=u[k])}else S=u;return Cs(o),u=Pa(n,o,r,S,$,f),k=Cr(),n!==null&&!pi?(Jc(n,o,f),Ar(n,o,f)):(Kt&&k&&Fh(o),o.flags|=1,Ui(n,o,u,f),o.child)}function ce(n,o,r,u,f){if(n===null){var $=r.type;return typeof $=="function"&&!Bh($)&&$.defaultProps===void 0&&r.compare===null?(o.tag=15,o.type=$,Hf(n,o,$,u,f)):(n=Oa(r.type,null,u,o,o.mode,f),n.ref=o.ref,n.return=o,o.child=n)}if($=n.child,!mn(n,f)){var S=$.memoizedProps;if(r=r.compare,r=r!==null?r:d,r(S,u)&&n.ref===o.ref)return Ar(n,o,f)}return o.flags|=1,n=gr($,u),n.ref=o.ref,n.return=o,o.child=n}function Hf(n,o,r,u,f){if(n!==null){var $=n.memoizedProps;if(d($,u)&&n.ref===o.ref)if(pi=!1,o.pendingProps=u=$,mn(n,f))(n.flags&131072)!==0&&(pi=!0);else return o.lanes=n.lanes,Ar(n,o,f)}return rh(n,o,r,u,f)}function Gf(n,o,r,u){var f=u.children,$=n!==null?n.memoizedState:null;if(n===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),u.mode==="hidden"){if((o.flags&128)!==0){if($=$!==null?$.baseLanes|r:r,n!==null){for(u=o.child=n.child,f=0;u!==null;)f=f|u.lanes|u.childLanes,u=u.sibling;u=f&~$}else u=0,o.child=null;return jp(n,o,$,r,u)}if((r&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},n!==null&&el(o,$!==null?$.cachePool:null),$!==null?Kh(o,$):qh(),Zh(o);else return u=o.lanes=536870912,jp(n,o,$!==null?$.baseLanes|r:r,r,u)}else $!==null?(el(o,$.cachePool),Kh(o,$),il(),o.memoizedState=null):(n!==null&&el(o,null),qh(),il());return Ui(n,o,f,r),o.child}function qa(n,o){return n!==null&&n.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function jp(n,o,r,u,f){var $=Rs();return $=$===null?null:{parent:si._currentValue,pool:$},o.memoizedState={baseLanes:r,cachePool:$},n!==null&&el(o,null),qh(),Zh(o),n!==null&&xu(n,o,u,!0),o.childLanes=f,null}function Ja(n,o){return o=Yl({mode:o.mode,children:o.children},n.mode),o.ref=n.ref,n.child=o,o.return=n,o}function Vf(n,o,r){return nl(o,n.child,null,r),n=Ja(o,o.pendingProps),n.flags|=2,fo(o),o.memoizedState=null,n}function sh(n,o,r){var u=o.pendingProps,f=(o.flags&128)!==0;if(o.flags&=-129,n===null){if(Kt){if(u.mode==="hidden")return n=Ja(o,u),o.lanes=536870912,qa(null,n);if(Jh(o),(n=Bn)?(n=Fr(n,os),n=n!==null&&n.data==="&"?n:null,n!==null&&(o.memoizedState={dehydrated:n,treeContext:Jr!==null?{id:Lo,overflow:vs}:null,retryLane:536870912,hydrationErrors:null},r=Nu(n),r.return=o,o.child=r,xn=o,Bn=null)):n=null,n===null)throw br(o);return o.lanes=536870912,null}return Ja(o,u)}var $=n.memoizedState;if($!==null){var S=$.dehydrated;if(Jh(o),f)if(o.flags&256)o.flags&=-257,o=Vf(n,o,r);else if(o.memoizedState!==null)o.child=n.child,o.flags|=128,o=null;else throw Error(a(558));else if(pi||xu(n,o,r,!1),f=(r&n.childLanes)!==0,pi||f){if(u=hn,u!==null&&(S=jt(u,r),S!==0&&S!==$.retryLane))throw $.retryLane=S,vn(n,S),Vi(u,n,S),Uf;bh(),o=Vf(n,o,r)}else n=$.treeContext,Bn=io(S.nextSibling),xn=o,Kt=!0,_r=null,os=!1,n!==null&&Uh(o,n),o=Ja(o,u),o.flags|=4096;return o}return n=gr(n.child,{mode:u.mode,children:u.children}),n.ref=o.ref,o.child=n,n.return=o,n}function Za(n,o){var r=o.ref;if(r===null)n!==null&&n.ref!==null&&(o.flags|=4194816);else{if(typeof r!="function"&&typeof r!="object")throw Error(a(284));(n===null||n.ref!==r)&&(o.flags|=4194816)}}function rh(n,o,r,u,f){return Cs(o),r=Pa(n,o,r,u,void 0,f),u=Cr(),n!==null&&!pi?(Jc(n,o,f),Ar(n,o,f)):(Kt&&u&&Fh(o),o.flags|=1,Ui(n,o,r,f),o.child)}function Or(n,o,r,u,f,$){return Cs(o),o.updateQueue=null,r=td(o,u,r,f),Tf(n),u=Cr(),n!==null&&!pi?(Jc(n,o,$),Ar(n,o,$)):(Kt&&u&&Fh(o),o.flags|=1,Ui(n,o,r,$),o.child)}function zf(n,o,r,u,f){if(Cs(o),o.stateNode===null){var $=Bi,S=r.contextType;typeof S=="object"&&S!==null&&($=Pi(S)),$=new r(u,$),o.memoizedState=$.state!==null&&$.state!==void 0?$.state:null,$.updater=Ya,o.stateNode=$,$._reactInternals=o,$=o.stateNode,$.props=u,$.state=o.memoizedState,$.refs={},xo(o),S=r.contextType,$.context=typeof S=="object"&&S!==null?Pi(S):Bi,$.state=o.memoizedState,S=r.getDerivedStateFromProps,typeof S=="function"&&(Xa(o,r,S,u),$.state=o.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof $.getSnapshotBeforeUpdate=="function"||typeof $.UNSAFE_componentWillMount!="function"&&typeof $.componentWillMount!="function"||(S=$.state,typeof $.componentWillMount=="function"&&$.componentWillMount(),typeof $.UNSAFE_componentWillMount=="function"&&$.UNSAFE_componentWillMount(),S!==$.state&&Ya.enqueueReplaceState($,$.state,null),Is(o,u,$,f),Ma(),$.state=o.memoizedState),typeof $.componentDidMount=="function"&&(o.flags|=4194308),u=!0}else if(n===null){$=o.stateNode;var k=o.memoizedProps,V=Xl(r,k);$.props=V;var fe=$.context,Ie=r.contextType;S=Bi,typeof Ie=="object"&&Ie!==null&&(S=Pi(Ie));var Me=r.getDerivedStateFromProps;Ie=typeof Me=="function"||typeof $.getSnapshotBeforeUpdate=="function",k=o.pendingProps!==k,Ie||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(k||fe!==S)&&xf(o,$,u,S),Gs=!1;var me=o.memoizedState;$.state=me,Is(o,u,$,f),Ma(),fe=o.memoizedState,k||me!==fe||Gs?(typeof Me=="function"&&(Xa(o,r,Me,u),fe=o.memoizedState),(V=Gs||vd(o,r,V,u,me,fe,S))?(Ie||typeof $.UNSAFE_componentWillMount!="function"&&typeof $.componentWillMount!="function"||(typeof $.componentWillMount=="function"&&$.componentWillMount(),typeof $.UNSAFE_componentWillMount=="function"&&$.UNSAFE_componentWillMount()),typeof $.componentDidMount=="function"&&(o.flags|=4194308)):(typeof $.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=u,o.memoizedState=fe),$.props=u,$.state=fe,$.context=S,u=V):(typeof $.componentDidMount=="function"&&(o.flags|=4194308),u=!1)}else{$=o.stateNode,Xc(n,o),S=o.memoizedProps,Ie=Xl(r,S),$.props=Ie,Me=o.pendingProps,me=$.context,fe=r.contextType,V=Bi,typeof fe=="object"&&fe!==null&&(V=Pi(fe)),k=r.getDerivedStateFromProps,(fe=typeof k=="function"||typeof $.getSnapshotBeforeUpdate=="function")||typeof $.UNSAFE_componentWillReceiveProps!="function"&&typeof $.componentWillReceiveProps!="function"||(S!==Me||me!==V)&&xf(o,$,u,V),Gs=!1,me=o.memoizedState,$.state=me,Is(o,u,$,f),Ma();var Ee=o.memoizedState;S!==Me||me!==Ee||Gs||n!==null&&n.dependencies!==null&&Hc(n.dependencies)?(typeof k=="function"&&(Xa(o,r,k,u),Ee=o.memoizedState),(Ie=Gs||vd(o,r,Ie,u,me,Ee,V)||n!==null&&n.dependencies!==null&&Hc(n.dependencies))?(fe||typeof $.UNSAFE_componentWillUpdate!="function"&&typeof $.componentWillUpdate!="function"||(typeof $.componentWillUpdate=="function"&&$.componentWillUpdate(u,Ee,V),typeof $.UNSAFE_componentWillUpdate=="function"&&$.UNSAFE_componentWillUpdate(u,Ee,V)),typeof $.componentDidUpdate=="function"&&(o.flags|=4),typeof $.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof $.componentDidUpdate!="function"||S===n.memoizedProps&&me===n.memoizedState||(o.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||S===n.memoizedProps&&me===n.memoizedState||(o.flags|=1024),o.memoizedProps=u,o.memoizedState=Ee),$.props=u,$.state=Ee,$.context=V,u=Ie):(typeof $.componentDidUpdate!="function"||S===n.memoizedProps&&me===n.memoizedState||(o.flags|=4),typeof $.getSnapshotBeforeUpdate!="function"||S===n.memoizedProps&&me===n.memoizedState||(o.flags|=1024),u=!1)}return $=u,Za(n,o),u=(o.flags&128)!==0,$||u?($=o.stateNode,r=u&&typeof r.getDerivedStateFromError!="function"?null:$.render(),o.flags|=1,n!==null&&u?(o.child=nl(o,n.child,null,f),o.child=nl(o,null,r,f)):Ui(n,o,r,f),o.memoizedState=$.state,n=o.child):n=Ar(n,o,f),n}function Qa(n,o,r,u){return Pl(),o.flags|=256,Ui(n,o,r,u),o.child}var ll={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Co(n){return{baseLanes:n,cachePool:$t()}}function zs(n,o,r){return n=n!==null?n.childLanes&~r:0,o&&(n|=eo),n}function Os(n,o,r){var u=o.pendingProps,f=!1,$=(o.flags&128)!==0,S;if((S=$)||(S=n!==null&&n.memoizedState===null?!1:(ri.current&2)!==0),S&&(f=!0,o.flags&=-129),S=(o.flags&32)!==0,o.flags&=-33,n===null){if(Kt){if(f?yr(o):il(),(n=Bn)?(n=Fr(n,os),n=n!==null&&n.data!=="&"?n:null,n!==null&&(o.memoizedState={dehydrated:n,treeContext:Jr!==null?{id:Lo,overflow:vs}:null,retryLane:536870912,hydrationErrors:null},r=Nu(n),r.return=o,o.child=r,xn=o,Bn=null)):n=null,n===null)throw br(o);return fc(n)?o.lanes=32:o.lanes=536870912,null}var k=u.children;return u=u.fallback,f?(il(),f=o.mode,k=Yl({mode:"hidden",children:k},f),u=Bl(u,f,r,null),k.return=o,u.return=o,k.sibling=u,o.child=k,u=o.child,u.memoizedState=Co(r),u.childLanes=zs(n,S,r),o.memoizedState=ll,qa(null,u)):(yr(o),lh(o,k))}var V=n.memoizedState;if(V!==null&&(k=V.dehydrated,k!==null)){if($)o.flags&256?(yr(o),o.flags&=-257,o=bi(n,o,r)):o.memoizedState!==null?(il(),o.child=n.child,o.flags|=128,o=null):(il(),k=u.fallback,f=o.mode,u=Yl({mode:"visible",children:u.children},f),k=Bl(k,f,r,null),k.flags|=2,u.return=o,k.return=o,u.sibling=k,o.child=u,nl(o,n.child,null,r),u=o.child,u.memoizedState=Co(r),u.childLanes=zs(n,S,r),o.memoizedState=ll,o=qa(null,u));else if(yr(o),fc(k)){if(S=k.nextSibling&&k.nextSibling.dataset,S)var fe=S.dgst;S=fe,u=Error(a(419)),u.stack="",u.digest=S,Du({value:u,source:null,stack:null}),o=bi(n,o,r)}else if(pi||xu(n,o,r,!1),S=(r&n.childLanes)!==0,pi||S){if(S=hn,S!==null&&(u=jt(S,r),u!==0&&u!==V.retryLane))throw V.retryLane=u,vn(n,u),Vi(S,n,u),Uf;ra(k)||bh(),o=bi(n,o,r)}else ra(k)?(o.flags|=192,o.child=n.child,o=null):(n=V.treeContext,Bn=io(k.nextSibling),xn=o,Kt=!0,_r=null,os=!1,n!==null&&Uh(o,n),o=lh(o,u.children),o.flags|=4096);return o}return f?(il(),k=u.fallback,f=o.mode,V=n.child,fe=V.sibling,u=gr(V,{mode:"hidden",children:u.children}),u.subtreeFlags=V.subtreeFlags&65011712,fe!==null?k=gr(fe,k):(k=Bl(k,f,r,null),k.flags|=2),k.return=o,u.return=o,u.sibling=k,o.child=u,qa(null,u),u=o.child,k=n.child.memoizedState,k===null?k=Co(r):(f=k.cachePool,f!==null?(V=si._currentValue,f=f.parent!==V?{parent:V,pool:V}:f):f=$t(),k={baseLanes:k.baseLanes|r,cachePool:f}),u.memoizedState=k,u.childLanes=zs(n,S,r),o.memoizedState=ll,qa(n.child,u)):(yr(o),r=n.child,n=r.sibling,r=gr(r,{mode:"visible",children:u.children}),r.return=o,r.sibling=null,n!==null&&(S=o.deletions,S===null?(o.deletions=[n],o.flags|=16):S.push(n)),o.child=r,o.memoizedState=null,r)}function lh(n,o){return o=Yl({mode:"visible",children:o},n.mode),o.return=n,n.child=o}function Yl(n,o){return n=To(22,n,null,o),n.lanes=0,n}function bi(n,o,r){return nl(o,n.child,null,r),n=lh(o,o.pendingProps.children),n.flags|=2,o.memoizedState=null,n}function Ai(n,o,r){n.lanes|=o;var u=n.alternate;u!==null&&(u.lanes|=o),Uc(n.return,o,r)}function Wf(n,o,r,u,f,$){var S=n.memoizedState;S===null?n.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:u,tail:r,tailMode:f,treeForkCount:$}:(S.isBackwards=o,S.rendering=null,S.renderingStartTime=0,S.last=u,S.tail=r,S.tailMode=f,S.treeForkCount=$)}function Hi(n,o,r){var u=o.pendingProps,f=u.revealOrder,$=u.tail;u=u.children;var S=ri.current,k=(S&2)!==0;if(k?(S=S&1|2,o.flags|=128):S&=1,He(ri,S),Ui(n,o,u,r),u=Kt?Mu:0,!k&&n!==null&&(n.flags&128)!==0)e:for(n=o.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Ai(n,r,o);else if(n.tag===19)Ai(n,r,o);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===o)break e;for(;n.sibling===null;){if(n.return===null||n.return===o)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(f){case"forwards":for(r=o.child,f=null;r!==null;)n=r.alternate,n!==null&&qc(n)===null&&(f=r),r=r.sibling;r=f,r===null?(f=o.child,o.child=null):(f=r.sibling,r.sibling=null),Wf(o,!1,f,r,$,u);break;case"backwards":case"unstable_legacy-backwards":for(r=null,f=o.child,o.child=null;f!==null;){if(n=f.alternate,n!==null&&qc(n)===null){o.child=f;break}n=f.sibling,f.sibling=r,r=f,f=n}Wf(o,!0,r,null,$,u);break;case"together":Wf(o,!1,null,null,void 0,u);break;default:o.memoizedState=null}return o.child}function Ar(n,o,r){if(n!==null&&(o.dependencies=n.dependencies),Ys|=o.lanes,(r&o.childLanes)===0)if(n!==null){if(xu(n,o,r,!1),(r&o.childLanes)===0)return null}else return null;if(n!==null&&o.child!==n.child)throw Error(a(153));if(o.child!==null){for(n=o.child,r=gr(n,n.pendingProps),o.child=r,r.return=o;n.sibling!==null;)n=n.sibling,r=r.sibling=gr(n,n.pendingProps),r.return=o;r.sibling=null}return o.child}function mn(n,o){return(n.lanes&o)!==0?!0:(n=n.dependencies,!!(n!==null&&Hc(n)))}function uh(n,o,r){switch(o.tag){case 3:An(o,o.stateNode.containerInfo),Qr(o,si,n.memoizedState.cache),Pl();break;case 27:case 5:Qe(o);break;case 4:An(o,o.stateNode.containerInfo);break;case 10:Qr(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,Jh(o),null;break;case 13:var u=o.memoizedState;if(u!==null)return u.dehydrated!==null?(yr(o),o.flags|=128,null):(r&o.child.childLanes)!==0?Os(n,o,r):(yr(o),n=Ar(n,o,r),n!==null?n.sibling:null);yr(o);break;case 19:var f=(n.flags&128)!==0;if(u=(r&o.childLanes)!==0,u||(xu(n,o,r,!1),u=(r&o.childLanes)!==0),f){if(u)return Hi(n,o,r);o.flags|=128}if(f=o.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),He(ri,ri.current),u)break;return null;case 22:return o.lanes=0,Gf(n,o,r,o.pendingProps);case 24:Qr(o,si,n.memoizedState.cache)}return Ar(n,o,r)}function jf(n,o,r){if(n!==null)if(n.memoizedProps!==o.pendingProps)pi=!0;else{if(!mn(n,r)&&(o.flags&128)===0)return pi=!1,uh(n,o,r);pi=(n.flags&131072)!==0}else pi=!1,Kt&&(o.flags&1048576)!==0&&$f(o,Mu,o.index);switch(o.lanes=0,o.tag){case 16:e:{var u=o.pendingProps;if(n=Tr(o.elementType),o.type=n,typeof n=="function")Bh(n)?(u=Xl(n,u),o.tag=1,o=zf(null,o,n,u,r)):(o.tag=0,o=rh(null,o,n,u,r));else{if(n!=null){var f=n.$$typeof;if(f===Ae){o.tag=11,o=Ir(null,o,n,u,r);break e}else if(f===xe){o.tag=14,o=ce(null,o,n,u,r);break e}}throw o=Yt(n)||n,Error(a(306,o,""))}}return o;case 0:return rh(n,o,o.type,o.pendingProps,r);case 1:return u=o.type,f=Xl(u,o.pendingProps),zf(n,o,u,f,r);case 3:e:{if(An(o,o.stateNode.containerInfo),n===null)throw Error(a(387));u=o.pendingProps;var $=o.memoizedState;f=$.element,Xc(n,o),Is(o,u,null,r);var S=o.memoizedState;if(u=S.cache,Qr(o,si,u),u!==$.cache&&Ss(o,[si],r,!0),Ma(),u=S.element,$.isDehydrated)if($={element:u,isDehydrated:!1,cache:S.cache},o.updateQueue.baseState=$,o.memoizedState=$,o.flags&256){o=Qa(n,o,u,r);break e}else if(u!==f){f=ns(Error(a(424)),o),Du(f),o=Qa(n,o,u,r);break e}else{switch(n=o.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(Bn=io(n.firstChild),xn=o,Kt=!0,_r=null,os=!0,r=Ef(o,null,u,r),o.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling}else{if(Pl(),u===f){o=Ar(n,o,r);break e}Ui(n,o,u,r)}o=o.child}return o;case 26:return Za(n,o),n===null?(r=ca(o.type,null,o.pendingProps,null))?o.memoizedState=r:Kt||(r=o.type,n=o.pendingProps,u=As(Ze.current).createElement(r),u[Tn]=o,u[Qn]=n,wi(u,r,n),Kn(u),o.stateNode=u):o.memoizedState=ca(o.type,n.memoizedProps,o.pendingProps,n.memoizedState),null;case 27:return Qe(o),n===null&&Kt&&(u=o.stateNode=Ur(o.type,o.pendingProps,Ze.current),xn=o,os=!0,f=Bn,lu(o.type)?(pp=f,Bn=io(u.firstChild)):Bn=f),Ui(n,o,o.pendingProps.children,r),Za(n,o),n===null&&(o.flags|=4194304),o.child;case 5:return n===null&&Kt&&((f=u=Bn)&&(u=as(u,o.type,o.pendingProps,os),u!==null?(o.stateNode=u,xn=o,Bn=io(u.firstChild),os=!1,f=!0):f=!1),f||br(o)),Qe(o),f=o.type,$=o.pendingProps,S=n!==null?n.memoizedProps:null,u=$.children,hp(f,$)?u=null:S!==null&&hp(f,S)&&(o.flags|=32),o.memoizedState!==null&&(f=Pa(n,o,Fp,null,null,r),bc._currentValue=f),Za(n,o),Ui(n,o,u,r),o.child;case 6:return n===null&&Kt&&((n=r=Bn)&&(r=fn(r,o.pendingProps,os),r!==null?(o.stateNode=r,xn=o,Bn=null,n=!0):n=!1),n||br(o)),null;case 13:return Os(n,o,r);case 4:return An(o,o.stateNode.containerInfo),u=o.pendingProps,n===null?o.child=nl(o,null,u,r):Ui(n,o,u,r),o.child;case 11:return Ir(n,o,o.type,o.pendingProps,r);case 7:return Ui(n,o,o.pendingProps,r),o.child;case 8:return Ui(n,o,o.pendingProps.children,r),o.child;case 12:return Ui(n,o,o.pendingProps.children,r),o.child;case 10:return u=o.pendingProps,Qr(o,o.type,u.value),Ui(n,o,u.children,r),o.child;case 9:return f=o.type._context,u=o.pendingProps.children,Cs(o),f=Pi(f),u=u(f),o.flags|=1,Ui(n,o,u,r),o.child;case 14:return ce(n,o,o.type,o.pendingProps,r);case 15:return Hf(n,o,o.type,o.pendingProps,r);case 19:return Hi(n,o,r);case 31:return sh(n,o,r);case 22:return Gf(n,o,r,o.pendingProps);case 24:return Cs(o),u=Pi(si),n===null?(f=Rs(),f===null&&(f=hn,$=Na(),f.pooledCache=$,$.refCount++,$!==null&&(f.pooledCacheLanes|=r),f=$),o.memoizedState={parent:u,cache:f},xo(o),Qr(o,si,f)):((n.lanes&r)!==0&&(Xc(n,o),Is(o,null,null,r),Ma()),f=n.memoizedState,$=o.memoizedState,f.parent!==u?(f={parent:u,cache:u},o.memoizedState=f,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=f),Qr(o,si,u)):(u=$.cache,Qr(o,si,u),u!==f.cache&&Ss(o,[si],r,!0))),Ui(n,o,o.pendingProps.children,r),o.child;case 29:throw o.pendingProps}throw Error(a(156,o.tag))}function wr(n){n.flags|=4}function Xu(n,o,r,u,f){if((o=(n.mode&32)!==0)&&(o=!1),o){if(n.flags|=16777216,(f&335544128)===f)if(n.stateNode.complete)n.flags|=8192;else if(eu())n.flags|=8192;else throw tl=zc,zh}else n.flags&=-16777217}function Xf(n,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Rn(o))if(eu())n.flags|=8192;else throw tl=zc,zh}function li(n,o){o!==null&&(n.flags|=4),n.flags&16384&&(o=n.tag!==22?qe():536870912,n.lanes|=o,Ju|=o)}function Nr(n,o){if(!Kt)switch(n.tailMode){case"hidden":o=n.tail;for(var r=null;o!==null;)o.alternate!==null&&(r=o),o=o.sibling;r===null?n.tail=null:r.sibling=null;break;case"collapsed":r=n.tail;for(var u=null;r!==null;)r.alternate!==null&&(u=r),r=r.sibling;u===null?o||n.tail===null?n.tail=null:n.tail.sibling=null:u.sibling=null}}function tn(n){var o=n.alternate!==null&&n.alternate.child===n.child,r=0,u=0;if(o)for(var f=n.child;f!==null;)r|=f.lanes|f.childLanes,u|=f.subtreeFlags&65011712,u|=f.flags&65011712,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)r|=f.lanes|f.childLanes,u|=f.subtreeFlags,u|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=u,n.childLanes=r,o}function Yf(n,o,r){var u=o.pendingProps;switch(mr(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tn(o),null;case 1:return tn(o),null;case 3:return r=o.stateNode,u=null,n!==null&&(u=n.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),Er(si),tt(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(Lu(o)?wr(o):n===null||n.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Hh())),tn(o),null;case 26:var f=o.type,$=o.memoizedState;return n===null?(wr(o),$!==null?(tn(o),Xf(o,$)):(tn(o),Xu(o,f,null,u,r))):$?$!==n.memoizedState?(wr(o),tn(o),Xf(o,$)):(tn(o),o.flags&=-16777217):(n=n.memoizedProps,n!==u&&wr(o),tn(o),Xu(o,f,n,u,r)),null;case 27:if(Ni(o),r=Ze.current,f=o.type,n!==null&&o.stateNode!=null)n.memoizedProps!==u&&wr(o);else{if(!u){if(o.stateNode===null)throw Error(a(166));return tn(o),null}n=it.current,Lu(o)?mf(o):(n=Ur(f,u,r),o.stateNode=n,wr(o))}return tn(o),null;case 5:if(Ni(o),f=o.type,n!==null&&o.stateNode!=null)n.memoizedProps!==u&&wr(o);else{if(!u){if(o.stateNode===null)throw Error(a(166));return tn(o),null}if($=it.current,Lu(o))mf(o);else{var S=As(Ze.current);switch($){case 1:$=S.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:$=S.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":$=S.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":$=S.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":$=S.createElement("div"),$.innerHTML="<script><\/script>",$=$.removeChild($.firstChild);break;case"select":$=typeof u.is=="string"?S.createElement("select",{is:u.is}):S.createElement("select"),u.multiple?$.multiple=!0:u.size&&($.size=u.size);break;default:$=typeof u.is=="string"?S.createElement(f,{is:u.is}):S.createElement(f)}}$[Tn]=o,$[Qn]=u;e:for(S=o.child;S!==null;){if(S.tag===5||S.tag===6)$.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===o)break e;for(;S.sibling===null;){if(S.return===null||S.return===o)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}o.stateNode=$;e:switch(wi($,f,u),f){case"button":case"input":case"select":case"textarea":u=!!u.autoFocus;break e;case"img":u=!0;break e;default:u=!1}u&&wr(o)}}return tn(o),Xu(o,o.type,n===null?null:n.memoizedProps,o.pendingProps,r),null;case 6:if(n&&o.stateNode!=null)n.memoizedProps!==u&&wr(o);else{if(typeof u!="string"&&o.stateNode===null)throw Error(a(166));if(n=Ze.current,Lu(o)){if(n=o.stateNode,r=o.memoizedProps,u=null,f=xn,f!==null)switch(f.tag){case 27:case 5:u=f.memoizedProps}n[Tn]=o,n=!!(n.nodeValue===r||u!==null&&u.suppressHydrationWarning===!0||Ch(n.nodeValue,r)),n||br(o,!0)}else n=As(n).createTextNode(u),n[Tn]=o,o.stateNode=n}return tn(o),null;case 31:if(r=o.memoizedState,n===null||n.memoizedState!==null){if(u=Lu(o),r!==null){if(n===null){if(!u)throw Error(a(318));if(n=o.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(a(557));n[Tn]=o}else Pl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;tn(o),n=!1}else r=Hh(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=r),n=!0;if(!n)return o.flags&256?(fo(o),o):(fo(o),null);if((o.flags&128)!==0)throw Error(a(558))}return tn(o),null;case 13:if(u=o.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(f=Lu(o),u!==null&&u.dehydrated!==null){if(n===null){if(!f)throw Error(a(318));if(f=o.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(a(317));f[Tn]=o}else Pl(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;tn(o),f=!1}else f=Hh(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=f),f=!0;if(!f)return o.flags&256?(fo(o),o):(fo(o),null)}return fo(o),(o.flags&128)!==0?(o.lanes=r,o):(r=u!==null,n=n!==null&&n.memoizedState!==null,r&&(u=o.child,f=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(f=u.alternate.memoizedState.cachePool.pool),$=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&($=u.memoizedState.cachePool.pool),$!==f&&(u.flags|=2048)),r!==n&&r&&(o.child.flags|=8192),li(o,o.updateQueue),tn(o),null);case 4:return tt(),n===null&&Yd(o.stateNode.containerInfo),tn(o),null;case 10:return Er(o.type),tn(o),null;case 19:if(Ce(ri),u=o.memoizedState,u===null)return tn(o),null;if(f=(o.flags&128)!==0,$=u.rendering,$===null)if(f)Nr(u,!1);else{if(ii!==0||n!==null&&(n.flags&128)!==0)for(n=o.child;n!==null;){if($=qc(n),$!==null){for(o.flags|=128,Nr(u,!1),n=$.updateQueue,o.updateQueue=n,li(o,n),o.subtreeFlags=0,n=r,r=o.child;r!==null;)pf(r,n),r=r.sibling;return He(ri,ri.current&1|2),Kt&&is(o,u.treeForkCount),o.child}n=n.sibling}u.tail!==null&&In()>fh&&(o.flags|=128,f=!0,Nr(u,!1),o.lanes=4194304)}else{if(!f)if(n=qc($),n!==null){if(o.flags|=128,f=!0,n=n.updateQueue,o.updateQueue=n,li(o,n),Nr(u,!0),u.tail===null&&u.tailMode==="hidden"&&!$.alternate&&!Kt)return tn(o),null}else 2*In()-u.renderingStartTime>fh&&r!==536870912&&(o.flags|=128,f=!0,Nr(u,!1),o.lanes=4194304);u.isBackwards?($.sibling=o.child,o.child=$):(n=u.last,n!==null?n.sibling=$:o.child=$,u.last=$)}return u.tail!==null?(n=u.tail,u.rendering=n,u.tail=n.sibling,u.renderingStartTime=In(),n.sibling=null,r=ri.current,He(ri,f?r&1|2:r&1),Kt&&is(o,u.treeForkCount),n):(tn(o),null);case 22:case 23:return fo(o),Da(),u=o.memoizedState!==null,n!==null?n.memoizedState!==null!==u&&(o.flags|=8192):u&&(o.flags|=8192),u?(r&536870912)!==0&&(o.flags&128)===0&&(tn(o),o.subtreeFlags&6&&(o.flags|=8192)):tn(o),r=o.updateQueue,r!==null&&li(o,r.retryQueue),r=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(r=n.memoizedState.cachePool.pool),u=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(u=o.memoizedState.cachePool.pool),u!==r&&(o.flags|=2048),n!==null&&Ce(yn),null;case 24:return r=null,n!==null&&(r=n.memoizedState.cache),o.memoizedState.cache!==r&&(o.flags|=2048),Er(si),tn(o),null;case 25:return null;case 30:return null}throw Error(a(156,o.tag))}function Kf(n,o){switch(mr(o),o.tag){case 1:return n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 3:return Er(si),tt(),n=o.flags,(n&65536)!==0&&(n&128)===0?(o.flags=n&-65537|128,o):null;case 26:case 27:case 5:return Ni(o),null;case 31:if(o.memoizedState!==null){if(fo(o),o.alternate===null)throw Error(a(340));Pl()}return n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 13:if(fo(o),n=o.memoizedState,n!==null&&n.dehydrated!==null){if(o.alternate===null)throw Error(a(340));Pl()}return n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 19:return Ce(ri),null;case 4:return tt(),null;case 10:return Er(o.type),null;case 22:case 23:return fo(o),Da(),n!==null&&Ce(yn),n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 24:return Er(si),null;case 25:return null;default:return null}}function qf(n,o){switch(mr(o),o.tag){case 3:Er(si),tt();break;case 26:case 27:case 5:Ni(o);break;case 4:tt();break;case 31:o.memoizedState!==null&&fo(o);break;case 13:fo(o);break;case 19:Ce(ri);break;case 10:Er(o.type);break;case 22:case 23:fo(o),Da(),n!==null&&Ce(yn);break;case 24:Er(si)}}function ls(n,o){try{var r=o.updateQueue,u=r!==null?r.lastEffect:null;if(u!==null){var f=u.next;r=f;do{if((r.tag&n)===n){u=void 0;var $=r.create,S=r.inst;u=$(),S.destroy=u}r=r.next}while(r!==f)}}catch(k){nn(o,o.return,k)}}function un(n,o,r){try{var u=o.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var $=f.next;u=$;do{if((u.tag&n)===n){var S=u.inst,k=S.destroy;if(k!==void 0){S.destroy=void 0,f=o;var V=r,fe=k;try{fe()}catch(Ie){nn(f,V,Ie)}}}u=u.next}while(u!==$)}}catch(Ie){nn(o,o.return,Ie)}}function Cd(n){var o=n.updateQueue;if(o!==null){var r=n.stateNode;try{La(o,r)}catch(u){nn(n,n.return,u)}}}function Rd(n,o,r){r.props=Xl(n.type,n.memoizedProps),r.state=n.memoizedState;try{r.componentWillUnmount()}catch(u){nn(n,o,u)}}function Yu(n,o){try{var r=n.ref;if(r!==null){switch(n.tag){case 26:case 27:case 5:var u=n.stateNode;break;case 30:u=n.stateNode;break;default:u=n.stateNode}typeof r=="function"?n.refCleanup=r(u):r.current=u}}catch(f){nn(n,o,f)}}function Ne(n,o){var r=n.ref,u=n.refCleanup;if(r!==null)if(typeof u=="function")try{u()}catch(f){nn(n,o,f)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof r=="function")try{r(null)}catch(f){nn(n,o,f)}else r.current=null}function le(n){var o=n.type,r=n.memoizedProps,u=n.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":r.autoFocus&&u.focus();break e;case"img":r.src?u.src=r.src:r.srcSet&&(u.srcset=r.srcSet)}}catch(f){nn(n,n.return,f)}}function Nt(n,o,r){try{var u=n.stateNode;qd(u,n.type,r,o),u[Qn]=o}catch(f){nn(n,n.return,f)}}function Mt(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&lu(n.type)||n.tag===4}function Id(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Mt(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&lu(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function kr(n,o,r){var u=n.tag;if(u===5||u===6)n=n.stateNode,o?(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r).insertBefore(n,o):(o=r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,o.appendChild(n),r=r._reactRootContainer,r!=null||o.onclick!==null||(o.onclick=_o));else if(u!==4&&(u===27&&lu(n.type)&&(r=n.stateNode,o=null),n=n.child,n!==null))for(kr(n,o,r),n=n.sibling;n!==null;)kr(n,o,r),n=n.sibling}function ah(n,o,r){var u=n.tag;if(u===5||u===6)n=n.stateNode,o?r.insertBefore(n,o):r.appendChild(n);else if(u!==4&&(u===27&&lu(n.type)&&(r=n.stateNode),n=n.child,n!==null))for(ah(n,o,r),n=n.sibling;n!==null;)ah(n,o,r),n=n.sibling}function Jf(n){var o=n.stateNode,r=n.memoizedProps;try{for(var u=n.type,f=o.attributes;f.length;)o.removeAttributeNode(f[0]);wi(o,u,r),o[Tn]=n,o[Qn]=r}catch($){nn(n,n.return,$)}}var ul=!1,Pn=!1,qn=!1,ch=typeof WeakSet=="function"?WeakSet:Set,Ei=null;function Od(n,o){if(n=n.containerInfo,oa=Ec,n=R(n),w(n)){if("selectionStart"in n)var r={start:n.selectionStart,end:n.selectionEnd};else e:{r=(r=n.ownerDocument)&&r.defaultView||window;var u=r.getSelection&&r.getSelection();if(u&&u.rangeCount!==0){r=u.anchorNode;var f=u.anchorOffset,$=u.focusNode;u=u.focusOffset;try{r.nodeType,$.nodeType}catch{r=null;break e}var S=0,k=-1,V=-1,fe=0,Ie=0,Me=n,me=null;t:for(;;){for(var Ee;Me!==r||f!==0&&Me.nodeType!==3||(k=S+f),Me!==$||u!==0&&Me.nodeType!==3||(V=S+u),Me.nodeType===3&&(S+=Me.nodeValue.length),(Ee=Me.firstChild)!==null;)me=Me,Me=Ee;for(;;){if(Me===n)break t;if(me===r&&++fe===f&&(k=S),me===$&&++Ie===u&&(V=S),(Ee=Me.nextSibling)!==null)break;Me=me,me=Me.parentNode}Me=Ee}r=k===-1||V===-1?null:{start:k,end:V}}else r=null}r=r||{start:0,end:0}}else r=null;for(dc={focusedElem:n,selectionRange:r},Ec=!1,Ei=o;Ei!==null;)if(o=Ei,n=o.child,(o.subtreeFlags&1028)!==0&&n!==null)n.return=o,Ei=n;else for(;Ei!==null;){switch(o=Ei,$=o.alternate,n=o.flags,o.tag){case 0:if((n&4)!==0&&(n=o.updateQueue,n=n!==null?n.events:null,n!==null))for(r=0;r<n.length;r++)f=n[r],f.ref.impl=f.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&$!==null){n=void 0,r=o,f=$.memoizedProps,$=$.memoizedState,u=r.stateNode;try{var ct=Xl(r.type,f);n=u.getSnapshotBeforeUpdate(ct,$),u.__reactInternalSnapshotBeforeUpdate=n}catch(yt){nn(r,r.return,yt)}}break;case 3:if((n&1024)!==0){if(n=o.stateNode.containerInfo,r=n.nodeType,r===9)Qd(n);else if(r===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Qd(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(a(163))}if(n=o.sibling,n!==null){n.return=o.return,Ei=n;break}Ei=o.return}}function ec(n,o,r){var u=r.flags;switch(r.tag){case 0:case 11:case 15:Mr(n,r),u&4&&ls(5,r);break;case 1:if(Mr(n,r),u&4)if(n=r.stateNode,o===null)try{n.componentDidMount()}catch(S){nn(r,r.return,S)}else{var f=Xl(r.type,o.memoizedProps);o=o.memoizedState;try{n.componentDidUpdate(f,o,n.__reactInternalSnapshotBeforeUpdate)}catch(S){nn(r,r.return,S)}}u&64&&Cd(r),u&512&&Yu(r,r.return);break;case 3:if(Mr(n,r),u&64&&(n=r.updateQueue,n!==null)){if(o=null,r.child!==null)switch(r.child.tag){case 27:case 5:o=r.child.stateNode;break;case 1:o=r.child.stateNode}try{La(n,o)}catch(S){nn(r,r.return,S)}}break;case 27:o===null&&u&4&&Jf(r);case 26:case 5:Mr(n,r),o===null&&u&4&&le(r),u&512&&Yu(r,r.return);break;case 12:Mr(n,r);break;case 31:Mr(n,r),u&4&&Zf(n,r);break;case 13:Mr(n,r),u&4&&Lt(n,r),u&64&&(n=r.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(r=qp.bind(null,r),ef(n,r))));break;case 22:if(u=r.memoizedState!==null||ul,!u){o=o!==null&&o.memoizedState!==null||Pn,f=ul;var $=Pn;ul=u,(Pn=o)&&!$?Lr(n,r,(r.subtreeFlags&8772)!==0):Mr(n,r),ul=f,Pn=$}break;case 30:break;default:Mr(n,r)}}function tc(n){var o=n.alternate;o!==null&&(n.alternate=null,tc(o)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(o=n.stateNode,o!==null&&zr(o)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var zn=null,Fo=!1;function Uo(n,o,r){for(r=r.child;r!==null;)Ad(n,o,r),r=r.sibling}function Ad(n,o,r){if(L&&typeof L.onCommitFiberUnmount=="function")try{L.onCommitFiberUnmount(v,r)}catch{}switch(r.tag){case 26:Pn||Ne(r,o),Uo(n,o,r),r.memoizedState?r.memoizedState.count--:r.stateNode&&(r=r.stateNode,r.parentNode.removeChild(r));break;case 27:Pn||Ne(r,o);var u=zn,f=Fo;lu(r.type)&&(zn=r.stateNode,Fo=!1),Uo(n,o,r),On(r.stateNode),zn=u,Fo=f;break;case 5:Pn||Ne(r,o);case 6:if(u=zn,f=Fo,zn=null,Uo(n,o,r),zn=u,Fo=f,zn!==null)if(Fo)try{(zn.nodeType===9?zn.body:zn.nodeName==="HTML"?zn.ownerDocument.body:zn).removeChild(r.stateNode)}catch($){nn(r,o,$)}else try{zn.removeChild(r.stateNode)}catch($){nn(r,o,$)}break;case 18:zn!==null&&(Fo?(n=zn,Ih(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,r.stateNode),da(n)):Ih(zn,r.stateNode));break;case 4:u=zn,f=Fo,zn=r.stateNode.containerInfo,Fo=!0,Uo(n,o,r),zn=u,Fo=f;break;case 0:case 11:case 14:case 15:un(2,r,o),Pn||un(4,r,o),Uo(n,o,r);break;case 1:Pn||(Ne(r,o),u=r.stateNode,typeof u.componentWillUnmount=="function"&&Rd(r,o,u)),Uo(n,o,r);break;case 21:Uo(n,o,r);break;case 22:Pn=(u=Pn)||r.memoizedState!==null,Uo(n,o,r),Pn=u;break;default:Uo(n,o,r)}}function Zf(n,o){if(o.memoizedState===null&&(n=o.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{da(n)}catch(r){nn(o,o.return,r)}}}function Lt(n,o){if(o.memoizedState===null&&(n=o.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{da(n)}catch(r){nn(o,o.return,r)}}function Xp(n){switch(n.tag){case 31:case 13:case 19:var o=n.stateNode;return o===null&&(o=n.stateNode=new ch),o;case 22:return n=n.stateNode,o=n._retryCache,o===null&&(o=n._retryCache=new ch),o;default:throw Error(a(435,n.tag))}}function Ws(n,o){var r=Xp(n);o.forEach(function(u){if(!r.has(u)){r.add(u);var f=Jp.bind(null,n,u);u.then(f,f)}})}function ui(n,o){var r=o.deletions;if(r!==null)for(var u=0;u<r.length;u++){var f=r[u],$=n,S=o,k=S;e:for(;k!==null;){switch(k.tag){case 27:if(lu(k.type)){zn=k.stateNode,Fo=!1;break e}break;case 5:zn=k.stateNode,Fo=!1;break e;case 3:case 4:zn=k.stateNode.containerInfo,Fo=!0;break e}k=k.return}if(zn===null)throw Error(a(160));Ad($,S,f),zn=null,Fo=!1,$=f.alternate,$!==null&&($.return=null),f.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)al(o,n),o=o.sibling}var po=null;function al(n,o){var r=n.alternate,u=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:ui(o,n),Ti(n),u&4&&(un(3,n,n.return),ls(3,n),un(5,n,n.return));break;case 1:ui(o,n),Ti(n),u&512&&(Pn||r===null||Ne(r,r.return)),u&64&&ul&&(n=n.updateQueue,n!==null&&(u=n.callbacks,u!==null&&(r=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=r===null?u:r.concat(u))));break;case 26:var f=po;if(ui(o,n),Ti(n),u&512&&(Pn||r===null||Ne(r,r.return)),u&4){var $=r!==null?r.memoizedState:null;if(u=n.memoizedState,r===null)if(u===null)if(n.stateNode===null){e:{u=n.type,r=n.memoizedProps,f=f.ownerDocument||f;t:switch(u){case"title":$=f.getElementsByTagName("title")[0],(!$||$[wo]||$[Tn]||$.namespaceURI==="http://www.w3.org/2000/svg"||$.hasAttribute("itemprop"))&&($=f.createElement(u),f.head.insertBefore($,f.querySelector("head > title"))),wi($,u,r),$[Tn]=n,Kn($),u=$;break e;case"link":var S=bp("link","href",f).get(u+(r.href||""));if(S){for(var k=0;k<S.length;k++)if($=S[k],$.getAttribute("href")===(r.href==null||r.href===""?null:r.href)&&$.getAttribute("rel")===(r.rel==null?null:r.rel)&&$.getAttribute("title")===(r.title==null?null:r.title)&&$.getAttribute("crossorigin")===(r.crossOrigin==null?null:r.crossOrigin)){S.splice(k,1);break t}}$=f.createElement(u),wi($,u,r),f.head.appendChild($);break;case"meta":if(S=bp("meta","content",f).get(u+(r.content||""))){for(k=0;k<S.length;k++)if($=S[k],$.getAttribute("content")===(r.content==null?null:""+r.content)&&$.getAttribute("name")===(r.name==null?null:r.name)&&$.getAttribute("property")===(r.property==null?null:r.property)&&$.getAttribute("http-equiv")===(r.httpEquiv==null?null:r.httpEquiv)&&$.getAttribute("charset")===(r.charSet==null?null:r.charSet)){S.splice(k,1);break t}}$=f.createElement(u),wi($,u,r),f.head.appendChild($);break;default:throw Error(a(468,u))}$[Tn]=n,Kn($),u=$}n.stateNode=u}else tf(f,n.type,n.stateNode);else n.stateNode=pc(f,u,n.memoizedProps);else $!==u?($===null?r.stateNode!==null&&(r=r.stateNode,r.parentNode.removeChild(r)):$.count--,u===null?tf(f,n.type,n.stateNode):pc(f,u,n.memoizedProps)):u===null&&n.stateNode!==null&&Nt(n,n.memoizedProps,r.memoizedProps)}break;case 27:ui(o,n),Ti(n),u&512&&(Pn||r===null||Ne(r,r.return)),r!==null&&u&4&&Nt(n,n.memoizedProps,r.memoizedProps);break;case 5:if(ui(o,n),Ti(n),u&512&&(Pn||r===null||Ne(r,r.return)),n.flags&32){f=n.stateNode;try{ir(f,"")}catch(ct){nn(n,n.return,ct)}}u&4&&n.stateNode!=null&&(f=n.memoizedProps,Nt(n,f,r!==null?r.memoizedProps:f)),u&1024&&(qn=!0);break;case 6:if(ui(o,n),Ti(n),u&4){if(n.stateNode===null)throw Error(a(162));u=n.memoizedProps,r=n.stateNode;try{r.nodeValue=u}catch(ct){nn(n,n.return,ct)}}break;case 3:if(Oh=null,f=po,po=$l(o.containerInfo),ui(o,n),po=f,Ti(n),u&4&&r!==null&&r.memoizedState.isDehydrated)try{da(o.containerInfo)}catch(ct){nn(n,n.return,ct)}qn&&(qn=!1,go(n));break;case 4:u=po,po=$l(n.stateNode.containerInfo),ui(o,n),Ti(n),po=u;break;case 12:ui(o,n),Ti(n);break;case 31:ui(o,n),Ti(n),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,Ws(n,u)));break;case 13:ui(o,n),Ti(n),n.child.flags&8192&&n.memoizedState!==null!=(r!==null&&r.memoizedState!==null)&&(dh=In()),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,Ws(n,u)));break;case 22:f=n.memoizedState!==null;var V=r!==null&&r.memoizedState!==null,fe=ul,Ie=Pn;if(ul=fe||f,Pn=Ie||V,ui(o,n),Pn=Ie,ul=fe,Ti(n),u&8192)e:for(o=n.stateNode,o._visibility=f?o._visibility&-2:o._visibility|1,f&&(r===null||V||ul||Pn||Kl(n)),r=null,o=n;;){if(o.tag===5||o.tag===26){if(r===null){V=r=o;try{if($=V.stateNode,f)S=$.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{k=V.stateNode;var Me=V.memoizedProps.style,me=Me!=null&&Me.hasOwnProperty("display")?Me.display:null;k.style.display=me==null||typeof me=="boolean"?"":(""+me).trim()}}catch(ct){nn(V,V.return,ct)}}}else if(o.tag===6){if(r===null){V=o;try{V.stateNode.nodeValue=f?"":V.memoizedProps}catch(ct){nn(V,V.return,ct)}}}else if(o.tag===18){if(r===null){V=o;try{var Ee=V.stateNode;f?qs(Ee,!0):qs(V.stateNode,!1)}catch(ct){nn(V,V.return,ct)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===n)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break e;for(;o.sibling===null;){if(o.return===null||o.return===n)break e;r===o&&(r=null),o=o.return}r===o&&(r=null),o.sibling.return=o.return,o=o.sibling}u&4&&(u=n.updateQueue,u!==null&&(r=u.retryQueue,r!==null&&(u.retryQueue=null,Ws(n,r))));break;case 19:ui(o,n),Ti(n),u&4&&(u=n.updateQueue,u!==null&&(n.updateQueue=null,Ws(n,u)));break;case 30:break;case 21:break;default:ui(o,n),Ti(n)}}function Ti(n){var o=n.flags;if(o&2){try{for(var r,u=n.return;u!==null;){if(Mt(u)){r=u;break}u=u.return}if(r==null)throw Error(a(160));switch(r.tag){case 27:var f=r.stateNode,$=Id(n);ah(n,$,f);break;case 5:var S=r.stateNode;r.flags&32&&(ir(S,""),r.flags&=-33);var k=Id(n);ah(n,k,S);break;case 3:case 4:var V=r.stateNode.containerInfo,fe=Id(n);kr(n,fe,V);break;default:throw Error(a(161))}}catch(Ie){nn(n,n.return,Ie)}n.flags&=-3}o&4096&&(n.flags&=-4097)}function go(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var o=n;go(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),n=n.sibling}}function Mr(n,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)ec(n,o.alternate,o),o=o.sibling}function Kl(n){for(n=n.child;n!==null;){var o=n;switch(o.tag){case 0:case 11:case 14:case 15:un(4,o,o.return),Kl(o);break;case 1:Ne(o,o.return);var r=o.stateNode;typeof r.componentWillUnmount=="function"&&Rd(o,o.return,r),Kl(o);break;case 27:On(o.stateNode);case 26:case 5:Ne(o,o.return),Kl(o);break;case 22:o.memoizedState===null&&Kl(o);break;case 30:Kl(o);break;default:Kl(o)}n=n.sibling}}function Lr(n,o,r){for(r=r&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var u=o.alternate,f=n,$=o,S=$.flags;switch($.tag){case 0:case 11:case 15:Lr(f,$,r),ls(4,$);break;case 1:if(Lr(f,$,r),u=$,f=u.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(fe){nn(u,u.return,fe)}if(u=$,f=u.updateQueue,f!==null){var k=u.stateNode;try{var V=f.shared.hiddenCallbacks;if(V!==null)for(f.shared.hiddenCallbacks=null,f=0;f<V.length;f++)Yc(V[f],k)}catch(fe){nn(u,u.return,fe)}}r&&S&64&&Cd($),Yu($,$.return);break;case 27:Jf($);case 26:case 5:Lr(f,$,r),r&&u===null&&S&4&&le($),Yu($,$.return);break;case 12:Lr(f,$,r);break;case 31:Lr(f,$,r),r&&S&4&&Zf(f,$);break;case 13:Lr(f,$,r),r&&S&4&&Lt(f,$);break;case 22:$.memoizedState===null&&Lr(f,$,r),Yu($,$.return);break;case 30:break;default:Lr(f,$,r)}o=o.sibling}}function wd(n,o){var r=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(r=n.memoizedState.cachePool.pool),n=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(n=o.memoizedState.cachePool.pool),n!==r&&(n!=null&&n.refCount++,r!=null&&Bu(r))}function Nd(n,o){n=null,o.alternate!==null&&(n=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==n&&(o.refCount++,n!=null&&Bu(n))}function js(n,o,r,u){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)kd(n,o,r,u),o=o.sibling}function kd(n,o,r,u){var f=o.flags;switch(o.tag){case 0:case 11:case 15:js(n,o,r,u),f&2048&&ls(9,o);break;case 1:js(n,o,r,u);break;case 3:js(n,o,r,u),f&2048&&(n=null,o.alternate!==null&&(n=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==n&&(o.refCount++,n!=null&&Bu(n)));break;case 12:if(f&2048){js(n,o,r,u),n=o.stateNode;try{var $=o.memoizedProps,S=$.id,k=$.onPostCommit;typeof k=="function"&&k(S,o.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(V){nn(o,o.return,V)}}else js(n,o,r,u);break;case 31:js(n,o,r,u);break;case 13:js(n,o,r,u);break;case 23:break;case 22:$=o.stateNode,S=o.alternate,o.memoizedState!==null?$._visibility&2?js(n,o,r,u):ql(n,o):$._visibility&2?js(n,o,r,u):($._visibility|=2,Ku(n,o,r,u,(o.subtreeFlags&10256)!==0||!1)),f&2048&&wd(S,o);break;case 24:js(n,o,r,u),f&2048&&Nd(o.alternate,o);break;default:js(n,o,r,u)}}function Ku(n,o,r,u,f){for(f=f&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var $=n,S=o,k=r,V=u,fe=S.flags;switch(S.tag){case 0:case 11:case 15:Ku($,S,k,V,f),ls(8,S);break;case 23:break;case 22:var Ie=S.stateNode;S.memoizedState!==null?Ie._visibility&2?Ku($,S,k,V,f):ql($,S):(Ie._visibility|=2,Ku($,S,k,V,f)),f&&fe&2048&&wd(S.alternate,S);break;case 24:Ku($,S,k,V,f),f&&fe&2048&&Nd(S.alternate,S);break;default:Ku($,S,k,V,f)}o=o.sibling}}function ql(n,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var r=n,u=o,f=u.flags;switch(u.tag){case 22:ql(r,u),f&2048&&wd(u.alternate,u);break;case 24:ql(r,u),f&2048&&Nd(u.alternate,u);break;default:ql(r,u)}o=o.sibling}}var qu=8192;function cl(n,o,r){if(n.subtreeFlags&qu)for(n=n.child;n!==null;)Md(n,o,r),n=n.sibling}function Md(n,o,r){switch(n.tag){case 26:cl(n,o,r),n.flags&qu&&n.memoizedState!==null&&og(r,po,n.memoizedState,n.memoizedProps);break;case 5:cl(n,o,r);break;case 3:case 4:var u=po;po=$l(n.stateNode.containerInfo),cl(n,o,r),po=u;break;case 22:n.memoizedState===null&&(u=n.alternate,u!==null&&u.memoizedState!==null?(u=qu,qu=16777216,cl(n,o,r),qu=u):cl(n,o,r));break;default:cl(n,o,r)}}function Yp(n){var o=n.alternate;if(o!==null&&(n=o.child,n!==null)){o.child=null;do o=n.sibling,n.sibling=null,n=o;while(n!==null)}}function hh(n){var o=n.deletions;if((n.flags&16)!==0){if(o!==null)for(var r=0;r<o.length;r++){var u=o[r];Ei=u,nc(u,n)}Yp(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Ho(n),n=n.sibling}function Ho(n){switch(n.tag){case 0:case 11:case 15:hh(n),n.flags&2048&&un(9,n,n.return);break;case 3:hh(n);break;case 12:hh(n);break;case 22:var o=n.stateNode;n.memoizedState!==null&&o._visibility&2&&(n.return===null||n.return.tag!==13)?(o._visibility&=-3,Wn(n)):hh(n);break;default:hh(n)}}function Wn(n){var o=n.deletions;if((n.flags&16)!==0){if(o!==null)for(var r=0;r<o.length;r++){var u=o[r];Ei=u,nc(u,n)}Yp(n)}for(n=n.child;n!==null;){switch(o=n,o.tag){case 0:case 11:case 15:un(8,o,o.return),Wn(o);break;case 22:r=o.stateNode,r._visibility&2&&(r._visibility&=-3,Wn(o));break;default:Wn(o)}n=n.sibling}}function nc(n,o){for(;Ei!==null;){var r=Ei;switch(r.tag){case 0:case 11:case 15:un(8,r,o);break;case 23:case 22:if(r.memoizedState!==null&&r.memoizedState.cachePool!==null){var u=r.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:Bu(r.memoizedState.cache)}if(u=r.child,u!==null)u.return=r,Ei=u;else e:for(r=n;Ei!==null;){u=Ei;var f=u.sibling,$=u.return;if(tc(u),u===r){Ei=null;break e}if(f!==null){f.return=$,Ei=f;break e}Ei=$}}}var Ld={getCacheForType:function(n){var o=Pi(si),r=o.data.get(n);return r===void 0&&(r=n(),o.data.set(n,r)),r},cacheSignal:function(){return Pi(si).controller.signal}},Qf=typeof WeakMap=="function"?WeakMap:Map,an=0,hn=null,Gt=null,wt=0,Sn=0,$o=null,Dr=!1,Jl=!1,Zl=!1,Xs=0,ii=0,Ys=0,hl=0,Dd=0,eo=0,Ju=0,ic=null,vi=null,xd=!1,dh=0,ep=0,fh=1/0,ph=null,dl=null,yi=0,fl=null,Go=null,xr=0,Bd=0,gh=null,Pd=null,oc=0,Jn=null;function Gi(){return(an&2)!==0&&wt!==0?wt&-wt:de.T!==null?jo():Mi()}function tp(){if(eo===0)if((wt&536870912)===0||Kt){var n=$i;$i<<=1,($i&3932160)===0&&($i=262144),eo=n}else eo=536870912;return n=So.current,n!==null&&(n.flags|=32),eo}function Vi(n,o,r){(n===hn&&(Sn===2||Sn===9)||n.cancelPendingCommit!==null)&&(jn(n,0),Vo(n,wt,eo,!1)),Qt(n,r),((an&2)===0||n!==hn)&&(n===hn&&((an&2)===0&&(hl|=r),ii===4&&Vo(n,wt,eo,!1)),Ks(n))}function np(n,o,r){if((an&6)!==0)throw Error(a(327));var u=!r&&(o&127)===0&&(o&n.expiredLanes)===0||ee(n,o),f=u?Ud(n,o):Fd(n,o,!0),$=u;do{if(f===0){Jl&&!u&&Vo(n,o,0,!1);break}else{if(r=n.current.alternate,$&&!Kp(r)){f=Fd(n,o,!1),$=!1;continue}if(f===2){if($=o,n.errorRecoveryDisabledLanes&$)var S=0;else S=n.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){o=S;e:{var k=n;f=ic;var V=k.current.memoizedState.isDehydrated;if(V&&(jn(k,S).flags|=256),S=Fd(k,S,!1),S!==2){if(Zl&&!V){k.errorRecoveryDisabledLanes|=$,hl|=$,f=4;break e}$=vi,vi=f,$!==null&&(vi===null?vi=$:vi.push.apply(vi,$))}f=S}if($=!1,f!==2)continue}}if(f===1){jn(n,0),Vo(n,o,0,!0);break}e:{switch(u=n,$=f,$){case 0:case 1:throw Error(a(345));case 4:if((o&4194048)!==o)break;case 6:Vo(u,o,eo,!Dr);break e;case 2:vi=null;break;case 3:case 5:break;default:throw Error(a(329))}if((o&62914560)===o&&(f=dh+300-In(),10<f)){if(Vo(u,o,eo,!Dr),G(u,0,!0)!==0)break e;xr=o,u.timeoutHandle=fp(ip.bind(null,u,r,vi,ph,xd,o,eo,hl,Ju,Dr,$,"Throttled",-0,0),f);break e}ip(u,r,vi,ph,xd,o,eo,hl,Ju,Dr,$,null,-0,0)}}break}while(!0);Ks(n)}function ip(n,o,r,u,f,$,S,k,V,fe,Ie,Me,me,Ee){if(n.timeoutHandle=-1,Me=o.subtreeFlags,Me&8192||(Me&16785408)===16785408){Me={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:_o},Md(o,$,Me);var ct=($&62914560)===$?dh-In():($&4194048)===$?ep-In():0;if(ct=mc(Me,ct),ct!==null){xr=$,n.cancelPendingCommit=ct(nu.bind(null,n,o,$,r,u,f,S,k,V,Ie,Me,null,me,Ee)),Vo(n,$,S,!fe);return}}nu(n,o,$,r,u,f,S,k,V)}function Kp(n){for(var o=n;;){var r=o.tag;if((r===0||r===11||r===15)&&o.flags&16384&&(r=o.updateQueue,r!==null&&(r=r.stores,r!==null)))for(var u=0;u<r.length;u++){var f=r[u],$=f.getSnapshot;f=f.value;try{if(!fi($(),f))return!1}catch{return!1}}if(r=o.child,o.subtreeFlags&16384&&r!==null)r.return=o,o=r;else{if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Vo(n,o,r,u){o&=~Dd,o&=~hl,n.suspendedLanes|=o,n.pingedLanes&=~o,u&&(n.warmLanes|=o),u=n.expirationTimes;for(var f=o;0<f;){var $=31-F(f),S=1<<$;u[$]=-1,f&=~S}r!==0&&hi(n,r,o)}function $h(){return(an&6)===0?(uc(0),!1):!0}function Zu(){if(Gt!==null){if(Sn===0)var n=Gt.return;else n=Gt,ys=Fl=null,Vu(n),Hl=null,vr=0,n=Gt;for(;n!==null;)qf(n.alternate,n),n=n.return;Gt=null}}function jn(n,o){var r=n.timeoutHandle;r!==-1&&(n.timeoutHandle=-1,Zd(r)),r=n.cancelPendingCommit,r!==null&&(n.cancelPendingCommit=null,r()),xr=0,Zu(),hn=n,Gt=r=gr(n.current,null),wt=o,Sn=0,$o=null,Dr=!1,Jl=ee(n,o),Zl=!1,Ju=eo=Dd=hl=Ys=ii=0,vi=ic=null,xd=!1,(o&8)!==0&&(o|=o&32);var u=n.entangledLanes;if(u!==0)for(n=n.entanglements,u&=o;0<u;){var f=31-F(u),$=1<<f;o|=n[f],u&=~$}return Xs=o,Ii(),r}function Ql(n,o){xt=null,de.H=ju,o===kn||o===Vc?(o=jh(),Sn=3):o===zh?(o=jh(),Sn=4):Sn=o===Uf?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,$o=o,Gt===null&&(ii=1,oh(n,ns(o,n.current)))}function eu(){var n=So.current;return n===null?!0:(wt&4194048)===wt?Bo===null:(wt&62914560)===wt||(wt&536870912)!==0?n===Bo:!1}function mh(){var n=de.H;return de.H=ju,n===null?ju:n}function _h(){var n=de.A;return de.A=Ld,n}function bh(){ii=4,Dr||(wt&4194048)!==wt&&So.current!==null||(Jl=!0),(Ys&134217727)===0&&(hl&134217727)===0||hn===null||Vo(hn,wt,eo,!1)}function Fd(n,o,r){var u=an;an|=2;var f=mh(),$=_h();(hn!==n||wt!==o)&&(ph=null,jn(n,o)),o=!1;var S=ii;e:do try{if(Sn!==0&&Gt!==null){var k=Gt,V=$o;switch(Sn){case 8:Zu(),S=6;break e;case 3:case 2:case 9:case 6:So.current===null&&(o=!0);var fe=Sn;if(Sn=0,$o=null,Qu(n,k,V,fe),r&&Jl){S=0;break e}break;default:fe=Sn,Sn=0,$o=null,Qu(n,k,V,fe)}}op(),S=ii;break}catch(Ie){Ql(n,Ie)}while(!0);return o&&n.shellSuspendCounter++,ys=Fl=null,an=u,de.H=f,de.A=$,Gt===null&&(hn=null,wt=0,Ii()),S}function op(){for(;Gt!==null;)tu(Gt)}function Ud(n,o){var r=an;an|=2;var u=mh(),f=_h();hn!==n||wt!==o?(ph=null,fh=In()+500,jn(n,o)):Jl=ee(n,o);e:do try{if(Sn!==0&&Gt!==null){o=Gt;var $=$o;t:switch(Sn){case 1:Sn=0,$o=null,Qu(n,o,$,1);break;case 2:case 9:if(Wh($)){Sn=0,$o=null,rp(o);break}o=function(){Sn!==2&&Sn!==9||hn!==n||(Sn=7),Ks(n)},$.then(o,o);break e;case 3:Sn=7;break e;case 4:Sn=5;break e;case 7:Wh($)?(Sn=0,$o=null,rp(o)):(Sn=0,$o=null,Qu(n,o,$,7));break;case 5:var S=null;switch(Gt.tag){case 26:S=Gt.memoizedState;case 5:case 27:var k=Gt;if(S?Rn(S):k.stateNode.complete){Sn=0,$o=null;var V=k.sibling;if(V!==null)Gt=V;else{var fe=k.return;fe!==null?(Gt=fe,Fn(fe)):Gt=null}break t}}Sn=0,$o=null,Qu(n,o,$,5);break;case 6:Sn=0,$o=null,Qu(n,o,$,6);break;case 8:Zu(),ii=6;break e;default:throw Error(a(462))}}sp();break}catch(Ie){Ql(n,Ie)}while(!0);return ys=Fl=null,de.H=u,de.A=f,an=r,Gt!==null?0:(hn=null,wt=0,Ii(),ii)}function sp(){for(;Gt!==null&&!bn();)tu(Gt)}function tu(n){var o=jf(n.alternate,n,Xs);n.memoizedProps=n.pendingProps,o===null?Fn(n):Gt=o}function rp(n){var o=n,r=o.alternate;switch(o.tag){case 15:case 0:o=Or(r,o,o.pendingProps,o.type,void 0,wt);break;case 11:o=Or(r,o,o.pendingProps,o.type.render,o.ref,wt);break;case 5:Vu(o);default:qf(r,o),o=Gt=pf(o,Xs),o=jf(r,o,Xs)}n.memoizedProps=n.pendingProps,o===null?Fn(n):Gt=o}function Qu(n,o,r,u){ys=Fl=null,Vu(o),Hl=null,vr=0;var f=o.return;try{if(Wp(n,f,o,r,wt)){ii=1,oh(n,ns(r,n.current)),Gt=null;return}}catch($){if(f!==null)throw Gt=f,$;ii=1,oh(n,ns(r,n.current)),Gt=null;return}o.flags&32768?(Kt||u===1?n=!0:Jl||(wt&536870912)!==0?n=!1:(Dr=n=!0,(u===2||u===9||u===3||u===6)&&(u=So.current,u!==null&&u.tag===13&&(u.flags|=16384))),sc(o,n)):Fn(o)}function Fn(n){var o=n;do{if((o.flags&32768)!==0){sc(o,Dr);return}n=o.return;var r=Yf(o.alternate,o,Xs);if(r!==null){Gt=r;return}if(o=o.sibling,o!==null){Gt=o;return}Gt=o=n}while(o!==null);ii===0&&(ii=5)}function sc(n,o){do{var r=Kf(n.alternate,n);if(r!==null){r.flags&=32767,Gt=r;return}if(r=n.return,r!==null&&(r.flags|=32768,r.subtreeFlags=0,r.deletions=null),!o&&(n=n.sibling,n!==null)){Gt=n;return}Gt=n=r}while(n!==null);ii=6,Gt=null}function nu(n,o,r,u,f,$,S,k,V){n.cancelPendingCommit=null;do ea();while(yi!==0);if((an&6)!==0)throw Error(a(327));if(o!==null){if(o===n.current)throw Error(a(177));if($=o.lanes|o.childLanes,$|=At,En(n,r,$,S,k,V),n===hn&&(Gt=hn=null,wt=0),Go=o,fl=n,xr=r,Bd=$,gh=f,Pd=u,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,na(Ht,function(){return Gd(),null})):(n.callbackNode=null,n.callbackPriority=0),u=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||u){u=de.T,de.T=null,f=Ve.p,Ve.p=2,S=an,an|=4;try{Od(n,o,r)}finally{an=S,Ve.p=f,de.T=u}}yi=1,Hd(),pl(),lp()}}function Hd(){if(yi===1){yi=0;var n=fl,o=Go,r=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||r){r=de.T,de.T=null;var u=Ve.p;Ve.p=2;var f=an;an|=4;try{al(o,n);var $=dc,S=R(n.containerInfo),k=$.focusedElem,V=$.selectionRange;if(S!==k&&k&&k.ownerDocument&&y(k.ownerDocument.documentElement,k)){if(V!==null&&w(k)){var fe=V.start,Ie=V.end;if(Ie===void 0&&(Ie=fe),"selectionStart"in k)k.selectionStart=fe,k.selectionEnd=Math.min(Ie,k.value.length);else{var Me=k.ownerDocument||document,me=Me&&Me.defaultView||window;if(me.getSelection){var Ee=me.getSelection(),ct=k.textContent.length,yt=Math.min(V.start,ct),cn=V.end===void 0?yt:Math.min(V.end,ct);!Ee.extend&&yt>cn&&(S=cn,cn=yt,yt=S);var re=b(k,yt),Q=b(k,cn);if(re&&Q&&(Ee.rangeCount!==1||Ee.anchorNode!==re.node||Ee.anchorOffset!==re.offset||Ee.focusNode!==Q.node||Ee.focusOffset!==Q.offset)){var he=Me.createRange();he.setStart(re.node,re.offset),Ee.removeAllRanges(),yt>cn?(Ee.addRange(he),Ee.extend(Q.node,Q.offset)):(he.setEnd(Q.node,Q.offset),Ee.addRange(he))}}}}for(Me=[],Ee=k;Ee=Ee.parentNode;)Ee.nodeType===1&&Me.push({element:Ee,left:Ee.scrollLeft,top:Ee.scrollTop});for(typeof k.focus=="function"&&k.focus(),k=0;k<Me.length;k++){var we=Me[k];we.element.scrollLeft=we.left,we.element.scrollTop=we.top}}Ec=!!oa,dc=oa=null}finally{an=f,Ve.p=u,de.T=r}}n.current=o,yi=2}}function pl(){if(yi===2){yi=0;var n=fl,o=Go,r=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||r){r=de.T,de.T=null;var u=Ve.p;Ve.p=2;var f=an;an|=4;try{ec(n,o.alternate,o)}finally{an=f,Ve.p=u,de.T=r}}yi=3}}function lp(){if(yi===4||yi===3){yi=0,so();var n=fl,o=Go,r=xr,u=Pd;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?yi=5:(yi=0,Go=fl=null,Eh(n,n.pendingLanes));var f=n.pendingLanes;if(f===0&&(dl=null),ro(r),o=o.stateNode,L&&typeof L.onCommitFiberRoot=="function")try{L.onCommitFiberRoot(v,o,void 0,(o.current.flags&128)===128)}catch{}if(u!==null){o=de.T,f=Ve.p,Ve.p=2,de.T=null;try{for(var $=n.onRecoverableError,S=0;S<u.length;S++){var k=u[S];$(k.value,{componentStack:k.stack})}}finally{de.T=o,Ve.p=f}}(xr&3)!==0&&ea(),Ks(n),f=n.pendingLanes,(r&261930)!==0&&(f&42)!==0?n===Jn?oc++:(oc=0,Jn=n):oc=0,uc(0)}}function Eh(n,o){(n.pooledCacheLanes&=o)===0&&(o=n.pooledCache,o!=null&&(n.pooledCache=null,Bu(o)))}function ea(){return Hd(),pl(),lp(),Gd()}function Gd(){if(yi!==5)return!1;var n=fl,o=Bd;Bd=0;var r=ro(xr),u=de.T,f=Ve.p;try{Ve.p=32>r?32:r,de.T=null,r=gh,gh=null;var $=fl,S=xr;if(yi=0,Go=fl=null,xr=0,(an&6)!==0)throw Error(a(331));var k=an;if(an|=4,Ho($.current),kd($,$.current,S,r),an=k,uc(0,!1),L&&typeof L.onPostCommitFiberRoot=="function")try{L.onPostCommitFiberRoot(v,$)}catch{}return!0}finally{Ve.p=f,de.T=u,Eh(n,o)}}function to(n,o,r){o=ns(r,o),o=Ka(n.stateNode,o,2),n=Fi(n,o,2),n!==null&&(Qt(n,2),Ks(n))}function nn(n,o,r){if(n.tag===3)to(n,n,r);else for(;o!==null;){if(o.tag===3){to(o,n,r);break}else if(o.tag===1){var u=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(dl===null||!dl.has(u))){n=ns(r,n),r=Ff(2),u=Fi(o,r,2),u!==null&&(Sd(r,u,o,n),Qt(u,2),Ks(u));break}}o=o.return}}function rc(n,o,r){var u=n.pingCache;if(u===null){u=n.pingCache=new Qf;var f=new Set;u.set(o,f)}else f=u.get(o),f===void 0&&(f=new Set,u.set(o,f));f.has(r)||(Zl=!0,f.add(r),n=Th.bind(null,n,o,r),o.then(n,n))}function Th(n,o,r){var u=n.pingCache;u!==null&&u.delete(o),n.pingedLanes|=n.suspendedLanes&r,n.warmLanes&=~r,hn===n&&(wt&r)===r&&(ii===4||ii===3&&(wt&62914560)===wt&&300>In()-dh?(an&2)===0&&jn(n,0):Dd|=r,Ju===wt&&(Ju=0)),Ks(n)}function ta(n,o){o===0&&(o=qe()),n=vn(n,o),n!==null&&(Qt(n,o),Ks(n))}function qp(n){var o=n.memoizedState,r=0;o!==null&&(r=o.retryLane),ta(n,r)}function Jp(n,o){var r=0;switch(n.tag){case 31:case 13:var u=n.stateNode,f=n.memoizedState;f!==null&&(r=f.retryLane);break;case 19:u=n.stateNode;break;case 22:u=n.stateNode._retryCache;break;default:throw Error(a(314))}u!==null&&u.delete(o),ta(n,r)}function na(n,o){return Ln(n,o)}var lc=null,iu=null,zo=!1,ou=!1,vh=!1,Br=0;function Ks(n){n!==iu&&n.next===null&&(iu===null?lc=iu=n:iu=iu.next=n),ou=!0,zo||(zo=!0,Zp())}function uc(n,o){if(!vh&&ou){vh=!0;do for(var r=!1,u=lc;u!==null;){if(n!==0){var f=u.pendingLanes;if(f===0)var $=0;else{var S=u.suspendedLanes,k=u.pingedLanes;$=(1<<31-F(42|n)+1)-1,$&=f&~(S&~k),$=$&201326741?$&201326741|1:$?$|2:0}$!==0&&(r=!0,Wd(u,$))}else $=wt,$=G(u,u===hn?$:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),($&3)===0||ee(u,$)||(r=!0,Wd(u,$));u=u.next}while(r);vh=!1}}function Vd(){gi()}function gi(){ou=zo=!1;var n=0;Br!==0&&dp()&&(n=Br);for(var o=In(),r=null,u=lc;u!==null;){var f=u.next,$=Wo(u,o);$===0?(u.next=null,r===null?lc=f:r.next=f,f===null&&(iu=r)):(r=u,(n!==0||($&3)!==0)&&(ou=!0)),u=f}yi!==0&&yi!==5||uc(n),Br!==0&&(Br=0)}function Wo(n,o){for(var r=n.suspendedLanes,u=n.pingedLanes,f=n.expirationTimes,$=n.pendingLanes&-62914561;0<$;){var S=31-F($),k=1<<S,V=f[S];V===-1?((k&r)===0||(k&u)!==0)&&(f[S]=Te(k,o)):V<=o&&(n.expiredLanes|=k),$&=~k}if(o=hn,r=wt,r=G(n,n===o?r:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),u=n.callbackNode,r===0||n===o&&(Sn===2||Sn===9)||n.cancelPendingCommit!==null)return u!==null&&u!==null&&_n(u),n.callbackNode=null,n.callbackPriority=0;if((r&3)===0||ee(n,r)){if(o=r&-r,o===n.callbackPriority)return o;switch(u!==null&&_n(u),ro(r)){case 2:case 8:r=Hn;break;case 32:r=Ht;break;case 268435456:r=Xn;break;default:r=Ht}return u=zd.bind(null,n),r=Ln(r,u),n.callbackPriority=o,n.callbackNode=r,o}return u!==null&&u!==null&&_n(u),n.callbackPriority=2,n.callbackNode=null,2}function zd(n,o){if(yi!==0&&yi!==5)return n.callbackNode=null,n.callbackPriority=0,null;var r=n.callbackNode;if(ea()&&n.callbackNode!==r)return null;var u=wt;return u=G(n,n===hn?u:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),u===0?null:(np(n,u,o),Wo(n,In()),n.callbackNode!=null&&n.callbackNode===r?zd.bind(null,n):null)}function Wd(n,o){if(ea())return null;np(n,o,!0)}function Zp(){sa(function(){(an&6)!==0?Ln(Zn,Vd):gi()})}function jo(){if(Br===0){var n=Pu;n===0&&(n=je,je<<=1,(je&261888)===0&&(je=256)),Br=n}return Br}function ac(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:ms(""+n)}function dn(n,o){var r=o.ownerDocument.createElement("input");return r.name=o.name,r.value=o.value,n.id&&r.setAttribute("form",n.id),o.parentNode.insertBefore(r,o),n=new FormData(n),r.parentNode.removeChild(r),n}function ai(n,o,r,u,f){if(o==="submit"&&r&&r.stateNode===f){var $=ac((f[Qn]||null).action),S=u.submitter;S&&(o=(o=S[Qn]||null)?ac(o.formAction):S.getAttribute("formAction"),o!==null&&($=o,S=null));var k=new Eu("action","action",null,u,f);n.push({event:k,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Br!==0){var V=S?dn(f,S):new FormData(f);ge(r,{pending:!0,data:V,method:f.method,action:$},null,V)}}else typeof $=="function"&&(k.preventDefault(),V=S?dn(f,S):new FormData(f),ge(r,{pending:!0,data:V,method:f.method,action:$},$,V))},currentTarget:f}]})}}for(var su=0;su<et.length;su++){var jd=et[su],Xd=jd.toLowerCase(),up=jd[0].toUpperCase()+jd.slice(1);Ue(Xd,"on"+up)}Ue(ue,"onAnimationEnd"),Ue($e,"onAnimationIteration"),Ue(ye,"onAnimationStart"),Ue("dblclick","onDoubleClick"),Ue("focusin","onFocus"),Ue("focusout","onBlur"),Ue(ke,"onTransitionRun"),Ue(ze,"onTransitionStart"),Ue(nt,"onTransitionCancel"),Ue(Pe,"onTransitionEnd"),ps("onMouseEnter",["mouseout","mouseover"]),ps("onMouseLeave",["mouseout","mouseover"]),ps("onPointerEnter",["pointerout","pointerover"]),ps("onPointerLeave",["pointerout","pointerover"]),Jo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Jo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Jo("onBeforeInput",["compositionend","keypress","textInput","paste"]),Jo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Jo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Jo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cc=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Pr));function Xo(n,o){o=(o&4)!==0;for(var r=0;r<n.length;r++){var u=n[r],f=u.event;u=u.listeners;e:{var $=void 0;if(o)for(var S=u.length-1;0<=S;S--){var k=u[S],V=k.instance,fe=k.currentTarget;if(k=k.listener,V!==$&&f.isPropagationStopped())break e;$=k,f.currentTarget=fe;try{$(f)}catch(Ie){Ge(Ie)}f.currentTarget=null,$=V}else for(S=0;S<u.length;S++){if(k=u[S],V=k.instance,fe=k.currentTarget,k=k.listener,V!==$&&f.isPropagationStopped())break e;$=k,f.currentTarget=fe;try{$(f)}catch(Ie){Ge(Ie)}f.currentTarget=null,$=V}}}}function Vt(n,o){var r=o[fs];r===void 0&&(r=o[fs]=new Set);var u=n+"__bubble";r.has(u)||(yh(o,n,2,!1),r.add(u))}function us(n,o,r){var u=0;o&&(u|=4),yh(r,n,u,o)}var ia="_reactListening"+Math.random().toString(36).slice(2);function Yd(n){if(!n[ia]){n[ia]=!0,er.forEach(function(r){r!=="selectionchange"&&(cc.has(r)||us(r,!1,n),us(r,!0,n))});var o=n.nodeType===9?n:n.ownerDocument;o===null||o[ia]||(o[ia]=!0,us("selectionchange",!1,o))}}function yh(n,o,r,u){switch(Ip(o)){case 2:var f=Cp;break;case 8:f=ug;break;default:f=of}r=f.bind(null,o,r,n),f=void 0,!ga||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(f=!0),u?f!==void 0?n.addEventListener(o,r,{capture:!0,passive:f}):n.addEventListener(o,r,!0):f!==void 0?n.addEventListener(o,r,{passive:f}):n.addEventListener(o,r,!1)}function gl(n,o,r,u,f){var $=u;if((o&1)===0&&(o&2)===0&&u!==null)e:for(;;){if(u===null)return;var S=u.tag;if(S===3||S===4){var k=u.stateNode.containerInfo;if(k===f)break;if(S===4)for(S=u.return;S!==null;){var V=S.tag;if((V===3||V===4)&&S.stateNode.containerInfo===f)return;S=S.return}for(;k!==null;){if(S=ks(k),S===null)return;if(V=S.tag,V===5||V===6||V===26||V===27){u=$=S;continue e}k=k.parentNode}}u=u.return}sr(function(){var fe=$,Ie=Ls(r),Me=[];e:{var me=Ye.get(n);if(me!==void 0){var Ee=Eu,ct=n;switch(n){case"keypress":if(xs(r)===0)break e;case"keydown":case"keyup":Ee=Cu;break;case"focusin":ct="focus",Ee=Xr;break;case"focusout":ct="blur",Ee=Xr;break;case"beforeblur":case"afterblur":Ee=Xr;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ee=vu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ee=Ac;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ee=Ta;break;case ue:case $e:case ye:Ee=wc;break;case Pe:Ee=kl;break;case"scroll":case"scrollend":Ee=Tu;break;case"wheel":Ee=Ps;break;case"copy":case"cut":case"paste":Ee=bo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ee=Ea;break;case"toggle":case"beforetoggle":Ee=ya}var yt=(o&4)!==0,cn=!yt&&(n==="scroll"||n==="scrollend"),re=yt?me!==null?me+"Capture":null:me;yt=[];for(var Q=fe,he;Q!==null;){var we=Q;if(he=we.stateNode,we=we.tag,we!==5&&we!==26&&we!==27||he===null||re===null||(we=bs(Q,re),we!=null&&yt.push(Dt(Q,we,he))),cn)break;Q=Q.return}0<yt.length&&(me=new Ee(me,ct,null,r,Ie),Me.push({event:me,listeners:yt}))}}if((o&7)===0){e:{if(me=n==="mouseover"||n==="pointerover",Ee=n==="mouseout"||n==="pointerout",me&&r!==es&&(ct=r.relatedTarget||r.fromElement)&&(ks(ct)||ct[qi]))break e;if((Ee||me)&&(me=Ie.window===Ie?Ie:(me=Ie.ownerDocument)?me.defaultView||me.parentWindow:window,Ee?(ct=r.relatedTarget||r.toElement,Ee=fe,ct=ct?ks(ct):null,ct!==null&&(cn=E(ct),yt=ct.tag,ct!==cn||yt!==5&&yt!==27&&yt!==6)&&(ct=null)):(Ee=null,ct=fe),Ee!==ct)){if(yt=vu,we="onMouseLeave",re="onMouseEnter",Q="mouse",(n==="pointerout"||n==="pointerover")&&(yt=Ea,we="onPointerLeave",re="onPointerEnter",Q="pointer"),cn=Ee==null?me:lo(Ee),he=ct==null?me:lo(ct),me=new yt(we,Q+"leave",Ee,r,Ie),me.target=cn,me.relatedTarget=he,we=null,ks(Ie)===fe&&(yt=new yt(re,Q+"enter",ct,r,Ie),yt.target=he,yt.relatedTarget=cn,we=yt),cn=we,Ee&&ct)t:{for(yt=ru,re=Ee,Q=ct,he=0,we=re;we;we=yt(we))he++;we=0;for(var bt=Q;bt;bt=yt(bt))we++;for(;0<he-we;)re=yt(re),he--;for(;0<we-he;)Q=yt(Q),we--;for(;he--;){if(re===Q||Q!==null&&re===Q.alternate){yt=re;break t}re=yt(re),Q=yt(Q)}yt=null}else yt=null;Ee!==null&&Sh(Me,me,Ee,yt,!1),ct!==null&&cn!==null&&Sh(Me,cn,ct,yt,!0)}}e:{if(me=fe?lo(fe):window,Ee=me.nodeName&&me.nodeName.toLowerCase(),Ee==="select"||Ee==="input"&&me.type==="file")var Zt=Yr;else if(hr(me))if(co)Zt=Kr;else{Zt=pr;var gt=Pc}else Ee=me.nodeName,!Ee||Ee.toLowerCase()!=="input"||me.type!=="checkbox"&&me.type!=="radio"?fe&&Il(fe.elementType)&&(Zt=Yr):Zt=Ia;if(Zt&&(Zt=Zt(n,fe))){Ou(Me,Zt,r,Ie);break e}gt&&gt(n,me,fe),n==="focusout"&&fe&&me.type==="number"&&fe.memoizedProps.value!=null&&Cl(me,"number",me.value)}switch(gt=fe?lo(fe):window,n){case"focusin":(hr(gt)||gt.contentEditable==="true")&&(U=gt,W=fe,q=null);break;case"focusout":q=W=U=null;break;case"mousedown":ie=!0;break;case"contextmenu":case"mouseup":case"dragend":ie=!1,z(Me,r,Ie);break;case"selectionchange":if(x)break;case"keydown":case"keyup":z(Me,r,Ie)}var ut;if(cr)e:{switch(n){case"compositionstart":var Xt="onCompositionStart";break e;case"compositionend":Xt="onCompositionEnd";break e;case"compositionupdate":Xt="onCompositionUpdate";break e}Xt=void 0}else Fs?Iu(n,r)&&(Xt="onCompositionEnd"):n==="keydown"&&r.keyCode===229&&(Xt="onCompositionStart");Xt&&(Ru&&r.locale!=="ko"&&(Fs||Xt!=="onCompositionStart"?Xt==="onCompositionEnd"&&Fs&&(ut=Mo()):(ko=Ie,bu="value"in ko?ko.value:ko.textContent,Fs=!0)),gt=hc(fe,Xt),0<gt.length&&(Xt=new Al(Xt,n,null,r,Ie),Me.push({event:Xt,listeners:gt}),ut?Xt.data=ut:(ut=Ca(r),ut!==null&&(Xt.data=ut)))),(ut=Dc?Ra(n,r):xc(n,r))&&(Xt=hc(fe,"onBeforeInput"),0<Xt.length&&(gt=new Al("onBeforeInput","beforeinput",null,r,Ie),Me.push({event:gt,listeners:Xt}),gt.data=ut)),ai(Me,n,fe,r,Ie)}Xo(Me,o)})}function Dt(n,o,r){return{instance:n,listener:o,currentTarget:r}}function hc(n,o){for(var r=o+"Capture",u=[];n!==null;){var f=n,$=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||$===null||(f=bs(n,r),f!=null&&u.unshift(Dt(n,f,$)),f=bs(n,o),f!=null&&u.push(Dt(n,f,$))),n.tag===3)return u;n=n.return}return[]}function ru(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function Sh(n,o,r,u,f){for(var $=o._reactName,S=[];r!==null&&r!==u;){var k=r,V=k.alternate,fe=k.stateNode;if(k=k.tag,V!==null&&V===u)break;k!==5&&k!==26&&k!==27||fe===null||(V=fe,f?(fe=bs(r,$),fe!=null&&S.unshift(Dt(r,fe,V))):f||(fe=bs(r,$),fe!=null&&S.push(Dt(r,fe,V)))),r=r.return}S.length!==0&&n.push({event:o,listeners:S})}var _g=/\r\n?/g,Qp=/\u0000|\uFFFD/g;function ap(n){return(typeof n=="string"?n:""+n).replace(_g,`
`).replace(Qp,"")}function Ch(n,o){return o=ap(o),ap(n)===o}function Cn(n,o,r,u,f,$){switch(r){case"children":typeof u=="string"?o==="body"||o==="textarea"&&u===""||ir(n,u):(typeof u=="number"||typeof u=="bigint")&&o!=="body"&&ir(n,""+u);break;case"className":$s(n,"class",u);break;case"tabIndex":$s(n,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":$s(n,r,u);break;case"style":pa(n,u,$);break;case"data":if(o!=="object"){$s(n,"data",u);break}case"src":case"href":if(u===""&&(o!=="a"||r!=="href")){n.removeAttribute(r);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){n.removeAttribute(r);break}u=ms(""+u),n.setAttribute(r,u);break;case"action":case"formAction":if(typeof u=="function"){n.setAttribute(r,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof $=="function"&&(r==="formAction"?(o!=="input"&&Cn(n,o,"name",f.name,f,null),Cn(n,o,"formEncType",f.formEncType,f,null),Cn(n,o,"formMethod",f.formMethod,f,null),Cn(n,o,"formTarget",f.formTarget,f,null)):(Cn(n,o,"encType",f.encType,f,null),Cn(n,o,"method",f.method,f,null),Cn(n,o,"target",f.target,f,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){n.removeAttribute(r);break}u=ms(""+u),n.setAttribute(r,u);break;case"onClick":u!=null&&(n.onclick=_o);break;case"onScroll":u!=null&&Vt("scroll",n);break;case"onScrollEnd":u!=null&&Vt("scrollend",n);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(r=u.__html,r!=null){if(f.children!=null)throw Error(a(60));n.innerHTML=r}}break;case"multiple":n.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":n.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){n.removeAttribute("xlink:href");break}r=ms(""+u),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",r);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(r,""+u):n.removeAttribute(r);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(r,""):n.removeAttribute(r);break;case"capture":case"download":u===!0?n.setAttribute(r,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?n.setAttribute(r,u):n.removeAttribute(r);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?n.setAttribute(r,u):n.removeAttribute(r);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?n.removeAttribute(r):n.setAttribute(r,u);break;case"popover":Vt("beforetoggle",n),Vt("toggle",n),Ut(n,"popover",u);break;case"xlinkActuate":uo(n,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":uo(n,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":uo(n,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":uo(n,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":uo(n,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":uo(n,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":uo(n,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":uo(n,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":uo(n,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Ut(n,"is",u);break;case"innerText":case"textContent":break;default:(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(r=xh.get(r)||r,Ut(n,r,u))}}function Kd(n,o,r,u,f,$){switch(r){case"style":pa(n,u,$);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(r=u.__html,r!=null){if(f.children!=null)throw Error(a(60));n.innerHTML=r}}break;case"children":typeof u=="string"?ir(n,u):(typeof u=="number"||typeof u=="bigint")&&ir(n,""+u);break;case"onScroll":u!=null&&Vt("scroll",n);break;case"onScrollEnd":u!=null&&Vt("scrollend",n);break;case"onClick":u!=null&&(n.onclick=_o);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!tr.hasOwnProperty(r))e:{if(r[0]==="o"&&r[1]==="n"&&(f=r.endsWith("Capture"),o=r.slice(2,f?r.length-7:void 0),$=n[Qn]||null,$=$!=null?$[r]:null,typeof $=="function"&&n.removeEventListener(o,$,f),typeof u=="function")){typeof $!="function"&&$!==null&&(r in n?n[r]=null:n.hasAttribute(r)&&n.removeAttribute(r)),n.addEventListener(o,u,f);break e}r in n?n[r]=u:u===!0?n.setAttribute(r,""):Ut(n,r,u)}}}function wi(n,o,r){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Vt("error",n),Vt("load",n);var u=!1,f=!1,$;for($ in r)if(r.hasOwnProperty($)){var S=r[$];if(S!=null)switch($){case"src":u=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,o));default:Cn(n,o,$,S,r,null)}}f&&Cn(n,o,"srcSet",r.srcSet,r,null),u&&Cn(n,o,"src",r.src,r,null);return;case"input":Vt("invalid",n);var k=$=S=f=null,V=null,fe=null;for(u in r)if(r.hasOwnProperty(u)){var Ie=r[u];if(Ie!=null)switch(u){case"name":f=Ie;break;case"type":S=Ie;break;case"checked":V=Ie;break;case"defaultChecked":fe=Ie;break;case"value":$=Ie;break;case"defaultValue":k=Ie;break;case"children":case"dangerouslySetInnerHTML":if(Ie!=null)throw Error(a(137,o));break;default:Cn(n,o,u,Ie,r,null)}}Zo(n,$,k,V,fe,S,f,!1);return;case"select":Vt("invalid",n),u=S=$=null;for(f in r)if(r.hasOwnProperty(f)&&(k=r[f],k!=null))switch(f){case"value":$=k;break;case"defaultValue":S=k;break;case"multiple":u=k;default:Cn(n,o,f,k,r,null)}o=$,r=S,n.multiple=!!u,o!=null?Qo(n,!!u,o,!1):r!=null&&Qo(n,!!u,r,!0);return;case"textarea":Vt("invalid",n),$=f=u=null;for(S in r)if(r.hasOwnProperty(S)&&(k=r[S],k!=null))switch(S){case"value":u=k;break;case"defaultValue":f=k;break;case"children":$=k;break;case"dangerouslySetInnerHTML":if(k!=null)throw Error(a(91));break;default:Cn(n,o,S,k,r,null)}jr(n,u,f,$);return;case"option":for(V in r)if(r.hasOwnProperty(V)&&(u=r[V],u!=null))switch(V){case"selected":n.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:Cn(n,o,V,u,r,null)}return;case"dialog":Vt("beforetoggle",n),Vt("toggle",n),Vt("cancel",n),Vt("close",n);break;case"iframe":case"object":Vt("load",n);break;case"video":case"audio":for(u=0;u<Pr.length;u++)Vt(Pr[u],n);break;case"image":Vt("error",n),Vt("load",n);break;case"details":Vt("toggle",n);break;case"embed":case"source":case"link":Vt("error",n),Vt("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(fe in r)if(r.hasOwnProperty(fe)&&(u=r[fe],u!=null))switch(fe){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,o));default:Cn(n,o,fe,u,r,null)}return;default:if(Il(o)){for(Ie in r)r.hasOwnProperty(Ie)&&(u=r[Ie],u!==void 0&&Kd(n,o,Ie,u,r,void 0));return}}for(k in r)r.hasOwnProperty(k)&&(u=r[k],u!=null&&Cn(n,o,k,u,r,null))}function qd(n,o,r,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,$=null,S=null,k=null,V=null,fe=null,Ie=null;for(Ee in r){var Me=r[Ee];if(r.hasOwnProperty(Ee)&&Me!=null)switch(Ee){case"checked":break;case"value":break;case"defaultValue":V=Me;default:u.hasOwnProperty(Ee)||Cn(n,o,Ee,null,u,Me)}}for(var me in u){var Ee=u[me];if(Me=r[me],u.hasOwnProperty(me)&&(Ee!=null||Me!=null))switch(me){case"type":$=Ee;break;case"name":f=Ee;break;case"checked":fe=Ee;break;case"defaultChecked":Ie=Ee;break;case"value":S=Ee;break;case"defaultValue":k=Ee;break;case"children":case"dangerouslySetInnerHTML":if(Ee!=null)throw Error(a(137,o));break;default:Ee!==Me&&Cn(n,o,me,Ee,u,Me)}}Ci(n,S,k,V,fe,Ie,$,f);return;case"select":Ee=S=k=me=null;for($ in r)if(V=r[$],r.hasOwnProperty($)&&V!=null)switch($){case"value":break;case"multiple":Ee=V;default:u.hasOwnProperty($)||Cn(n,o,$,null,u,V)}for(f in u)if($=u[f],V=r[f],u.hasOwnProperty(f)&&($!=null||V!=null))switch(f){case"value":me=$;break;case"defaultValue":k=$;break;case"multiple":S=$;default:$!==V&&Cn(n,o,f,$,u,V)}o=k,r=S,u=Ee,me!=null?Qo(n,!!r,me,!1):!!u!=!!r&&(o!=null?Qo(n,!!r,o,!0):Qo(n,!!r,r?[]:"",!1));return;case"textarea":Ee=me=null;for(k in r)if(f=r[k],r.hasOwnProperty(k)&&f!=null&&!u.hasOwnProperty(k))switch(k){case"value":break;case"children":break;default:Cn(n,o,k,null,u,f)}for(S in u)if(f=u[S],$=r[S],u.hasOwnProperty(S)&&(f!=null||$!=null))switch(S){case"value":me=f;break;case"defaultValue":Ee=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(a(91));break;default:f!==$&&Cn(n,o,S,f,u,$)}Rl(n,me,Ee);return;case"option":for(var ct in r)if(me=r[ct],r.hasOwnProperty(ct)&&me!=null&&!u.hasOwnProperty(ct))switch(ct){case"selected":n.selected=!1;break;default:Cn(n,o,ct,null,u,me)}for(V in u)if(me=u[V],Ee=r[V],u.hasOwnProperty(V)&&me!==Ee&&(me!=null||Ee!=null))switch(V){case"selected":n.selected=me&&typeof me!="function"&&typeof me!="symbol";break;default:Cn(n,o,V,me,u,Ee)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var yt in r)me=r[yt],r.hasOwnProperty(yt)&&me!=null&&!u.hasOwnProperty(yt)&&Cn(n,o,yt,null,u,me);for(fe in u)if(me=u[fe],Ee=r[fe],u.hasOwnProperty(fe)&&me!==Ee&&(me!=null||Ee!=null))switch(fe){case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(a(137,o));break;default:Cn(n,o,fe,me,u,Ee)}return;default:if(Il(o)){for(var cn in r)me=r[cn],r.hasOwnProperty(cn)&&me!==void 0&&!u.hasOwnProperty(cn)&&Kd(n,o,cn,void 0,u,me);for(Ie in u)me=u[Ie],Ee=r[Ie],!u.hasOwnProperty(Ie)||me===Ee||me===void 0&&Ee===void 0||Kd(n,o,Ie,me,u,Ee);return}}for(var re in r)me=r[re],r.hasOwnProperty(re)&&me!=null&&!u.hasOwnProperty(re)&&Cn(n,o,re,null,u,me);for(Me in u)me=u[Me],Ee=r[Me],!u.hasOwnProperty(Me)||me===Ee||me==null&&Ee==null||Cn(n,o,Me,me,u,Ee)}function cp(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function eg(){if(typeof performance.getEntriesByType=="function"){for(var n=0,o=0,r=performance.getEntriesByType("resource"),u=0;u<r.length;u++){var f=r[u],$=f.transferSize,S=f.initiatorType,k=f.duration;if($&&k&&cp(S)){for(S=0,k=f.responseEnd,u+=1;u<r.length;u++){var V=r[u],fe=V.startTime;if(fe>k)break;var Ie=V.transferSize,Me=V.initiatorType;Ie&&cp(Me)&&(V=V.responseEnd,S+=Ie*(V<k?1:(k-fe)/(V-fe)))}if(--u,o+=8*($+S)/(f.duration/1e3),n++,10<n)break}}if(0<n)return o/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var oa=null,dc=null;function As(n){return n.nodeType===9?n:n.ownerDocument}function no(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Jd(n,o){if(n===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&o==="foreignObject"?0:n}function hp(n,o){return n==="textarea"||n==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Rh=null;function dp(){var n=window.event;return n&&n.type==="popstate"?n===Rh?!1:(Rh=n,!0):(Rh=null,!1)}var fp=typeof setTimeout=="function"?setTimeout:void 0,Zd=typeof clearTimeout=="function"?clearTimeout:void 0,zi=typeof Promise=="function"?Promise:void 0,sa=typeof queueMicrotask=="function"?queueMicrotask:typeof zi<"u"?function(n){return zi.resolve(null).then(n).catch(bg)}:fp;function bg(n){setTimeout(function(){throw n})}function lu(n){return n==="head"}function Ih(n,o){var r=o,u=0;do{var f=r.nextSibling;if(n.removeChild(r),f&&f.nodeType===8)if(r=f.data,r==="/$"||r==="/&"){if(u===0){n.removeChild(f),da(o);return}u--}else if(r==="$"||r==="$?"||r==="$~"||r==="$!"||r==="&")u++;else if(r==="html")On(n.ownerDocument.documentElement);else if(r==="head"){r=n.ownerDocument.head,On(r);for(var $=r.firstChild;$;){var S=$.nextSibling,k=$.nodeName;$[wo]||k==="SCRIPT"||k==="STYLE"||k==="LINK"&&$.rel.toLowerCase()==="stylesheet"||r.removeChild($),$=S}}else r==="body"&&On(n.ownerDocument.body);r=f}while(r);da(o)}function qs(n,o){var r=n;n=0;do{var u=r.nextSibling;if(r.nodeType===1?o?(r._stashedDisplay=r.style.display,r.style.display="none"):(r.style.display=r._stashedDisplay||"",r.getAttribute("style")===""&&r.removeAttribute("style")):r.nodeType===3&&(o?(r._stashedText=r.nodeValue,r.nodeValue=""):r.nodeValue=r._stashedText||""),u&&u.nodeType===8)if(r=u.data,r==="/$"){if(n===0)break;n--}else r!=="$"&&r!=="$?"&&r!=="$~"&&r!=="$!"||n++;r=u}while(r)}function Qd(n){var o=n.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var r=o;switch(o=o.nextSibling,r.nodeName){case"HTML":case"HEAD":case"BODY":Qd(r),zr(r);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(r.rel.toLowerCase()==="stylesheet")continue}n.removeChild(r)}}function as(n,o,r,u){for(;n.nodeType===1;){var f=r;if(n.nodeName.toLowerCase()!==o.toLowerCase()){if(!u&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(u){if(!n[wo])switch(o){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if($=n.getAttribute("rel"),$==="stylesheet"&&n.hasAttribute("data-precedence"))break;if($!==f.rel||n.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||n.getAttribute("title")!==(f.title==null?null:f.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if($=n.getAttribute("src"),($!==(f.src==null?null:f.src)||n.getAttribute("type")!==(f.type==null?null:f.type)||n.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&$&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(o==="input"&&n.type==="hidden"){var $=f.name==null?null:""+f.name;if(f.type==="hidden"&&n.getAttribute("name")===$)return n}else return n;if(n=io(n.nextSibling),n===null)break}return null}function fn(n,o,r){if(o==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!r||(n=io(n.nextSibling),n===null))return null;return n}function Fr(n,o){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=io(n.nextSibling),n===null))return null;return n}function ra(n){return n.data==="$?"||n.data==="$~"}function fc(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function ef(n,o){var r=n.ownerDocument;if(n.data==="$~")n._reactRetry=o;else if(n.data!=="$?"||r.readyState!=="loading")o();else{var u=function(){o(),r.removeEventListener("DOMContentLoaded",u)};r.addEventListener("DOMContentLoaded",u),n._reactRetry=u}}function io(n){for(;n!=null;n=n.nextSibling){var o=n.nodeType;if(o===1||o===3)break;if(o===8){if(o=n.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return n}var pp=null;function ws(n){n=n.nextSibling;for(var o=0;n;){if(n.nodeType===8){var r=n.data;if(r==="/$"||r==="/&"){if(o===0)return io(n.nextSibling);o--}else r!=="$"&&r!=="$!"&&r!=="$?"&&r!=="$~"&&r!=="&"||o++}n=n.nextSibling}return null}function pn(n){n=n.previousSibling;for(var o=0;n;){if(n.nodeType===8){var r=n.data;if(r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"){if(o===0)return n;o--}else r!=="/$"&&r!=="/&"||o++}n=n.previousSibling}return null}function Ur(n,o,r){switch(o=As(r),n){case"html":if(n=o.documentElement,!n)throw Error(a(452));return n;case"head":if(n=o.head,!n)throw Error(a(453));return n;case"body":if(n=o.body,!n)throw Error(a(454));return n;default:throw Error(a(451))}}function On(n){for(var o=n.attributes;o.length;)n.removeAttributeNode(o[0]);zr(n)}var Ro=new Map,lt=new Set;function $l(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Js=Ve.d;Ve.d={f:gp,r:Jt,D:ua,C:tg,L:aa,m:mp,X:ng,S:_p,M:Wi};function gp(){var n=Js.f(),o=$h();return n||o}function Jt(n){var o=rn(n);o!==null&&o.tag===5&&o.type==="form"?Gp(o):Js.r(n)}var la=typeof document>"u"?null:document;function $p(n,o,r){var u=la;if(u&&typeof o=="string"&&o){var f=_i(o);f='link[rel="'+n+'"][href="'+f+'"]',typeof r=="string"&&(f+='[crossorigin="'+r+'"]'),lt.has(f)||(lt.add(f),n={rel:n,crossOrigin:r,href:o},u.querySelector(f)===null&&(o=u.createElement("link"),wi(o,"link",n),Kn(o),u.head.appendChild(o)))}}function ua(n){Js.D(n),$p("dns-prefetch",n,null)}function tg(n,o){Js.C(n,o),$p("preconnect",n,o)}function aa(n,o,r){Js.L(n,o,r);var u=la;if(u&&n&&o){var f='link[rel="preload"][as="'+_i(o)+'"]';o==="image"&&r&&r.imageSrcSet?(f+='[imagesrcset="'+_i(r.imageSrcSet)+'"]',typeof r.imageSizes=="string"&&(f+='[imagesizes="'+_i(r.imageSizes)+'"]')):f+='[href="'+_i(n)+'"]';var $=f;switch(o){case"style":$=Io(n);break;case"script":$=Zs(n)}Ro.has($)||(n=D({rel:"preload",href:o==="image"&&r&&r.imageSrcSet?void 0:n,as:o},r),Ro.set($,n),u.querySelector(f)!==null||o==="style"&&u.querySelector(cs($))||o==="script"&&u.querySelector(uu($))||(o=u.createElement("link"),wi(o,"link",n),Kn(o),u.head.appendChild(o)))}}function mp(n,o){Js.m(n,o);var r=la;if(r&&n){var u=o&&typeof o.as=="string"?o.as:"script",f='link[rel="modulepreload"][as="'+_i(u)+'"][href="'+_i(n)+'"]',$=f;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":$=Zs(n)}if(!Ro.has($)&&(n=D({rel:"modulepreload",href:n},o),Ro.set($,n),r.querySelector(f)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(r.querySelector(uu($)))return}u=r.createElement("link"),wi(u,"link",n),Kn(u),r.head.appendChild(u)}}}function _p(n,o,r){Js.S(n,o,r);var u=la;if(u&&n){var f=Ji(u).hoistableStyles,$=Io(n);o=o||"default";var S=f.get($);if(!S){var k={loading:0,preload:null};if(S=u.querySelector(cs($)))k.loading=5;else{n=D({rel:"stylesheet",href:n,"data-precedence":o},r),(r=Ro.get($))&&ha(n,r);var V=S=u.createElement("link");Kn(V),wi(V,"link",n),V._p=new Promise(function(fe,Ie){V.onload=fe,V.onerror=Ie}),V.addEventListener("load",function(){k.loading|=1}),V.addEventListener("error",function(){k.loading|=2}),k.loading|=4,au(S,o,u)}S={type:"stylesheet",instance:S,count:1,state:k},f.set($,S)}}}function ng(n,o){Js.X(n,o);var r=la;if(r&&n){var u=Ji(r).hoistableScripts,f=Zs(n),$=u.get(f);$||($=r.querySelector(uu(f)),$||(n=D({src:n,async:!0},o),(o=Ro.get(f))&&gc(n,o),$=r.createElement("script"),Kn($),wi($,"link",n),r.head.appendChild($)),$={type:"script",instance:$,count:1,state:null},u.set(f,$))}}function Wi(n,o){Js.M(n,o);var r=la;if(r&&n){var u=Ji(r).hoistableScripts,f=Zs(n),$=u.get(f);$||($=r.querySelector(uu(f)),$||(n=D({src:n,async:!0,type:"module"},o),(o=Ro.get(f))&&gc(n,o),$=r.createElement("script"),Kn($),wi($,"link",n),r.head.appendChild($)),$={type:"script",instance:$,count:1,state:null},u.set(f,$))}}function ca(n,o,r,u){var f=(f=Ze.current)?$l(f):null;if(!f)throw Error(a(446));switch(n){case"meta":case"title":return null;case"style":return typeof r.precedence=="string"&&typeof r.href=="string"?(o=Io(r.href),r=Ji(f).hoistableStyles,u=r.get(o),u||(u={type:"style",instance:null,count:0,state:null},r.set(o,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(r.rel==="stylesheet"&&typeof r.href=="string"&&typeof r.precedence=="string"){n=Io(r.href);var $=Ji(f).hoistableStyles,S=$.get(n);if(S||(f=f.ownerDocument||f,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},$.set(n,S),($=f.querySelector(cs(n)))&&!$._p&&(S.instance=$,S.state.loading=5),Ro.has(n)||(r={rel:"preload",as:"style",href:r.href,crossOrigin:r.crossOrigin,integrity:r.integrity,media:r.media,hrefLang:r.hrefLang,referrerPolicy:r.referrerPolicy},Ro.set(n,r),$||ig(f,n,r,S.state))),o&&u===null)throw Error(a(528,""));return S}if(o&&u!==null)throw Error(a(529,""));return null;case"script":return o=r.async,r=r.src,typeof r=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=Zs(r),r=Ji(f).hoistableScripts,u=r.get(o),u||(u={type:"script",instance:null,count:0,state:null},r.set(o,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,n))}}function Io(n){return'href="'+_i(n)+'"'}function cs(n){return'link[rel="stylesheet"]['+n+"]"}function Yo(n){return D({},n,{"data-precedence":n.precedence,precedence:null})}function ig(n,o,r,u){n.querySelector('link[rel="preload"][as="style"]['+o+"]")?u.loading=1:(o=n.createElement("link"),u.preload=o,o.addEventListener("load",function(){return u.loading|=1}),o.addEventListener("error",function(){return u.loading|=2}),wi(o,"link",r),Kn(o),n.head.appendChild(o))}function Zs(n){return'[src="'+_i(n)+'"]'}function uu(n){return"script[async]"+n}function pc(n,o,r){if(o.count++,o.instance===null)switch(o.type){case"style":var u=n.querySelector('style[data-href~="'+_i(r.href)+'"]');if(u)return o.instance=u,Kn(u),u;var f=D({},r,{"data-href":r.href,"data-precedence":r.precedence,href:null,precedence:null});return u=(n.ownerDocument||n).createElement("style"),Kn(u),wi(u,"style",f),au(u,r.precedence,n),o.instance=u;case"stylesheet":f=Io(r.href);var $=n.querySelector(cs(f));if($)return o.state.loading|=4,o.instance=$,Kn($),$;u=Yo(r),(f=Ro.get(f))&&ha(u,f),$=(n.ownerDocument||n).createElement("link"),Kn($);var S=$;return S._p=new Promise(function(k,V){S.onload=k,S.onerror=V}),wi($,"link",u),o.state.loading|=4,au($,r.precedence,n),o.instance=$;case"script":return $=Zs(r.src),(f=n.querySelector(uu($)))?(o.instance=f,Kn(f),f):(u=r,(f=Ro.get($))&&(u=D({},r),gc(u,f)),n=n.ownerDocument||n,f=n.createElement("script"),Kn(f),wi(f,"link",u),n.head.appendChild(f),o.instance=f);case"void":return null;default:throw Error(a(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(u=o.instance,o.state.loading|=4,au(u,r.precedence,n));return o.instance}function au(n,o,r){for(var u=r.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=u.length?u[u.length-1]:null,$=f,S=0;S<u.length;S++){var k=u[S];if(k.dataset.precedence===o)$=k;else if($!==f)break}$?$.parentNode.insertBefore(n,$.nextSibling):(o=r.nodeType===9?r.head:r,o.insertBefore(n,o.firstChild))}function ha(n,o){n.crossOrigin==null&&(n.crossOrigin=o.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=o.referrerPolicy),n.title==null&&(n.title=o.title)}function gc(n,o){n.crossOrigin==null&&(n.crossOrigin=o.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=o.referrerPolicy),n.integrity==null&&(n.integrity=o.integrity)}var Oh=null;function bp(n,o,r){if(Oh===null){var u=new Map,f=Oh=new Map;f.set(r,u)}else f=Oh,u=f.get(r),u||(u=new Map,f.set(r,u));if(u.has(n))return u;for(u.set(n,null),r=r.getElementsByTagName(n),f=0;f<r.length;f++){var $=r[f];if(!($[wo]||$[Tn]||n==="link"&&$.getAttribute("rel")==="stylesheet")&&$.namespaceURI!=="http://www.w3.org/2000/svg"){var S=$.getAttribute(o)||"";S=n+S;var k=u.get(S);k?k.push($):u.set(S,[$])}}return u}function tf(n,o,r){n=n.ownerDocument||n,n.head.insertBefore(r,o==="title"?n.querySelector("head > title"):null)}function Hr(n,o,r){if(r===1||o.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return n=o.disabled,typeof o.precedence=="string"&&n==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function Rn(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function og(n,o,r,u){if(r.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(r.state.loading&4)===0){if(r.instance===null){var f=Io(u.href),$=o.querySelector(cs(f));if($){o=$._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(n.count++,n=_c.bind(n),o.then(n,n)),r.state.loading|=4,r.instance=$,Kn($);return}$=o.ownerDocument||o,u=Yo(u),(f=Ro.get(f))&&ha(u,f),$=$.createElement("link"),Kn($);var S=$;S._p=new Promise(function(k,V){S.onload=k,S.onerror=V}),wi($,"link",u),r.instance=$}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(r,o),(o=r.state.preload)&&(r.state.loading&3)===0&&(n.count++,r=_c.bind(n),o.addEventListener("load",r),o.addEventListener("error",r))}}var $c=0;function mc(n,o){return n.stylesheets&&n.count===0&&ji(n,n.stylesheets),0<n.count||0<n.imgCount?function(r){var u=setTimeout(function(){if(n.stylesheets&&ji(n,n.stylesheets),n.unsuspend){var $=n.unsuspend;n.unsuspend=null,$()}},6e4+o);0<n.imgBytes&&$c===0&&($c=62500*eg());var f=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&ji(n,n.stylesheets),n.unsuspend)){var $=n.unsuspend;n.unsuspend=null,$()}},(n.imgBytes>$c?50:800)+o);return n.unsuspend=r,function(){n.unsuspend=null,clearTimeout(u),clearTimeout(f)}}:null}function _c(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ji(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Ah=null;function ji(n,o){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Ah=new Map,o.forEach(sg,n),Ah=null,_c.call(n))}function sg(n,o){if(!(o.state.loading&4)){var r=Ah.get(n);if(r)var u=r.get(null);else{r=new Map,Ah.set(n,r);for(var f=n.querySelectorAll("link[data-precedence],style[data-precedence]"),$=0;$<f.length;$++){var S=f[$];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(r.set(S.dataset.precedence,S),u=S)}u&&r.set(null,u)}f=o.instance,S=f.getAttribute("data-precedence"),$=r.get(S)||u,$===u&&r.set(null,f),r.set(S,f),this.count++,u=_c.bind(this),f.addEventListener("load",u),f.addEventListener("error",u),$?$.parentNode.insertBefore(f,$.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(f,n.firstChild)),o.state.loading|=4}}var bc={$$typeof:Le,Provider:null,Consumer:null,_currentValue:ft,_currentValue2:ft,_threadCount:0};function nf(n,o,r,u,f,$,S,k,V){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=dt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dt(0),this.hiddenUpdates=dt(null),this.identifierPrefix=u,this.onUncaughtError=f,this.onCaughtError=$,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=V,this.incompleteTransitions=new Map}function Ep(n,o,r,u,f,$,S,k,V,fe,Ie,Me){return n=new nf(n,o,r,S,V,fe,Ie,Me,k),o=1,$===!0&&(o|=24),$=To(3,null,null,o),n.current=$,$.stateNode=n,o=Na(),o.refCount++,n.pooledCache=o,o.refCount++,$.memoizedState={element:u,isDehydrated:r,cache:o},xo($),n}function rg(n){return n?(n=Bi,n):Bi}function Tp(n,o,r,u,f,$){f=rg(f),u.context===null?u.context=f:u.pendingContext=f,u=ss(o),u.payload={element:r},$=$===void 0?null:$,$!==null&&(u.callback=$),r=Fi(n,u,o),r!==null&&(Vi(r,n,o),Hu(r,n,o))}function lg(n,o){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var r=n.retryLane;n.retryLane=r!==0&&r<o?r:o}}function vp(n,o){lg(n,o),(n=n.alternate)&&lg(n,o)}function yp(n){if(n.tag===13||n.tag===31){var o=vn(n,67108864);o!==null&&Vi(o,n,67108864),vp(n,67108864)}}function Sp(n){if(n.tag===13||n.tag===31){var o=Gi();o=qo(o);var r=vn(n,o);r!==null&&Vi(r,n,o),vp(n,o)}}var Ec=!0;function Cp(n,o,r,u){var f=de.T;de.T=null;var $=Ve.p;try{Ve.p=2,of(n,o,r,u)}finally{Ve.p=$,de.T=f}}function ug(n,o,r,u){var f=de.T;de.T=null;var $=Ve.p;try{Ve.p=8,of(n,o,r,u)}finally{Ve.p=$,de.T=f}}function of(n,o,r,u){if(Ec){var f=hs(u);if(f===null)gl(n,o,u,sf,r),Op(n,u);else if(Eg(f,n,o,r,u))u.stopPropagation();else if(Op(n,u),o&4&&-1<rf.indexOf(n)){for(;f!==null;){var $=rn(f);if($!==null)switch($.tag){case 3:if($=$.stateNode,$.current.memoizedState.isDehydrated){var S=M($.pendingLanes);if(S!==0){var k=$;for(k.pendingLanes|=2,k.entangledLanes|=2;S;){var V=1<<31-F(S);k.entanglements[1]|=V,S&=~V}Ks($),(an&6)===0&&(fh=In()+500,uc(0))}}break;case 31:case 13:k=vn($,2),k!==null&&Vi(k,$,2),$h(),vp($,2)}if($=hs(u),$===null&&gl(n,o,u,sf,r),$===f)break;f=$}f!==null&&u.stopPropagation()}else gl(n,o,u,null,r)}}function hs(n){return n=Ls(n),Rp(n)}var sf=null;function Rp(n){if(sf=null,n=ks(n),n!==null){var o=E(n);if(o===null)n=null;else{var r=o.tag;if(r===13){if(n=C(o),n!==null)return n;n=null}else if(r===31){if(n=A(o),n!==null)return n;n=null}else if(r===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;n=null}else o!==n&&(n=null)}}return sf=n,null}function Ip(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(X()){case Zn:return 2;case Hn:return 8;case Ht:case sn:return 32;case Xn:return 268435456;default:return 32}default:return 32}}var wh=!1,ml=null,Gr=null,ds=null,Tc=new Map,cu=new Map,_l=[],rf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Op(n,o){switch(n){case"focusin":case"focusout":ml=null;break;case"dragenter":case"dragleave":Gr=null;break;case"mouseover":case"mouseout":ds=null;break;case"pointerover":case"pointerout":Tc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":cu.delete(o.pointerId)}}function Nh(n,o,r,u,f,$){return n===null||n.nativeEvent!==$?(n={blockedOn:o,domEventName:r,eventSystemFlags:u,nativeEvent:$,targetContainers:[f]},o!==null&&(o=rn(o),o!==null&&yp(o)),n):(n.eventSystemFlags|=u,o=n.targetContainers,f!==null&&o.indexOf(f)===-1&&o.push(f),n)}function Eg(n,o,r,u,f){switch(o){case"focusin":return ml=Nh(ml,n,o,r,u,f),!0;case"dragenter":return Gr=Nh(Gr,n,o,r,u,f),!0;case"mouseover":return ds=Nh(ds,n,o,r,u,f),!0;case"pointerover":var $=f.pointerId;return Tc.set($,Nh(Tc.get($)||null,n,o,r,u,f)),!0;case"gotpointercapture":return $=f.pointerId,cu.set($,Nh(cu.get($)||null,n,o,r,u,f)),!0}return!1}function kh(n){var o=ks(n.target);if(o!==null){var r=E(o);if(r!==null){if(o=r.tag,o===13){if(o=C(r),o!==null){n.blockedOn=o,mo(n.priority,function(){Sp(r)});return}}else if(o===31){if(o=A(r),o!==null){n.blockedOn=o,mo(n.priority,function(){Sp(r)});return}}else if(o===3&&r.stateNode.current.memoizedState.isDehydrated){n.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}n.blockedOn=null}function vc(n){if(n.blockedOn!==null)return!1;for(var o=n.targetContainers;0<o.length;){var r=hs(n.nativeEvent);if(r===null){r=n.nativeEvent;var u=new r.constructor(r.type,r);es=u,r.target.dispatchEvent(u),es=null}else return o=rn(r),o!==null&&yp(o),n.blockedOn=r,!1;o.shift()}return!0}function ag(n,o,r){vc(n)&&r.delete(o)}function cg(){wh=!1,ml!==null&&vc(ml)&&(ml=null),Gr!==null&&vc(Gr)&&(Gr=null),ds!==null&&vc(ds)&&(ds=null),Tc.forEach(ag),cu.forEach(ag)}function yc(n,o){n.blockedOn===o&&(n.blockedOn=null,wh||(wh=!0,h.unstable_scheduleCallback(h.unstable_NormalPriority,cg)))}var Sc=null;function bl(n){Sc!==n&&(Sc=n,h.unstable_scheduleCallback(h.unstable_NormalPriority,function(){Sc===n&&(Sc=null);for(var o=0;o<n.length;o+=3){var r=n[o],u=n[o+1],f=n[o+2];if(typeof u!="function"){if(Rp(u||r)===null)continue;break}var $=rn(r);$!==null&&(n.splice(o,3),o-=3,ge($,{pending:!0,data:f,method:r.method,action:u},u,f))}}))}function da(n){function o(V){return yc(V,n)}ml!==null&&yc(ml,n),Gr!==null&&yc(Gr,n),ds!==null&&yc(ds,n),Tc.forEach(o),cu.forEach(o);for(var r=0;r<_l.length;r++){var u=_l[r];u.blockedOn===n&&(u.blockedOn=null)}for(;0<_l.length&&(r=_l[0],r.blockedOn===null);)kh(r),r.blockedOn===null&&_l.shift();if(r=(n.ownerDocument||n).$$reactFormReplay,r!=null)for(u=0;u<r.length;u+=3){var f=r[u],$=r[u+1],S=f[Qn]||null;if(typeof $=="function")S||bl(r);else if(S){var k=null;if($&&$.hasAttribute("formAction")){if(f=$,S=$[Qn]||null)k=S.formAction;else if(Rp(f)!==null)continue}else k=S.action;typeof k=="function"?r[u+1]=k:(r.splice(u,3),u-=3),bl(r)}}}function Mh(){function n($){$.canIntercept&&$.info==="react-transition"&&$.intercept({handler:function(){return new Promise(function(S){return f=S})},focusReset:"manual",scroll:"manual"})}function o(){f!==null&&(f(),f=null),u||setTimeout(r,20)}function r(){if(!u&&!navigation.transition){var $=navigation.currentEntry;$&&$.url!=null&&navigation.navigate($.url,{state:$.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var u=!1,f=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(r,100),function(){u=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),f!==null&&(f(),f=null)}}}function Xi(n){this._internalRoot=n}lf.prototype.render=Xi.prototype.render=function(n){var o=this._internalRoot;if(o===null)throw Error(a(409));var r=o.current,u=Gi();Tp(r,u,n,o,null,null)},lf.prototype.unmount=Xi.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var o=n.containerInfo;Tp(n.current,2,null,n,null,null),$h(),o[qi]=null}};function lf(n){this._internalRoot=n}lf.prototype.unstable_scheduleHydration=function(n){if(n){var o=Mi();n={blockedOn:null,target:n,priority:o};for(var r=0;r<_l.length&&o!==0&&o<_l[r].priority;r++);_l.splice(r,0,n),r===0&&kh(n)}};var K=p.version;if(K!=="19.2.0")throw Error(a(527,K,"19.2.0"));Ve.findDOMNode=function(n){var o=n._reactInternals;if(o===void 0)throw typeof n.render=="function"?Error(a(188)):(n=Object.keys(n).join(","),Error(a(268,n)));return n=O(o),n=n!==null?H(n):null,n=n===null?null:n.stateNode,n};var Vr={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:de,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hu.isDisabled&&hu.supportsFiber)try{v=hu.inject(Vr),L=hu}catch{}}return reactDomClient_production.createRoot=function(n,o){if(!_(n))throw Error(a(299));var r=!1,u="",f=Bf,$=zp,S=Pf;return o!=null&&(o.unstable_strictMode===!0&&(r=!0),o.identifierPrefix!==void 0&&(u=o.identifierPrefix),o.onUncaughtError!==void 0&&(f=o.onUncaughtError),o.onCaughtError!==void 0&&($=o.onCaughtError),o.onRecoverableError!==void 0&&(S=o.onRecoverableError)),o=Ep(n,1,!1,null,null,r,u,null,f,$,S,Mh),n[qi]=o.current,Yd(n),new Xi(o)},reactDomClient_production.hydrateRoot=function(n,o,r){if(!_(n))throw Error(a(299));var u=!1,f="",$=Bf,S=zp,k=Pf,V=null;return r!=null&&(r.unstable_strictMode===!0&&(u=!0),r.identifierPrefix!==void 0&&(f=r.identifierPrefix),r.onUncaughtError!==void 0&&($=r.onUncaughtError),r.onCaughtError!==void 0&&(S=r.onCaughtError),r.onRecoverableError!==void 0&&(k=r.onRecoverableError),r.formState!==void 0&&(V=r.formState)),o=Ep(n,1,!0,o,r??null,u,f,V,$,S,k,Mh),o.context=rg(null),r=o.current,u=Gi(),u=qo(u),f=ss(u),f.callback=null,Fi(r,f,u),r=u,o.current.lanes=r,Qt(o,r),Ks(o),n[qi]=o.current,Yd(n),new lf(o)},reactDomClient_production.version="19.2.0",reactDomClient_production}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client.exports;hasRequiredClient=1;function h(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(h)}catch(p){console.error(p)}}return h(),client.exports=requireReactDomClient_production(),client.exports}var clientExports=requireClient(),BlockType=(h=>(h.STANDARD="STANDARD",h.DATE="DATE",h.ZODIAC="ZODIAC",h.AGE="AGE",h.UNIT="UNIT",h.CART="CART",h))(BlockType||{}),TokenType=(h=>(h.NUMBER="NUMBER",h.OPERATOR="OPERATOR",h.BLOCK_REF="BLOCK_REF",h.FUNCTION="FUNCTION",h.LPAREN="LPAREN",h.RPAREN="RPAREN",h))(TokenType||{});function tokenize(h){const p=[];let l=0;for(;l<h.length;){const a=h[l];if(/\s/.test(a)){l++;continue}if(/\d/.test(a)||a==="."&&l+1<h.length&&/\d/.test(h[l+1])){let _="";for(;l<h.length&&(/\d/.test(h[l])||h[l]===".");)_+=h[l],l++;p.push({type:TokenType.NUMBER,value:_});continue}if(a==="{"&&l+1<h.length&&h[l+1]==="{"){let _="";for(l+=2;l<h.length&&!(h[l]==="}"&&l+1<h.length&&h[l+1]==="}");)_+=h[l],l++;l<h.length&&(l+=2),p.push({type:TokenType.BLOCK_REF,value:_.trim(),blockId:_.trim()});continue}if(["+","-","*","/","%"].includes(a)){p.push({type:TokenType.OPERATOR,value:a}),l++;continue}if(a==="("){p.push({type:TokenType.LPAREN,value:a}),l++;continue}if(a===")"){p.push({type:TokenType.RPAREN,value:a}),l++;continue}l++}return p}function extractBlockReferences(h){return tokenize(h).filter(l=>l.type===TokenType.BLOCK_REF).map(l=>l.blockId).filter((l,a,_)=>_.indexOf(l)===a)}function substituteBlockValues(h,p){let l=h;return p.forEach((a,_)=>{const E=new RegExp(`\\{\\{${_}\\}\\}`,"g");l=l.replace(E,`(${a})`)}),l}function validateFormula(h){if(!h||h.trim().length===0)return{valid:!1,error:"Formula cannot be empty"};const p=tokenize(h);if(p.length===0)return{valid:!1,error:"No valid tokens found"};let l=0;for(const a of p)if(a.type===TokenType.LPAREN&&l++,a.type===TokenType.RPAREN&&l--,l<0)return{valid:!1,error:"Unmatched closing parenthesis"};if(l!==0)return{valid:!1,error:"Unmatched opening parenthesis"};for(let a=0;a<p.length-1;a++){const _=p[a],E=p[a+1];if(_.type===TokenType.OPERATOR&&E.type===TokenType.OPERATOR&&!(_.value!=="-"&&E.value==="-"))return{valid:!1,error:"Consecutive operators not allowed"}}return{valid:!0}}/*!
 *  decimal.js v10.6.0
 *  An arbitrary-precision Decimal type for JavaScript.
 *  https://github.com/MikeMcl/decimal.js
 *  Copyright (c) 2025 Michael Mclaughlin <M8ch88l@gmail.com>
 *  MIT Licence
 */var EXP_LIMIT=9e15,MAX_DIGITS=1e9,NUMERALS="0123456789abcdef",LN10="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",PI="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",DEFAULTS={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-EXP_LIMIT,maxE:EXP_LIMIT,crypto:!1},inexact,quadrant,external=!0,decimalError="[DecimalError] ",invalidArgument=decimalError+"Invalid argument: ",precisionLimitExceeded=decimalError+"Precision limit exceeded",cryptoUnavailable=decimalError+"crypto unavailable",tag="[object Decimal]",mathfloor=Math.floor,mathpow=Math.pow,isBinary=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,isHex=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,isOctal=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,isDecimal=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,BASE=1e7,LOG_BASE=7,MAX_SAFE_INTEGER=9007199254740991,LN10_PRECISION=LN10.length-1,PI_PRECISION=PI.length-1,P={toStringTag:tag};P.absoluteValue=P.abs=function(){var h=new this.constructor(this);return h.s<0&&(h.s=1),finalise(h)};P.ceil=function(){return finalise(new this.constructor(this),this.e+1,2)};P.clampedTo=P.clamp=function(h,p){var l,a=this,_=a.constructor;if(h=new _(h),p=new _(p),!h.s||!p.s)return new _(NaN);if(h.gt(p))throw Error(invalidArgument+p);return l=a.cmp(h),l<0?h:a.cmp(p)>0?p:new _(a)};P.comparedTo=P.cmp=function(h){var p,l,a,_,E=this,C=E.d,A=(h=new E.constructor(h)).d,N=E.s,O=h.s;if(!C||!A)return!N||!O?NaN:N!==O?N:C===A?0:!C^N<0?1:-1;if(!C[0]||!A[0])return C[0]?N:A[0]?-O:0;if(N!==O)return N;if(E.e!==h.e)return E.e>h.e^N<0?1:-1;for(a=C.length,_=A.length,p=0,l=a<_?a:_;p<l;++p)if(C[p]!==A[p])return C[p]>A[p]^N<0?1:-1;return a===_?0:a>_^N<0?1:-1};P.cosine=P.cos=function(){var h,p,l=this,a=l.constructor;return l.d?l.d[0]?(h=a.precision,p=a.rounding,a.precision=h+Math.max(l.e,l.sd())+LOG_BASE,a.rounding=1,l=cosine(a,toLessThanHalfPi(a,l)),a.precision=h,a.rounding=p,finalise(quadrant==2||quadrant==3?l.neg():l,h,p,!0)):new a(1):new a(NaN)};P.cubeRoot=P.cbrt=function(){var h,p,l,a,_,E,C,A,N,O,H=this,D=H.constructor;if(!H.isFinite()||H.isZero())return new D(H);for(external=!1,E=H.s*mathpow(H.s*H,1/3),!E||Math.abs(E)==1/0?(l=digitsToString(H.d),h=H.e,(E=(h-l.length+1)%3)&&(l+=E==1||E==-2?"0":"00"),E=mathpow(l,1/3),h=mathfloor((h+1)/3)-(h%3==(h<0?-1:2)),E==1/0?l="5e"+h:(l=E.toExponential(),l=l.slice(0,l.indexOf("e")+1)+h),a=new D(l),a.s=H.s):a=new D(E.toString()),C=(h=D.precision)+3;;)if(A=a,N=A.times(A).times(A),O=N.plus(H),a=divide(O.plus(H).times(A),O.plus(N),C+2,1),digitsToString(A.d).slice(0,C)===(l=digitsToString(a.d)).slice(0,C))if(l=l.slice(C-3,C+1),l=="9999"||!_&&l=="4999"){if(!_&&(finalise(A,h+1,0),A.times(A).times(A).eq(H))){a=A;break}C+=4,_=1}else{(!+l||!+l.slice(1)&&l.charAt(0)=="5")&&(finalise(a,h+1,1),p=!a.times(a).times(a).eq(H));break}return external=!0,finalise(a,h,D.rounding,p)};P.decimalPlaces=P.dp=function(){var h,p=this.d,l=NaN;if(p){if(h=p.length-1,l=(h-mathfloor(this.e/LOG_BASE))*LOG_BASE,h=p[h],h)for(;h%10==0;h/=10)l--;l<0&&(l=0)}return l};P.dividedBy=P.div=function(h){return divide(this,new this.constructor(h))};P.dividedToIntegerBy=P.divToInt=function(h){var p=this,l=p.constructor;return finalise(divide(p,new l(h),0,1,1),l.precision,l.rounding)};P.equals=P.eq=function(h){return this.cmp(h)===0};P.floor=function(){return finalise(new this.constructor(this),this.e+1,3)};P.greaterThan=P.gt=function(h){return this.cmp(h)>0};P.greaterThanOrEqualTo=P.gte=function(h){var p=this.cmp(h);return p==1||p===0};P.hyperbolicCosine=P.cosh=function(){var h,p,l,a,_,E=this,C=E.constructor,A=new C(1);if(!E.isFinite())return new C(E.s?1/0:NaN);if(E.isZero())return A;l=C.precision,a=C.rounding,C.precision=l+Math.max(E.e,E.sd())+4,C.rounding=1,_=E.d.length,_<32?(h=Math.ceil(_/3),p=(1/tinyPow(4,h)).toString()):(h=16,p="2.3283064365386962890625e-10"),E=taylorSeries(C,1,E.times(p),new C(1),!0);for(var N,O=h,H=new C(8);O--;)N=E.times(E),E=A.minus(N.times(H.minus(N.times(H))));return finalise(E,C.precision=l,C.rounding=a,!0)};P.hyperbolicSine=P.sinh=function(){var h,p,l,a,_=this,E=_.constructor;if(!_.isFinite()||_.isZero())return new E(_);if(p=E.precision,l=E.rounding,E.precision=p+Math.max(_.e,_.sd())+4,E.rounding=1,a=_.d.length,a<3)_=taylorSeries(E,2,_,_,!0);else{h=1.4*Math.sqrt(a),h=h>16?16:h|0,_=_.times(1/tinyPow(5,h)),_=taylorSeries(E,2,_,_,!0);for(var C,A=new E(5),N=new E(16),O=new E(20);h--;)C=_.times(_),_=_.times(A.plus(C.times(N.times(C).plus(O))))}return E.precision=p,E.rounding=l,finalise(_,p,l,!0)};P.hyperbolicTangent=P.tanh=function(){var h,p,l=this,a=l.constructor;return l.isFinite()?l.isZero()?new a(l):(h=a.precision,p=a.rounding,a.precision=h+7,a.rounding=1,divide(l.sinh(),l.cosh(),a.precision=h,a.rounding=p)):new a(l.s)};P.inverseCosine=P.acos=function(){var h=this,p=h.constructor,l=h.abs().cmp(1),a=p.precision,_=p.rounding;return l!==-1?l===0?h.isNeg()?getPi(p,a,_):new p(0):new p(NaN):h.isZero()?getPi(p,a+4,_).times(.5):(p.precision=a+6,p.rounding=1,h=new p(1).minus(h).div(h.plus(1)).sqrt().atan(),p.precision=a,p.rounding=_,h.times(2))};P.inverseHyperbolicCosine=P.acosh=function(){var h,p,l=this,a=l.constructor;return l.lte(1)?new a(l.eq(1)?0:NaN):l.isFinite()?(h=a.precision,p=a.rounding,a.precision=h+Math.max(Math.abs(l.e),l.sd())+4,a.rounding=1,external=!1,l=l.times(l).minus(1).sqrt().plus(l),external=!0,a.precision=h,a.rounding=p,l.ln()):new a(l)};P.inverseHyperbolicSine=P.asinh=function(){var h,p,l=this,a=l.constructor;return!l.isFinite()||l.isZero()?new a(l):(h=a.precision,p=a.rounding,a.precision=h+2*Math.max(Math.abs(l.e),l.sd())+6,a.rounding=1,external=!1,l=l.times(l).plus(1).sqrt().plus(l),external=!0,a.precision=h,a.rounding=p,l.ln())};P.inverseHyperbolicTangent=P.atanh=function(){var h,p,l,a,_=this,E=_.constructor;return _.isFinite()?_.e>=0?new E(_.abs().eq(1)?_.s/0:_.isZero()?_:NaN):(h=E.precision,p=E.rounding,a=_.sd(),Math.max(a,h)<2*-_.e-1?finalise(new E(_),h,p,!0):(E.precision=l=a-_.e,_=divide(_.plus(1),new E(1).minus(_),l+h,1),E.precision=h+4,E.rounding=1,_=_.ln(),E.precision=h,E.rounding=p,_.times(.5))):new E(NaN)};P.inverseSine=P.asin=function(){var h,p,l,a,_=this,E=_.constructor;return _.isZero()?new E(_):(p=_.abs().cmp(1),l=E.precision,a=E.rounding,p!==-1?p===0?(h=getPi(E,l+4,a).times(.5),h.s=_.s,h):new E(NaN):(E.precision=l+6,E.rounding=1,_=_.div(new E(1).minus(_.times(_)).sqrt().plus(1)).atan(),E.precision=l,E.rounding=a,_.times(2)))};P.inverseTangent=P.atan=function(){var h,p,l,a,_,E,C,A,N,O=this,H=O.constructor,D=H.precision,j=H.rounding;if(O.isFinite()){if(O.isZero())return new H(O);if(O.abs().eq(1)&&D+4<=PI_PRECISION)return C=getPi(H,D+4,j).times(.25),C.s=O.s,C}else{if(!O.s)return new H(NaN);if(D+4<=PI_PRECISION)return C=getPi(H,D+4,j).times(.5),C.s=O.s,C}for(H.precision=A=D+10,H.rounding=1,l=Math.min(28,A/LOG_BASE+2|0),h=l;h;--h)O=O.div(O.times(O).plus(1).sqrt().plus(1));for(external=!1,p=Math.ceil(A/LOG_BASE),a=1,N=O.times(O),C=new H(O),_=O;h!==-1;)if(_=_.times(N),E=C.minus(_.div(a+=2)),_=_.times(N),C=E.plus(_.div(a+=2)),C.d[p]!==void 0)for(h=p;C.d[h]===E.d[h]&&h--;);return l&&(C=C.times(2<<l-1)),external=!0,finalise(C,H.precision=D,H.rounding=j,!0)};P.isFinite=function(){return!!this.d};P.isInteger=P.isInt=function(){return!!this.d&&mathfloor(this.e/LOG_BASE)>this.d.length-2};P.isNaN=function(){return!this.s};P.isNegative=P.isNeg=function(){return this.s<0};P.isPositive=P.isPos=function(){return this.s>0};P.isZero=function(){return!!this.d&&this.d[0]===0};P.lessThan=P.lt=function(h){return this.cmp(h)<0};P.lessThanOrEqualTo=P.lte=function(h){return this.cmp(h)<1};P.logarithm=P.log=function(h){var p,l,a,_,E,C,A,N,O=this,H=O.constructor,D=H.precision,j=H.rounding,be=5;if(h==null)h=new H(10),p=!0;else{if(h=new H(h),l=h.d,h.s<0||!l||!l[0]||h.eq(1))return new H(NaN);p=h.eq(10)}if(l=O.d,O.s<0||!l||!l[0]||O.eq(1))return new H(l&&!l[0]?-1/0:O.s!=1?NaN:l?0:1/0);if(p)if(l.length>1)E=!0;else{for(_=l[0];_%10===0;)_/=10;E=_!==1}if(external=!1,A=D+be,C=naturalLogarithm(O,A),a=p?getLn10(H,A+10):naturalLogarithm(h,A),N=divide(C,a,A,1),checkRoundingDigits(N.d,_=D,j))do if(A+=10,C=naturalLogarithm(O,A),a=p?getLn10(H,A+10):naturalLogarithm(h,A),N=divide(C,a,A,1),!E){+digitsToString(N.d).slice(_+1,_+15)+1==1e14&&(N=finalise(N,D+1,0));break}while(checkRoundingDigits(N.d,_+=10,j));return external=!0,finalise(N,D,j)};P.minus=P.sub=function(h){var p,l,a,_,E,C,A,N,O,H,D,j,be=this,Oe=be.constructor;if(h=new Oe(h),!be.d||!h.d)return!be.s||!h.s?h=new Oe(NaN):be.d?h.s=-h.s:h=new Oe(h.d||be.s!==h.s?be:NaN),h;if(be.s!=h.s)return h.s=-h.s,be.plus(h);if(O=be.d,j=h.d,A=Oe.precision,N=Oe.rounding,!O[0]||!j[0]){if(j[0])h.s=-h.s;else if(O[0])h=new Oe(be);else return new Oe(N===3?-0:0);return external?finalise(h,A,N):h}if(l=mathfloor(h.e/LOG_BASE),H=mathfloor(be.e/LOG_BASE),O=O.slice(),E=H-l,E){for(D=E<0,D?(p=O,E=-E,C=j.length):(p=j,l=H,C=O.length),a=Math.max(Math.ceil(A/LOG_BASE),C)+2,E>a&&(E=a,p.length=1),p.reverse(),a=E;a--;)p.push(0);p.reverse()}else{for(a=O.length,C=j.length,D=a<C,D&&(C=a),a=0;a<C;a++)if(O[a]!=j[a]){D=O[a]<j[a];break}E=0}for(D&&(p=O,O=j,j=p,h.s=-h.s),C=O.length,a=j.length-C;a>0;--a)O[C++]=0;for(a=j.length;a>E;){if(O[--a]<j[a]){for(_=a;_&&O[--_]===0;)O[_]=BASE-1;--O[_],O[a]+=BASE}O[a]-=j[a]}for(;O[--C]===0;)O.pop();for(;O[0]===0;O.shift())--l;return O[0]?(h.d=O,h.e=getBase10Exponent(O,l),external?finalise(h,A,N):h):new Oe(N===3?-0:0)};P.modulo=P.mod=function(h){var p,l=this,a=l.constructor;return h=new a(h),!l.d||!h.s||h.d&&!h.d[0]?new a(NaN):!h.d||l.d&&!l.d[0]?finalise(new a(l),a.precision,a.rounding):(external=!1,a.modulo==9?(p=divide(l,h.abs(),0,3,1),p.s*=h.s):p=divide(l,h,0,a.modulo,1),p=p.times(h),external=!0,l.minus(p))};P.naturalExponential=P.exp=function(){return naturalExponential(this)};P.naturalLogarithm=P.ln=function(){return naturalLogarithm(this)};P.negated=P.neg=function(){var h=new this.constructor(this);return h.s=-h.s,finalise(h)};P.plus=P.add=function(h){var p,l,a,_,E,C,A,N,O,H,D=this,j=D.constructor;if(h=new j(h),!D.d||!h.d)return!D.s||!h.s?h=new j(NaN):D.d||(h=new j(h.d||D.s===h.s?D:NaN)),h;if(D.s!=h.s)return h.s=-h.s,D.minus(h);if(O=D.d,H=h.d,A=j.precision,N=j.rounding,!O[0]||!H[0])return H[0]||(h=new j(D)),external?finalise(h,A,N):h;if(E=mathfloor(D.e/LOG_BASE),a=mathfloor(h.e/LOG_BASE),O=O.slice(),_=E-a,_){for(_<0?(l=O,_=-_,C=H.length):(l=H,a=E,C=O.length),E=Math.ceil(A/LOG_BASE),C=E>C?E+1:C+1,_>C&&(_=C,l.length=1),l.reverse();_--;)l.push(0);l.reverse()}for(C=O.length,_=H.length,C-_<0&&(_=C,l=H,H=O,O=l),p=0;_;)p=(O[--_]=O[_]+H[_]+p)/BASE|0,O[_]%=BASE;for(p&&(O.unshift(p),++a),C=O.length;O[--C]==0;)O.pop();return h.d=O,h.e=getBase10Exponent(O,a),external?finalise(h,A,N):h};P.precision=P.sd=function(h){var p,l=this;if(h!==void 0&&h!==!!h&&h!==1&&h!==0)throw Error(invalidArgument+h);return l.d?(p=getPrecision(l.d),h&&l.e+1>p&&(p=l.e+1)):p=NaN,p};P.round=function(){var h=this,p=h.constructor;return finalise(new p(h),h.e+1,p.rounding)};P.sine=P.sin=function(){var h,p,l=this,a=l.constructor;return l.isFinite()?l.isZero()?new a(l):(h=a.precision,p=a.rounding,a.precision=h+Math.max(l.e,l.sd())+LOG_BASE,a.rounding=1,l=sine(a,toLessThanHalfPi(a,l)),a.precision=h,a.rounding=p,finalise(quadrant>2?l.neg():l,h,p,!0)):new a(NaN)};P.squareRoot=P.sqrt=function(){var h,p,l,a,_,E,C=this,A=C.d,N=C.e,O=C.s,H=C.constructor;if(O!==1||!A||!A[0])return new H(!O||O<0&&(!A||A[0])?NaN:A?C:1/0);for(external=!1,O=Math.sqrt(+C),O==0||O==1/0?(p=digitsToString(A),(p.length+N)%2==0&&(p+="0"),O=Math.sqrt(p),N=mathfloor((N+1)/2)-(N<0||N%2),O==1/0?p="5e"+N:(p=O.toExponential(),p=p.slice(0,p.indexOf("e")+1)+N),a=new H(p)):a=new H(O.toString()),l=(N=H.precision)+3;;)if(E=a,a=E.plus(divide(C,E,l+2,1)).times(.5),digitsToString(E.d).slice(0,l)===(p=digitsToString(a.d)).slice(0,l))if(p=p.slice(l-3,l+1),p=="9999"||!_&&p=="4999"){if(!_&&(finalise(E,N+1,0),E.times(E).eq(C))){a=E;break}l+=4,_=1}else{(!+p||!+p.slice(1)&&p.charAt(0)=="5")&&(finalise(a,N+1,1),h=!a.times(a).eq(C));break}return external=!0,finalise(a,N,H.rounding,h)};P.tangent=P.tan=function(){var h,p,l=this,a=l.constructor;return l.isFinite()?l.isZero()?new a(l):(h=a.precision,p=a.rounding,a.precision=h+10,a.rounding=1,l=l.sin(),l.s=1,l=divide(l,new a(1).minus(l.times(l)).sqrt(),h+10,0),a.precision=h,a.rounding=p,finalise(quadrant==2||quadrant==4?l.neg():l,h,p,!0)):new a(NaN)};P.times=P.mul=function(h){var p,l,a,_,E,C,A,N,O,H=this,D=H.constructor,j=H.d,be=(h=new D(h)).d;if(h.s*=H.s,!j||!j[0]||!be||!be[0])return new D(!h.s||j&&!j[0]&&!be||be&&!be[0]&&!j?NaN:!j||!be?h.s/0:h.s*0);for(l=mathfloor(H.e/LOG_BASE)+mathfloor(h.e/LOG_BASE),N=j.length,O=be.length,N<O&&(E=j,j=be,be=E,C=N,N=O,O=C),E=[],C=N+O,a=C;a--;)E.push(0);for(a=O;--a>=0;){for(p=0,_=N+a;_>a;)A=E[_]+be[a]*j[_-a-1]+p,E[_--]=A%BASE|0,p=A/BASE|0;E[_]=(E[_]+p)%BASE|0}for(;!E[--C];)E.pop();return p?++l:E.shift(),h.d=E,h.e=getBase10Exponent(E,l),external?finalise(h,D.precision,D.rounding):h};P.toBinary=function(h,p){return toStringBinary(this,2,h,p)};P.toDecimalPlaces=P.toDP=function(h,p){var l=this,a=l.constructor;return l=new a(l),h===void 0?l:(checkInt32(h,0,MAX_DIGITS),p===void 0?p=a.rounding:checkInt32(p,0,8),finalise(l,h+l.e+1,p))};P.toExponential=function(h,p){var l,a=this,_=a.constructor;return h===void 0?l=finiteToString(a,!0):(checkInt32(h,0,MAX_DIGITS),p===void 0?p=_.rounding:checkInt32(p,0,8),a=finalise(new _(a),h+1,p),l=finiteToString(a,!0,h+1)),a.isNeg()&&!a.isZero()?"-"+l:l};P.toFixed=function(h,p){var l,a,_=this,E=_.constructor;return h===void 0?l=finiteToString(_):(checkInt32(h,0,MAX_DIGITS),p===void 0?p=E.rounding:checkInt32(p,0,8),a=finalise(new E(_),h+_.e+1,p),l=finiteToString(a,!1,h+a.e+1)),_.isNeg()&&!_.isZero()?"-"+l:l};P.toFraction=function(h){var p,l,a,_,E,C,A,N,O,H,D,j,be=this,Oe=be.d,ve=be.constructor;if(!Oe)return new ve(be);if(O=l=new ve(1),a=N=new ve(0),p=new ve(a),E=p.e=getPrecision(Oe)-be.e-1,C=E%LOG_BASE,p.d[0]=mathpow(10,C<0?LOG_BASE+C:C),h==null)h=E>0?p:O;else{if(A=new ve(h),!A.isInt()||A.lt(O))throw Error(invalidArgument+A);h=A.gt(p)?E>0?p:O:A}for(external=!1,A=new ve(digitsToString(Oe)),H=ve.precision,ve.precision=E=Oe.length*LOG_BASE*2;D=divide(A,p,0,1,1),_=l.plus(D.times(a)),_.cmp(h)!=1;)l=a,a=_,_=O,O=N.plus(D.times(_)),N=_,_=p,p=A.minus(D.times(_)),A=_;return _=divide(h.minus(l),a,0,1,1),N=N.plus(_.times(O)),l=l.plus(_.times(a)),N.s=O.s=be.s,j=divide(O,a,E,1).minus(be).abs().cmp(divide(N,l,E,1).minus(be).abs())<1?[O,a]:[N,l],ve.precision=H,external=!0,j};P.toHexadecimal=P.toHex=function(h,p){return toStringBinary(this,16,h,p)};P.toNearest=function(h,p){var l=this,a=l.constructor;if(l=new a(l),h==null){if(!l.d)return l;h=new a(1),p=a.rounding}else{if(h=new a(h),p===void 0?p=a.rounding:checkInt32(p,0,8),!l.d)return h.s?l:h;if(!h.d)return h.s&&(h.s=l.s),h}return h.d[0]?(external=!1,l=divide(l,h,0,p,1).times(h),external=!0,finalise(l)):(h.s=l.s,l=h),l};P.toNumber=function(){return+this};P.toOctal=function(h,p){return toStringBinary(this,8,h,p)};P.toPower=P.pow=function(h){var p,l,a,_,E,C,A=this,N=A.constructor,O=+(h=new N(h));if(!A.d||!h.d||!A.d[0]||!h.d[0])return new N(mathpow(+A,O));if(A=new N(A),A.eq(1))return A;if(a=N.precision,E=N.rounding,h.eq(1))return finalise(A,a,E);if(p=mathfloor(h.e/LOG_BASE),p>=h.d.length-1&&(l=O<0?-O:O)<=MAX_SAFE_INTEGER)return _=intPow(N,A,l,a),h.s<0?new N(1).div(_):finalise(_,a,E);if(C=A.s,C<0){if(p<h.d.length-1)return new N(NaN);if((h.d[p]&1)==0&&(C=1),A.e==0&&A.d[0]==1&&A.d.length==1)return A.s=C,A}return l=mathpow(+A,O),p=l==0||!isFinite(l)?mathfloor(O*(Math.log("0."+digitsToString(A.d))/Math.LN10+A.e+1)):new N(l+"").e,p>N.maxE+1||p<N.minE-1?new N(p>0?C/0:0):(external=!1,N.rounding=A.s=1,l=Math.min(12,(p+"").length),_=naturalExponential(h.times(naturalLogarithm(A,a+l)),a),_.d&&(_=finalise(_,a+5,1),checkRoundingDigits(_.d,a,E)&&(p=a+10,_=finalise(naturalExponential(h.times(naturalLogarithm(A,p+l)),p),p+5,1),+digitsToString(_.d).slice(a+1,a+15)+1==1e14&&(_=finalise(_,a+1,0)))),_.s=C,external=!0,N.rounding=E,finalise(_,a,E))};P.toPrecision=function(h,p){var l,a=this,_=a.constructor;return h===void 0?l=finiteToString(a,a.e<=_.toExpNeg||a.e>=_.toExpPos):(checkInt32(h,1,MAX_DIGITS),p===void 0?p=_.rounding:checkInt32(p,0,8),a=finalise(new _(a),h,p),l=finiteToString(a,h<=a.e||a.e<=_.toExpNeg,h)),a.isNeg()&&!a.isZero()?"-"+l:l};P.toSignificantDigits=P.toSD=function(h,p){var l=this,a=l.constructor;return h===void 0?(h=a.precision,p=a.rounding):(checkInt32(h,1,MAX_DIGITS),p===void 0?p=a.rounding:checkInt32(p,0,8)),finalise(new a(l),h,p)};P.toString=function(){var h=this,p=h.constructor,l=finiteToString(h,h.e<=p.toExpNeg||h.e>=p.toExpPos);return h.isNeg()&&!h.isZero()?"-"+l:l};P.truncated=P.trunc=function(){return finalise(new this.constructor(this),this.e+1,1)};P.valueOf=P.toJSON=function(){var h=this,p=h.constructor,l=finiteToString(h,h.e<=p.toExpNeg||h.e>=p.toExpPos);return h.isNeg()?"-"+l:l};function digitsToString(h){var p,l,a,_=h.length-1,E="",C=h[0];if(_>0){for(E+=C,p=1;p<_;p++)a=h[p]+"",l=LOG_BASE-a.length,l&&(E+=getZeroString(l)),E+=a;C=h[p],a=C+"",l=LOG_BASE-a.length,l&&(E+=getZeroString(l))}else if(C===0)return"0";for(;C%10===0;)C/=10;return E+C}function checkInt32(h,p,l){if(h!==~~h||h<p||h>l)throw Error(invalidArgument+h)}function checkRoundingDigits(h,p,l,a){var _,E,C,A;for(E=h[0];E>=10;E/=10)--p;return--p<0?(p+=LOG_BASE,_=0):(_=Math.ceil((p+1)/LOG_BASE),p%=LOG_BASE),E=mathpow(10,LOG_BASE-p),A=h[_]%E|0,a==null?p<3?(p==0?A=A/100|0:p==1&&(A=A/10|0),C=l<4&&A==99999||l>3&&A==49999||A==5e4||A==0):C=(l<4&&A+1==E||l>3&&A+1==E/2)&&(h[_+1]/E/100|0)==mathpow(10,p-2)-1||(A==E/2||A==0)&&(h[_+1]/E/100|0)==0:p<4?(p==0?A=A/1e3|0:p==1?A=A/100|0:p==2&&(A=A/10|0),C=(a||l<4)&&A==9999||!a&&l>3&&A==4999):C=((a||l<4)&&A+1==E||!a&&l>3&&A+1==E/2)&&(h[_+1]/E/1e3|0)==mathpow(10,p-3)-1,C}function convertBase(h,p,l){for(var a,_=[0],E,C=0,A=h.length;C<A;){for(E=_.length;E--;)_[E]*=p;for(_[0]+=NUMERALS.indexOf(h.charAt(C++)),a=0;a<_.length;a++)_[a]>l-1&&(_[a+1]===void 0&&(_[a+1]=0),_[a+1]+=_[a]/l|0,_[a]%=l)}return _.reverse()}function cosine(h,p){var l,a,_;if(p.isZero())return p;a=p.d.length,a<32?(l=Math.ceil(a/3),_=(1/tinyPow(4,l)).toString()):(l=16,_="2.3283064365386962890625e-10"),h.precision+=l,p=taylorSeries(h,1,p.times(_),new h(1));for(var E=l;E--;){var C=p.times(p);p=C.times(C).minus(C).times(8).plus(1)}return h.precision-=l,p}var divide=(function(){function h(a,_,E){var C,A=0,N=a.length;for(a=a.slice();N--;)C=a[N]*_+A,a[N]=C%E|0,A=C/E|0;return A&&a.unshift(A),a}function p(a,_,E,C){var A,N;if(E!=C)N=E>C?1:-1;else for(A=N=0;A<E;A++)if(a[A]!=_[A]){N=a[A]>_[A]?1:-1;break}return N}function l(a,_,E,C){for(var A=0;E--;)a[E]-=A,A=a[E]<_[E]?1:0,a[E]=A*C+a[E]-_[E];for(;!a[0]&&a.length>1;)a.shift()}return function(a,_,E,C,A,N){var O,H,D,j,be,Oe,ve,Xe,Ke,_e,Le,Ae,rt,De,xe,at,ht,ot,Je,Rt,Bt=a.constructor,Yt=a.s==_.s?1:-1,kt=a.d,de=_.d;if(!kt||!kt[0]||!de||!de[0])return new Bt(!a.s||!_.s||(kt?de&&kt[0]==de[0]:!de)?NaN:kt&&kt[0]==0||!de?Yt*0:Yt/0);for(N?(be=1,H=a.e-_.e):(N=BASE,be=LOG_BASE,H=mathfloor(a.e/be)-mathfloor(_.e/be)),Je=de.length,ht=kt.length,Ke=new Bt(Yt),_e=Ke.d=[],D=0;de[D]==(kt[D]||0);D++);if(de[D]>(kt[D]||0)&&H--,E==null?(De=E=Bt.precision,C=Bt.rounding):A?De=E+(a.e-_.e)+1:De=E,De<0)_e.push(1),Oe=!0;else{if(De=De/be+2|0,D=0,Je==1){for(j=0,de=de[0],De++;(D<ht||j)&&De--;D++)xe=j*N+(kt[D]||0),_e[D]=xe/de|0,j=xe%de|0;Oe=j||D<ht}else{for(j=N/(de[0]+1)|0,j>1&&(de=h(de,j,N),kt=h(kt,j,N),Je=de.length,ht=kt.length),at=Je,Le=kt.slice(0,Je),Ae=Le.length;Ae<Je;)Le[Ae++]=0;Rt=de.slice(),Rt.unshift(0),ot=de[0],de[1]>=N/2&&++ot;do j=0,O=p(de,Le,Je,Ae),O<0?(rt=Le[0],Je!=Ae&&(rt=rt*N+(Le[1]||0)),j=rt/ot|0,j>1?(j>=N&&(j=N-1),ve=h(de,j,N),Xe=ve.length,Ae=Le.length,O=p(ve,Le,Xe,Ae),O==1&&(j--,l(ve,Je<Xe?Rt:de,Xe,N))):(j==0&&(O=j=1),ve=de.slice()),Xe=ve.length,Xe<Ae&&ve.unshift(0),l(Le,ve,Ae,N),O==-1&&(Ae=Le.length,O=p(de,Le,Je,Ae),O<1&&(j++,l(Le,Je<Ae?Rt:de,Ae,N))),Ae=Le.length):O===0&&(j++,Le=[0]),_e[D++]=j,O&&Le[0]?Le[Ae++]=kt[at]||0:(Le=[kt[at]],Ae=1);while((at++<ht||Le[0]!==void 0)&&De--);Oe=Le[0]!==void 0}_e[0]||_e.shift()}if(be==1)Ke.e=H,inexact=Oe;else{for(D=1,j=_e[0];j>=10;j/=10)D++;Ke.e=D+H*be-1,finalise(Ke,A?E+Ke.e+1:E,C,Oe)}return Ke}})();function finalise(h,p,l,a){var _,E,C,A,N,O,H,D,j,be=h.constructor;e:if(p!=null){if(D=h.d,!D)return h;for(_=1,A=D[0];A>=10;A/=10)_++;if(E=p-_,E<0)E+=LOG_BASE,C=p,H=D[j=0],N=H/mathpow(10,_-C-1)%10|0;else if(j=Math.ceil((E+1)/LOG_BASE),A=D.length,j>=A)if(a){for(;A++<=j;)D.push(0);H=N=0,_=1,E%=LOG_BASE,C=E-LOG_BASE+1}else break e;else{for(H=A=D[j],_=1;A>=10;A/=10)_++;E%=LOG_BASE,C=E-LOG_BASE+_,N=C<0?0:H/mathpow(10,_-C-1)%10|0}if(a=a||p<0||D[j+1]!==void 0||(C<0?H:H%mathpow(10,_-C-1)),O=l<4?(N||a)&&(l==0||l==(h.s<0?3:2)):N>5||N==5&&(l==4||a||l==6&&(E>0?C>0?H/mathpow(10,_-C):0:D[j-1])%10&1||l==(h.s<0?8:7)),p<1||!D[0])return D.length=0,O?(p-=h.e+1,D[0]=mathpow(10,(LOG_BASE-p%LOG_BASE)%LOG_BASE),h.e=-p||0):D[0]=h.e=0,h;if(E==0?(D.length=j,A=1,j--):(D.length=j+1,A=mathpow(10,LOG_BASE-E),D[j]=C>0?(H/mathpow(10,_-C)%mathpow(10,C)|0)*A:0),O)for(;;)if(j==0){for(E=1,C=D[0];C>=10;C/=10)E++;for(C=D[0]+=A,A=1;C>=10;C/=10)A++;E!=A&&(h.e++,D[0]==BASE&&(D[0]=1));break}else{if(D[j]+=A,D[j]!=BASE)break;D[j--]=0,A=1}for(E=D.length;D[--E]===0;)D.pop()}return external&&(h.e>be.maxE?(h.d=null,h.e=NaN):h.e<be.minE&&(h.e=0,h.d=[0])),h}function finiteToString(h,p,l){if(!h.isFinite())return nonFiniteToString(h);var a,_=h.e,E=digitsToString(h.d),C=E.length;return p?(l&&(a=l-C)>0?E=E.charAt(0)+"."+E.slice(1)+getZeroString(a):C>1&&(E=E.charAt(0)+"."+E.slice(1)),E=E+(h.e<0?"e":"e+")+h.e):_<0?(E="0."+getZeroString(-_-1)+E,l&&(a=l-C)>0&&(E+=getZeroString(a))):_>=C?(E+=getZeroString(_+1-C),l&&(a=l-_-1)>0&&(E=E+"."+getZeroString(a))):((a=_+1)<C&&(E=E.slice(0,a)+"."+E.slice(a)),l&&(a=l-C)>0&&(_+1===C&&(E+="."),E+=getZeroString(a))),E}function getBase10Exponent(h,p){var l=h[0];for(p*=LOG_BASE;l>=10;l/=10)p++;return p}function getLn10(h,p,l){if(p>LN10_PRECISION)throw external=!0,l&&(h.precision=l),Error(precisionLimitExceeded);return finalise(new h(LN10),p,1,!0)}function getPi(h,p,l){if(p>PI_PRECISION)throw Error(precisionLimitExceeded);return finalise(new h(PI),p,l,!0)}function getPrecision(h){var p=h.length-1,l=p*LOG_BASE+1;if(p=h[p],p){for(;p%10==0;p/=10)l--;for(p=h[0];p>=10;p/=10)l++}return l}function getZeroString(h){for(var p="";h--;)p+="0";return p}function intPow(h,p,l,a){var _,E=new h(1),C=Math.ceil(a/LOG_BASE+4);for(external=!1;;){if(l%2&&(E=E.times(p),truncate$1(E.d,C)&&(_=!0)),l=mathfloor(l/2),l===0){l=E.d.length-1,_&&E.d[l]===0&&++E.d[l];break}p=p.times(p),truncate$1(p.d,C)}return external=!0,E}function isOdd(h){return h.d[h.d.length-1]&1}function maxOrMin(h,p,l){for(var a,_,E=new h(p[0]),C=0;++C<p.length;){if(_=new h(p[C]),!_.s){E=_;break}a=E.cmp(_),(a===l||a===0&&E.s===l)&&(E=_)}return E}function naturalExponential(h,p){var l,a,_,E,C,A,N,O=0,H=0,D=0,j=h.constructor,be=j.rounding,Oe=j.precision;if(!h.d||!h.d[0]||h.e>17)return new j(h.d?h.d[0]?h.s<0?0:1/0:1:h.s?h.s<0?0:h:NaN);for(p==null?(external=!1,N=Oe):N=p,A=new j(.03125);h.e>-2;)h=h.times(A),D+=5;for(a=Math.log(mathpow(2,D))/Math.LN10*2+5|0,N+=a,l=E=C=new j(1),j.precision=N;;){if(E=finalise(E.times(h),N,1),l=l.times(++H),A=C.plus(divide(E,l,N,1)),digitsToString(A.d).slice(0,N)===digitsToString(C.d).slice(0,N)){for(_=D;_--;)C=finalise(C.times(C),N,1);if(p==null)if(O<3&&checkRoundingDigits(C.d,N-a,be,O))j.precision=N+=10,l=E=A=new j(1),H=0,O++;else return finalise(C,j.precision=Oe,be,external=!0);else return j.precision=Oe,C}C=A}}function naturalLogarithm(h,p){var l,a,_,E,C,A,N,O,H,D,j,be=1,Oe=10,ve=h,Xe=ve.d,Ke=ve.constructor,_e=Ke.rounding,Le=Ke.precision;if(ve.s<0||!Xe||!Xe[0]||!ve.e&&Xe[0]==1&&Xe.length==1)return new Ke(Xe&&!Xe[0]?-1/0:ve.s!=1?NaN:Xe?0:ve);if(p==null?(external=!1,H=Le):H=p,Ke.precision=H+=Oe,l=digitsToString(Xe),a=l.charAt(0),Math.abs(E=ve.e)<15e14){for(;a<7&&a!=1||a==1&&l.charAt(1)>3;)ve=ve.times(h),l=digitsToString(ve.d),a=l.charAt(0),be++;E=ve.e,a>1?(ve=new Ke("0."+l),E++):ve=new Ke(a+"."+l.slice(1))}else return O=getLn10(Ke,H+2,Le).times(E+""),ve=naturalLogarithm(new Ke(a+"."+l.slice(1)),H-Oe).plus(O),Ke.precision=Le,p==null?finalise(ve,Le,_e,external=!0):ve;for(D=ve,N=C=ve=divide(ve.minus(1),ve.plus(1),H,1),j=finalise(ve.times(ve),H,1),_=3;;){if(C=finalise(C.times(j),H,1),O=N.plus(divide(C,new Ke(_),H,1)),digitsToString(O.d).slice(0,H)===digitsToString(N.d).slice(0,H))if(N=N.times(2),E!==0&&(N=N.plus(getLn10(Ke,H+2,Le).times(E+""))),N=divide(N,new Ke(be),H,1),p==null)if(checkRoundingDigits(N.d,H-Oe,_e,A))Ke.precision=H+=Oe,O=C=ve=divide(D.minus(1),D.plus(1),H,1),j=finalise(ve.times(ve),H,1),_=A=1;else return finalise(N,Ke.precision=Le,_e,external=!0);else return Ke.precision=Le,N;N=O,_+=2}}function nonFiniteToString(h){return String(h.s*h.s/0)}function parseDecimal(h,p){var l,a,_;for((l=p.indexOf("."))>-1&&(p=p.replace(".","")),(a=p.search(/e/i))>0?(l<0&&(l=a),l+=+p.slice(a+1),p=p.substring(0,a)):l<0&&(l=p.length),a=0;p.charCodeAt(a)===48;a++);for(_=p.length;p.charCodeAt(_-1)===48;--_);if(p=p.slice(a,_),p){if(_-=a,h.e=l=l-a-1,h.d=[],a=(l+1)%LOG_BASE,l<0&&(a+=LOG_BASE),a<_){for(a&&h.d.push(+p.slice(0,a)),_-=LOG_BASE;a<_;)h.d.push(+p.slice(a,a+=LOG_BASE));p=p.slice(a),a=LOG_BASE-p.length}else a-=_;for(;a--;)p+="0";h.d.push(+p),external&&(h.e>h.constructor.maxE?(h.d=null,h.e=NaN):h.e<h.constructor.minE&&(h.e=0,h.d=[0]))}else h.e=0,h.d=[0];return h}function parseOther(h,p){var l,a,_,E,C,A,N,O,H;if(p.indexOf("_")>-1){if(p=p.replace(/(\d)_(?=\d)/g,"$1"),isDecimal.test(p))return parseDecimal(h,p)}else if(p==="Infinity"||p==="NaN")return+p||(h.s=NaN),h.e=NaN,h.d=null,h;if(isHex.test(p))l=16,p=p.toLowerCase();else if(isBinary.test(p))l=2;else if(isOctal.test(p))l=8;else throw Error(invalidArgument+p);for(E=p.search(/p/i),E>0?(N=+p.slice(E+1),p=p.substring(2,E)):p=p.slice(2),E=p.indexOf("."),C=E>=0,a=h.constructor,C&&(p=p.replace(".",""),A=p.length,E=A-E,_=intPow(a,new a(l),E,E*2)),O=convertBase(p,l,BASE),H=O.length-1,E=H;O[E]===0;--E)O.pop();return E<0?new a(h.s*0):(h.e=getBase10Exponent(O,H),h.d=O,external=!1,C&&(h=divide(h,_,A*4)),N&&(h=h.times(Math.abs(N)<54?mathpow(2,N):Decimal.pow(2,N))),external=!0,h)}function sine(h,p){var l,a=p.d.length;if(a<3)return p.isZero()?p:taylorSeries(h,2,p,p);l=1.4*Math.sqrt(a),l=l>16?16:l|0,p=p.times(1/tinyPow(5,l)),p=taylorSeries(h,2,p,p);for(var _,E=new h(5),C=new h(16),A=new h(20);l--;)_=p.times(p),p=p.times(E.plus(_.times(C.times(_).minus(A))));return p}function taylorSeries(h,p,l,a,_){var E,C,A,N,O=h.precision,H=Math.ceil(O/LOG_BASE);for(external=!1,N=l.times(l),A=new h(a);;){if(C=divide(A.times(N),new h(p++*p++),O,1),A=_?a.plus(C):a.minus(C),a=divide(C.times(N),new h(p++*p++),O,1),C=A.plus(a),C.d[H]!==void 0){for(E=H;C.d[E]===A.d[E]&&E--;);if(E==-1)break}E=A,A=a,a=C,C=E}return external=!0,C.d.length=H+1,C}function tinyPow(h,p){for(var l=h;--p;)l*=h;return l}function toLessThanHalfPi(h,p){var l,a=p.s<0,_=getPi(h,h.precision,1),E=_.times(.5);if(p=p.abs(),p.lte(E))return quadrant=a?4:1,p;if(l=p.divToInt(_),l.isZero())quadrant=a?3:2;else{if(p=p.minus(l.times(_)),p.lte(E))return quadrant=isOdd(l)?a?2:3:a?4:1,p;quadrant=isOdd(l)?a?1:4:a?3:2}return p.minus(_).abs()}function toStringBinary(h,p,l,a){var _,E,C,A,N,O,H,D,j,be=h.constructor,Oe=l!==void 0;if(Oe?(checkInt32(l,1,MAX_DIGITS),a===void 0?a=be.rounding:checkInt32(a,0,8)):(l=be.precision,a=be.rounding),!h.isFinite())H=nonFiniteToString(h);else{for(H=finiteToString(h),C=H.indexOf("."),Oe?(_=2,p==16?l=l*4-3:p==8&&(l=l*3-2)):_=p,C>=0&&(H=H.replace(".",""),j=new be(1),j.e=H.length-C,j.d=convertBase(finiteToString(j),10,_),j.e=j.d.length),D=convertBase(H,10,_),E=N=D.length;D[--N]==0;)D.pop();if(!D[0])H=Oe?"0p+0":"0";else{if(C<0?E--:(h=new be(h),h.d=D,h.e=E,h=divide(h,j,l,a,0,_),D=h.d,E=h.e,O=inexact),C=D[l],A=_/2,O=O||D[l+1]!==void 0,O=a<4?(C!==void 0||O)&&(a===0||a===(h.s<0?3:2)):C>A||C===A&&(a===4||O||a===6&&D[l-1]&1||a===(h.s<0?8:7)),D.length=l,O)for(;++D[--l]>_-1;)D[l]=0,l||(++E,D.unshift(1));for(N=D.length;!D[N-1];--N);for(C=0,H="";C<N;C++)H+=NUMERALS.charAt(D[C]);if(Oe){if(N>1)if(p==16||p==8){for(C=p==16?4:3,--N;N%C;N++)H+="0";for(D=convertBase(H,_,p),N=D.length;!D[N-1];--N);for(C=1,H="1.";C<N;C++)H+=NUMERALS.charAt(D[C])}else H=H.charAt(0)+"."+H.slice(1);H=H+(E<0?"p":"p+")+E}else if(E<0){for(;++E;)H="0"+H;H="0."+H}else if(++E>N)for(E-=N;E--;)H+="0";else E<N&&(H=H.slice(0,E)+"."+H.slice(E))}H=(p==16?"0x":p==2?"0b":p==8?"0o":"")+H}return h.s<0?"-"+H:H}function truncate$1(h,p){if(h.length>p)return h.length=p,!0}function abs(h){return new this(h).abs()}function acos(h){return new this(h).acos()}function acosh(h){return new this(h).acosh()}function add$2(h,p){return new this(h).plus(p)}function asin(h){return new this(h).asin()}function asinh(h){return new this(h).asinh()}function atan(h){return new this(h).atan()}function atanh(h){return new this(h).atanh()}function atan2(h,p){h=new this(h),p=new this(p);var l,a=this.precision,_=this.rounding,E=a+4;return!h.s||!p.s?l=new this(NaN):!h.d&&!p.d?(l=getPi(this,E,1).times(p.s>0?.25:.75),l.s=h.s):!p.d||h.isZero()?(l=p.s<0?getPi(this,a,_):new this(0),l.s=h.s):!h.d||p.isZero()?(l=getPi(this,E,1).times(.5),l.s=h.s):p.s<0?(this.precision=E,this.rounding=1,l=this.atan(divide(h,p,E,1)),p=getPi(this,E,1),this.precision=a,this.rounding=_,l=h.s<0?l.minus(p):l.plus(p)):l=this.atan(divide(h,p,E,1)),l}function cbrt(h){return new this(h).cbrt()}function ceil(h){return finalise(h=new this(h),h.e+1,2)}function clamp(h,p,l){return new this(h).clamp(p,l)}function config$1(h){if(!h||typeof h!="object")throw Error(decimalError+"Object expected");var p,l,a,_=h.defaults===!0,E=["precision",1,MAX_DIGITS,"rounding",0,8,"toExpNeg",-EXP_LIMIT,0,"toExpPos",0,EXP_LIMIT,"maxE",0,EXP_LIMIT,"minE",-EXP_LIMIT,0,"modulo",0,9];for(p=0;p<E.length;p+=3)if(l=E[p],_&&(this[l]=DEFAULTS[l]),(a=h[l])!==void 0)if(mathfloor(a)===a&&a>=E[p+1]&&a<=E[p+2])this[l]=a;else throw Error(invalidArgument+l+": "+a);if(l="crypto",_&&(this[l]=DEFAULTS[l]),(a=h[l])!==void 0)if(a===!0||a===!1||a===0||a===1)if(a)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[l]=!0;else throw Error(cryptoUnavailable);else this[l]=!1;else throw Error(invalidArgument+l+": "+a);return this}function cos(h){return new this(h).cos()}function cosh(h){return new this(h).cosh()}function clone(h){var p,l,a;function _(E){var C,A,N,O=this;if(!(O instanceof _))return new _(E);if(O.constructor=_,isDecimalInstance(E)){O.s=E.s,external?!E.d||E.e>_.maxE?(O.e=NaN,O.d=null):E.e<_.minE?(O.e=0,O.d=[0]):(O.e=E.e,O.d=E.d.slice()):(O.e=E.e,O.d=E.d?E.d.slice():E.d);return}if(N=typeof E,N==="number"){if(E===0){O.s=1/E<0?-1:1,O.e=0,O.d=[0];return}if(E<0?(E=-E,O.s=-1):O.s=1,E===~~E&&E<1e7){for(C=0,A=E;A>=10;A/=10)C++;external?C>_.maxE?(O.e=NaN,O.d=null):C<_.minE?(O.e=0,O.d=[0]):(O.e=C,O.d=[E]):(O.e=C,O.d=[E]);return}if(E*0!==0){E||(O.s=NaN),O.e=NaN,O.d=null;return}return parseDecimal(O,E.toString())}if(N==="string")return(A=E.charCodeAt(0))===45?(E=E.slice(1),O.s=-1):(A===43&&(E=E.slice(1)),O.s=1),isDecimal.test(E)?parseDecimal(O,E):parseOther(O,E);if(N==="bigint")return E<0?(E=-E,O.s=-1):O.s=1,parseDecimal(O,E.toString());throw Error(invalidArgument+E)}if(_.prototype=P,_.ROUND_UP=0,_.ROUND_DOWN=1,_.ROUND_CEIL=2,_.ROUND_FLOOR=3,_.ROUND_HALF_UP=4,_.ROUND_HALF_DOWN=5,_.ROUND_HALF_EVEN=6,_.ROUND_HALF_CEIL=7,_.ROUND_HALF_FLOOR=8,_.EUCLID=9,_.config=_.set=config$1,_.clone=clone,_.isDecimal=isDecimalInstance,_.abs=abs,_.acos=acos,_.acosh=acosh,_.add=add$2,_.asin=asin,_.asinh=asinh,_.atan=atan,_.atanh=atanh,_.atan2=atan2,_.cbrt=cbrt,_.ceil=ceil,_.clamp=clamp,_.cos=cos,_.cosh=cosh,_.div=div,_.exp=exp,_.floor=floor,_.hypot=hypot,_.ln=ln,_.log=log,_.log10=log10,_.log2=log2,_.max=max,_.min=min,_.mod=mod,_.mul=mul,_.pow=pow,_.random=random,_.round=round,_.sign=sign,_.sin=sin,_.sinh=sinh,_.sqrt=sqrt,_.sub=sub,_.sum=sum,_.tan=tan,_.tanh=tanh,_.trunc=trunc,h===void 0&&(h={}),h&&h.defaults!==!0)for(a=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],p=0;p<a.length;)h.hasOwnProperty(l=a[p++])||(h[l]=this[l]);return _.config(h),_}function div(h,p){return new this(h).div(p)}function exp(h){return new this(h).exp()}function floor(h){return finalise(h=new this(h),h.e+1,3)}function hypot(){var h,p,l=new this(0);for(external=!1,h=0;h<arguments.length;)if(p=new this(arguments[h++]),p.d)l.d&&(l=l.plus(p.times(p)));else{if(p.s)return external=!0,new this(1/0);l=p}return external=!0,l.sqrt()}function isDecimalInstance(h){return h instanceof Decimal||h&&h.toStringTag===tag||!1}function ln(h){return new this(h).ln()}function log(h,p){return new this(h).log(p)}function log2(h){return new this(h).log(2)}function log10(h){return new this(h).log(10)}function max(){return maxOrMin(this,arguments,-1)}function min(){return maxOrMin(this,arguments,1)}function mod(h,p){return new this(h).mod(p)}function mul(h,p){return new this(h).mul(p)}function pow(h,p){return new this(h).pow(p)}function random(h){var p,l,a,_,E=0,C=new this(1),A=[];if(h===void 0?h=this.precision:checkInt32(h,1,MAX_DIGITS),a=Math.ceil(h/LOG_BASE),this.crypto)if(crypto.getRandomValues)for(p=crypto.getRandomValues(new Uint32Array(a));E<a;)_=p[E],_>=429e7?p[E]=crypto.getRandomValues(new Uint32Array(1))[0]:A[E++]=_%1e7;else if(crypto.randomBytes){for(p=crypto.randomBytes(a*=4);E<a;)_=p[E]+(p[E+1]<<8)+(p[E+2]<<16)+((p[E+3]&127)<<24),_>=214e7?crypto.randomBytes(4).copy(p,E):(A.push(_%1e7),E+=4);E=a/4}else throw Error(cryptoUnavailable);else for(;E<a;)A[E++]=Math.random()*1e7|0;for(a=A[--E],h%=LOG_BASE,a&&h&&(_=mathpow(10,LOG_BASE-h),A[E]=(a/_|0)*_);A[E]===0;E--)A.pop();if(E<0)l=0,A=[0];else{for(l=-1;A[0]===0;l-=LOG_BASE)A.shift();for(a=1,_=A[0];_>=10;_/=10)a++;a<LOG_BASE&&(l-=LOG_BASE-a)}return C.e=l,C.d=A,C}function round(h){return finalise(h=new this(h),h.e+1,this.rounding)}function sign(h){return h=new this(h),h.d?h.d[0]?h.s:0*h.s:h.s||NaN}function sin(h){return new this(h).sin()}function sinh(h){return new this(h).sinh()}function sqrt(h){return new this(h).sqrt()}function sub(h,p){return new this(h).sub(p)}function sum(){var h=0,p=arguments,l=new this(p[h]);for(external=!1;l.s&&++h<p.length;)l=l.plus(p[h]);return external=!0,finalise(l,this.precision,this.rounding)}function tan(h){return new this(h).tan()}function tanh(h){return new this(h).tanh()}function trunc(h){return finalise(h=new this(h),h.e+1,1)}P[Symbol.for("nodejs.util.inspect.custom")]=P.toString;P[Symbol.toStringTag]="Decimal";var Decimal=P.constructor=clone(DEFAULTS);LN10=new Decimal(LN10);PI=new Decimal(PI);Decimal.set({precision:50});function evaluate(h){const p=h.replace(/\s/g,"");return parseExpression(p,{pos:0})}function parseExpression(h,p){let l=parseTerm(h,p);for(;p.pos<h.length;){const a=h[p.pos];if(a==="+"||a==="-"){p.pos++;const _=parseTerm(h,p);l=a==="+"?l.plus(_):l.minus(_)}else break}return l}function parseTerm(h,p){let l=parseFactor(h,p);for(;p.pos<h.length;){const a=h[p.pos];if(a==="*"||a==="/"||a==="%"){p.pos++;const _=parseFactor(h,p);if(a==="*")l=l.times(_);else if(a==="/"){if(_.isZero())throw new Error("Division by zero");l=l.dividedBy(_)}else a==="%"&&(l=l.modulo(_))}else break}return l}function parseFactor(h,p){if(p.pos<h.length&&h[p.pos]==="-")return p.pos++,parseFactor(h,p).negated();if(p.pos<h.length&&h[p.pos]==="+")return p.pos++,parseFactor(h,p);if(p.pos<h.length&&h[p.pos]==="("){p.pos++;const l=parseExpression(h,p);if(p.pos<h.length&&h[p.pos]===")")p.pos++;else throw new Error("Missing closing parenthesis");return l}return parseNumber(h,p)}function parseNumber(h,p){let l="";const a=p.pos;for(;p.pos<h.length&&(/\d/.test(h[p.pos])||h[p.pos]===".");)l+=h[p.pos],p.pos++;if(l.length===0)throw new Error(`Expected number at position ${a}`);return new Decimal(l)}function calculateFormula(h,p){try{const l=validateFormula(h);if(!l.valid)return{success:!1,error:l.error};const a=substituteBlockValues(h,p);return{success:!0,value:evaluate(a).toString()}}catch(l){return{success:!1,error:l instanceof Error?l.message:"Calculation error"}}}function formatNumber(h,p={}){const{currencySymbol:l="",useThousandsSeparator:a=!0,decimalPlaces:_=2}=p,E=new Decimal(h),C=E.modulo(1).equals(0);let A;if(C?A=E.toFixed(0):A=E.toFixed(_),a){const N=A.split(".");N[0]=N[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),A=N.join(".")}return l?`${l}${A}`:A}function formatDisplayNumber(h){if(h.endsWith(".")||h===""||h==="-")return h;const p=parseFloat(h);if(isNaN(p))return h;const l=h.split("."),a=l[0],_=l[1],E=a.replace(/\B(?=(\d{3})+(?!\d))/g,",");return _!==void 0?E+"."+_:E}function Calculator({mode:h,onCreateBlock:p,blockValues:l}){const[a,_]=reactExports.useState(""),[E,C]=reactExports.useState("0"),[A,N]=reactExports.useState(null),[O,H]=reactExports.useState(!1),[D,j]=reactExports.useState(!1),be=reactExports.useRef(null),Oe=reactExports.useRef(0);reactExports.useEffect(()=>{_(""),C("0"),N(null),j(!1)},[h]),reactExports.useEffect(()=>{const ot=Je=>{if(!(Je.target instanceof HTMLTextAreaElement||Je.target instanceof HTMLInputElement))if((/^[0-9.]$/.test(Je.key)||["+","-","*","/","Enter","Escape","Backspace"].includes(Je.key))&&Je.preventDefault(),/^[0-9]$/.test(Je.key))ve(Je.key);else if(Je.key===".")ht();else if(Je.key==="+")Xe("+");else if(Je.key==="-")Xe("-");else if(Je.key==="*")Xe("*");else if(Je.key==="/")Xe("/");else if(Je.key==="Enter"||Je.key==="=")if(Je.key==="=")De();else{const Rt=Date.now();Rt-Oe.current<1e3?(De(),Oe.current=0):Oe.current=Rt}else Je.key==="Escape"||Je.key==="c"||Je.key==="C"?Ke():Je.key==="Backspace"&&_e()};return window.addEventListener("keydown",ot),()=>window.removeEventListener("keydown",ot)},[E,a,D]);const ve=ot=>{N(null),D?(C(ot),j(!1)):C(E==="0"&&ot!=="."?ot:E+ot)},Xe=ot=>{if(N(null),D)if(a.length===0){const Je=E+ot;_(Je),j(!0)}else{const Je=a.slice(0,-1)+ot;_(Je),j(!0)}else{const Je=a+E+ot;_(Je),j(!0)}},Ke=()=>{_(""),C("0"),N(null),j(!1)},_e=()=>{!D&&E.length>1?C(E.slice(0,-1)):(C("0"),j(!1))},Le=ot=>{ot.preventDefault(),ot.dataTransfer.dropEffect="copy",H(!0)},Ae=()=>{H(!1)},rt=ot=>{ot.preventDefault(),H(!1);const Je=ot.dataTransfer.getData("blockValue"),Rt=ot.dataTransfer.getData("blockId");if(Je&&Rt)if(D&&a.length>0){const Bt=a+Je,Yt=calculateFormula(Bt,l);Yt.success&&Yt.value?(C(Yt.value),_(""),j(!1)):(C(Je),j(!1))}else _(""),C(Je),j(!1)},De=()=>{N(null);const ot=a+E;if(!ot||ot==="0")return;const Je=validateFormula(ot);if(!Je.valid){N(Je.error||"Invalid formula");return}const Rt=calculateFormula(ot,l);Rt.success&&Rt.value?(p(Rt.value),_(""),C("0"),j(!1)):N(Rt.error||"Calculation error")},xe=()=>{if(E!=="0"&&E!==""){const ot=parseFloat(E)/100;C(ot.toString()),_(a.slice(0,-E.length)+ot.toString())}},at=()=>{if(E!=="0"&&E!==""){const ot=parseFloat(E)*-1;C(ot.toString()),_(a.slice(0,-E.length)+ot.toString())}},ht=()=>{E.includes(".")||(C(E+"."),_(a+"."))};return jsxRuntimeExports.jsxs("div",{className:"calculator-panel",children:[jsxRuntimeExports.jsxs("div",{ref:be,className:`calculator-display ${O?"drag-over":""}`,onDragOver:Le,onDragLeave:Ae,onDrop:rt,children:[O&&jsxRuntimeExports.jsx("div",{className:"drop-indicator",children:"マグネットをここにおいてね"}),jsxRuntimeExports.jsx("div",{className:"calculator-formula",children:a||" "}),jsxRuntimeExports.jsx("div",{className:"calculator-value",children:formatDisplayNumber(E)}),A&&jsxRuntimeExports.jsx("div",{style:{fontSize:"0.875rem",color:"var(--accent-red)"},children:A})]}),h===BlockType.STANDARD&&jsxRuntimeExports.jsxs("div",{className:"calculator-buttons",children:[jsxRuntimeExports.jsx("button",{className:"calc-btn clear",onClick:Ke,children:"C"}),jsxRuntimeExports.jsx("button",{className:"calc-btn",onClick:at,children:"+/-"}),jsxRuntimeExports.jsx("button",{className:"calc-btn",onClick:xe,children:"%"}),jsxRuntimeExports.jsx("button",{className:"calc-btn operator",onClick:()=>Xe("/"),children:"÷"}),jsxRuntimeExports.jsx("button",{className:"calc-btn",onClick:()=>ve("7"),children:"7"}),jsxRuntimeExports.jsx("button",{className:"calc-btn",onClick:()=>ve("8"),children:"8"}),jsxRuntimeExports.jsx("button",{className:"calc-btn",onClick:()=>ve("9"),children:"9"}),jsxRuntimeExports.jsx("button",{className:"calc-btn operator",onClick:()=>Xe("*"),children:"×"}),jsxRuntimeExports.jsx("button",{className:"calc-btn",onClick:()=>ve("4"),children:"4"}),jsxRuntimeExports.jsx("button",{className:"calc-btn",onClick:()=>ve("5"),children:"5"}),jsxRuntimeExports.jsx("button",{className:"calc-btn",onClick:()=>ve("6"),children:"6"}),jsxRuntimeExports.jsx("button",{className:"calc-btn operator",onClick:()=>Xe("-"),children:"-"}),jsxRuntimeExports.jsx("button",{className:"calc-btn",onClick:()=>ve("1"),children:"1"}),jsxRuntimeExports.jsx("button",{className:"calc-btn",onClick:()=>ve("2"),children:"2"}),jsxRuntimeExports.jsx("button",{className:"calc-btn",onClick:()=>ve("3"),children:"3"}),jsxRuntimeExports.jsx("button",{className:"calc-btn operator",onClick:()=>Xe("+"),children:"+"}),jsxRuntimeExports.jsx("button",{className:"calc-btn",onClick:()=>ve("0"),children:"0"}),jsxRuntimeExports.jsx("button",{className:"calc-btn",onClick:ht,children:"."}),jsxRuntimeExports.jsx("button",{className:"calc-btn",onClick:_e,children:"⌫"}),jsxRuntimeExports.jsx("button",{className:"calc-btn equals",onClick:De,children:"="})]}),h===BlockType.DATE&&jsxRuntimeExports.jsxs("div",{style:{padding:"1rem",color:"var(--text-secondary)"},children:[jsxRuntimeExports.jsx("p",{children:"日づけのけいさんモード"}),jsxRuntimeExports.jsx("p",{style:{fontSize:"0.875rem",marginTop:"0.5rem"},children:"じゅんびちゅう：日づけのたしざん・ひきざん・ちがいをけいさんできるよ"})]}),h===BlockType.ZODIAC&&jsxRuntimeExports.jsxs("div",{style:{padding:"1rem",color:"var(--text-secondary)"},children:[jsxRuntimeExports.jsx("p",{children:"十二支のけいさんモード"}),jsxRuntimeExports.jsx("p",{style:{fontSize:"0.875rem",marginTop:"0.5rem"},children:"じゅんびちゅう：年から十二支をしらべられるよ"})]}),h===BlockType.UNIT&&jsxRuntimeExports.jsxs("div",{style:{padding:"1rem",color:"var(--text-secondary)"},children:[jsxRuntimeExports.jsx("p",{children:"たんいへんかんモード"}),jsxRuntimeExports.jsx("p",{style:{fontSize:"0.875rem",marginTop:"0.5rem"},children:"じゅんびちゅう：ながさ・おもさ・かさ・おんど・おかねのへんかんができるよ"})]})]})}var reactDomExports=requireReactDom();const canUseDOM=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function isWindow(h){const p=Object.prototype.toString.call(h);return p==="[object Window]"||p==="[object global]"}function isNode(h){return"nodeType"in h}function getWindow(h){var p,l;return h?isWindow(h)?h:isNode(h)&&(p=(l=h.ownerDocument)==null?void 0:l.defaultView)!=null?p:window:window}function isDocument(h){const{Document:p}=getWindow(h);return h instanceof p}function isHTMLElement(h){return isWindow(h)?!1:h instanceof getWindow(h).HTMLElement}function isSVGElement(h){return h instanceof getWindow(h).SVGElement}function getOwnerDocument(h){return h?isWindow(h)?h.document:isNode(h)?isDocument(h)?h:isHTMLElement(h)||isSVGElement(h)?h.ownerDocument:document:document:document}const useIsomorphicLayoutEffect=canUseDOM?reactExports.useLayoutEffect:reactExports.useEffect;function useEvent(h){const p=reactExports.useRef(h);return useIsomorphicLayoutEffect(()=>{p.current=h}),reactExports.useCallback(function(){for(var l=arguments.length,a=new Array(l),_=0;_<l;_++)a[_]=arguments[_];return p.current==null?void 0:p.current(...a)},[])}function useInterval(){const h=reactExports.useRef(null),p=reactExports.useCallback((a,_)=>{h.current=setInterval(a,_)},[]),l=reactExports.useCallback(()=>{h.current!==null&&(clearInterval(h.current),h.current=null)},[]);return[p,l]}function useLatestValue(h,p){p===void 0&&(p=[h]);const l=reactExports.useRef(h);return useIsomorphicLayoutEffect(()=>{l.current!==h&&(l.current=h)},p),l}function useLazyMemo(h,p){const l=reactExports.useRef();return reactExports.useMemo(()=>{const a=h(l.current);return l.current=a,a},[...p])}function useNodeRef(h){const p=useEvent(h),l=reactExports.useRef(null),a=reactExports.useCallback(_=>{_!==l.current&&p?.(_,l.current),l.current=_},[]);return[l,a]}function usePrevious(h){const p=reactExports.useRef();return reactExports.useEffect(()=>{p.current=h},[h]),p.current}let ids={};function useUniqueId(h,p){return reactExports.useMemo(()=>{if(p)return p;const l=ids[h]==null?0:ids[h]+1;return ids[h]=l,h+"-"+l},[h,p])}function createAdjustmentFn(h){return function(p){for(var l=arguments.length,a=new Array(l>1?l-1:0),_=1;_<l;_++)a[_-1]=arguments[_];return a.reduce((E,C)=>{const A=Object.entries(C);for(const[N,O]of A){const H=E[N];H!=null&&(E[N]=H+h*O)}return E},{...p})}}const add$1=createAdjustmentFn(1),subtract=createAdjustmentFn(-1);function hasViewportRelativeCoordinates(h){return"clientX"in h&&"clientY"in h}function isKeyboardEvent(h){if(!h)return!1;const{KeyboardEvent:p}=getWindow(h.target);return p&&h instanceof p}function isTouchEvent(h){if(!h)return!1;const{TouchEvent:p}=getWindow(h.target);return p&&h instanceof p}function getEventCoordinates(h){if(isTouchEvent(h)){if(h.touches&&h.touches.length){const{clientX:p,clientY:l}=h.touches[0];return{x:p,y:l}}else if(h.changedTouches&&h.changedTouches.length){const{clientX:p,clientY:l}=h.changedTouches[0];return{x:p,y:l}}}return hasViewportRelativeCoordinates(h)?{x:h.clientX,y:h.clientY}:null}const CSS=Object.freeze({Translate:{toString(h){if(!h)return;const{x:p,y:l}=h;return"translate3d("+(p?Math.round(p):0)+"px, "+(l?Math.round(l):0)+"px, 0)"}},Scale:{toString(h){if(!h)return;const{scaleX:p,scaleY:l}=h;return"scaleX("+p+") scaleY("+l+")"}},Transform:{toString(h){if(h)return[CSS.Translate.toString(h),CSS.Scale.toString(h)].join(" ")}},Transition:{toString(h){let{property:p,duration:l,easing:a}=h;return p+" "+l+"ms "+a}}}),SELECTOR="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function findFirstFocusableNode(h){return h.matches(SELECTOR)?h:h.querySelector(SELECTOR)}const hiddenStyles={display:"none"};function HiddenText(h){let{id:p,value:l}=h;return React.createElement("div",{id:p,style:hiddenStyles},l)}function LiveRegion(h){let{id:p,announcement:l,ariaLiveType:a="assertive"}=h;const _={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return React.createElement("div",{id:p,style:_,role:"status","aria-live":a,"aria-atomic":!0},l)}function useAnnouncement(){const[h,p]=reactExports.useState("");return{announce:reactExports.useCallback(a=>{a!=null&&p(a)},[]),announcement:h}}const DndMonitorContext=reactExports.createContext(null);function useDndMonitor(h){const p=reactExports.useContext(DndMonitorContext);reactExports.useEffect(()=>{if(!p)throw new Error("useDndMonitor must be used within a children of <DndContext>");return p(h)},[h,p])}function useDndMonitorProvider(){const[h]=reactExports.useState(()=>new Set),p=reactExports.useCallback(a=>(h.add(a),()=>h.delete(a)),[h]);return[reactExports.useCallback(a=>{let{type:_,event:E}=a;h.forEach(C=>{var A;return(A=C[_])==null?void 0:A.call(C,E)})},[h]),p]}const defaultScreenReaderInstructions={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},defaultAnnouncements={onDragStart(h){let{active:p}=h;return"Picked up draggable item "+p.id+"."},onDragOver(h){let{active:p,over:l}=h;return l?"Draggable item "+p.id+" was moved over droppable area "+l.id+".":"Draggable item "+p.id+" is no longer over a droppable area."},onDragEnd(h){let{active:p,over:l}=h;return l?"Draggable item "+p.id+" was dropped over droppable area "+l.id:"Draggable item "+p.id+" was dropped."},onDragCancel(h){let{active:p}=h;return"Dragging was cancelled. Draggable item "+p.id+" was dropped."}};function Accessibility(h){let{announcements:p=defaultAnnouncements,container:l,hiddenTextDescribedById:a,screenReaderInstructions:_=defaultScreenReaderInstructions}=h;const{announce:E,announcement:C}=useAnnouncement(),A=useUniqueId("DndLiveRegion"),[N,O]=reactExports.useState(!1);if(reactExports.useEffect(()=>{O(!0)},[]),useDndMonitor(reactExports.useMemo(()=>({onDragStart(D){let{active:j}=D;E(p.onDragStart({active:j}))},onDragMove(D){let{active:j,over:be}=D;p.onDragMove&&E(p.onDragMove({active:j,over:be}))},onDragOver(D){let{active:j,over:be}=D;E(p.onDragOver({active:j,over:be}))},onDragEnd(D){let{active:j,over:be}=D;E(p.onDragEnd({active:j,over:be}))},onDragCancel(D){let{active:j,over:be}=D;E(p.onDragCancel({active:j,over:be}))}}),[E,p])),!N)return null;const H=React.createElement(React.Fragment,null,React.createElement(HiddenText,{id:a,value:_.draggable}),React.createElement(LiveRegion,{id:A,announcement:C}));return l?reactDomExports.createPortal(H,l):H}var Action;(function(h){h.DragStart="dragStart",h.DragMove="dragMove",h.DragEnd="dragEnd",h.DragCancel="dragCancel",h.DragOver="dragOver",h.RegisterDroppable="registerDroppable",h.SetDroppableDisabled="setDroppableDisabled",h.UnregisterDroppable="unregisterDroppable"})(Action||(Action={}));function noop(){}function useSensor(h,p){return reactExports.useMemo(()=>({sensor:h,options:p??{}}),[h,p])}function useSensors(){for(var h=arguments.length,p=new Array(h),l=0;l<h;l++)p[l]=arguments[l];return reactExports.useMemo(()=>[...p].filter(a=>a!=null),[...p])}const defaultCoordinates=Object.freeze({x:0,y:0});function sortCollisionsDesc(h,p){let{data:{value:l}}=h,{data:{value:a}}=p;return a-l}function getFirstCollision(h,p){if(!h||h.length===0)return null;const[l]=h;return l[p]}function getIntersectionRatio(h,p){const l=Math.max(p.top,h.top),a=Math.max(p.left,h.left),_=Math.min(p.left+p.width,h.left+h.width),E=Math.min(p.top+p.height,h.top+h.height),C=_-a,A=E-l;if(a<_&&l<E){const N=p.width*p.height,O=h.width*h.height,H=C*A,D=H/(N+O-H);return Number(D.toFixed(4))}return 0}const rectIntersection=h=>{let{collisionRect:p,droppableRects:l,droppableContainers:a}=h;const _=[];for(const E of a){const{id:C}=E,A=l.get(C);if(A){const N=getIntersectionRatio(A,p);N>0&&_.push({id:C,data:{droppableContainer:E,value:N}})}}return _.sort(sortCollisionsDesc)};function adjustScale(h,p,l){return{...h,scaleX:p&&l?p.width/l.width:1,scaleY:p&&l?p.height/l.height:1}}function getRectDelta(h,p){return h&&p?{x:h.left-p.left,y:h.top-p.top}:defaultCoordinates}function createRectAdjustmentFn(h){return function(l){for(var a=arguments.length,_=new Array(a>1?a-1:0),E=1;E<a;E++)_[E-1]=arguments[E];return _.reduce((C,A)=>({...C,top:C.top+h*A.y,bottom:C.bottom+h*A.y,left:C.left+h*A.x,right:C.right+h*A.x}),{...l})}}const getAdjustedRect=createRectAdjustmentFn(1);function parseTransform(h){if(h.startsWith("matrix3d(")){const p=h.slice(9,-1).split(/, /);return{x:+p[12],y:+p[13],scaleX:+p[0],scaleY:+p[5]}}else if(h.startsWith("matrix(")){const p=h.slice(7,-1).split(/, /);return{x:+p[4],y:+p[5],scaleX:+p[0],scaleY:+p[3]}}return null}function inverseTransform(h,p,l){const a=parseTransform(p);if(!a)return h;const{scaleX:_,scaleY:E,x:C,y:A}=a,N=h.left-C-(1-_)*parseFloat(l),O=h.top-A-(1-E)*parseFloat(l.slice(l.indexOf(" ")+1)),H=_?h.width/_:h.width,D=E?h.height/E:h.height;return{width:H,height:D,top:O,right:N+H,bottom:O+D,left:N}}const defaultOptions={ignoreTransform:!1};function getClientRect(h,p){p===void 0&&(p=defaultOptions);let l=h.getBoundingClientRect();if(p.ignoreTransform){const{transform:O,transformOrigin:H}=getWindow(h).getComputedStyle(h);O&&(l=inverseTransform(l,O,H))}const{top:a,left:_,width:E,height:C,bottom:A,right:N}=l;return{top:a,left:_,width:E,height:C,bottom:A,right:N}}function getTransformAgnosticClientRect(h){return getClientRect(h,{ignoreTransform:!0})}function getWindowClientRect(h){const p=h.innerWidth,l=h.innerHeight;return{top:0,left:0,right:p,bottom:l,width:p,height:l}}function isFixed(h,p){return p===void 0&&(p=getWindow(h).getComputedStyle(h)),p.position==="fixed"}function isScrollable(h,p){p===void 0&&(p=getWindow(h).getComputedStyle(h));const l=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(_=>{const E=p[_];return typeof E=="string"?l.test(E):!1})}function getScrollableAncestors(h,p){const l=[];function a(_){if(p!=null&&l.length>=p||!_)return l;if(isDocument(_)&&_.scrollingElement!=null&&!l.includes(_.scrollingElement))return l.push(_.scrollingElement),l;if(!isHTMLElement(_)||isSVGElement(_)||l.includes(_))return l;const E=getWindow(h).getComputedStyle(_);return _!==h&&isScrollable(_,E)&&l.push(_),isFixed(_,E)?l:a(_.parentNode)}return h?a(h):l}function getFirstScrollableAncestor(h){const[p]=getScrollableAncestors(h,1);return p??null}function getScrollableElement(h){return!canUseDOM||!h?null:isWindow(h)?h:isNode(h)?isDocument(h)||h===getOwnerDocument(h).scrollingElement?window:isHTMLElement(h)?h:null:null}function getScrollXCoordinate(h){return isWindow(h)?h.scrollX:h.scrollLeft}function getScrollYCoordinate(h){return isWindow(h)?h.scrollY:h.scrollTop}function getScrollCoordinates(h){return{x:getScrollXCoordinate(h),y:getScrollYCoordinate(h)}}var Direction;(function(h){h[h.Forward=1]="Forward",h[h.Backward=-1]="Backward"})(Direction||(Direction={}));function isDocumentScrollingElement(h){return!canUseDOM||!h?!1:h===document.scrollingElement}function getScrollPosition(h){const p={x:0,y:0},l=isDocumentScrollingElement(h)?{height:window.innerHeight,width:window.innerWidth}:{height:h.clientHeight,width:h.clientWidth},a={x:h.scrollWidth-l.width,y:h.scrollHeight-l.height},_=h.scrollTop<=p.y,E=h.scrollLeft<=p.x,C=h.scrollTop>=a.y,A=h.scrollLeft>=a.x;return{isTop:_,isLeft:E,isBottom:C,isRight:A,maxScroll:a,minScroll:p}}const defaultThreshold={x:.2,y:.2};function getScrollDirectionAndSpeed(h,p,l,a,_){let{top:E,left:C,right:A,bottom:N}=l;a===void 0&&(a=10),_===void 0&&(_=defaultThreshold);const{isTop:O,isBottom:H,isLeft:D,isRight:j}=getScrollPosition(h),be={x:0,y:0},Oe={x:0,y:0},ve={height:p.height*_.y,width:p.width*_.x};return!O&&E<=p.top+ve.height?(be.y=Direction.Backward,Oe.y=a*Math.abs((p.top+ve.height-E)/ve.height)):!H&&N>=p.bottom-ve.height&&(be.y=Direction.Forward,Oe.y=a*Math.abs((p.bottom-ve.height-N)/ve.height)),!j&&A>=p.right-ve.width?(be.x=Direction.Forward,Oe.x=a*Math.abs((p.right-ve.width-A)/ve.width)):!D&&C<=p.left+ve.width&&(be.x=Direction.Backward,Oe.x=a*Math.abs((p.left+ve.width-C)/ve.width)),{direction:be,speed:Oe}}function getScrollElementRect(h){if(h===document.scrollingElement){const{innerWidth:E,innerHeight:C}=window;return{top:0,left:0,right:E,bottom:C,width:E,height:C}}const{top:p,left:l,right:a,bottom:_}=h.getBoundingClientRect();return{top:p,left:l,right:a,bottom:_,width:h.clientWidth,height:h.clientHeight}}function getScrollOffsets(h){return h.reduce((p,l)=>add$1(p,getScrollCoordinates(l)),defaultCoordinates)}function getScrollXOffset(h){return h.reduce((p,l)=>p+getScrollXCoordinate(l),0)}function getScrollYOffset(h){return h.reduce((p,l)=>p+getScrollYCoordinate(l),0)}function scrollIntoViewIfNeeded(h,p){if(p===void 0&&(p=getClientRect),!h)return;const{top:l,left:a,bottom:_,right:E}=p(h);getFirstScrollableAncestor(h)&&(_<=0||E<=0||l>=window.innerHeight||a>=window.innerWidth)&&h.scrollIntoView({block:"center",inline:"center"})}const properties=[["x",["left","right"],getScrollXOffset],["y",["top","bottom"],getScrollYOffset]];class Rect{constructor(p,l){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const a=getScrollableAncestors(l),_=getScrollOffsets(a);this.rect={...p},this.width=p.width,this.height=p.height;for(const[E,C,A]of properties)for(const N of C)Object.defineProperty(this,N,{get:()=>{const O=A(a),H=_[E]-O;return this.rect[N]+H},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Listeners{constructor(p){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(l=>{var a;return(a=this.target)==null?void 0:a.removeEventListener(...l)})},this.target=p}add(p,l,a){var _;(_=this.target)==null||_.addEventListener(p,l,a),this.listeners.push([p,l,a])}}function getEventListenerTarget(h){const{EventTarget:p}=getWindow(h);return h instanceof p?h:getOwnerDocument(h)}function hasExceededDistance(h,p){const l=Math.abs(h.x),a=Math.abs(h.y);return typeof p=="number"?Math.sqrt(l**2+a**2)>p:"x"in p&&"y"in p?l>p.x&&a>p.y:"x"in p?l>p.x:"y"in p?a>p.y:!1}var EventName;(function(h){h.Click="click",h.DragStart="dragstart",h.Keydown="keydown",h.ContextMenu="contextmenu",h.Resize="resize",h.SelectionChange="selectionchange",h.VisibilityChange="visibilitychange"})(EventName||(EventName={}));function preventDefault(h){h.preventDefault()}function stopPropagation(h){h.stopPropagation()}var KeyboardCode;(function(h){h.Space="Space",h.Down="ArrowDown",h.Right="ArrowRight",h.Left="ArrowLeft",h.Up="ArrowUp",h.Esc="Escape",h.Enter="Enter",h.Tab="Tab"})(KeyboardCode||(KeyboardCode={}));const defaultKeyboardCodes={start:[KeyboardCode.Space,KeyboardCode.Enter],cancel:[KeyboardCode.Esc],end:[KeyboardCode.Space,KeyboardCode.Enter,KeyboardCode.Tab]},defaultKeyboardCoordinateGetter=(h,p)=>{let{currentCoordinates:l}=p;switch(h.code){case KeyboardCode.Right:return{...l,x:l.x+25};case KeyboardCode.Left:return{...l,x:l.x-25};case KeyboardCode.Down:return{...l,y:l.y+25};case KeyboardCode.Up:return{...l,y:l.y-25}}};class KeyboardSensor{constructor(p){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=p;const{event:{target:l}}=p;this.props=p,this.listeners=new Listeners(getOwnerDocument(l)),this.windowListeners=new Listeners(getWindow(l)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(EventName.Resize,this.handleCancel),this.windowListeners.add(EventName.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(EventName.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:p,onStart:l}=this.props,a=p.node.current;a&&scrollIntoViewIfNeeded(a),l(defaultCoordinates)}handleKeyDown(p){if(isKeyboardEvent(p)){const{active:l,context:a,options:_}=this.props,{keyboardCodes:E=defaultKeyboardCodes,coordinateGetter:C=defaultKeyboardCoordinateGetter,scrollBehavior:A="smooth"}=_,{code:N}=p;if(E.end.includes(N)){this.handleEnd(p);return}if(E.cancel.includes(N)){this.handleCancel(p);return}const{collisionRect:O}=a.current,H=O?{x:O.left,y:O.top}:defaultCoordinates;this.referenceCoordinates||(this.referenceCoordinates=H);const D=C(p,{active:l,context:a.current,currentCoordinates:H});if(D){const j=subtract(D,H),be={x:0,y:0},{scrollableAncestors:Oe}=a.current;for(const ve of Oe){const Xe=p.code,{isTop:Ke,isRight:_e,isLeft:Le,isBottom:Ae,maxScroll:rt,minScroll:De}=getScrollPosition(ve),xe=getScrollElementRect(ve),at={x:Math.min(Xe===KeyboardCode.Right?xe.right-xe.width/2:xe.right,Math.max(Xe===KeyboardCode.Right?xe.left:xe.left+xe.width/2,D.x)),y:Math.min(Xe===KeyboardCode.Down?xe.bottom-xe.height/2:xe.bottom,Math.max(Xe===KeyboardCode.Down?xe.top:xe.top+xe.height/2,D.y))},ht=Xe===KeyboardCode.Right&&!_e||Xe===KeyboardCode.Left&&!Le,ot=Xe===KeyboardCode.Down&&!Ae||Xe===KeyboardCode.Up&&!Ke;if(ht&&at.x!==D.x){const Je=ve.scrollLeft+j.x,Rt=Xe===KeyboardCode.Right&&Je<=rt.x||Xe===KeyboardCode.Left&&Je>=De.x;if(Rt&&!j.y){ve.scrollTo({left:Je,behavior:A});return}Rt?be.x=ve.scrollLeft-Je:be.x=Xe===KeyboardCode.Right?ve.scrollLeft-rt.x:ve.scrollLeft-De.x,be.x&&ve.scrollBy({left:-be.x,behavior:A});break}else if(ot&&at.y!==D.y){const Je=ve.scrollTop+j.y,Rt=Xe===KeyboardCode.Down&&Je<=rt.y||Xe===KeyboardCode.Up&&Je>=De.y;if(Rt&&!j.x){ve.scrollTo({top:Je,behavior:A});return}Rt?be.y=ve.scrollTop-Je:be.y=Xe===KeyboardCode.Down?ve.scrollTop-rt.y:ve.scrollTop-De.y,be.y&&ve.scrollBy({top:-be.y,behavior:A});break}}this.handleMove(p,add$1(subtract(D,this.referenceCoordinates),be))}}}handleMove(p,l){const{onMove:a}=this.props;p.preventDefault(),a(l)}handleEnd(p){const{onEnd:l}=this.props;p.preventDefault(),this.detach(),l()}handleCancel(p){const{onCancel:l}=this.props;p.preventDefault(),this.detach(),l()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}KeyboardSensor.activators=[{eventName:"onKeyDown",handler:(h,p,l)=>{let{keyboardCodes:a=defaultKeyboardCodes,onActivation:_}=p,{active:E}=l;const{code:C}=h.nativeEvent;if(a.start.includes(C)){const A=E.activatorNode.current;return A&&h.target!==A?!1:(h.preventDefault(),_?.({event:h.nativeEvent}),!0)}return!1}}];function isDistanceConstraint(h){return!!(h&&"distance"in h)}function isDelayConstraint(h){return!!(h&&"delay"in h)}class AbstractPointerSensor{constructor(p,l,a){var _;a===void 0&&(a=getEventListenerTarget(p.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=p,this.events=l;const{event:E}=p,{target:C}=E;this.props=p,this.events=l,this.document=getOwnerDocument(C),this.documentListeners=new Listeners(this.document),this.listeners=new Listeners(a),this.windowListeners=new Listeners(getWindow(C)),this.initialCoordinates=(_=getEventCoordinates(E))!=null?_:defaultCoordinates,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:p,props:{options:{activationConstraint:l,bypassActivationConstraint:a}}}=this;if(this.listeners.add(p.move.name,this.handleMove,{passive:!1}),this.listeners.add(p.end.name,this.handleEnd),p.cancel&&this.listeners.add(p.cancel.name,this.handleCancel),this.windowListeners.add(EventName.Resize,this.handleCancel),this.windowListeners.add(EventName.DragStart,preventDefault),this.windowListeners.add(EventName.VisibilityChange,this.handleCancel),this.windowListeners.add(EventName.ContextMenu,preventDefault),this.documentListeners.add(EventName.Keydown,this.handleKeydown),l){if(a!=null&&a({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(isDelayConstraint(l)){this.timeoutId=setTimeout(this.handleStart,l.delay),this.handlePending(l);return}if(isDistanceConstraint(l)){this.handlePending(l);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(p,l){const{active:a,onPending:_}=this.props;_(a,p,this.initialCoordinates,l)}handleStart(){const{initialCoordinates:p}=this,{onStart:l}=this.props;p&&(this.activated=!0,this.documentListeners.add(EventName.Click,stopPropagation,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(EventName.SelectionChange,this.removeTextSelection),l(p))}handleMove(p){var l;const{activated:a,initialCoordinates:_,props:E}=this,{onMove:C,options:{activationConstraint:A}}=E;if(!_)return;const N=(l=getEventCoordinates(p))!=null?l:defaultCoordinates,O=subtract(_,N);if(!a&&A){if(isDistanceConstraint(A)){if(A.tolerance!=null&&hasExceededDistance(O,A.tolerance))return this.handleCancel();if(hasExceededDistance(O,A.distance))return this.handleStart()}if(isDelayConstraint(A)&&hasExceededDistance(O,A.tolerance))return this.handleCancel();this.handlePending(A,O);return}p.cancelable&&p.preventDefault(),C(N)}handleEnd(){const{onAbort:p,onEnd:l}=this.props;this.detach(),this.activated||p(this.props.active),l()}handleCancel(){const{onAbort:p,onCancel:l}=this.props;this.detach(),this.activated||p(this.props.active),l()}handleKeydown(p){p.code===KeyboardCode.Esc&&this.handleCancel()}removeTextSelection(){var p;(p=this.document.getSelection())==null||p.removeAllRanges()}}const events={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class PointerSensor extends AbstractPointerSensor{constructor(p){const{event:l}=p,a=getOwnerDocument(l.target);super(p,events,a)}}PointerSensor.activators=[{eventName:"onPointerDown",handler:(h,p)=>{let{nativeEvent:l}=h,{onActivation:a}=p;return!l.isPrimary||l.button!==0?!1:(a?.({event:l}),!0)}}];const events$1={move:{name:"mousemove"},end:{name:"mouseup"}};var MouseButton;(function(h){h[h.RightClick=2]="RightClick"})(MouseButton||(MouseButton={}));class MouseSensor extends AbstractPointerSensor{constructor(p){super(p,events$1,getOwnerDocument(p.event.target))}}MouseSensor.activators=[{eventName:"onMouseDown",handler:(h,p)=>{let{nativeEvent:l}=h,{onActivation:a}=p;return l.button===MouseButton.RightClick?!1:(a?.({event:l}),!0)}}];const events$2={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class TouchSensor extends AbstractPointerSensor{constructor(p){super(p,events$2)}static setup(){return window.addEventListener(events$2.move.name,p,{capture:!1,passive:!1}),function(){window.removeEventListener(events$2.move.name,p)};function p(){}}}TouchSensor.activators=[{eventName:"onTouchStart",handler:(h,p)=>{let{nativeEvent:l}=h,{onActivation:a}=p;const{touches:_}=l;return _.length>1?!1:(a?.({event:l}),!0)}}];var AutoScrollActivator;(function(h){h[h.Pointer=0]="Pointer",h[h.DraggableRect=1]="DraggableRect"})(AutoScrollActivator||(AutoScrollActivator={}));var TraversalOrder;(function(h){h[h.TreeOrder=0]="TreeOrder",h[h.ReversedTreeOrder=1]="ReversedTreeOrder"})(TraversalOrder||(TraversalOrder={}));function useAutoScroller(h){let{acceleration:p,activator:l=AutoScrollActivator.Pointer,canScroll:a,draggingRect:_,enabled:E,interval:C=5,order:A=TraversalOrder.TreeOrder,pointerCoordinates:N,scrollableAncestors:O,scrollableAncestorRects:H,delta:D,threshold:j}=h;const be=useScrollIntent({delta:D,disabled:!E}),[Oe,ve]=useInterval(),Xe=reactExports.useRef({x:0,y:0}),Ke=reactExports.useRef({x:0,y:0}),_e=reactExports.useMemo(()=>{switch(l){case AutoScrollActivator.Pointer:return N?{top:N.y,bottom:N.y,left:N.x,right:N.x}:null;case AutoScrollActivator.DraggableRect:return _}},[l,_,N]),Le=reactExports.useRef(null),Ae=reactExports.useCallback(()=>{const De=Le.current;if(!De)return;const xe=Xe.current.x*Ke.current.x,at=Xe.current.y*Ke.current.y;De.scrollBy(xe,at)},[]),rt=reactExports.useMemo(()=>A===TraversalOrder.TreeOrder?[...O].reverse():O,[A,O]);reactExports.useEffect(()=>{if(!E||!O.length||!_e){ve();return}for(const De of rt){if(a?.(De)===!1)continue;const xe=O.indexOf(De),at=H[xe];if(!at)continue;const{direction:ht,speed:ot}=getScrollDirectionAndSpeed(De,at,_e,p,j);for(const Je of["x","y"])be[Je][ht[Je]]||(ot[Je]=0,ht[Je]=0);if(ot.x>0||ot.y>0){ve(),Le.current=De,Oe(Ae,C),Xe.current=ot,Ke.current=ht;return}}Xe.current={x:0,y:0},Ke.current={x:0,y:0},ve()},[p,Ae,a,ve,E,C,JSON.stringify(_e),JSON.stringify(be),Oe,O,rt,H,JSON.stringify(j)])}const defaultScrollIntent={x:{[Direction.Backward]:!1,[Direction.Forward]:!1},y:{[Direction.Backward]:!1,[Direction.Forward]:!1}};function useScrollIntent(h){let{delta:p,disabled:l}=h;const a=usePrevious(p);return useLazyMemo(_=>{if(l||!a||!_)return defaultScrollIntent;const E={x:Math.sign(p.x-a.x),y:Math.sign(p.y-a.y)};return{x:{[Direction.Backward]:_.x[Direction.Backward]||E.x===-1,[Direction.Forward]:_.x[Direction.Forward]||E.x===1},y:{[Direction.Backward]:_.y[Direction.Backward]||E.y===-1,[Direction.Forward]:_.y[Direction.Forward]||E.y===1}}},[l,p,a])}function useCachedNode(h,p){const l=p!=null?h.get(p):void 0,a=l?l.node.current:null;return useLazyMemo(_=>{var E;return p==null?null:(E=a??_)!=null?E:null},[a,p])}function useCombineActivators(h,p){return reactExports.useMemo(()=>h.reduce((l,a)=>{const{sensor:_}=a,E=_.activators.map(C=>({eventName:C.eventName,handler:p(C.handler,a)}));return[...l,...E]},[]),[h,p])}var MeasuringStrategy;(function(h){h[h.Always=0]="Always",h[h.BeforeDragging=1]="BeforeDragging",h[h.WhileDragging=2]="WhileDragging"})(MeasuringStrategy||(MeasuringStrategy={}));var MeasuringFrequency;(function(h){h.Optimized="optimized"})(MeasuringFrequency||(MeasuringFrequency={}));const defaultValue=new Map;function useDroppableMeasuring(h,p){let{dragging:l,dependencies:a,config:_}=p;const[E,C]=reactExports.useState(null),{frequency:A,measure:N,strategy:O}=_,H=reactExports.useRef(h),D=Xe(),j=useLatestValue(D),be=reactExports.useCallback(function(Ke){Ke===void 0&&(Ke=[]),!j.current&&C(_e=>_e===null?Ke:_e.concat(Ke.filter(Le=>!_e.includes(Le))))},[j]),Oe=reactExports.useRef(null),ve=useLazyMemo(Ke=>{if(D&&!l)return defaultValue;if(!Ke||Ke===defaultValue||H.current!==h||E!=null){const _e=new Map;for(let Le of h){if(!Le)continue;if(E&&E.length>0&&!E.includes(Le.id)&&Le.rect.current){_e.set(Le.id,Le.rect.current);continue}const Ae=Le.node.current,rt=Ae?new Rect(N(Ae),Ae):null;Le.rect.current=rt,rt&&_e.set(Le.id,rt)}return _e}return Ke},[h,E,l,D,N]);return reactExports.useEffect(()=>{H.current=h},[h]),reactExports.useEffect(()=>{D||be()},[l,D]),reactExports.useEffect(()=>{E&&E.length>0&&C(null)},[JSON.stringify(E)]),reactExports.useEffect(()=>{D||typeof A!="number"||Oe.current!==null||(Oe.current=setTimeout(()=>{be(),Oe.current=null},A))},[A,D,be,...a]),{droppableRects:ve,measureDroppableContainers:be,measuringScheduled:E!=null};function Xe(){switch(O){case MeasuringStrategy.Always:return!1;case MeasuringStrategy.BeforeDragging:return l;default:return!l}}}function useInitialValue(h,p){return useLazyMemo(l=>h?l||(typeof p=="function"?p(h):h):null,[p,h])}function useInitialRect(h,p){return useInitialValue(h,p)}function useMutationObserver(h){let{callback:p,disabled:l}=h;const a=useEvent(p),_=reactExports.useMemo(()=>{if(l||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:E}=window;return new E(a)},[a,l]);return reactExports.useEffect(()=>()=>_?.disconnect(),[_]),_}function useResizeObserver(h){let{callback:p,disabled:l}=h;const a=useEvent(p),_=reactExports.useMemo(()=>{if(l||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:E}=window;return new E(a)},[l]);return reactExports.useEffect(()=>()=>_?.disconnect(),[_]),_}function defaultMeasure(h){return new Rect(getClientRect(h),h)}function useRect(h,p,l){p===void 0&&(p=defaultMeasure);const[a,_]=reactExports.useState(null);function E(){_(N=>{if(!h)return null;if(h.isConnected===!1){var O;return(O=N??l)!=null?O:null}const H=p(h);return JSON.stringify(N)===JSON.stringify(H)?N:H})}const C=useMutationObserver({callback(N){if(h)for(const O of N){const{type:H,target:D}=O;if(H==="childList"&&D instanceof HTMLElement&&D.contains(h)){E();break}}}}),A=useResizeObserver({callback:E});return useIsomorphicLayoutEffect(()=>{E(),h?(A?.observe(h),C?.observe(document.body,{childList:!0,subtree:!0})):(A?.disconnect(),C?.disconnect())},[h]),a}function useRectDelta(h){const p=useInitialValue(h);return getRectDelta(h,p)}const defaultValue$1=[];function useScrollableAncestors(h){const p=reactExports.useRef(h),l=useLazyMemo(a=>h?a&&a!==defaultValue$1&&h&&p.current&&h.parentNode===p.current.parentNode?a:getScrollableAncestors(h):defaultValue$1,[h]);return reactExports.useEffect(()=>{p.current=h},[h]),l}function useScrollOffsets(h){const[p,l]=reactExports.useState(null),a=reactExports.useRef(h),_=reactExports.useCallback(E=>{const C=getScrollableElement(E.target);C&&l(A=>A?(A.set(C,getScrollCoordinates(C)),new Map(A)):null)},[]);return reactExports.useEffect(()=>{const E=a.current;if(h!==E){C(E);const A=h.map(N=>{const O=getScrollableElement(N);return O?(O.addEventListener("scroll",_,{passive:!0}),[O,getScrollCoordinates(O)]):null}).filter(N=>N!=null);l(A.length?new Map(A):null),a.current=h}return()=>{C(h),C(E)};function C(A){A.forEach(N=>{const O=getScrollableElement(N);O?.removeEventListener("scroll",_)})}},[_,h]),reactExports.useMemo(()=>h.length?p?Array.from(p.values()).reduce((E,C)=>add$1(E,C),defaultCoordinates):getScrollOffsets(h):defaultCoordinates,[h,p])}function useScrollOffsetsDelta(h,p){p===void 0&&(p=[]);const l=reactExports.useRef(null);return reactExports.useEffect(()=>{l.current=null},p),reactExports.useEffect(()=>{const a=h!==defaultCoordinates;a&&!l.current&&(l.current=h),!a&&l.current&&(l.current=null)},[h]),l.current?subtract(h,l.current):defaultCoordinates}function useSensorSetup(h){reactExports.useEffect(()=>{if(!canUseDOM)return;const p=h.map(l=>{let{sensor:a}=l;return a.setup==null?void 0:a.setup()});return()=>{for(const l of p)l?.()}},h.map(p=>{let{sensor:l}=p;return l}))}function useSyntheticListeners(h,p){return reactExports.useMemo(()=>h.reduce((l,a)=>{let{eventName:_,handler:E}=a;return l[_]=C=>{E(C,p)},l},{}),[h,p])}function useWindowRect(h){return reactExports.useMemo(()=>h?getWindowClientRect(h):null,[h])}const defaultValue$2=[];function useRects(h,p){p===void 0&&(p=getClientRect);const[l]=h,a=useWindowRect(l?getWindow(l):null),[_,E]=reactExports.useState(defaultValue$2);function C(){E(()=>h.length?h.map(N=>isDocumentScrollingElement(N)?a:new Rect(p(N),N)):defaultValue$2)}const A=useResizeObserver({callback:C});return useIsomorphicLayoutEffect(()=>{A?.disconnect(),C(),h.forEach(N=>A?.observe(N))},[h]),_}function getMeasurableNode(h){if(!h)return null;if(h.children.length>1)return h;const p=h.children[0];return isHTMLElement(p)?p:h}function useDragOverlayMeasuring(h){let{measure:p}=h;const[l,a]=reactExports.useState(null),_=reactExports.useCallback(O=>{for(const{target:H}of O)if(isHTMLElement(H)){a(D=>{const j=p(H);return D?{...D,width:j.width,height:j.height}:j});break}},[p]),E=useResizeObserver({callback:_}),C=reactExports.useCallback(O=>{const H=getMeasurableNode(O);E?.disconnect(),H&&E?.observe(H),a(H?p(H):null)},[p,E]),[A,N]=useNodeRef(C);return reactExports.useMemo(()=>({nodeRef:A,rect:l,setRef:N}),[l,A,N])}const defaultSensors=[{sensor:PointerSensor,options:{}},{sensor:KeyboardSensor,options:{}}],defaultData={current:{}},defaultMeasuringConfiguration={draggable:{measure:getTransformAgnosticClientRect},droppable:{measure:getTransformAgnosticClientRect,strategy:MeasuringStrategy.WhileDragging,frequency:MeasuringFrequency.Optimized},dragOverlay:{measure:getClientRect}};class DroppableContainersMap extends Map{get(p){var l;return p!=null&&(l=super.get(p))!=null?l:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(p=>{let{disabled:l}=p;return!l})}getNodeFor(p){var l,a;return(l=(a=this.get(p))==null?void 0:a.node.current)!=null?l:void 0}}const defaultPublicContext={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new DroppableContainersMap,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:noop},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:defaultMeasuringConfiguration,measureDroppableContainers:noop,windowRect:null,measuringScheduled:!1},defaultInternalContext={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:noop,draggableNodes:new Map,over:null,measureDroppableContainers:noop},InternalContext=reactExports.createContext(defaultInternalContext),PublicContext=reactExports.createContext(defaultPublicContext);function getInitialState(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new DroppableContainersMap}}}function reducer(h,p){switch(p.type){case Action.DragStart:return{...h,draggable:{...h.draggable,initialCoordinates:p.initialCoordinates,active:p.active}};case Action.DragMove:return h.draggable.active==null?h:{...h,draggable:{...h.draggable,translate:{x:p.coordinates.x-h.draggable.initialCoordinates.x,y:p.coordinates.y-h.draggable.initialCoordinates.y}}};case Action.DragEnd:case Action.DragCancel:return{...h,draggable:{...h.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Action.RegisterDroppable:{const{element:l}=p,{id:a}=l,_=new DroppableContainersMap(h.droppable.containers);return _.set(a,l),{...h,droppable:{...h.droppable,containers:_}}}case Action.SetDroppableDisabled:{const{id:l,key:a,disabled:_}=p,E=h.droppable.containers.get(l);if(!E||a!==E.key)return h;const C=new DroppableContainersMap(h.droppable.containers);return C.set(l,{...E,disabled:_}),{...h,droppable:{...h.droppable,containers:C}}}case Action.UnregisterDroppable:{const{id:l,key:a}=p,_=h.droppable.containers.get(l);if(!_||a!==_.key)return h;const E=new DroppableContainersMap(h.droppable.containers);return E.delete(l),{...h,droppable:{...h.droppable,containers:E}}}default:return h}}function RestoreFocus(h){let{disabled:p}=h;const{active:l,activatorEvent:a,draggableNodes:_}=reactExports.useContext(InternalContext),E=usePrevious(a),C=usePrevious(l?.id);return reactExports.useEffect(()=>{if(!p&&!a&&E&&C!=null){if(!isKeyboardEvent(E)||document.activeElement===E.target)return;const A=_.get(C);if(!A)return;const{activatorNode:N,node:O}=A;if(!N.current&&!O.current)return;requestAnimationFrame(()=>{for(const H of[N.current,O.current]){if(!H)continue;const D=findFirstFocusableNode(H);if(D){D.focus();break}}})}},[a,p,_,C,E]),null}function applyModifiers(h,p){let{transform:l,...a}=p;return h!=null&&h.length?h.reduce((_,E)=>E({transform:_,...a}),l):l}function useMeasuringConfiguration(h){return reactExports.useMemo(()=>({draggable:{...defaultMeasuringConfiguration.draggable,...h?.draggable},droppable:{...defaultMeasuringConfiguration.droppable,...h?.droppable},dragOverlay:{...defaultMeasuringConfiguration.dragOverlay,...h?.dragOverlay}}),[h?.draggable,h?.droppable,h?.dragOverlay])}function useLayoutShiftScrollCompensation(h){let{activeNode:p,measure:l,initialRect:a,config:_=!0}=h;const E=reactExports.useRef(!1),{x:C,y:A}=typeof _=="boolean"?{x:_,y:_}:_;useIsomorphicLayoutEffect(()=>{if(!C&&!A||!p){E.current=!1;return}if(E.current||!a)return;const O=p?.node.current;if(!O||O.isConnected===!1)return;const H=l(O),D=getRectDelta(H,a);if(C||(D.x=0),A||(D.y=0),E.current=!0,Math.abs(D.x)>0||Math.abs(D.y)>0){const j=getFirstScrollableAncestor(O);j&&j.scrollBy({top:D.y,left:D.x})}},[p,C,A,a,l])}const ActiveDraggableContext=reactExports.createContext({...defaultCoordinates,scaleX:1,scaleY:1});var Status;(function(h){h[h.Uninitialized=0]="Uninitialized",h[h.Initializing=1]="Initializing",h[h.Initialized=2]="Initialized"})(Status||(Status={}));const DndContext=reactExports.memo(function(p){var l,a,_,E;let{id:C,accessibility:A,autoScroll:N=!0,children:O,sensors:H=defaultSensors,collisionDetection:D=rectIntersection,measuring:j,modifiers:be,...Oe}=p;const ve=reactExports.useReducer(reducer,void 0,getInitialState),[Xe,Ke]=ve,[_e,Le]=useDndMonitorProvider(),[Ae,rt]=reactExports.useState(Status.Uninitialized),De=Ae===Status.Initialized,{draggable:{active:xe,nodes:at,translate:ht},droppable:{containers:ot}}=Xe,Je=xe!=null?at.get(xe):null,Rt=reactExports.useRef({initial:null,translated:null}),Bt=reactExports.useMemo(()=>{var T;return xe!=null?{id:xe,data:(T=Je?.data)!=null?T:defaultData,rect:Rt}:null},[xe,Je]),Yt=reactExports.useRef(null),[kt,de]=reactExports.useState(null),[Ve,ft]=reactExports.useState(null),_t=useLatestValue(Oe,Object.values(Oe)),Be=useUniqueId("DndDescribedBy",C),J=reactExports.useMemo(()=>ot.getEnabled(),[ot]),Ce=useMeasuringConfiguration(j),{droppableRects:He,measureDroppableContainers:it,measuringScheduled:Et}=useDroppableMeasuring(J,{dragging:De,dependencies:[ht.x,ht.y],config:Ce.droppable}),Ze=useCachedNode(at,xe),Pt=reactExports.useMemo(()=>Ve?getEventCoordinates(Ve):null,[Ve]),An=$i(),tt=useInitialRect(Ze,Ce.draggable.measure);useLayoutShiftScrollCompensation({activeNode:xe!=null?at.get(xe):null,config:An.layoutShiftCompensation,initialRect:tt,measure:Ce.draggable.measure});const Qe=useRect(Ze,Ce.draggable.measure,tt),Ni=useRect(Ze?Ze.parentElement:null),ae=reactExports.useRef({activatorEvent:null,active:null,activeNode:Ze,collisionRect:null,collisions:null,droppableRects:He,draggableNodes:at,draggingNode:null,draggingNodeRect:null,droppableContainers:ot,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),We=ot.getNodeFor((l=ae.current.over)==null?void 0:l.id),Mn=useDragOverlayMeasuring({measure:Ce.dragOverlay.measure}),vt=(a=Mn.nodeRef.current)!=null?a:Ze,Si=De?(_=Mn.rect)!=null?_:Qe:null,Wt=!!(Mn.nodeRef.current&&Mn.rect),Yi=useRectDelta(Wt?null:Qe),Ki=useWindowRect(vt?getWindow(vt):null),Ln=useScrollableAncestors(De?We??Ze:null),_n=useRects(Ln),bn=applyModifiers(be,{transform:{x:ht.x-Yi.x,y:ht.y-Yi.y,scaleX:1,scaleY:1},activatorEvent:Ve,active:Bt,activeNodeRect:Qe,containerNodeRect:Ni,draggingNodeRect:Si,over:ae.current.over,overlayNodeRect:Mn.rect,scrollableAncestors:Ln,scrollableAncestorRects:_n,windowRect:Ki}),so=Pt?add$1(Pt,ht):null,In=useScrollOffsets(Ln),X=useScrollOffsetsDelta(In),Zn=useScrollOffsetsDelta(In,[Qe]),Hn=add$1(bn,X),Ht=Si?getAdjustedRect(Si,bn):null,sn=Bt&&Ht?D({active:Bt,collisionRect:Ht,droppableRects:He,droppableContainers:J,pointerCoordinates:so}):null,Xn=getFirstCollision(sn,"id"),[qt,Yn]=reactExports.useState(null),v=Wt?bn:add$1(bn,Zn),L=adjustScale(v,(E=qt?.rect)!=null?E:null,Qe),Y=reactExports.useRef(null),F=reactExports.useCallback((T,M)=>{let{sensor:G,options:ee}=M;if(Yt.current==null)return;const Te=at.get(Yt.current);if(!Te)return;const qe=T.nativeEvent,dt=new G({active:Yt.current,activeNode:Te,event:qe,options:ee,context:ae,onAbort(En){if(!at.get(En))return;const{onDragAbort:St}=_t.current,jt={id:En};St?.(jt),_e({type:"onDragAbort",event:jt})},onPending(En,hi,St,jt){if(!at.get(En))return;const{onDragPending:ro}=_t.current,Mi={id:En,constraint:hi,initialCoordinates:St,offset:jt};ro?.(Mi),_e({type:"onDragPending",event:Mi})},onStart(En){const hi=Yt.current;if(hi==null)return;const St=at.get(hi);if(!St)return;const{onDragStart:jt}=_t.current,qo={activatorEvent:qe,active:{id:hi,data:St.data,rect:Rt}};reactDomExports.unstable_batchedUpdates(()=>{jt?.(qo),rt(Status.Initializing),Ke({type:Action.DragStart,initialCoordinates:En,active:hi}),_e({type:"onDragStart",event:qo}),de(Y.current),ft(qe)})},onMove(En){Ke({type:Action.DragMove,coordinates:En})},onEnd:Qt(Action.DragEnd),onCancel:Qt(Action.DragCancel)});Y.current=dt;function Qt(En){return async function(){const{active:St,collisions:jt,over:qo,scrollAdjustedTranslate:ro}=ae.current;let Mi=null;if(St&&ro){const{cancelDrop:mo}=_t.current;Mi={activatorEvent:qe,active:St,collisions:jt,delta:ro,over:qo},En===Action.DragEnd&&typeof mo=="function"&&await Promise.resolve(mo(Mi))&&(En=Action.DragCancel)}Yt.current=null,reactDomExports.unstable_batchedUpdates(()=>{Ke({type:En}),rt(Status.Uninitialized),Yn(null),de(null),ft(null),Y.current=null;const mo=En===Action.DragEnd?"onDragEnd":"onDragCancel";if(Mi){const Li=_t.current[mo];Li?.(Mi),_e({type:mo,event:Mi})}})}}},[at]),Fe=reactExports.useCallback((T,M)=>(G,ee)=>{const Te=G.nativeEvent,qe=at.get(ee);if(Yt.current!==null||!qe||Te.dndKit||Te.defaultPrevented)return;const dt={active:qe};T(G,M.options,dt)===!0&&(Te.dndKit={capturedBy:M.sensor},Yt.current=ee,F(G,M))},[at,F]),Ft=useCombineActivators(H,Fe);useSensorSetup(H),useIsomorphicLayoutEffect(()=>{Qe&&Ae===Status.Initializing&&rt(Status.Initialized)},[Qe,Ae]),reactExports.useEffect(()=>{const{onDragMove:T}=_t.current,{active:M,activatorEvent:G,collisions:ee,over:Te}=ae.current;if(!M||!G)return;const qe={active:M,activatorEvent:G,collisions:ee,delta:{x:Hn.x,y:Hn.y},over:Te};reactDomExports.unstable_batchedUpdates(()=>{T?.(qe),_e({type:"onDragMove",event:qe})})},[Hn.x,Hn.y]),reactExports.useEffect(()=>{const{active:T,activatorEvent:M,collisions:G,droppableContainers:ee,scrollAdjustedTranslate:Te}=ae.current;if(!T||Yt.current==null||!M||!Te)return;const{onDragOver:qe}=_t.current,dt=ee.get(Xn),Qt=dt&&dt.rect.current?{id:dt.id,rect:dt.rect.current,data:dt.data,disabled:dt.disabled}:null,En={active:T,activatorEvent:M,collisions:G,delta:{x:Te.x,y:Te.y},over:Qt};reactDomExports.unstable_batchedUpdates(()=>{Yn(Qt),qe?.(En),_e({type:"onDragOver",event:En})})},[Xn]),useIsomorphicLayoutEffect(()=>{ae.current={activatorEvent:Ve,active:Bt,activeNode:Ze,collisionRect:Ht,collisions:sn,droppableRects:He,draggableNodes:at,draggingNode:vt,draggingNodeRect:Si,droppableContainers:ot,over:qt,scrollableAncestors:Ln,scrollAdjustedTranslate:Hn},Rt.current={initial:Si,translated:Ht}},[Bt,Ze,sn,Ht,at,vt,Si,He,ot,qt,Ln,Hn]),useAutoScroller({...An,delta:ht,draggingRect:Ht,pointerCoordinates:so,scrollableAncestors:Ln,scrollableAncestorRects:_n});const ki=reactExports.useMemo(()=>({active:Bt,activeNode:Ze,activeNodeRect:Qe,activatorEvent:Ve,collisions:sn,containerNodeRect:Ni,dragOverlay:Mn,draggableNodes:at,droppableContainers:ot,droppableRects:He,over:qt,measureDroppableContainers:it,scrollableAncestors:Ln,scrollableAncestorRects:_n,measuringConfiguration:Ce,measuringScheduled:Et,windowRect:Ki}),[Bt,Ze,Qe,Ve,sn,Ni,Mn,at,ot,He,qt,it,Ln,_n,Ce,Et,Ki]),je=reactExports.useMemo(()=>({activatorEvent:Ve,activators:Ft,active:Bt,activeNodeRect:Qe,ariaDescribedById:{draggable:Be},dispatch:Ke,draggableNodes:at,over:qt,measureDroppableContainers:it}),[Ve,Ft,Bt,Qe,Ke,Be,at,qt,it]);return React.createElement(DndMonitorContext.Provider,{value:Le},React.createElement(InternalContext.Provider,{value:je},React.createElement(PublicContext.Provider,{value:ki},React.createElement(ActiveDraggableContext.Provider,{value:L},O)),React.createElement(RestoreFocus,{disabled:A?.restoreFocus===!1})),React.createElement(Accessibility,{...A,hiddenTextDescribedById:Be}));function $i(){const T=kt?.autoScrollEnabled===!1,M=typeof N=="object"?N.enabled===!1:N===!1,G=De&&!T&&!M;return typeof N=="object"?{...N,enabled:G}:{enabled:G}}}),NullContext=reactExports.createContext(null),defaultRole="button",ID_PREFIX="Draggable";function useDraggable(h){let{id:p,data:l,disabled:a=!1,attributes:_}=h;const E=useUniqueId(ID_PREFIX),{activators:C,activatorEvent:A,active:N,activeNodeRect:O,ariaDescribedById:H,draggableNodes:D,over:j}=reactExports.useContext(InternalContext),{role:be=defaultRole,roleDescription:Oe="draggable",tabIndex:ve=0}=_??{},Xe=N?.id===p,Ke=reactExports.useContext(Xe?ActiveDraggableContext:NullContext),[_e,Le]=useNodeRef(),[Ae,rt]=useNodeRef(),De=useSyntheticListeners(C,p),xe=useLatestValue(l);useIsomorphicLayoutEffect(()=>(D.set(p,{id:p,key:E,node:_e,activatorNode:Ae,data:xe}),()=>{const ht=D.get(p);ht&&ht.key===E&&D.delete(p)}),[D,p]);const at=reactExports.useMemo(()=>({role:be,tabIndex:ve,"aria-disabled":a,"aria-pressed":Xe&&be===defaultRole?!0:void 0,"aria-roledescription":Oe,"aria-describedby":H.draggable}),[a,be,ve,Xe,Oe,H.draggable]);return{active:N,activatorEvent:A,activeNodeRect:O,attributes:at,isDragging:Xe,listeners:a?void 0:De,node:_e,over:j,setNodeRef:Le,setActivatorNodeRef:rt,transform:Ke}}function truncate(h,p){return h.length<=p?h:h.slice(0,p-3)+"..."}function displayNumber(h,p){const l=p?.showCurrencySymbol?p?.currencySymbol:"";return formatNumber(h,{...p,currencySymbol:l})}function getBlockTypeColor(h){return{STANDARD:"#3b82f6",DATE:"#10b981",ZODIAC:"#8b5cf6",AGE:"#f59e0b",UNIT:"#ef4444",CART:"#ec4899"}[h]||"#6b7280"}function calculateNewBlockPosition(h,p,l){for(let C=20;C<l-150;C+=170)for(let A=20;A<p-200;A+=220)if(!h.some(O=>{const H=Math.abs(O.positionX-A),D=Math.abs(O.positionY-C);return H<200&&D<150}))return{x:A,y:C};return{x:p/2+Math.random()*100-50,y:l/2+Math.random()*100-50}}function CBlockComponent({block:h,onUpdateMemo:p,onDelete:l,onSelect:a,selected:_,settings:E}){const[C,A]=reactExports.useState(!1),[N,O]=reactExports.useState(h.memoText||""),H=reactExports.useRef(null),{attributes:D,listeners:j,setNodeRef:be,transform:Oe,isDragging:ve}=useDraggable({id:h.blockId,data:{type:"c-block",block:h,blockId:h.blockId,blockValue:h.value}}),Xe=De=>{De.dataTransfer.setData("blockId",h.blockId),De.dataTransfer.setData("blockValue",h.value),De.dataTransfer.effectAllowed="copy"},Ke={transform:CSS.Translate.toString(Oe),left:`${h.positionX}px`,top:`${h.positionY}px`},_e=getBlockTypeColor(h.type),Le=()=>{p(h.blockId,N),A(!1)},Ae=()=>{O(h.memoText||""),A(!1)},rt=()=>{A(!0),setTimeout(()=>{H.current?.focus()},0)};return jsxRuntimeExports.jsxs("div",{ref:be,className:`c-block ${ve?"dragging":""} ${_?"selected":""}`,style:Ke,onClick:De=>a(h.blockId,De.ctrlKey||De.metaKey),onDragStart:Xe,draggable:!0,children:[jsxRuntimeExports.jsxs("div",{className:"c-block-header",style:{backgroundColor:_e},...j,...D,children:[jsxRuntimeExports.jsx("span",{className:"c-block-type",children:h.type}),jsxRuntimeExports.jsxs("div",{className:"c-block-actions",children:[jsxRuntimeExports.jsx("button",{className:"c-block-btn",onPointerDown:De=>De.stopPropagation(),onClick:De=>{De.stopPropagation(),rt()},title:"メモをかく",children:"✎"}),jsxRuntimeExports.jsx("button",{className:"c-block-btn",onPointerDown:De=>De.stopPropagation(),onClick:De=>{De.stopPropagation(),confirm("このマグネットをけしますか？")&&l(h.blockId)},title:"マグネットをけす",children:"🗑️"})]})]}),jsxRuntimeExports.jsxs("div",{className:"c-block-content",children:[jsxRuntimeExports.jsx("div",{className:"c-block-formula",title:h.formulaString,children:truncate(h.formulaString,50)}),jsxRuntimeExports.jsx("div",{className:"c-block-value",children:displayNumber(h.value,E)}),C?jsxRuntimeExports.jsxs("div",{onClick:De=>De.stopPropagation(),children:[jsxRuntimeExports.jsx("textarea",{ref:H,className:"c-block-memo-edit",value:N,onChange:De=>O(De.target.value),onKeyDown:De=>{De.key==="Enter"&&De.ctrlKey?Le():De.key==="Escape"&&Ae()},placeholder:"メモをかいてね (Ctrl+Enterでほぞん、Escでキャンセル)",rows:4}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.5rem"},children:[jsxRuntimeExports.jsx("button",{onClick:Le,style:{flex:1,padding:"0.5rem",backgroundColor:"#95e1d3",color:"white",border:"none",borderRadius:"0.5rem",cursor:"pointer",fontWeight:700},children:"ほぞん"}),jsxRuntimeExports.jsx("button",{onClick:Ae,style:{flex:1,padding:"0.5rem",backgroundColor:"#ff6b6b",color:"white",border:"none",borderRadius:"0.5rem",cursor:"pointer",fontWeight:700},children:"キャンセル"})]})]}):jsxRuntimeExports.jsx("div",{className:"c-block-memo",onClick:De=>{De.stopPropagation(),rt()},style:{cursor:"text",minHeight:h.memoText?"auto":"2rem"},title:"クリックしてメモをかく",children:h.memoText||"メモをかく..."})]})]})}function Canvas({blocks:h,onUpdateBlockPosition:p,onUpdateBlockMemo:l,onDeleteBlock:a,onCondenseAll:_,settings:E}){const[C,A]=reactExports.useState(new Set),N=useSensor(MouseSensor,{activationConstraint:{distance:5}}),O=useSensor(TouchSensor,{activationConstraint:{delay:100,tolerance:5}}),H=useSensors(N,O);reactExports.useEffect(()=>{const _e=Le=>{if((Le.key==="Delete"||Le.key==="Backspace")&&C.size>0){if(Le.target instanceof HTMLTextAreaElement||Le.target instanceof HTMLInputElement)return;Le.preventDefault(),Oe()}else if(Le.ctrlKey&&Le.key==="a"){Le.preventDefault();const Ae=new Set(h.map(rt=>rt.blockId));A(Ae)}else Le.key==="Escape"&&A(new Set)};return window.addEventListener("keydown",_e),()=>window.removeEventListener("keydown",_e)},[C,h]);const D=_e=>{const{active:Le,delta:Ae}=_e;if(Le.data.current?.type==="c-block"){const rt=Le.data.current.block,De=rt.positionX+Ae.x,xe=rt.positionY+Ae.y,at=Math.max(0,De),ht=Math.max(0,xe);p(rt.blockId,at,ht)}},j=(_e,Le)=>{if(Le){const Ae=new Set(C);Ae.has(_e)?Ae.delete(_e):Ae.add(_e),A(Ae)}else A(new Set([_e]))},be=_e=>{_e.target===_e.currentTarget&&A(new Set)},Oe=()=>{if(C.size===0)return;const _e=C.size,Le=_e===1?"このマグネットをけしますか？":`${_e}このマグネットをけしますか？`;confirm(Le)&&(C.forEach(Ae=>a(Ae)),A(new Set))},ve=()=>{const _e=new Set(h.map(Le=>Le.blockId));A(_e)},Xe=()=>{A(new Set)},Ke=()=>{if(!E?.showDependencyLines||C.size===0)return null;const _e=[];return C.forEach(Le=>{const Ae=h.find(rt=>rt.blockId===Le);Ae&&(Ae.parentIds.forEach(rt=>{const De=h.find(xe=>xe.blockId===rt);if(De){const xe=Ae.positionX+96,at=Ae.positionY+56,ht=De.positionX+96,ot=De.positionY+56;_e.push(jsxRuntimeExports.jsx("svg",{className:"dependency-line highlighted",style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none"},children:jsxRuntimeExports.jsx("line",{x1:xe,y1:at,x2:ht,y2:ot})},`parent-${Le}-${rt}`))}}),Ae.childIds.forEach(rt=>{const De=h.find(xe=>xe.blockId===rt);if(De){const xe=Ae.positionX+96,at=Ae.positionY+56,ht=De.positionX+96,ot=De.positionY+56;_e.push(jsxRuntimeExports.jsx("svg",{className:"dependency-line highlighted",style:{position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none"},children:jsxRuntimeExports.jsx("line",{x1:xe,y1:at,x2:ht,y2:ot})},`child-${Le}-${rt}`))}}))}),_e};return jsxRuntimeExports.jsxs("div",{className:"canvas-container",onClick:be,children:[h.length>0&&jsxRuntimeExports.jsx("button",{className:"condense-btn",onClick:_,title:"ぜんぶのマグネットをまとめる",children:jsxRuntimeExports.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsx("path",{d:"M12 3 L12 9 M9 7 L12 9 L15 7",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),jsxRuntimeExports.jsx("path",{d:"M12 21 L12 15 M9 17 L12 15 L15 17",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),jsxRuntimeExports.jsx("path",{d:"M3 12 L9 12 M7 9 L9 12 L7 15",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),jsxRuntimeExports.jsx("path",{d:"M21 12 L15 12 M17 9 L15 12 L17 15",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),jsxRuntimeExports.jsx("circle",{cx:"12",cy:"12",r:"2",fill:"white"})]})}),C.size>0&&jsxRuntimeExports.jsxs("div",{className:"canvas-toolbar",children:[jsxRuntimeExports.jsxs("div",{className:"toolbar-info",children:[C.size,"この マグネット をせんたくちゅう"]}),jsxRuntimeExports.jsx("button",{className:"toolbar-btn toolbar-btn-danger",onClick:Oe,title:"選択したブロックを削除",children:"🗑️ けす"}),jsxRuntimeExports.jsx("button",{className:"toolbar-btn",onClick:ve,title:"すべて選択 (Ctrl+A)",children:"☑️ ぜんぶ"}),jsxRuntimeExports.jsx("button",{className:"toolbar-btn",onClick:Xe,title:"選択解除 (Esc)",children:"✕ とりけし"})]}),jsxRuntimeExports.jsx(DndContext,{sensors:H,onDragEnd:D,children:jsxRuntimeExports.jsxs("div",{className:"canvas",children:[Ke(),h.map(_e=>jsxRuntimeExports.jsx(CBlockComponent,{block:_e,onUpdateMemo:l,onDelete:a,onSelect:j,selected:C.has(_e.blockId),settings:E?{currencySymbol:E.currencySymbol,showCurrencySymbol:E.showCurrencySymbol,useThousandsSeparator:E.useThousandsSeparator,decimalPlaces:E.decimalPlaces}:void 0},_e.blockId)),h.length===0&&jsxRuntimeExports.jsxs("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center",color:"var(--text-muted)"},children:[jsxRuntimeExports.jsx("h2",{style:{fontSize:"1.5rem",marginBottom:"1rem"},children:"けいさんノートへようこそ！"}),jsxRuntimeExports.jsx("p",{style:{fontSize:"1rem"},children:"ひだりのでんたくで、けいさんしてみよう"}),jsxRuntimeExports.jsx("p",{style:{fontSize:"0.875rem",marginTop:"0.5rem"},children:"けっかがマグネットになって、こっちにでてくるよ！"})]})]})})]})}var blockly$1={exports:{}},blockly_compressed$1={exports:{}},blockly_compressed=blockly_compressed$1.exports,hasRequiredBlockly_compressed;function requireBlockly_compressed(){return hasRequiredBlockly_compressed||(hasRequiredBlockly_compressed=1,(function(h,p){(function(l,a){h.exports=a()})(blockly_compressed,function(){var l={},a,_,E,C,A,N,O,H,D,j,be,Oe,ve,Xe,Ke,_e,Le,Ae,rt,De,xe,at,ht,ot,Je,Rt,Bt,Yt,kt,de,Ve,ft,_t,Be,J,Ce,He,it,Et,Ze,Pt,An,tt,Qe,Ni,ae,We,Mn,vt,Si,Wt,Yi,Ki,Ln,_n,bn,so,In,X,Zn,Hn,Ht,sn,Xn,qt,Yn,v,L,Y,F,Fe,Ft,ki,je,$i,T,M,G,ee,Te,qe,dt,Qt,En,hi,St,jt,qo,ro,Mi,mo,Li,Tn,Qn,qi,fs,vl,Ns,Qs,wo,zr,ks,rn,lo,Ji,Kn,er,tr,Jo,ps,gs,yl,nr,Sl,Ut,$s,uo,mi,Wr,Ic,_u,No,It,Ms,_i,Ci,Zo,Cl,Qo,Rl,jr,ir,Oc,zt,pa,Il,xh,Di,ms,_o,es,Ls,or,wn,gn,_s,sr,bs,di,ga,xi,ko,bu,Ds,Mo,xs,Ol,$a,oi,rr,Eu,ao,Tu,Bs,lr,Es,Zi,vu,ma,Ac,yu,Xr,Su,wc,Nc,bo,ur,Al,_a,ba,Ri,wl,ar,kc,Cu,Mc,Ea,Nl,Ta,Eo,kl,va,Ps,Ml,ya,Lc,cr,ts,Dc,Ru,Ll,Sa,Iu,Ca,Fs,Ra,xc,Bc,hr,Ou,Us,dr,Ts,Dl,Yr,co,Nn,fr,ho,Au,xl,Pc,pr,Ia,Kr,Hs,fi,d,g,b,y,R,w,x,U,W,q,ie,z,se,Z,te,ne,oe,ue,$e,ye,ke,ze,nt,Pe,Ye,et,Ue,Ge,Tt,Ct,At,Ii,Ot,ei,vn,qr,Dn,Bi,wu,To,Bh,gr,pf,Oa,Bl,Fc,Nu,Ph,gf,ns,ku,$r,Aa,Mu,vo,yo,Jr,Lo,vs,is,$f,Fh,mr,Uh,xn,Bn,Kt,_r,os,Zr,br,mf,_f,Lu,Pl,Hh,Du,Gh,Fl,ys,Qr,Er,Uc,Ss,xu,Hc,Cs,Pi,wa,Gc,Dp,xp,Bp,si,Na,Bu,Ul,Vh,Pu,Fu,Pp,pt,Do,Oi,yn,Rs,el,$t,kn,zh,Vc,zc,Wh,bf,Tr,tl,jh,Xh,Hl,vr,Wc,ka,jc,Uu,nl,Ef,Gs,xo,Xc,ss,Fi,Hu,Yh,Gl,Ma,Is,Yc,La,Vl,Kc,Kh,qh,Da,So,Bo,yr,Jh,Zh,il,fo,ri,qc,rs,xt,$n,ti,Gu,ol,Sr,xa,Ba,zl,Qh,Gn,ed,Pa,Tf,td,Fp,Cr,Jc,Vu,Qi,ni,zu,Wu,Fa,Zc,Vs,Ua,Qc,eh,nd,id,vf,yf,Sf,Cf,od,Rf,Up,If,Of,sd,th,rd,ld,ud,ad,cd,hd,Ha,Wl,Af,Ga,Va,dd,nh,wf,fd,pd,gd,$d,md,_d,Nf,bd,Ed,kf,Mf,Hp,ge;a=function(e,t,i,s){if(!(e instanceof Re)&&typeof e!="string"||`${e}`.trim()==="")throw Error('Invalid type "'+e+'". The type must be a non-empty string or a Blockly.registry.Type.');if(e=`${e}`.toLowerCase(),typeof t!="string"||t.trim()==="")throw Error('Invalid name "'+t+'". The name must be a non-empty string.');const c=t.toLowerCase();if(!i)throw Error("Can not register a null value");let m=sl[e],I=za[e];if(m||(m=sl[e]=Object.create(null),I=za[e]=Object.create(null)),_(e,i),!s&&m[c]&&m[c]!==i)throw Error('Name "'+c+'" with type "'+e+'" already registered.');m[c]=i,I[c]=t},_=function(e,t){switch(e){case String(Re.FIELD):if(typeof t.fromJson!="function")throw Error('Type "'+e+'" must have a fromJson function')}},E=function(e,t){e=`${e}`.toLowerCase(),t=t.toLowerCase();const i=sl[e];i&&i[t]?(delete sl[e][t],delete za[e][t]):console.warn("Unable to unregister ["+t+"]["+e+"] from the registry.")},C=function(e,t,i){e=`${e}`.toLowerCase(),t=t.toLowerCase();const s=sl[e];if(!s||!s[t]){if(t="Unable to find ["+t+"]["+e+"] in the registry.",i)throw Error(t+" You must require or register a "+e+" plugin.");return console.warn(t),null}return s[t]},A=function(e,t){return e=`${e}`.toLowerCase(),t=t.toLowerCase(),(e=sl[e])?!!e[t]:!1},N=function(e,t,i){return C(e,t,i)},O=function(e,t,i){return C(e,t,i)},H=function(e,t,i){e=`${e}`.toLowerCase();var s=sl[e];if(!s){if(s=`Unable to find [${e}] in the registry.`,i)throw Error(`${s} You must require or register a ${e} plugin.`);return console.warn(s),null}if(!t)return s;e=za[e],i=Object.create(null);for(const c of Object.keys(s))i[e[c]]=s[c];return i},D=function(e,t,i){return t=t.plugins[String(e)]||Po,typeof t=="function"?t:N(e,t,i)},j=function(e,t){be(),ih=setTimeout(function(){t&&t.handleRightClick(e)},Vp)},be=function(){ih&&(clearTimeout(ih),ih=0)},Oe=function(){ja=null},ve=function(e){return!e.type.startsWith("pointer")||e instanceof PointerEvent&&Ke(e)},Xe=function(e){return`${e.pointerId}`},Ke=function(e){const t=Xe(e);return ja?ja===t:e.type==="pointerdown"?(ja=t,!0):!1},_e=function(e,t,i,s,c){function m(B){(c||ve(B))&&(i?s.call(i,B):s(B))}const I=[];if(t in Rr)for(let B=0;B<Rr[t].length;B++){const Se=Rr[t][B];e.addEventListener(Se,m,!1),I.push([e,Se,m])}else e.addEventListener(t,m,!1),I.push([e,t,m]);return I},Le=function(e,t,i,s){function c(I){i?s.call(i,I):s(I)}const m=[];if(t in Rr)for(let I=0;I<Rr[t].length;I++){const B=Rr[t][I];e.addEventListener(B,c,!1),m.push([e,B,c])}else e.addEventListener(t,c,!1),m.push([e,t,c]);return m},Ae=function(e){const t=e[e.length-1][2];for(;e.length;){const[i,s,c]=e.pop();i.removeEventListener(s,c,!1)}return t},rt=function(e){if(e.target instanceof HTMLElement){if(e.target.isContentEditable||e.target.getAttribute("data-is-text-input")==="true")return!0;if(e.target instanceof HTMLInputElement)return e=e.target,e.type==="text"||e.type==="number"||e.type==="email"||e.type==="password"||e.type==="search"||e.type==="tel"||e.type==="url";if(e.target instanceof HTMLTextAreaElement)return!0}return!1},De=function(e){return e.ctrlKey&&Sd?!0:e.button===2},xe=function(e,t,i){const s=t.createSVGPoint();return s.x=e.clientX,s.y=e.clientY,i||(i=t.getScreenCTM().inverse()),s.matrixTransform(i)},at=function(e){switch(e.deltaMode){default:return{x:e.deltaX,y:e.deltaY};case 1:return{x:e.deltaX*pi,y:e.deltaY*pi};case 2:return{x:e.deltaX*Ui,y:e.deltaY*Ui}}},ht=function(){return"blockly-"+(jp++).toString(36)},ot=function(){return qa.genUid()},Je=function(e){return e.type===ce.BLOCK_CREATE},Rt=function(e){return e.type===ce.BLOCK_DELETE},Bt=function(e){return e.type===ce.BLOCK_CHANGE},Yt=function(e){return e.type===ce.BLOCK_FIELD_INTERMEDIATE_CHANGE},kt=function(e){return e.type===ce.BLOCK_MOVE},de=function(e){return e.type===ce.CLICK},Ve=function(e){return e.type===ce.BUBBLE_OPEN},ft=function(e){return e.type===ce.VIEWPORT_CHANGE},l.setRecordUndo$$module$build$src$core$events$utils=function(e){sh=e},_t=function(){return sh},Be=function(e){zf.fireInternal(e)},J=function(e){if(Ze()){if(!Or.length)try{requestAnimationFrame(()=>{setTimeout(Ce,0)})}catch{setTimeout(Ce,0)}He(e)}},Ce=function(){const e=it(Or);Or.length=0;for(const t of e){if(!t.workspaceId)continue;let i;(i=sn(t.workspaceId))==null||i.fireChangeListener(t)}},He=function(e){if(Bt(e)&&e.element==="mutation"){let t;for(t=Or.length;t>0;t--){const i=Or[t-1];if(i.group!==e.group||i.workspaceId!==e.workspaceId||!kt(i)||i.newParentId!==e.blockId)break}Or.splice(t,0,e)}else Or.push(e)},it=function(e){const t=[];for(const i of e)if(e=t[t.length-1],!i.isNull())if(e&&e.workspaceId===i.workspaceId&&e.group===i.group)if(kt(i)&&kt(e)&&i.blockId===e.blockId){if(e.newParentId=i.newParentId,e.newInputName=i.newInputName,e.newCoordinate=i.newCoordinate,e.reason||i.reason){let s,c;e.reason=Array.from(new Set(((s=e.reason)!=null?s:[]).concat((c=i.reason)!=null?c:[])))}}else Bt(i)&&Bt(e)&&i.blockId===e.blockId&&i.element===e.element&&i.name===e.name?e.newValue=i.newValue:ft(i)&&ft(e)?(e.viewTop=i.viewTop,e.viewLeft=i.viewLeft,e.scale=i.scale,e.oldScale=i.oldScale):de(i)&&Ve(e)||t.push(i);else t.push(i);return e=t.filter(i=>!i.isNull())},Et=function(){for(let e=0,t;t=Or[e];e++)t.recordUndo=!1},l.disable$$module$build$src$core$events$utils=function(){Za++},l.enable$$module$build$src$core$events$utils=function(){Za--},Ze=function(){return Za===0},l.getGroup$$module$build$src$core$events$utils=function(){return Vf},l.setGroup$$module$build$src$core$events$utils=function(e){zf.setGroupInternal(e)},Pt=function(e){Vf=typeof e=="boolean"?e?ot():"":e},An=function(e){const t=[];e=e.getDescendants(!1);for(let i=0,s;s=e[i];i++)t[i]=s.id;return t},tt=function(e,t){const i=Qe(e.type);if(!i)throw Error("Unknown event type.");return i.fromJson(e,t)},Qe=function(e){const t=N(Re.EVENT,e);if(!t)throw Error(`Event type ${e} not found in registry.`);return t},Ni=function(e){if((kt(e)||Je(e))&&e.workspaceId){var t=sn(e.workspaceId);if(!e.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(e=t.getBlockById(e.blockId)){const i=sh;try{sh=!1;const s=e.getParent();if(s&&!s.hasDisabledReason(rh)){const c=e.getDescendants(!1);for(let m=0,I;I=c[m];m++)I.setDisabledReason(!1,rh)}else if((e.outputConnection||e.previousConnection)&&!t.isDragging())do e.setDisabledReason(!0,rh),e=e.getNextBlock();while(e)}finally{sh=i}}}},ae=function(e,t,i){e=document.createElementNS(Qa,`${e}`);for(const s in t)e.setAttribute(s,`${t[s]}`);return i&&i.appendChild(e),e},We=function(e,t){return t=t.split(" "),t.every(i=>e.classList.contains(i))?!1:(e.classList.add(...t),!0)},Mn=function(e,t){e.classList.remove(...t.split(" "))},vt=function(e,t){return t=t.split(" "),t.every(i=>!e.classList.contains(i))?!1:(e.classList.remove(...t),!0)},Si=function(e,t){return e.classList.contains(t)},Wt=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null},Yi=function(e,t){const i=t.nextSibling;if(t=t.parentNode,!t)throw Error("Reference node has no parent.");i?t.insertBefore(e,i):t.appendChild(e)},Ki=function(e,t){e.style.transform=t,e.style["-webkit-transform"]=t},Ln=function(){lh++,Os||(Os=Object.create(null))},_n=function(){lh--,lh||(Os=null)},bn=function(e){const t=e.textContent+`
`+e.className.baseVal;var i;return Os&&(i=Os[t])||(i=window.getComputedStyle(e),i=In(e,i.fontSize,i.fontWeight,i.fontFamily),Os&&(Os[t]=i)),i},so=function(e,t,i,s){return In(e,t+"pt",i,s)},In=function(e,t,i,s){const c=e.textContent;e=c+`
`+e.className.baseVal;var m;return Os&&(m=Os[e])||(Yl||(m=document.createElement("canvas"),m.className="blocklyComputeCanvas",document.body.appendChild(m),Yl=m.getContext("2d")),c&&Yl?(Yl.font=i+" "+t+" "+s,m=Yl.measureText(c).width):m=0,Os&&(Os[e]=m)),m},X=function(e,t,i,s){const c=document.createElement("span");c.style.font=i+" "+t+" "+s,c.textContent=e,e=document.createElement("div"),e.style.width="1px",e.style.height="0",t=document.createElement("div"),t.style.display="flex",t.style.position="fixed",t.style.top="0",t.style.left="0",t.appendChild(c),t.appendChild(e),document.body.appendChild(t),i={height:0,baseline:0};try{t.style.alignItems="baseline",i.baseline=e.offsetTop-c.offsetTop,t.style.alignItems="flex-end",i.height=e.offsetTop-c.offsetTop}finally{document.body.removeChild(t)}return i},l.getFocusManager$$module$build$src$core$focus_manager=function(){return Hi.getFocusManager()},Zn=function(e){return e&&typeof e.getFocusableElement=="function"&&typeof e.getFocusableTree=="function"&&typeof e.onNodeFocus=="function"&&typeof e.onNodeBlur=="function"&&typeof e.canBeFocused=="function"},Hn=function(e){return Zn(e)&&typeof e.id=="string"&&typeof e.workspace=="object"&&typeof e.select=="function"&&typeof e.unselect=="function"},Ht=function(e,t){for(const i in t)t[i]!==null&&Array.isArray(t[i])?e[i]=Ht(e[i]||[],t[i]):e[i]=t[i]!==null&&typeof t[i]=="object"?Ht(e[i]||Object.create(null),t[i]):t[i];return e},sn=function(e){return uh[e]||null},Xn=function(){const e=[];for(const t in uh)e.push(uh[t]);return e},qt=function(e){uh[e.id]=e},Yn=function(e){delete uh[e.id]},v=function(){return jf},L=function(e){jf=e},Y=function(){const e=l.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode();return e&&Hn(e)?e:null},F=function(e){l.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)},Fe=function(e){const t=Y();let i,s,c,m;const I=new(Qe(ce.SELECTED))((i=t?.id)!=null?i:null,(s=e?.id)!=null?s:null,(m=(c=e?.workspace.id)!=null?c:t?.workspace.id)!=null?m:"");Be(I)},Ft=function(){return wr},ki=function(e){wr=e},je=function(e){for(;e.options.parentWorkspace;)e=e.options.parentWorkspace;const t=e.getParentSvg(),i=e.getCachedParentSvgSize();var s=t.parentElement;if(s instanceof HTMLElement){var c=s.offsetWidth;s=s.offsetHeight,i.width!==c&&(t.setAttribute("width",c+"px"),e.setCachedParentSvgSize(c,null)),i.height!==s&&(t.setAttribute("height",s+"px"),e.setCachedParentSvgSize(null,s)),e.resize()}},$i=function(e,t){const i=Object.create(null),s=e.getDescendants(!0);t&&(e=e.getNextBlock())&&(e=s.indexOf(e),s.splice(e,s.length-e));for(let c=0,m;m=s[c];c++)i[m.type]?i[m.type]++:i[m.type]=1;return i},T=function(e){return function(){this.jsonInit(e)}},M=function(e){Xf.defineBlocksWithJsonArrayInternal(e)},G=function(e){l.defineBlocks$$module$build$src$core$common(l.createBlockDefinitionsFromJsonArray$$module$build$src$core$common(e))},l.createBlockDefinitionsFromJsonArray$$module$build$src$core$common=function(e){const t={};for(let i=0;i<e.length;i++){const s=e[i];if(!s){console.warn(`Block definition #${i} in JSON array is ${s}. Skipping`);continue}const c=s.type;c?t[c]={init:T(s)}:console.warn(`Block definition #${i} in JSON array is missing a type attribute. Skipping.`)}return t},l.defineBlocks$$module$build$src$core$common=function(e){for(const t of Object.keys(e)){const i=e[t];t in Vn&&console.warn(`Block definition "${t}" overwrites previous definition.`),Vn[t]=i}},ee=function(e){let t=v();const i=l.getFocusManager$$module$build$src$core$focus_manager().getFocusedTree();for(const s of Xn())if(i===s){t=s;break}!rt(e)&&t&&(!t.rendered||t.isFlyout||t.isVisible())&&mn.registry.onKeyDown(t,e)},Te=function(e,t){return t=e.indexOf(t),t===-1?!1:(e.splice(t,1),!0)},qe=function(e){if(Cd)throw Error("CSS already injected");Rd+=`
`+e},dt=function(e,t){Cd||(Cd=!0,e&&(e=t.replace(/[\\/]$/,""),t=Rd.replace(/<<<PATH>>>/g,e),Rd="",e=document.createElement("style"),e.id="blockly-common-style",t=document.createTextNode(t),e.appendChild(t),document.head.insertBefore(e,document.head.firstChild)))},Qt=function(e){return Id.getSizeInternal(e)},En=function(e){if(St(e,"display")!=="none")return hi(e);const t=e.style,i=t.display,s=t.visibility,c=t.position;t.visibility="hidden",t.position="absolute",t.display="inline";const m=e.offsetWidth;return e=e.offsetHeight,t.display=i,t.position=c,t.visibility=s,new Mt(m,e)},hi=function(e){return new Mt(e.offsetWidth,e.offsetHeight)},St=function(e,t){return e=window.getComputedStyle(e),e[t]||e.getPropertyValue(t)},jt=function(e){const t=new Ne(0,0);e=e.getBoundingClientRect();var i=document.documentElement;return i=new Ne(window.pageXOffset||i.scrollLeft,window.pageYOffset||i.scrollTop),t.x=e.left+i.x,t.y=e.top+i.y,t},qo=function(){const e=document.body,t=document.documentElement;return new Ne(e.scrollLeft||t.scrollLeft,e.scrollTop||t.scrollTop)},ro=function(e){const t=parseFloat(St(e,"borderLeftWidth")),i=parseFloat(St(e,"borderRightWidth")),s=parseFloat(St(e,"borderTopWidth"));return e=parseFloat(St(e,"borderBottomWidth")),new Nt(s,e,t,i)},Mi=function(e,t,i){e=mo(e,t,i),t.scrollLeft=e.x,t.scrollTop=e.y},mo=function(e,t,i){var s=jt(e),c=jt(t),m=ro(t);const I=s.x-c.x-m.left;return s=s.y-c.y-m.top,c=hi(e),e=t.clientWidth-c.width,c=t.clientHeight-c.height,m=t.scrollLeft,t=t.scrollTop,i?(m+=I-e/2,t+=s-c/2):(m+=Math.min(I,Math.max(I-e,0)),t+=Math.min(s,Math.max(s-c,0))),new Ne(m,t)},Li=function(e){const t=new Ne(0,0);var i=e.x&&e.getAttribute("x");const s=e.y&&e.getAttribute("y");return i&&(t.x=parseInt(i)),s&&(t.y=parseInt(s)),(i=(i=e.getAttribute("transform"))&&i.match(ah))&&(t.x+=Number(i[1]),i[3]&&(t.y+=Number(i[3]))),(e=e.getAttribute("style"))&&e.includes("translate")&&(e=e.match(Jf))&&(t.x+=Number(e[1]),e[3]&&(t.y+=Number(e[3]))),t},Tn=function(e){let t=0,i=0;for(;e;){const s=Li(e);if(t+=s.x,i+=s.y,(" "+(e.getAttribute("class")||"")+" ").includes(" injectionDiv "))break;e=e.parentNode}return new Ne(t,i)},Qn=function(){const e=qo();return new Nt(e.y,document.documentElement.clientHeight+e.y,e.x,document.documentElement.clientWidth+e.x)},qi=function(){const e=document.documentElement,t=window;return new Ne(t.pageXOffset||e.scrollLeft,t.pageYOffset||e.scrollTop)},fs=function(e,t){var i=t.x;t=t.y;const s=e.getInjectionDiv().getBoundingClientRect();return i=new Ne(i-s.left,t-s.top),t=e.getOriginOffsetInPixels(),Ne.difference(i,t).scale(1/e.scale)},vl=function(e,t){var i=t.scale(e.scale);t=i.x,i=i.y;const s=e.getInjectionDiv().getBoundingClientRect();return e=e.getOriginOffsetInPixels(),new Ne(t+s.left+e.x,i+s.top+e.y)},Ns=function(e){({document:Od=Od,DOMParser:ec=ec,XMLSerializer:tc=tc}=e),ch=new ec,Ei=new tc},l.createElement$$module$build$src$core$utils$xml=function(e){return Od.createElementNS(zn,e)},l.createTextNode$$module$build$src$core$utils$xml=function(e){return Od.createTextNode(e)},l.textToDom$$module$build$src$core$utils$xml=function(e){let t=ch.parseFromString(e,"text/xml");if(t&&t.documentElement&&!t.getElementsByTagName("parsererror").length)return t.documentElement;if((t=ch.parseFromString(e,"text/html"))&&t.body.firstChild&&t.body.firstChild.nodeName.toLowerCase()==="xml")return t.body.firstChild;throw Error(`DOMParser was unable to parse: ${e}`)},Qs=function(e){return wo(Ei.serializeToString(e))},wo=function(e){return e.replace(Fo,t=>`&#${t.charCodeAt(0)};`)},zr=function(e){return e?((e instanceof Element||typeof e=="string")&&(e=ps(e),e=er(e)),ks(e),e):null},ks=function(e){const t=e.kind;if(e=e.contents,t&&t!==Zf&&t!==Ad)throw Error("Invalid toolbox kind "+t+". Please supply either "+Zf+" or "+Ad);if(!e)throw Error("Toolbox must have a contents attribute.")},rn=function(e){return e?e.contents?e.contents:Array.isArray(e)&&e.length>0&&!e[0].nodeType?e:tr(e):[]},lo=function(e){return Xp.hasCategoriesInternal(e)},Ji=function(e){if(!e)return!1;const t=e.kind;return t?t===Ad:!!e.contents.filter(i=>i.kind.toUpperCase()==="CATEGORY").length},Kn=function(e){return e&&e.contents?!!e.contents.filter(function(t){return t.kind.toUpperCase()==="CATEGORY"}).length:!1},er=function(e){const t={contents:tr(e)};return e instanceof Node&&Jo(e,t),t},tr=function(e){const t=[];let i=e.childNodes;i||(i=e);for(let s=0,c;c=i[s];s++){if(!c.tagName)continue;e={};const m=c.tagName.toUpperCase();e.kind=m,m==="BLOCK"?e.blockxml=c:c.childNodes&&c.childNodes.length>0&&(e.contents=tr(c)),Jo(c,e),t.push(e)}return t},Jo=function(e,t){for(let i=0;i<e.attributes.length;i++){const s=e.attributes[i];s.nodeName.includes("css-")?(t.cssconfig=t.cssconfig||{},t.cssconfig[s.nodeName.replace("css-","")]=s.value):t[s.nodeName]=s.value}},ps=function(e){let t=null;if(e)if(typeof e=="string"){if(t=l.textToDom$$module$build$src$core$utils$xml(e),t.nodeName.toLowerCase()!=="xml")throw TypeError("Toolbox should be an <xml> document.")}else e instanceof Element&&(t=e);return t},gs=function(e,t,i,s,c,m){const I=m.scrollbar&&m.scrollbar.canScrollVertically();return e.horizontal===po.LEFT?(i=c.absoluteMetrics.left+i,I&&m.RTL&&(i+=qn.scrollbarThickness)):(i=c.absoluteMetrics.left+c.viewMetrics.width-t.width-i,I&&!m.RTL&&(i-=qn.scrollbarThickness)),e.vertical===ui.TOP?e=c.absoluteMetrics.top+s:(e=c.absoluteMetrics.top+c.viewMetrics.height-t.height-s,m.scrollbar&&m.scrollbar.canScrollHorizontally()&&(e-=qn.scrollbarThickness)),new Nt(e,e+t.height,i,i+t.width)},yl=function(e,t){return{horizontal:t.toolboxMetrics.position===Lt.LEFT||e.horizontalLayout&&!e.RTL?po.RIGHT:po.LEFT,vertical:t.toolboxMetrics.position===Lt.BOTTOM?ui.TOP:ui.BOTTOM}},nr=function(e,t,i,s){const c=e.left,m=e.right-e.left,I=e.bottom-e.top;for(let B=0;B<s.length;B++){const Se=s[B];e.intersects(Se)&&(e=i===al.UP?Se.top-I-t:Se.bottom+t,e=new Nt(e,e+I,c,c+m),B=-1)}return e},Sl=function(e,t){a(Re.SERIALIZER,e,t)},Ut=function(e){E(Re.SERIALIZER,e)},$s=function(e,{addCoordinates:t=!1,saveIds:i=!0}={}){const s=e.workspace,c=Object.create(null);return c.height=e.getSize().height,c.width=e.getSize().width,i&&(c.id=e.id),t&&(t=e.getRelativeToSurfaceXY(),c.x=s.RTL?s.getWidth()-t.x:t.x,c.y=t.y),e.getText()&&(c.text=e.getText()),e.isCollapsed()&&(c.collapsed=!0),e.isOwnEditable()||(c.editable=!1),e.isOwnMovable()||(c.movable=!1),e.isOwnDeletable()||(c.deletable=!1),c},uo=function(e,t,{recordUndo:i=!1}={}){const s=_t();if(l.setRecordUndo$$module$build$src$core$events$utils(i),i=t.newComment(e.id),e.text!==void 0&&i.setText(e.text),e.x!==void 0||e.y!==void 0){const m=i.getRelativeToSurfaceXY();let I,B=(I=e.x)!=null?I:m.x;B=t.RTL?t.getWidth()-B:B;var c;t=(c=e.y)!=null?c:m.y,i.moveTo(new Ne(B,t))}if(e.width!==void 0||e.height){c=i.getSize();let m,I;i.setSize(new Mt((m=e.width)!=null?m:c.width,(I=e.height)!=null?I:c.height))}return e.collapsed!==void 0&&i.setCollapsed(e.collapsed),e.editable!==void 0&&i.setEditable(e.editable),e.movable!==void 0&&i.setMovable(e.movable),e.deletable!==void 0&&i.setDeletable(e.deletable),l.setRecordUndo$$module$build$src$core$events$utils(s),i},mi=function(e,t){a(Re.PASTER,e,t)},Wr=function(e){E(Re.PASTER,e)},Ic=function(e){const t=e.workspace,i=e.getRelativeToSurfaceXY(),s=new Ne(0,0),c=t.getTopComments(!1).filter(m=>m.id!==e.id).map(m=>m.getRelativeToSurfaceXY());for(;_u(Ne.sum(i,s),c);)s.translate(t.RTL?-30:30,30);e.moveTo(Ne.sum(i,s))},_u=function(e,t){return t.some(i=>Math.abs(i.x-e.x)<=1&&Math.abs(i.y-e.y)<=1)},No=function(e,t){e.setAttribute(hh,t)},It=function(e,t,i){Array.isArray(i)&&(i=i.join(" ")),e.setAttribute(Yp+t,`${i}`)},Ms=function(e){return e&&typeof e.saveState=="function"&&typeof e.loadState=="function"},_i=function(e){return Qo(e),Cl()?(Rl(),Promise.resolve()):(Zl||(Zl=new Promise(t=>{Xs=t,ii=window.requestAnimationFrame(()=>{Rl(),t()})})),Zl)},Ci=function(){return Zl||Promise.resolve()},Zo=function(e){e||window.cancelAnimationFrame(ii),Rl(e),!e&&Xs&&Xs()},Cl=function(){return Pf},Qo=function(e){Dr.add(e),Jl.set(e,l.getGroup$$module$build$src$core$events$utils());const t=e.getParent();t?Qo(t):$o.add(e)},Rl=function(e){const t=e?new Set([e]):new Set([...$o].map(m=>m.workspace)),i=[...$o].filter(ir).filter(m=>t.has(m.workspace));for(var s of i)Oc(s);for(const m of t)m.resizeContents();for(var c of i)s=c.getRelativeToSurfaceXY(),c.updateComponentLocations(s);for(const m of i)c=l.getGroup$$module$build$src$core$events$utils(),(s=Jl.get(m))&&l.setGroup$$module$build$src$core$events$utils(s),m.bumpNeighbours(),l.setGroup$$module$build$src$core$events$utils(c);for(const m of i)jr(m);e||(Zl=null)},jr=function(e){$o.delete(e),Dr.delete(e),Jl.delete(e);for(const t of e.getChildren(!1))jr(t)},ir=function(e){return!e.isDisposed()&&!e.getParent()},Oc=function(e){if(Dr.has(e)&&e.initialized){for(const t of e.getChildren(!1))Oc(t);e.renderEfficiently()}},zt=function(e,t){dh(e,t)},pa=function(e=xd){dh=e},Il=function(e,t){fh(e,t)},xh=function(e=ep){fh=e},Di=function(e,t,i){dl(e,t,i)},ms=function(e=ph){dl=e},_o=function(e,t){fl(e,t)},es=function(e=yi){fl=e},Ls=function(e){return e&&typeof e.getProcedureDef=="function"},or=function(e){return e&&typeof e.getProcedureCall=="function"&&typeof e.renameProcedure=="function"},wn=function(e){return e.getVariableModel!==void 0},gn=function(e,t,i,s){e=e+" was deprecated in "+t+" and will be deleted in "+i+".",s&&(e+=`
Use `+s+" instead."),xr.has(e)||(xr.add(e),console.warn(e))},l.allUsedVarModels$$module$build$src$core$variables=function(e){e=e.getAllBlocks(!1);const t=new Set;for(let i=0;i<e.length;i++){const s=e[i].getVarModels();if(s)for(let c=0;c<s.length;c++){const m=s[c];m.getId()&&t.add(m)}}return Array.from(t.values())},l.allDeveloperVariables$$module$build$src$core$variables=function(e){e=e.getAllBlocks(!1);const t=new Set;for(let s=0,c;c=e[s];s++){var i=c.getDeveloperVariables;if(i){i=i();for(let m=0;m<i.length;m++)t.add(i[m])}}return Array.from(t.values())},_s=function(e){return sr(e,!1)},sr=function(e,t=!0){return Vn.variables_set||Vn.variables_get||console.warn("There are no variable blocks, but there is a variable category."),t?(gn("The XML return value of Blockly.Variables.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),ga(e)):(e.registerButtonCallback("CREATE_VARIABLE",function(i){Mo(i.getTargetWorkspace())}),[{kind:"button",text:"%{BKY_NEW_VARIABLE}",callbackkey:"CREATE_VARIABLE"},...di(e,e.getVariableMap().getVariablesOfType(""),!0)])},bs=function(e){return{VAR:{name:e.getName(),type:e.getType()}}},di=function(e,t,i,s="variables_get",c="variables_set"){i&&(i=Vn.math_change),e=[];const m=t.slice(-1)[0];return m&&(Vn[c]&&e.push({kind:"block",type:c,gap:i?8:24,fields:bs(m)}),i&&e.push({kind:"block",type:"math_change",gap:Vn[s]?20:8,fields:bs(m),inputs:{DELTA:{shadow:{type:"math_number",fields:{NUM:1}}}}})),Vn[s]&&e.push(...t.sort(lr).map(I=>({kind:"block",type:s,gap:8,fields:bs(I)}))),e},ga=function(e){let t=[];const i=document.createElement("button");return i.setAttribute("text","%{BKY_NEW_VARIABLE}"),i.setAttribute("callbackKey","CREATE_VARIABLE"),e.registerButtonCallback("CREATE_VARIABLE",function(s){Mo(s.getTargetWorkspace())}),t.push(i),e=xi(e),t=t.concat(e)},xi=function(e){e=e.getVariableMap().getVariablesOfType("");const t=[];if(e.length>0){var i=e[e.length-1];if(Vn.variables_set){var s=l.createElement$$module$build$src$core$utils$xml("block");s.setAttribute("type","variables_set"),s.setAttribute("gap",Vn.math_change?"8":"24"),s.appendChild(ao(i)),t.push(s)}if(Vn.math_change&&(s=l.createElement$$module$build$src$core$utils$xml("block"),s.setAttribute("type","math_change"),s.setAttribute("gap",Vn.variables_get?"20":"8"),s.appendChild(ao(i)),i=l.textToDom$$module$build$src$core$utils$xml('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),s.appendChild(i),t.push(s)),Vn.variables_get){e.sort(lr);for(let c=0,m;m=e[c];c++)i=l.createElement$$module$build$src$core$utils$xml("block"),i.setAttribute("type","variables_get"),i.setAttribute("gap","8"),i.appendChild(ao(m)),t.push(i)}}return t},ko=function(e){return oc.generateUniqueNameInternal(e)},bu=function(e){return Ds(Pd.charAt(0),e.getVariableMap().getAllVariables().map(t=>t.getName()))},Ds=function(e,t){if(!t.length)return e;const i=Pd;let s="",c=i.indexOf(e);for(;;){let m=!1;for(let I=0;I<t.length;I++)if(t[I].toLowerCase()===e){m=!0;break}if(!m)break;c++,c===i.length&&(c=0,s=`${Number(s)+1}`),e=i.charAt(c)+s}return e},Mo=function(e,t,i){function s(m){xs(l.Msg$$module$build$src$core$msg.NEW_VARIABLE_TITLE,m,function(I){if(I){var B=$a(I,e);if(B){if(B.getType()===c)var Se=l.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS.replace("%1",B.getName());else Se=l.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE,Se=Se.replace("%1",B.getName()).replace("%2",B.getType());zt(Se,function(){s(I)})}else e.getVariableMap().createVariable(I,c),t&&t(I)}else t&&t(null)})}const c=i||"";s("")},l.renameVariable$$module$build$src$core$variables=function(e,t,i){function s(c){const m=l.Msg$$module$build$src$core$msg.RENAME_VARIABLE_TITLE.replace("%1",t.getName());xs(m,c,function(I){if(I){var B=Ol(I,t.getType(),e),Se=oi(t.getName(),I,e);if(B||Se){var mt="";B?mt=l.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",B.getName()).replace("%2",B.getType()):Se&&(mt=l.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER.replace("%1",I).replace("%2",Se)),zt(mt,function(){s(I)})}else e.getVariableMap().renameVariable(t,I),i&&i(I)}else i&&i(null)})}s("")},xs=function(e,t,i){Di(e,t,function(s){s&&(s=s.replace(/[\s\xa0]+/g," ").trim(),s===l.Msg$$module$build$src$core$msg.RENAME_VARIABLE||s===l.Msg$$module$build$src$core$msg.NEW_VARIABLE)&&(s=null),i(s)})},Ol=function(e,t,i){i=i.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let s=0,c;c=i[s];s++)if(c.getName().toLowerCase()===e&&c.getType()!==t)return c;return null},$a=function(e,t){t=t.getVariableMap().getAllVariables(),e=e.toLowerCase();for(let i=0,s;s=t[i];i++)if(s.getName().toLowerCase()===e)return s;return null},oi=function(e,t,i){return i.getProcedureMap().getProcedures().length?rr(e,t,i):Eu(e,t,i)},rr=function(e,t,i){e=e.toLowerCase(),t=t.toLowerCase(),i=i.getProcedureMap().getProcedures();for(const c of i){var s=c.getParameters().filter(wn).map(m=>m.getVariableModel().getName());if(s&&(i=s.some(m=>m.toLowerCase()===e),s=s.some(m=>m.toLowerCase()===t),i&&s))return c.getName()}return null},Eu=function(e,t,i){e=e.toLowerCase(),t=t.toLowerCase(),i=i.getAllBlocks(!1);for(const c of i){if(!Ls(c))continue;i=c.getProcedureDef();var s=i[1];const m=s.some(I=>I.toLowerCase()===e);if(s=s.some(I=>I.toLowerCase()===t),m&&s)return i[0]}return null},ao=function(e){const t=l.createElement$$module$build$src$core$utils$xml("field");return t.setAttribute("name","VAR"),t.setAttribute("id",e.getId()),t.setAttribute("variabletype",e.getType()),e=l.createTextNode$$module$build$src$core$utils$xml(e.getName()),t.appendChild(e),t},l.getOrCreateVariablePackage$$module$build$src$core$variables=function(e,t,i,s){let c=l.getVariable$$module$build$src$core$variables(e,t,i,s);return c||(c=Tu(e,t,i,s)),c},l.getVariable$$module$build$src$core$variables=function(e,t,i,s){const c=e.getPotentialVariableMap();let m=null;if(t&&(m=e.getVariableById(t),!m&&c&&(m=c.getVariableById(t)),m))return m;if(i){if(s===void 0)throw Error("Tried to look up a variable by name without a type");m=e.getVariable(i,s),!m&&c&&(m=c.getVariable(i,s))}return m},Tu=function(e,t,i,s){const c=e.getVariableMap(),m=e.getPotentialVariableMap();return i||(i=ko(e.isFlyout?e.targetWorkspace:e)),m?m.createVariable(i,s,t??void 0):c.createVariable(i,s,t)},Bs=function(e,t){e=e.getAllVariables();const i=[];if(t.length!==e.length)for(let s=0;s<e.length;s++){const c=e[s];t.includes(c)||i.push(c)}return i},lr=function(e,t){return e.getName().localeCompare(t.getName(),void 0,{sensitivity:"base"})},Es=function(e,t){const i=[];e=e.getAllBlocks(!1);for(let s=0;s<e.length;s++){const c=e[s].getVarModels();if(c)for(let m=0;m<c.length;m++)c[m].getId()===t&&i.push(e[s])}return i},l.deleteVariable$$module$build$src$core$variables=function(e,t,i){var s=t.getName();const c=Es(e,t.getId());for(let m=c.length-1;m>=0;m--){const I=c[m];if(I.type==="procedures_defnoreturn"||I.type==="procedures_defreturn"){i=String(I.getFieldValue("NAME")),s=l.Msg$$module$build$src$core$msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",s).replace("%2",i),zt(s);return}I===i&&c.splice(m,1)}i&&c.length||c.length>1?(s=l.Msg$$module$build$src$core$msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(c.length+(i&&!i.workspace.isFlyout?1:0))).replace("%2",s),Il(s,m=>{m&&t&&e.getVariableMap().deleteVariable(t)})):e.getVariableMap().deleteVariable(t)},Zi=function(e,{addCoordinates:t=!1,addInputBlocks:i=!0,addNextBlocks:s=!0,doFullSerialization:c=!0,saveIds:m=!0}={}){if(e.isInsertionMarker())return null;const I={type:e.type,id:m?e.id:void 0};return t&&ma(e,I),vu(e,I),Ac(e,I,c),yu(e,I,c),Xr(e,I,c),i&&Su(e,I,c,m),s&&wc(e,I,c,m),I},vu=function(e,t){e.isCollapsed()&&(t.collapsed=!0),e.isEnabled()||(t.disabledReasons=Array.from(e.getDisabledReasons())),e.isOwnDeletable()||(t.deletable=!1),e.isOwnMovable()||(t.movable=!1),e.isOwnEditable()||(t.editable=!1),e.inputsInline!==void 0&&e.inputsInline!==e.inputsInlineDefault&&(t.inline=e.inputsInline),e.data&&(t.data=e.data)},ma=function(e,t){const i=e.workspace;e=e.getRelativeToSurfaceXY(),t.x=Math.round(i.RTL?i.getWidth()-e.x:e.x),t.y=Math.round(e.y)},Ac=function(e,t,i){e.saveExtraState?(e=e.saveExtraState(i),e!==null&&(t.extraState=e)):e.mutationToDom&&(e=e.mutationToDom(),e!==null&&(t.extraState=xn(e).replace(' xmlns="https://developers.google.com/blockly/xml"',"")))},yu=function(e,t,i){const s=Object.create(null);for(const c of e.getIcons())Ms(c)&&(e=c.saveState(i))&&(s[c.getType().toString()]=e);Object.keys(s).length&&(t.icons=s)},Xr=function(e,t,i){const s=Object.create(null);for(const c of e.getFields())c.isSerializable()&&(s[c.name]=c.saveState(i));Object.keys(s).length&&(t.fields=s)},Su=function(e,t,i,s){const c=Object.create(null);for(let m=0;m<e.inputList.length;m++){const I=e.inputList[m];if(!I.connection)continue;const B=Nc(I.connection,i,s);B&&(c[I.name]=B)}Object.keys(c).length&&(t.inputs=c)},wc=function(e,t,i,s){e.nextConnection&&(e=Nc(e.nextConnection,i,s))&&(t.next=e)},Nc=function(e,t,i){const s=e.getShadowState(!0);if(e=e.targetBlock(),!s&&!e)return null;const c=Object.create(null);return s&&(c.shadow=s),e&&!e.isShadow()&&(c.block=Zi(e,{doFullSerialization:t,saveIds:i})),c},bo=function(e,t,{recordUndo:i=!1}={}){return e=ur(e,t,{recordUndo:i}),t.rendered&&Zo(),e},ur=function(e,t,{parentConnection:i,isShadow:s=!1,recordUndo:c=!1}={}){const m=_t();l.setRecordUndo$$module$build$src$core$events$utils(c),(c=l.getGroup$$module$build$src$core$events$utils())||l.setGroup$$module$build$src$core$events$utils(!0),l.disable$$module$build$src$core$events$utils();const I=t.getAllVariables();let B;try{B=Al(e,t,{parentConnection:i,isShadow:s})}finally{l.enable$$module$build$src$core$events$utils()}if(_a(t,I),Ze()&&Be(new(Qe(ce.BLOCK_CREATE))(B)),l.setGroup$$module$build$src$core$events$utils(c),l.setRecordUndo$$module$build$src$core$events$utils(m),t.rendered){const Se=B;setTimeout(()=>{Se.disposed||Se.setConnectionTracking(!0)},1)}return B},Al=function(e,t,{parentConnection:i,isShadow:s=!1}={}){if(!e.type)throw new tp(e);const c=t.newBlock(e.type,e.id);return c.setShadow(s),ba(c,e),Ri(c,e),wl(c,e),ar(i,c,e),kc(c,e),Cu(c,e),Mc(c,e),Ea(c,e),Ta(c,t.rendered),c},_a=function(e,t){if(Ze())for(e=Bs(e,t),t=0;t<e.length;t++){const i=e[t];Be(new(Qe(ce.VAR_CREATE))(i))}},ba=function(e,t){let i=t.x===void 0?0:t.x;t=t.y===void 0?0:t.y;const s=e.workspace;i=s.RTL?s.getWidth()-i:i,e.moveBy(i,t)},Ri=function(e,t){if(t.collapsed&&e.setCollapsed(!0),t.deletable===!1&&e.setDeletable(!1),t.movable===!1&&e.setMovable(!1),t.editable===!1&&e.setEditable(!1),t.enabled===!1&&e.setDisabledReason(!0,wt),Array.isArray(t.disabledReasons))for(const i of t.disabledReasons)e.setDisabledReason(!0,i);t.inline!==void 0&&e.setInputsInline(t.inline),t.data!==void 0&&(e.data=t.data)},wl=function(e,t){t.extraState&&(e.loadExtraState?e.loadExtraState(t.extraState):e.domToMutation&&e.domToMutation(l.textToDom$$module$build$src$core$utils$xml(t.extraState)))},ar=function(e,t,i){if(e){if(e.getSourceBlock().isShadow()&&!t.isShadow())throw new ip(i);if(e.type===l.inputTypes$$module$build$src$core$inputs$input_types.VALUE){var s=t.outputConnection;if(!s)throw new Vi("output",t,i)}else if(s=t.previousConnection,!s)throw new Vi("previous",t,i);if(!e.connect(s)){const c=t.workspace.connectionChecker;throw new np(c.getErrorMessage(c.canConnectWithReason(s,e,!1),s,e),e.type===l.inputTypes$$module$build$src$core$inputs$input_types.VALUE?"output connection":"previous connection",t,i)}}},kc=function(e,t){if(t.icons){var i=Object.keys(t.icons);for(const c of i){i=t.icons[c];var s=e.getIcon(c);if(!s){if(s=N(Re.ICON,c,!1),!s)throw new Kp(c,e,t);s=new s(e),e.addIcon(s)}Ms(s)&&s.loadState(i)}}},Cu=function(e,t){if(t.fields){var i=Object.keys(t.fields);for(let s=0;s<i.length;s++){const c=i[s],m=t.fields[c],I=e.getField(c);I?I.loadState(m):console.warn(`Ignoring non-existant field ${c} in block ${e.type}`)}}},Mc=function(e,t){if(t.inputs){var i=Object.keys(t.inputs);for(let s=0;s<i.length;s++){const c=i[s],m=e.getInput(c);if(!m||!m.connection)throw new Vi(c,e,t);Nl(m.connection,t.inputs[c])}}},Ea=function(e,t){if(t.next){if(!e.nextConnection)throw new Vi("next",e,t);Nl(e.nextConnection,t.next)}},Nl=function(e,t){t.shadow&&e.setShadowState(t.shadow),t.block&&Al(t.block,e.getSourceBlock().workspace,{parentConnection:e})},Ta=function(e,t){if(t){e.setConnectionTracking(!1),e.initSvg(),e.queueRender();for(const i of e.getIcons())i.onLocationChange(e.getRelativeToSurfaceXY())}else e.initModel()},Eo=function(e){return typeof e.bubbleIsVisible=="function"&&typeof e.setBubbleVisible=="function"&&typeof e.getBubble=="function"},kl=function(e){return e*Math.PI/180},va=function(e){return e*180/Math.PI},Ps=function(e,t,i){if(i<e){const s=i;i=e,e=s}return Math.max(e,Math.min(t,i))},Ml=function(){document.querySelector(".blocklyDropDownDiv")||(Fn=document.createElement("div"),Fn.className="blocklyDropDownDiv",Fn.tabIndex=-1,(Ft()||document.body).appendChild(Fn),sc=document.createElement("div"),sc.className="blocklyDropDownContent",Fn.appendChild(sc),ea=_e(sc,"keydown",null,ee),nu=document.createElement("div"),nu.className="blocklyDropDownArrow",Fn.appendChild(nu),Fn.style.opacity="0",Fn.style.transition="transform "+Ud+"s, opacity "+Ud+"s")},ya=function(e){Hd=e},Lc=function(){return pl},cr=function(){return sc},ts=function(){ea&&(Ae(ea),ea=null),Fn.remove(),Ml()},Dc=function(e,t){Fn.style.backgroundColor=e,Fn.style.borderColor=t},Ru=function(e,t,i,s,c=!0){return Ca(Sa(t),e,c,i,s)},Ll=function(e,t,i,s=!0){return lp=!0,Ca(Iu(e),e,s,t,i)},Sa=function(e){var t=e.getSvgRoot();const i=e.workspace.scale,s=e.height*i;return e=e.width*i,t=jt(t),new Nt(t.y,t.y+s,t.x,t.x+e)},Iu=function(e){return e=e.getScaledBBox(),new Nt(e.top,e.bottom,e.left,e.right)},Ca=function(e,t,i,s,c){const m=e.left+(e.right-e.left)/2,I=e.bottom;e=e.top,c&&(e+=c),c=t.getSourceBlock();let B=c.workspace;for(;B.options.parentWorkspace;)B=B.options.parentWorkspace;return ya(B.getParentSvg().parentNode),Fs(t,c.RTL,m,I,m,e,i,s)},Fs=function(e,t,i,s,c,m,I,B){return pl=e,tu=B||null,Fn.style.direction=t?"rtl":"ltr",e=v(),rp=e.getRenderer().getClassName(),Qu=e.getTheme().getClassName(),We(Fn,rp),We(Fn,Qu),i=Dl(i,s,c,m),I&&(Eh=l.getFocusManager$$module$build$src$core$focus_manager().takeEphemeralFocus(Fn)),i},Ra=function(e,t,i,s){return e=hr(e,i.left,i.right,s.width),{initialX:e.divX,initialY:t,finalX:e.divX,finalY:t+op,arrowX:e.arrowX,arrowY:-9,arrowAtTop:!0,arrowVisible:!0}},xc=function(e,t,i,s){return e=hr(e,i.left,i.right,s.width),{initialX:e.divX,initialY:t-s.height,finalX:e.divX,finalY:t-s.height-op,arrowX:e.arrowX,arrowY:s.height-bh*2-_h/2,arrowAtTop:!1,arrowVisible:!0}},Bc=function(e,t,i){return e=hr(e,t.left,t.right,i.width),{initialX:e.divX,initialY:0,finalX:e.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},hr=function(e,t,i,s){return t=Ps(t,e-s/2,i-s),e=e-_h/2-t,i=Fd,e=Ps(i,e,s-i-_h),{arrowX:e,divX:t}},Ou=function(){return!!pl},Us=function(e,t){return pl===e?(t?Ts():dr(),!0):!1},dr=function(){Fn.style.transform="translate(0, 0)",Fn.style.opacity="0",sp=setTimeout(function(){Ts()},Ud*1e3),tu&&(tu(),tu=null)},Ts=function(){Ou()&&(sp&&clearTimeout(sp),tu&&(tu(),tu=null),ts(),pl=null,v().markFocused(),Eh&&(Eh(),Eh=null))},Dl=function(e,t,i,s){e=Gd.getPositionMetrics(e,t,i,s),e.arrowVisible?(t=e.arrowX,i=e.arrowY,s=e.arrowAtTop?45:225,nu.style.display="",nu.style.transform=`translate(${t}px, ${i}px) rotate(${s}deg)`,nu.setAttribute("class","blocklyDropDownArrow")):nu.style.display="none",t=Math.floor(e.initialX),i=Math.floor(e.initialY),s=Math.floor(e.finalX);const c=Math.floor(e.finalY);return Fn.style.left=t+"px",Fn.style.top=i+"px",Fn.style.display="block",Fn.style.opacity="1",Fn.style.transform="translate("+(s-t)+"px,"+(c-i)+"px)",!!e.arrowAtTop},Yr=function(){if(pl){var e=pl.getSourceBlock();e=lp?Iu(pl):Sa(e);const t=e.left+(e.right-e.left)/2;Dl(t,e.bottom,t,e.top)}else dr()},co=function(e){return e.length?e.reduce(function(t,i){return t.length<i.length?t:i}).length:0},Nn=function(e,t){if(!e.length)return 0;if(e.length===1)return e[0].length;let i=0;t=t||co(e);let s;for(s=0;s<t;s++){for(var c=e[0][s],m=1;m<e.length;m++)if(c!==e[m][s])return i;c===" "&&(i=s+1)}for(c=1;c<e.length;c++)if((m=e[c][s])&&m!==" ")return i;return t},fr=function(e,t){if(!e.length)return 0;if(e.length===1)return e[0].length;let i=0;t=t||co(e);let s;for(s=0;s<t;s++){for(var c=e[0].substr(-s-1,1),m=1;m<e.length;m++)if(c!==e[m].substr(-s-1,1))return i;c===" "&&(i=s+1)}for(c=1;c<e.length;c++)if((m=e[c].charAt(e[c].length-s-1))&&m!==" ")return i;return t},l.wrap$$module$build$src$core$utils$string=function(e,t){e=e.split(`
`);for(let i=0;i<e.length;i++)e[i]=ho(e[i],t);return e.join(`
`)},ho=function(e,t){if(e.length<=t)return e;const i=e.trim().split(/\s+/);for(var s=0;s<i.length;s++)i[s].length>t&&(t=i[s].length);var c=-1/0;let m,I=1;do{s=c,m=e,e=[],c=i.length/I;let B=1;for(let Se=0;Se<i.length-1;Se++)B<(Se+1.5)/c?(B++,e[Se]=!0):e[Se]=!1;e=xl(i,e,t),c=Au(i,e,t),e=Pc(i,e),I++}while(c>s);return m},Au=function(e,t,i){const s=[0],c=[];for(var m=0;m<e.length;m++)s[s.length-1]+=e[m].length,t[m]===!0?(s.push(0),c.push(e[m].charAt(e[m].length-1))):t[m]===!1&&s[s.length-1]++;for(e=Math.max(...s),t=0,m=0;m<s.length;m++)t-=Math.pow(Math.abs(i-s[m]),1.5)*2,t-=Math.pow(e-s[m],1.5),".?!".includes(c[m])?t+=i/3:",;)]}".includes(c[m])&&(t+=i/4);return s.length>1&&s[s.length-1]<=s[s.length-2]&&(t+=.5),t},xl=function(e,t,i){let s=Au(e,t,i),c;for(let m=0;m<t.length-1;m++){if(t[m]===t[m+1])continue;const I=[].concat(t);I[m]=!I[m],I[m+1]=!I[m+1];const B=Au(e,I,i);B>s&&(s=B,c=I)}return c?xl(e,c,i):t},Pc=function(e,t){const i=[];for(let s=0;s<e.length;s++)i.push(e[s]),t[s]!==void 0&&i.push(t[s]?`
`:" ");return i.join("")},l.isNumber$$module$build$src$core$utils$string=function(e){return/^\s*-?\d+(\.\d+)?\s*$/.test(e)},pr=function(e){rc=e},Ia=function(){return rc},Kr=function(){return Th},Hs=function(){return gi},fi=function(e){if(e=d(e)){for(e=e.tooltip;typeof e=="function";)e=e();if(typeof e!="string")throw Error("Tooltip function must return a string.");return e}return""},d=function(e){for(;e&&e.tooltip;){if(typeof e.tooltip=="string"||typeof e.tooltip=="function")return e;e=e.tooltip}return null},g=function(){document.querySelector(".blocklyTooltipDiv")||(gi=document.createElement("div"),gi.className="blocklyTooltipDiv",(Ft()||document.body).appendChild(gi))},b=function(e){e.mouseOverWrapper_=Le(e,"pointerover",null,R),e.mouseOutWrapper_=Le(e,"pointerout",null,w),e.addEventListener("pointermove",x,!1)},y=function(e){e&&(Ae(e.mouseOverWrapper_),Ae(e.mouseOutWrapper_),e.removeEventListener("pointermove",x))},R=function(e){ta||(e=d(e.currentTarget),zo!==e&&(W(),ou=null,zo=e),clearTimeout(Jp))},w=function(e){ta||(Jp=setTimeout(function(){ou=zo=null,W()},1),clearTimeout(na),na=0)},x=function(e){if(zo&&zo.tooltip&&!ta)if(Th){const t=lc-e.pageX;e=iu-e.pageY,Math.sqrt(t*t+e*e)>Ks&&W()}else ou!==zo&&(clearTimeout(na),lc=e.pageX,iu=e.pageY,na=setTimeout(te,uc))},U=function(){ou=zo=null,W()},W=function(){Th&&(Th=!1,gi&&(gi.style.display="none")),na&&(clearTimeout(na),na=0)},q=function(){W(),ta=!0},ie=function(){ta=!1},z=function(){gi&&zo&&(typeof rc=="function"?rc(gi,zo):se())},se=function(){var e=fi(zo);e=l.wrap$$module$build$src$core$utils$string(e,qp),e=e.split(`
`);for(let t=0;t<e.length;t++){const i=document.createElement("div");i.appendChild(document.createTextNode(e[t])),gi.appendChild(i)}},Z=function(e){const t=document.documentElement.clientWidth,i=document.documentElement.clientHeight;let s=lc;s=e?s-(vh+gi.offsetWidth):s+vh;let c=iu+Br;return c+gi.offsetHeight>i+window.scrollY&&(c-=gi.offsetHeight+2*Br),e?s=Math.max(Vd-window.scrollX,s):s+gi.offsetWidth>t+window.scrollX-2*Vd&&(s=t-gi.offsetWidth-2*Vd),{x:s,y:c}},te=function(){if(!ta&&(ou=zo,gi)){gi.textContent="",z();var e=zo.RTL;gi.style.direction=e?"rtl":"ltr",gi.style.display="block",Th=!0;var{x:t,y:i}=Z(e);gi.style.left=t+"px",gi.style.top=i+"px"}},ne=function(){return zd},oe=function(e){zd=e},ue=function(){return Wd},$e=function(e){Wd=e},ye=function(e){e=`${e}`.toLowerCase().trim();var t=Zp[e];if(t||(t=e.substring(0,2)==="0x"?"#"+e.substring(2):e,t=t[0]==="#"?t:"#"+t,/^#[0-9a-f]{6}$/.test(t)))return t;if(/^#[0-9a-f]{3}$/.test(t))return["#",t[1],t[1],t[2],t[2],t[3],t[3]].join("");var i=e.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return i&&(e=Number(i[1]),t=Number(i[2]),i=Number(i[3]),e>=0&&e<256&&t>=0&&t<256&&i>=0&&i<256)?ke(e,t,i):null},ke=function(e,t,i){return t=e<<16|t<<8|i,e<16?"#"+(16777216|t).toString(16).substr(1):"#"+t.toString(16)},ze=function(e){return e=ye(e),e?(e=parseInt(e.substr(1),16),[e>>16,e>>8&255,e&255]):[0,0,0]},nt=function(e,t,i){let s=0,c=0,m=0;if(t===0)m=c=s=i;else{const I=Math.floor(e/60),B=e/60-I;e=i*(1-t);const Se=i*(1-t*B);switch(t=i*(1-t*(1-B)),I){case 1:s=Se,c=i,m=e;break;case 2:s=e,c=i,m=t;break;case 3:s=e,c=Se,m=i;break;case 4:s=t,c=e,m=i;break;case 5:s=i,c=e,m=Se;break;case 6:case 0:s=i,c=t,m=e}}return ke(Math.floor(s),Math.floor(c),Math.floor(m))},Pe=function(e,t,i){return e=ye(e),!e||(t=ye(t),!t)?null:(e=ze(e),t=ze(t),ke(Math.round(t[0]+i*(e[0]-t[0])),Math.round(t[1]+i*(e[1]-t[1])),Math.round(t[2]+i*(e[2]-t[2]))))},Ye=function(e){return nt(e,zd,Wd*255)},et=function(e,t,i){const s=[];var c=e.split("");c.push("");var m=0;e=[];let I=null;for(let mt=0;mt<c.length;mt++){var B=c[mt];if(m===0)if(B==="%")(m=e.join(""))&&s.push(m),e.length=0,m=1;else if(i&&B===`
`){const ci=e.join("");ci&&s.push(ci),e.length=0,s.push(B)}else e.push(B);else if(m===1)B==="%"?(e.push(B),m=0):t&&"0"<=B&&B<="9"?(m=2,I=B,(B=e.join(""))&&s.push(B),e.length=0):B==="{"?m=3:(e.push("%",B),m=0);else if(m===2)if("0"<=B&&B<="9")I+=B;else{var Se=void 0;s.push(parseInt((Se=I)!=null?Se:"",10)),mt--,m=0}else m===3&&(B===""?(e.splice(0,0,"%{"),mt--,m=0):B!=="}"?e.push(B):(m=e.join(""),/[A-Z]\w*/i.test(m)?(B=m.toUpperCase(),(B=B.startsWith("BKY_")?B.substring(4):null)&&B in l.Msg$$module$build$src$core$msg?(m=l.Msg$$module$build$src$core$msg[B],typeof m=="string"?Array.prototype.push.apply(s,et(m,t,i)):t?s.push(`${m}`):s.push(m)):s.push("%{"+m+"}")):s.push("%{"+m+"}"),m=e.length=0))}for((t=e.join(""))&&s.push(t),Se=[],e.length=0,c=0;c<s.length;c++)typeof s[c]!="string"||i&&s[c]===`
`?((t=e.join(""))&&Se.push(t),e.length=0,Se.push(s[c])):e.push(s[c]);return(t=e.join(""))&&Se.push(t),e.length=0,Se},Ue=function(e){return et(e,!0,!0)},Ge=function(e){return typeof e!="string"?e:(e=et(e,!1,!1),e.length?String(e[0]):"")},Tt=function(e){let t=!0;const i=l.Msg$$module$build$src$core$msg,s=e.match(/%{BKY_[A-Z]\w*}/gi);if(s)for(let c=0;c<s.length;c++){const m=s[c].toUpperCase();i[m.slice(6,-1)]===void 0&&(console.warn("No message string for "+s[c]+" in "+e),t=!1)}return t},Ct=function(e){const t=typeof e=="string"?Ge(e):e;var i=Number(t);if(!isNaN(i)&&0<=i&&i<=360)return{hue:i,hex:nt(i,ne(),ue()*255)};if(i=ye(t))return{hue:null,hex:i};throw i='Invalid colour: "'+t+'"',e!==t&&(i+=' (from "'+e+'")'),Error(i)},At=function(){return Xo},Ii=function(e){if(Xo=e,e===null){let t;(t=document.querySelector("."+up))==null||t.remove()}},Ot=function(){const e=Ft()||document.body,t=document.querySelector("div."+up);t?Xo=t:(Xo=document.createElement("div"),Xo.className=up,Xo.tabIndex=-1),_e(Xo,"keydown",null,ee),e.appendChild(Xo)},ei=function(e,t,i,s,c=!0){if(vn(),su=e,Xd=i,i=Xo){if(i.style.direction=t?"rtl":"ltr",i.style.display="block",!s&&e instanceof dn){let B;s=(B=e.getSourceBlock())==null?void 0:B.workspace}var m;jd=(m=s)!=null?m:null;var I;e=(I=s)!=null?I:v(),Pr=e.getRenderer().getClassName(),cc=e.getTheme().getClassName(),Pr&&We(i,Pr),cc&&We(i,cc),c&&(Vt=l.getFocusManager$$module$build$src$core$focus_manager().takeEphemeralFocus(i))}},vn=function(){if(qr()){su=null;var e=Xo;e&&(e.style.display="none",e.style.left="",e.style.top="",Xd&&(Xd(),Xd=null),e.textContent="",Pr&&(vt(e,Pr),Pr=""),cc&&(vt(e,cc),cc=""),v().markFocused(),Vt&&(Vt(),Vt=null))}},qr=function(){return!!su},Dn=function(e){su===e&&vn()},Bi=function(e){let t=jd===null,i=e;for(;!t&&i;){if(i===e){t=!0;break}i=e.options.parentWorkspace}t&&vn()},wu=function(e,t,i){Xo.style.left=e+"px",Xo.style.top=t+"px",Xo.style.height=i+"px"},To=function(e,t,i,s){const c=gr(e,t,i);e=Bh(e,t,i,s),c<0?wu(e,0,i.height+c):wu(e,c,i.height)},Bh=function(e,t,i,s){return s?Math.min(Math.max(t.right-i.width,e.left),e.right-i.width):Math.max(Math.min(t.left,e.right-i.width),e.left)},gr=function(e,t,i){return t.bottom+i.height>=e.bottom?t.top-i.height:t.bottom},pf=function(e){return!(e==null||!e.repositionForWindowResize)},Oa=function(){pf(su)&&su.repositionForWindowResize()||vn()},Bl=function(){return ia},Fc=function(e){ia=e},Nu=function(e,t,i,s,c){if(ei(Yd,i,Aa,s),t.length){c||(e instanceof PointerEvent?c=new Ne(e.clientX,e.clientY):(console.warn("Context menu opened with keyboard but no location given"),c=new Ne(0,0)));var m=Ph(t,i,e,c);yh=m,gf(m,i,c),setTimeout(function(){m.focus()},1),ia=null}else $r()},Ph=function(e,t,i,s){const c=new Qf;c.setRole(Ho.MENU);for(let m=0;m<e.length;m++){const I=e[m];if(I.separator){c.addChild(new an);continue}const B=new Ld(I.text);B.setRightToLeft(t),B.setRole(Ho.MENUITEM),c.addChild(B),B.setEnabled(I.enabled),I.enabled&&B.onAction(function(Se,mt){$r(),requestAnimationFrame(()=>{setTimeout(()=>{I.callback(I.scope,i,mt,s)},0)})},{})}return c},gf=function(e,t,i){const s=Qn();i=new Nt(i.y+s.top,i.y+s.top,i.x+s.left,i.x+s.left),ns(e);const c=e.getSize();t&&(i.left+=c.width,i.right+=c.width,s.left+=c.width,s.right+=c.width),To(s,i,c,t),e.focus()},ns=function(e){var t=At();if(!t)throw Error("Attempting to create a context menu when widget div is null");t=e.render(t),We(t,"blocklyContextMenu"),_e(t,"contextmenu",null,ku),e.focus()},ku=function(e){e.preventDefault(),e.stopPropagation()},$r=function(){Dn(Yd),ia=null},Aa=function(){yh&&(yh.dispose(),yh=null)},l.callbackFactory$$module$build$src$core$contextmenu=function(e,t){return()=>{l.disable$$module$build$src$core$events$utils();let i;try{i=t instanceof Element?Zr(t,e.workspace):ur(t,e.workspace);const s=e.getRelativeToSurfaceXY();s.x=e.RTL?s.x-l.config$$module$build$src$core$config.snapRadius:s.x+l.config$$module$build$src$core$config.snapRadius,s.y+=l.config$$module$build$src$core$config.snapRadius*2,i.moveBy(s.x,s.y)}finally{l.enable$$module$build$src$core$events$utils()}return Ze()&&!i.isShadow()&&Be(new(Qe(ce.BLOCK_CREATE))(i)),l.getFocusManager$$module$build$src$core$focus_manager().focusNode(i),i}},Mu=function(e,t){return t=xe(t,e.getParentSvg(),e.getInverseScreenCTM()),t.x/=e.scale,t.y/=e.scale,t},vo=function(e,t,i){t=Mu(e,t),ap.set(e,Ne.difference(i,t))},yo=function(e,t){if(t=Mu(e,t),e=ap.get(e),!e)throw Error("Drag not initialized");return Ne.sum(e,t)},Jr=function(e,t=!1){const i=l.createElement$$module$build$src$core$utils$xml("xml");var s=vs(l.allUsedVarModels$$module$build$src$core$variables(e));s.hasChildNodes()&&i.appendChild(s);for(const c of e.getTopComments())i.appendChild(Lo(c,t));for(e=e.getTopBlocks(!0),s=0;s<e.length;s++)i.appendChild(is(e[s],t));return i},Lo=function(e,t=!1){const i=l.createElement$$module$build$src$core$utils$xml("comment");t||i.setAttribute("id",e.id),t=e.workspace;const s=e.getRelativeToSurfaceXY().clone();return s.x=t.RTL?t.getWidth()-s.x:s.x,i.setAttribute("x",`${s.x}`),i.setAttribute("y",`${s.y}`),i.setAttribute("w",`${e.getSize().width}`),i.setAttribute("h",`${e.getSize().height}`),e.getText()&&(i.textContent=e.getText()),e.isCollapsed()&&i.setAttribute("collapsed","true"),e.isOwnEditable()||i.setAttribute("editable","false"),e.isOwnMovable()||i.setAttribute("movable","false"),e.isOwnDeletable()||i.setAttribute("deletable","false"),i},vs=function(e){const t=l.createElement$$module$build$src$core$utils$xml("variables");for(let i=0;i<e.length;i++){const s=e[i],c=l.createElement$$module$build$src$core$utils$xml("variable");c.appendChild(l.createTextNode$$module$build$src$core$utils$xml(s.getName())),s.getType()&&c.setAttribute("type",s.getType()),c.id=s.getId(),t.appendChild(c)}return t},is=function(e,t){if(e.isInsertionMarker()&&(e=e.getChildren(!1)[0],!e))return new DocumentFragment;let i=0;if(e.workspace.RTL&&(i=e.workspace.getWidth()),t=mr(e,t),Uc(t)){const s=e.getRelativeToSurfaceXY();t.setAttribute("x",String(Math.round(e.workspace.RTL?i-s.x:s.x))),t.setAttribute("y",String(Math.round(s.y)))}return t},$f=function(e){if(e.isSerializable()){const t=l.createElement$$module$build$src$core$utils$xml("field");return t.setAttribute("name",e.name||""),e.toXml(t)}return null},Fh=function(e,t){for(const i of e.getFields())(e=$f(i))&&t.appendChild(e)},mr=function(e,t){if(e.isInsertionMarker())return(t=e.getChildren(!1)[0])?mr(t):new DocumentFragment;const i=l.createElement$$module$build$src$core$utils$xml(e.isShadow()?"shadow":"block");if(i.setAttribute("type",e.type),t||(i.id=e.id),e.mutationToDom){var s=e.mutationToDom();s&&(s.hasChildNodes()||s.hasAttributes())&&i.appendChild(s)}if(Fh(e,i),s=e.getCommentText()){var c=e.getIcon(jn.COMMENT),m=c.getBubbleSize(),I=c.bubbleIsVisible();c=c.getBubbleLocation();var B=l.createElement$$module$build$src$core$utils$xml("comment");B.appendChild(l.createTextNode$$module$build$src$core$utils$xml(s)),B.setAttribute("pinned",`${I}`),B.setAttribute("h",`${m.height}`),B.setAttribute("w",`${m.width}`),c&&(B.setAttribute("x",`${e.workspace.RTL?e.workspace.getWidth()-(c.x+m.width):c.x}`),B.setAttribute("y",`${c.y}`)),i.appendChild(B)}for(e.data&&(s=l.createElement$$module$build$src$core$utils$xml("data"),s.appendChild(l.createTextNode$$module$build$src$core$utils$xml(e.data)),i.appendChild(s)),s=0;s<e.inputList.length;s++){m=e.inputList[s];var Se=void 0;I=!0,m.type!==l.inputTypes$$module$build$src$core$inputs$input_types.DUMMY&&m.type!==l.inputTypes$$module$build$src$core$inputs$input_types.END_ROW&&(c=m.connection.targetBlock(),m.type===l.inputTypes$$module$build$src$core$inputs$input_types.VALUE?Se=l.createElement$$module$build$src$core$utils$xml("value"):m.type===l.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT&&(Se=l.createElement$$module$build$src$core$utils$xml("statement")),B=m.connection.getShadowDom(),!B||c&&c.isShadow()||Se.appendChild(Uh(B,t)),c&&(c=mr(c,t),c.nodeType===zs.ELEMENT_NODE&&(Se.appendChild(c),I=!1)),Se.setAttribute("name",m.name),I||i.appendChild(Se))}e.inputsInline!==void 0&&e.inputsInline!==e.inputsInlineDefault&&i.setAttribute("inline",String(e.inputsInline)),e.isCollapsed()&&i.setAttribute("collapsed","true"),e.isEnabled()||i.setAttribute("disabled-reasons",Array.from(e.getDisabledReasons()).map(encodeURIComponent).join(",")),e.isOwnDeletable()||i.setAttribute("deletable","false"),e.isOwnMovable()||i.setAttribute("movable","false"),e.isOwnEditable()||i.setAttribute("editable","false"),Se=e.getNextBlock();let mt;return Se&&(s=mr(Se,t),s.nodeType===zs.ELEMENT_NODE&&(mt=l.createElement$$module$build$src$core$utils$xml("next"),mt.appendChild(s),i.appendChild(mt))),e=e.nextConnection&&e.nextConnection.getShadowDom(),!e||Se&&Se.isShadow()||mt.appendChild(Uh(e,t)),i},Uh=function(e,t){let i=e=e.cloneNode(!0),s;for(;i;)if(t&&i.nodeName==="shadow"&&i.removeAttribute("id"),i.firstChild)i=i.firstChild;else{for(;i&&!i.nextSibling;){s=i,i=i.parentNode;let c;s.nodeType===zs.TEXT_NODE&&s.data.trim()===""&&((c=i)==null?void 0:c.firstChild)!==s&&Wt(s)}i&&(s=i,i=i.nextSibling,s.nodeType===zs.TEXT_NODE&&s.data.trim()===""&&Wt(s))}return e},xn=function(e){return Qs(e).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},Bn=function(e){e=xn(e).split("<");let t="";for(let i=1;i<e.length;i++){const s=e[i];s[0]==="/"&&(t=t.substring(2)),e[i]=t+"<"+s,s[0]!=="/"&&s.slice(-2)!=="/>"&&(t+="  ")}return e=e.join(`
`),e=e.replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>"),e.replace(/^\n/,"")},Kt=function(e,t){return t.setResizesEnabled(!1),t.clear(),e=l.domToWorkspace$$module$build$src$core$xml(e,t),t.setResizesEnabled(!0),e},l.domToWorkspace$$module$build$src$core$xml=function(e,t){let i=0;t.RTL&&(i=t.getWidth());const s=[];Ln();const c=l.getGroup$$module$build$src$core$events$utils();c||l.setGroup$$module$build$src$core$events$utils(!0),t.setResizesEnabled&&t.setResizesEnabled(!1);let m=!0;try{for(let I=0,B;B=e.childNodes[I];I++){const Se=B.nodeName.toLowerCase(),mt=B;if(Se==="block"||Se==="shadow"&&!_t()){const ci=Zr(mt,t);s.push(ci.id);let Un;const Ao=parseInt((Un=mt.getAttribute("x"))!=null?Un:"10",10);let fa;const mu=parseInt((fa=mt.getAttribute("y"))!=null?fa:"10",10);isNaN(Ao)||isNaN(mu)||ci.moveBy(t.RTL?i-Ao:Ao,mu,["create"]),m=!1}else{if(Se==="shadow")throw TypeError("Shadow block cannot be a top-level block.");if(Se==="comment")_r(mt,t);else if(Se==="variables"){if(m)br(mt,t);else throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");m=!1}}}}finally{l.setGroup$$module$build$src$core$events$utils(c),t.setResizesEnabled&&t.setResizesEnabled(!0),t.rendered&&Zo(),_n()}return Be(new(Qe(ce.FINISHED_LOADING))(t)),s},_r=function(e,t){var i;const s=(i=e.getAttribute("id"))!=null?i:void 0;i=t.rendered?new As(t,s):new dc(t,s);var c;i.setText((c=e.textContent)!=null?c:"");var m;c=parseInt((m=e.getAttribute("x"))!=null?m:"",10);let I;m=parseInt((I=e.getAttribute("y"))!=null?I:"",10),isNaN(c)||isNaN(m)||(c=t.RTL?t.getWidth()-c:c,i.moveTo(new Ne(c,m)));var B;t=parseInt((B=e.getAttribute("w"))!=null?B:"",10);let Se;return B=parseInt((Se=e.getAttribute("h"))!=null?Se:"",10),isNaN(t)||isNaN(B)||i.setSize(new Mt(t,B)),e.getAttribute("collapsed")==="true"&&i.setCollapsed(!0),e.getAttribute("editable")==="false"&&i.setEditable(!1),e.getAttribute("movable")==="false"&&i.setMovable(!1),e.getAttribute("deletable")==="false"&&i.setDeletable(!1),i},os=function(e,t){if(!t.getBlocksBoundingBox)return l.domToWorkspace$$module$build$src$core$xml(e,t);var i=t.getBlocksBoundingBox();if(e=l.domToWorkspace$$module$build$src$core$xml(e,t),i&&i.top!==i.bottom){var s=i.bottom;i=t.RTL?i.right:i.left;var c=1/0;let m=-1/0,I=1/0;for(let B=0;B<e.length;B++){const Se=t.getBlockById(e[B]).getRelativeToSurfaceXY();Se.y<I&&(I=Se.y),Se.x<c&&(c=Se.x),Se.x>m&&(m=Se.x)}for(s=s-I+10,i=t.RTL?i-m:i-c,c=0;c<e.length;c++)t.getBlockById(e[c]).moveBy(i,s,["create"])}return e},l.domToBlock$$module$build$src$core$xml=function(e,t){return e=Zr(e,t),t.rendered&&Zo(),e},Zr=function(e,t){l.disable$$module$build$src$core$events$utils();var i=t.getAllVariables();let s;try{if(s=ys(e,t),t.rendered){const c=s,m=s.getDescendants(!1);c.setConnectionTracking(!1);for(let I=m.length-1;I>=0;I--)m[I].initSvg();for(let I=m.length-1;I>=0;I--)m[I].queueRender();setTimeout(function(){c.disposed||c.setConnectionTracking(!0)},1),t.resizeContents()}else{const c=s.getDescendants(!1);for(let m=c.length-1;m>=0;m--)c[m].initModel()}}finally{l.enable$$module$build$src$core$events$utils()}if(Ze()){for(e=Bs(t,i),t=0;t<e.length;t++)i=e[t],Be(new(Qe(ce.VAR_CREATE))(i));Be(new(Qe(ce.BLOCK_CREATE))(s))}return s},br=function(e,t){for(let s=0;s<e.children.length;s++){var i=e.children[s];const c=i.getAttribute("type"),m=i.getAttribute("id");if(i=i.textContent,!i)break;let I;t.getVariableMap().createVariable(i,(I=c)!=null?I:void 0,m)}},mf=function(e){const t={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let i=0;i<e.children.length;i++){const s=e.children[i];if(s.nodeType!==zs.TEXT_NODE)switch(s.nodeName.toLowerCase()){case"mutation":t.mutation.push(s);break;case"comment":t.comment.push(s);break;case"data":t.data.push(s);break;case"title":case"field":t.field.push(s);break;case"value":case"statement":t.input.push(s);break;case"next":t.next.push(s);break;default:console.warn("Ignoring unknown tag: "+s.nodeName)}}return t},_f=function(e,t){let i=!1;for(let s=0;s<e.length;s++){const c=e[s];t.domToMutation&&(t.domToMutation(c),t.initSvg&&(i=!0))}return i},Lu=function(e,t){for(let i=0;i<e.length;i++){const s=e[i],c=s.textContent,m=s.getAttribute("pinned")==="true";let I;const B=parseInt((I=s.getAttribute("w"))!=null?I:"50",10);let Se;const mt=parseInt((Se=s.getAttribute("h"))!=null?Se:"50",10);let ci,Un=parseInt((ci=s.getAttribute("x"))!=null?ci:"",10),Ao;const fa=parseInt((Ao=s.getAttribute("y"))!=null?Ao:"",10);t.setCommentText(c);const mu=t.getIcon(jn.COMMENT);isNaN(B)||isNaN(mt)||mu.setBubbleSize(new Mt(B,mt)),mu.setBubbleVisible(m),setTimeout(()=>{isNaN(Un)||isNaN(fa)||(Un=t.workspace.RTL?t.workspace.getWidth()-(Un+B):Un,mu.setBubbleLocation(new Ne(Un,fa))),mu.setBubbleVisible(m)},1)}},Pl=function(e,t){for(let i=0;i<e.length;i++)t.data=e[i].textContent},Hh=function(e,t){for(let i=0;i<e.length;i++){const s=e[i],c=s.getAttribute("name");c?Qr(t,c,s):console.warn(`Ignoring unnamed field in block ${t.type}`)}},Du=function(e){let t=null,i=null;for(let s=0;s<e.childNodes.length;s++){const c=e.childNodes[s];Uc(c)&&(c.nodeName.toLowerCase()==="block"?t=c:c.nodeName.toLowerCase()==="shadow"&&(i=c))}return{childBlockElement:t,childShadowElement:i}},Gh=function(e,t,i,s){for(let m=0;m<e.length;m++){var c=e[m];const I=c.getAttribute("name"),B=I?i.getInput(I):null;if(!B){console.warn("Ignoring non-existent input "+I+" in block "+s);break}if(c=Du(c),c.childBlockElement){if(!B.connection)throw TypeError("Input connection does not exist.");ys(c.childBlockElement,t,B.connection,!1)}if(c.childShadowElement){let Se;(Se=B.connection)==null||Se.setShadowDom(c.childShadowElement)}}},Fl=function(e,t,i){for(let s=0;s<e.length;s++){const c=Du(e[s]);if(c.childBlockElement){if(!i.nextConnection)throw TypeError("Next statement does not exist.");if(i.nextConnection.isConnected())throw TypeError("Next statement is already connected.");ys(c.childBlockElement,t,i.nextConnection,!0)}c.childShadowElement&&i.nextConnection&&i.nextConnection.setShadowDom(c.childShadowElement)}},ys=function(e,t,i,s){var c;const m=e.getAttribute("type");if(!m)throw TypeError("Block type unspecified: "+e.outerHTML);var I=(c=e.getAttribute("id"))!=null?c:void 0;c=t.newBlock(m,I),I=mf(e);const B=_f(I.mutation,c);if(Lu(I.comment,c),Pl(I.data,c),i)if(s)if(c.previousConnection)i.connect(c.previousConnection);else throw TypeError("Next block does not have previous statement.");else if(c.outputConnection)i.connect(c.outputConnection);else if(c.previousConnection)i.connect(c.previousConnection);else throw TypeError("Child block does not have output or previous statement.");if(Hh(I.field,c),Gh(I.input,t,c,m),Fl(I.next,t,c),B&&c.initSvg(),(t=e.getAttribute("inline"))&&c.setInputsInline(t==="true"),(t=e.getAttribute("disabled"))&&c.setDisabledReason(t==="true"||t==="disabled",wt),t=e.getAttribute("disabled-reasons"),t!==null)for(var Se of t.split(","))c.setDisabledReason(!0,decodeURIComponent(Se));if((Se=e.getAttribute("deletable"))&&c.setDeletable(Se==="true"),(Se=e.getAttribute("movable"))&&c.setMovable(Se==="true"),(Se=e.getAttribute("editable"))&&c.setEditable(Se==="true"),(Se=e.getAttribute("collapsed"))&&c.setCollapsed(Se==="true"),e.nodeName.toLowerCase()==="shadow"){for(e=c.getChildren(!1),Se=0;Se<e.length;Se++)if(!e[Se].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");c.setShadow(!0)}return c},Qr=function(e,t,i){const s=e.getField(t);s?s.fromXml(i):console.warn("Ignoring non-existent field "+t+" in block "+e.type)},Er=function(e){for(let t=0;t<e.childNodes.length;t++){const i=e.childNodes[t];if(i.nodeName.toLowerCase()==="next"){e.removeChild(i);break}}},Uc=function(e){return e.nodeType===zs.ELEMENT_NODE},Ss=function(e,t){a(Re.FIELD,e,t,!0)},xu=function(e){E(Re.FIELD,e)},l.fromJson$$module$build$src$core$field_registry=function(e){return fp.fromJsonInternal(e)},Hc=function(e){const t=O(Re.FIELD,e.type);return t?t.fromJson(e):(console.warn("Blockly could not create a field of type "+e.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null)},Cs=function(e){return e&&typeof e=="object"&&"src"in e&&typeof e.src=="string"&&"alt"in e&&typeof e.alt=="string"&&"width"in e&&typeof e.width=="number"&&"height"in e&&typeof e.height=="number"},l.register$$module$build$src$core$extensions=function(e,t){if(typeof e!="string"||e.trim()==="")throw Error('Error: Invalid extension name "'+e+'"');if(io[e])throw Error('Error: Extension "'+e+'" is already registered.');if(typeof t!="function")throw Error('Error: Extension "'+e+'" must be a function');io[e]=t},l.registerMixin$$module$build$src$core$extensions=function(e,t){if(!t||typeof t!="object")throw Error('Error: Mixin "'+e+'" must be a object');l.register$$module$build$src$core$extensions(e,function(){this.mixin(t)})},l.registerMutator$$module$build$src$core$extensions=function(e,t,i,s){const c='Error when registering mutator "'+e+'": ';Bu(c,t);const m=si(t,c);if(i&&typeof i!="function")throw Error(c+'Extension "'+e+'" is not a function');l.register$$module$build$src$core$extensions(e,function(){m&&this.setMutator(new l.MutatorIcon$$module$build$src$core$icons$mutator_icon(s||[],this)),this.mixin(t),i&&i.apply(this)})},Pi=function(e){wa(e)?delete io[e]:console.warn('No extension mapping for name "'+e+'" found to unregister')},wa=function(e){return!!io[e]},Gc=function(e,t,i){const s=io[e];if(typeof s!="function")throw Error('Error: Extension "'+e+'" not found.');let c;if(i?Dp(e,t):c=Ul(t),s.apply(t),i)Bu('Error after applying mutator "'+e+'": ',t);else if(!Vh(c,t))throw Error('Error when applying extension "'+e+'": mutation properties changed when applying a non-mutator extension.')},Dp=function(e,t){if(Ul(t).length)throw Error('Error: tried to apply mutation "'+e+'" to a block that already has mutator functions.  Block id: '+t.id)},xp=function(e,t){return Na(e.mutationToDom,e.domToMutation,t+" mutationToDom/domToMutation")},Bp=function(e,t){return Na(e.saveExtraState,e.loadExtraState,t+" saveExtraState/loadExtraState")},si=function(e,t){return Na(e.compose,e.decompose,t+" compose/decompose")},Na=function(e,t,i){if(e&&t){if(typeof e!="function"||typeof t!="function")throw Error(i+" must be a function");return!0}if(!e&&!t)return!1;throw Error(i+"Must have both or neither functions")},Bu=function(e,t){const i=xp(t,e),s=Bp(t,e);if(!i&&!s)throw Error(e+"Mutations must contain either XML hooks, or JSON hooks, or both");si(t,e)},Ul=function(e){const t=[];return e.domToMutation!==void 0&&t.push(e.domToMutation),e.mutationToDom!==void 0&&t.push(e.mutationToDom),e.saveExtraState!==void 0&&t.push(e.saveExtraState),e.loadExtraState!==void 0&&t.push(e.loadExtraState),e.compose!==void 0&&t.push(e.compose),e.decompose!==void 0&&t.push(e.decompose),t},Vh=function(e,t){if(t=Ul(t),t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(e[i]!==t[i])return!1;return!0},Pu=function(e){if(typeof document!="object")throw Error("runAfterPageLoad() requires browser document.");if(document.readyState==="complete")e();else{const t=setInterval(function(){document.readyState==="complete"&&(clearInterval(t),e())},10)}},l.buildTooltipForDropdown$$module$build$src$core$extensions=function(e,t){const i=[];return function(){i.includes(this.type)||(Fu(this,e,t),i.push(this.type)),this.setTooltip((function(){const s=String(this.getFieldValue(e));return Ge(t[s])}).bind(this))}},Fu=function(e,t,i){var s=e.getField(t);if(s instanceof zi&&!s.isOptionListDynamic()){s=s.getOptions();for(const c of s)c!==zi.SEPARATOR&&([,s]=c,i[s]===void 0&&console.warn(`No tooltip mapping for value ${s} of field ${t} of block type ${e.type}.`))}},l.buildTooltipWithFieldText$$module$build$src$core$extensions=function(e,t){return function(){this.setTooltip((function(){const i=this.getField(t);return Ge(e).replace("%1",i?i.getText():"")}).bind(this))}},Pp=function(){const e=this.tooltip;this.setTooltip((function(){const t=this.getParent();return t&&t.getInputsInline()&&t.tooltip||e}).bind(this))},pt=function(e,t){return" "+e+","+t+" "},Do=function(e,t){return" "+e+t.join("")},Oi=function(e,t){return" M "+e+","+t+" "},yn=function(e,t){return" m "+e+","+t+" "},Rs=function(e,t){return" l "+e+","+t+" "},el=function(e){return" l"+e.join("")},$t=function(e,t){return" "+e+" "+t+" "},kn=function(e,t,i,s){return e+" "+i+" "+i+" "+t+s},zh=function(e,t){if(!e||!t)throw Error("Cannot connect null connections.");e.targetConnection=t,t.targetConnection=e},Vc=function(e,t){let i=null;t=t.outputConnection;const s=t?.getConnectionChecker();for(let c=0,m;m=e.inputList[c];c++){const I=m.connection;let B;if(I&&((B=s)!=null&&B.canConnect(t,I,!1))){if(i)return null;i=I}}return i},zc=function(e,t){let i;for(;i=Vc(e,t);)if(e=i.targetBlock(),!e||e.isShadow())return i;return null},Wh=function(e){return Zn(e)&&typeof e.getType=="function"&&typeof e.initView=="function"&&typeof e.dispose=="function"&&typeof e.getWeight=="function"&&typeof e.getSize=="function"&&typeof e.applyColour=="function"&&typeof e.hideForInsertionMarker=="function"&&typeof e.updateEditable=="function"&&typeof e.updateCollapsed=="function"&&typeof e.isShownWhenCollapsed=="function"&&typeof e.setOffsetInBlock=="function"&&typeof e.onLocationChange=="function"&&typeof e.onClick=="function"},bf=function(e){return Wh(e)&&Eo(e)&&Ms(e)&&typeof e.setText=="function"&&typeof e.getText=="function"&&typeof e.setBubbleSize=="function"&&typeof e.getBubbleSize=="function"&&typeof e.setBubbleLocation=="function"&&typeof e.getBubbleLocation=="function"&&e.getType()===jn.COMMENT},Tr=function(e){if(!(e.getDescendants(!1).length>100)){var t=e.workspace,i=e.getSvgRoot();t.getAudioManager().play("delete");var s=e.getRelativeToSurfaceXY(),c=i.cloneNode(!0);c.setAttribute("transform","translate("+s.x+","+s.y+")");var m;(m=t.getLayerManager())==null||m.appendToAnimationLayer({getSvgRoot:()=>c}),tl(c,{x:s.x,y:s.y,width:e.width,height:e.height},t.RTL,new Date)}},tl=function(e,t,i,s){const c=(new Date().getTime()-s.getTime())/150;c>1?Wt(e):(e.setAttribute("transform","translate("+(t.x+(i?-1:1)*t.width/2*c)+","+(t.y+t.height/2*c)+") scale("+(1-c)+")"),setTimeout(tl,10,e,t,i,s))},jh=function(e){var t=e.workspace;const i=t.scale;if(t.getAudioManager().play("click"),!(i<1)){var s=t.getSvgXY(e.getSvgRoot());e.outputConnection?(s.x+=(e.RTL?3:-3)*i,s.y+=13*i):e.previousConnection&&(s.x+=(e.RTL?-23:23)*i,s.y+=3*i);var c=ae(le.CIRCLE,{cx:s.x,cy:s.y,r:0,fill:"none",stroke:"#888","stroke-width":10},t.getParentSvg());e=ae(le.ANIMATE,{id:"animationCircle",begin:"indefinite",attributeName:"r",dur:"150ms",from:0,to:25*i},c),t=ae(le.ANIMATE,{id:"animationOpacity",begin:"indefinite",attributeName:"opacity",dur:"150ms",from:1,to:0},c),e.beginElement(),t.beginElement(),setTimeout(()=>void Wt(c),150)}},Xh=function(e){if(vr(),e.workspace.getAudioManager().play("disconnect"),!(e.workspace.scale<1)){var t=e.getHeightWidth().height;t=Math.atan(10/t)/Math.PI*180,e.RTL||(t*=-1),pc=e,Hl(e,t,new Date,0)}},Hl=function(e,t,i,s){const c=[.66,1,.66,0,-.66,-1,-.66,0];let m="";i.getTime()+200>new Date().getTime()&&(m=`skewX(${Math.round(c[s%c.length]*t)})`,uu=setTimeout(Hl,15,e,t,i,s+1)),e.getSvgRoot().setAttribute("transform",`${e.getTranslation()} ${m}`)},vr=function(){pc&&(uu&&(clearTimeout(uu),uu=null),pc.getSvgRoot().setAttribute("transform",pc.getTranslation()),pc=null)},Wc=function(e,t){e.workspace.RTL&&(t.x=e.workspace.getWidth()-t.x);const i=e.workspace,s=l.config$$module$build$src$core$config.snapRadius,c=Ne.difference(t,e.getRelativeToSurfaceXY()),m=new Ne(0,0),I=i.getAllBlocks(!1).filter(B=>B.id!=e.id).map(B=>B.getRelativeToSurfaceXY());for(;ka(Ne.sum(t,m),I)||jc(e,Ne.sum(c,m),s);)i.RTL?m.translate(-s,s*2):m.translate(s,s*2);e.moveTo(Ne.sum(t,m))},ka=function(e,t){return t.some(i=>Math.abs(i.x-e.x)<=1&&Math.abs(i.y-e.y)<=1)},jc=function(e,t,i){return e.getConnections_(!1).some(s=>!!s.closest(i,t).connection)},Uu=function(e,t,i){const s=i.getBoundingRectangle(),c=s.right-s.left,m=Ps(t.top,s.top,t.top+t.height-(s.bottom-s.top))-s.top;let I=t.left;return t=t.left+t.width-c,e.RTL?I=Math.min(t,I):t=Math.max(I,t),(e=Ps(I,s.left,t)-s.left)||m?(i.moveBy(e,m,["inbounds"]),!0):!1},nl=function(e){return t=>{var i=e.getMetricsManager();if(i.hasFixedEdges()&&!e.isDragging()){var s;if(Hf.includes((s=t.type)!=null?s:"")){s=i.getScrollMetrics(!0);const c=Ef(e,t);c&&(i=l.getGroup$$module$build$src$core$events$utils()||!1,l.setGroup$$module$build$src$core$events$utils(t.group),Uu(e,s,c)&&!t.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),l.setGroup$$module$build$src$core$events$utils(i))}else ft(t)&&t.scale&&t.oldScale&&t.scale>t.oldScale&&Gs(e)}}},Ef=function(e,t){let i=null;switch(t.type){case ce.BLOCK_CREATE:case ce.BLOCK_MOVE:(i=e.getBlockById(t.blockId))&&(i=i.getRootBlock());break;case ce.COMMENT_CREATE:case ce.COMMENT_MOVE:case ce.COMMENT_RESIZE:i=e.getCommentById(t.commentId)}return i},Gs=function(e){var t=e.getMetricsManager();if(t.hasFixedEdges()&&!e.isDragging()){t=t.getScrollMetrics(!0);var i=e.getTopBoundedElements();for(let s=0,c;c=i[s];s++)Uu(e,t,c)}},xo=function(e){return e&&typeof e.isDeletable=="function"&&typeof e.dispose=="function"&&typeof e.setDeleteStyle=="function"},Xc=function(e,t){const i=e.getIcons();for(const s of e.inputList){if(!s.isVisible())continue;i.push(...s.fieldRow);let c;if((c=s.connection)!=null&&c.targetBlock())if(e=s.connection.targetBlock(),s.connection.type!==lt.NEXT_STATEMENT||t)i.push(e);else{let m;(e=(m=e.lastConnectionInStack(!1))==null?void 0:m.getSourceBlock())&&i.push(e)}else{let m;((m=s.connection)==null?void 0:m.type)===lt.INPUT_VALUE&&i.push(s.connection)}}return i},ss=function(e,t){const i=e.workspace.getTopBoundedElements(!0).filter(c=>Zn(c));e=i.indexOf(e instanceof Rn?e.getRootBlock():e)+t;let s=null;if(e>=0&&e<i.length?s=i[e]:e<0?s=i[i.length-1]:e>=i.length&&(s=i[0]),t<0&&s instanceof Rn){let c,m;return(m=(c=s.lastConnectionInStack(!1))==null?void 0:c.getSourceBlock())!=null?m:s}return s},Fi=function(e,t){var i;let s;const c=e instanceof Rn?(s=(i=e.outputConnection)==null?void 0:i.targetBlock())!=null?s:e.getSurroundParent():e.getSourceBlock();return!(c instanceof Rn)||(i=Xc(c,t>0),e=i.indexOf(e),e===-1)?null:(t=e+t,t>=0&&t<i.length?i[t]:null)},Hu=function(e,t){a(Re.ICON,e.toString(),t)},Yh=function(e){E(Re.ICON,e)},Gl=function(e){return e&&typeof e.getRelativeToSurfaceXY=="function"&&typeof e.isMovable=="function"&&typeof e.startDrag=="function"&&typeof e.drag=="function"&&typeof e.endDrag=="function"&&typeof e.revertDrag=="function"},Ma=function(e){return e&&typeof e.autoHide=="function"},Is=function(e){return typeof e.getProcedureModel=="function"&&typeof e.doProcedureUpdate=="function"&&typeof e.isProcedureDef=="function"},Yc=function(e){return e&&typeof e.startPublishing=="function"&&typeof e.stopPublishing=="function"},La=function(e){const t=e.getProcedureMap().getProcedures().filter(s=>!s.getReturnTypes()).map(s=>[s.getName(),s.getParameters().map(c=>c.getName()),!1]);e.getBlocksByType("procedures_defnoreturn",!1).forEach(s=>{!Is(s)&&Ls(s)&&t.push(s.getProcedureDef())});const i=e.getProcedureMap().getProcedures().filter(s=>!!s.getReturnTypes()).map(s=>[s.getName(),s.getParameters().map(c=>c.getName()),!0]);return e.getBlocksByType("procedures_defreturn",!1).forEach(s=>{!Is(s)&&Ls(s)&&i.push(s.getProcedureDef())}),t.sort(Vl),i.sort(Vl),[t,i]},Vl=function(e,t){return e[0].localeCompare(t[0],void 0,{sensitivity:"base"})},l.findLegalName$$module$build$src$core$procedures=function(e,t){if(t.isInFlyout)return e;for(e=e||l.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed";!Kc(e,t.workspace,t);){const i=e.match(/^(.*?)(\d+)$/);e=i?i[1]+(parseInt(i[2])+1):e+"2"}return e},Kc=function(e,t,i){return!Kh(e,t,i)},Kh=function(e,t,i){for(const s of t.getAllBlocks(!1))if(s!==i&&Ls(s)&&l.Names$$module$build$src$core$names.equals(s.getProcedureDef()[0],e))return!0;i=i&&Is(i)?i?.getProcedureModel():void 0;for(const s of t.getProcedureMap().getProcedures())if(s!==i&&l.Names$$module$build$src$core$names.equals(s.getName(),e))return!0;return!1},l.rename$$module$build$src$core$procedures=function(e){var t=this.getSourceBlock();if(!t)throw new ai;e=e.trim();const i=l.findLegalName$$module$build$src$core$procedures(e,t);Is(t)&&!t.isInsertionMarker()&&t.getProcedureModel().setName(i);const s=this.getValue();if(s!==e&&s!==i)for(e=t.workspace.getAllBlocks(!1),t=0;t<e.length;t++){const c=e[t];c.renameProcedure&&c.renameProcedure(s,i)}return i},qh=function(e){function t(m,I){for(let Se=0;Se<m.length;Se++){var B=m[Se][0];const mt=m[Se][1],ci=l.createElement$$module$build$src$core$utils$xml("block");ci.setAttribute("type",I),ci.setAttribute("gap","16");const Un=l.createElement$$module$build$src$core$utils$xml("mutation");for(Un.setAttribute("name",B),ci.appendChild(Un),B=0;B<mt.length;B++){const Ao=l.createElement$$module$build$src$core$utils$xml("arg");Ao.setAttribute("name",mt[B]),Un.appendChild(Ao)}i.push(ci)}}const i=[];if(Vn.procedures_defnoreturn){var s=l.createElement$$module$build$src$core$utils$xml("block");s.setAttribute("type","procedures_defnoreturn"),s.setAttribute("gap","16");var c=l.createElement$$module$build$src$core$utils$xml("field");c.setAttribute("name","NAME"),c.appendChild(l.createTextNode$$module$build$src$core$utils$xml(l.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE)),s.appendChild(c),i.push(s)}return Vn.procedures_defreturn&&(s=l.createElement$$module$build$src$core$utils$xml("block"),s.setAttribute("type","procedures_defreturn"),s.setAttribute("gap","16"),c=l.createElement$$module$build$src$core$utils$xml("field"),c.setAttribute("name","NAME"),c.appendChild(l.createTextNode$$module$build$src$core$utils$xml(l.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE)),s.appendChild(c),i.push(s)),Vn.procedures_ifreturn&&(s=l.createElement$$module$build$src$core$utils$xml("block"),s.setAttribute("type","procedures_ifreturn"),s.setAttribute("gap","16"),i.push(s)),i.length&&i[i.length-1].setAttribute("gap","24"),e=La(e),t(e[0],"procedures_callnoreturn"),t(e[1],"procedures_callreturn"),i},Da=function(e){return So(e,!1)},So=function(e,t=!0){function i(c,m){for(const[I,B]of c)s.push({kind:"block",type:m,gap:16,extraState:{name:I,params:B}})}if(t)return gn("The XML return value of Blockly.Procedures.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),qh(e);const s=[];return Vn.procedures_defnoreturn&&s.push({kind:"block",type:"procedures_defnoreturn",gap:16,fields:{NAME:l.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE}}),Vn.procedures_defreturn&&s.push({kind:"block",type:"procedures_defreturn",gap:16,fields:{NAME:l.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE}}),Vn.procedures_ifreturn&&s.push({kind:"block",type:"procedures_ifreturn",gap:16}),s.length&&(s[s.length-1].gap=24),e=La(e),i(e[0],"procedures_callnoreturn"),i(e[1],"procedures_callreturn"),s},Bo=function(e){var t=[],i=e.getBlocksByType("procedures_mutatorarg",!1);for(let m=0,I;I=i[m];m++)t.push(I.getFieldValue("NAME"));i=l.createElement$$module$build$src$core$utils$xml("xml");const s=l.createElement$$module$build$src$core$utils$xml("block");s.setAttribute("type","procedures_mutatorarg");const c=l.createElement$$module$build$src$core$utils$xml("field");c.setAttribute("name","NAME"),t=Ds(l.DEFAULT_ARG$$module$build$src$core$procedures,t),t=l.createTextNode$$module$build$src$core$utils$xml(t),c.appendChild(t),s.appendChild(c),i.appendChild(s),e.updateToolbox(i)},yr=function(e){if(Ve(e)&&e.bubbleType==="mutator"&&e.isOpen&&e.blockId){e=sn(e.workspaceId).getBlockById(e.blockId);var t=e.type;(t==="procedures_defnoreturn"||t==="procedures_defreturn")&&(e=e.getIcon(l.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE).getWorkspace(),Bo(e),e.addChangeListener(Jh))}},Jh=function(e){(Je(e)||Rt(e)||Bt(e)||Yt(e))&&(e=sn(e.workspaceId),Bo(e))},Zh=function(e,t){return t.getAllBlocks(!1).filter(i=>il(i,e)||or(i)&&l.Names$$module$build$src$core$names.equals(i.getProcedureCall(),e))},il=function(e,t){return Is(e)&&!e.isProcedureDef()&&e.getProcedureModel()&&l.Names$$module$build$src$core$names.equals(e.getProcedureModel().getName(),t)},l.mutateCallers$$module$build$src$core$procedures=function(e){const t=_t();var i=e.getProcedureDef()[0];const s=e.mutationToDom(!0);e=Zh(i,e.workspace);for(let m=0,I;I=e[m];m++){i=(i=I.mutationToDom())&&Qs(i),I.domToMutation&&I.domToMutation(s);var c=I.mutationToDom();c=c&&Qs(c),i!==c&&(l.setRecordUndo$$module$build$src$core$events$utils(!1),Be(new(Qe(ce.BLOCK_CHANGE))(I,"mutation",null,i,c)),l.setRecordUndo$$module$build$src$core$events$utils(t))}},l.getDefinition$$module$build$src$core$procedures=function(e,t){for(const i of t.getAllBlocks(!1))if(Is(i)&&i.isProcedureDef()&&l.Names$$module$build$src$core$names.equals(i.getProcedureModel().getName(),e)||Ls(i)&&l.Names$$module$build$src$core$names.equals(i.getProcedureDef()[0],e))return i;return null},fo=function(e){return e.isDynamic},ri=function(e){return e.pathDown!==void 0&&e.pathUp!==void 0},qc=function(e){return e.pathLeft!==void 0&&e.pathRight!==void 0},rs=function(e,t){a(Re.RENDERER,e,t)},xt=function(e){E(Re.RENDERER,e)},$n=function(e,t,i){return e=new(N(Re.RENDERER,e))(e),e.init(t,i),e},ti=function(e){Mo(e.getTargetWorkspace(),void 0,"String")},Gu=function(e){Mo(e.getTargetWorkspace(),void 0,"Number")},ol=function(e){Mo(e.getTargetWorkspace(),void 0,"Colour")},Sr=function(e){return xa(e,!1)},xa=function(e,t=!0){return Vn.variables_set_dynamic||Vn.variables_get_dynamic||console.warn("There are no dynamic variable blocks, but there is a dynamic variable category."),t?(gn("The XML return value of Blockly.VariablesDynamic.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),Ba(e)):(e.registerButtonCallback("CREATE_VARIABLE_STRING",ti),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",Gu),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",ol),[{kind:"button",text:l.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE,callbackkey:"CREATE_VARIABLE_STRING"},{kind:"button",text:l.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE,callbackkey:"CREATE_VARIABLE_NUMBER"},{kind:"button",text:l.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE,callbackkey:"CREATE_VARIABLE_COLOUR"},...di(e,e.getVariableMap().getAllVariables(),!1,"variables_get_dynamic","variables_set_dynamic")])},Ba=function(e){let t=[],i=document.createElement("button");return i.setAttribute("text",l.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),t.push(i),i=document.createElement("button"),i.setAttribute("text",l.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),t.push(i),i=document.createElement("button"),i.setAttribute("text",l.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),t.push(i),e.registerButtonCallback("CREATE_VARIABLE_STRING",ti),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",Gu),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",ol),e=zl(e),t=t.concat(e)},zl=function(e){e=e.getVariableMap().getAllVariables();const t=[];if(e.length>0){if(Vn.variables_set_dynamic){var i=e[e.length-1];const s=l.createElement$$module$build$src$core$utils$xml("block");s.setAttribute("type","variables_set_dynamic"),s.setAttribute("gap","24"),s.appendChild(ao(i)),t.push(s)}if(Vn.variables_get_dynamic){e.sort(lr);for(let s=0,c;c=e[s];s++)i=l.createElement$$module$build$src$core$utils$xml("block"),i.setAttribute("type","variables_get_dynamic"),i.setAttribute("gap","8"),i.appendChild(ao(c)),t.push(i)}}return t},Qh=function(e,t){const i=e.toCopyData();return Ap=i,wp=Hn(e)&&e.workspace instanceof Ko?e.workspace:null,pg=t,i},Gn=function(){return Ap},ed=function(e){Ap=e},Pa=function(){return wp},Tf=function(e){wp=e},td=function(){return pg},Fp=function(e){pg=e},Cr=function(e,t,i){return e&&t?Jc(e,t,i):Ap&&wp?Jc(Ap,wp,pg):null},Jc=function(e,t,i){let s;t=t.isMutator?t:(s=t.options.parentWorkspace)!=null?s:t;let c,m;return(m=(c=O(Re.PASTER,e.paster,!1))==null?void 0:c.paste(e,t,i))!=null?m:null},Vu=function(e){return e&&typeof e.toCopyData=="function"},Qi=function(){mn.registry.register({name:du.ESCAPE,preconditionFn(e){return!e.isReadOnly()},callback(e){return e.hideChaff(),!0},keyCodes:[pn.ESC]})},ni=function(){mn.registry.register({name:du.DELETE,preconditionFn(e,t){return t=t.focusedNode,!e.isReadOnly()&&t!=null&&xo(t)&&t.isDeletable()&&!e.isDragging()&&!l.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()},callback(e,t,i,s){return t.preventDefault(),e=s.focusedNode,e instanceof Rn?e.checkAndDelete():xo(e)&&e.isDeletable()&&(l.setGroup$$module$build$src$core$events$utils(!0),e.dispose(),l.setGroup$$module$build$src$core$events$utils(!1)),!0},keyCodes:[pn.DELETE,pn.BACKSPACE]})},zu=function(e){return Vu(e)&&xo(e)&&Gl(e)?e.isCopyable?e.isCopyable():e instanceof Rn||e instanceof As?e.isOwnDeletable()&&e.isOwnMovable():e.isDeletable()&&e.isMovable():!1},Wu=function(e){return zu(e)&&xo(e)&&e.isDeletable()},Fa=function(){const e=mn.registry.createSerializedKey(pn.C,[pn.CTRL]),t=mn.registry.createSerializedKey(pn.C,[pn.META]);mn.registry.register({name:du.COPY,preconditionFn(i,s){return s=s.focusedNode,i=i.isFlyout?i.targetWorkspace:i,!!s&&!!i&&!i.isDragging()&&!l.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()&&zu(s)},callback(i,s,c,m){return s.preventDefault(),s=m.focusedNode,!s||!Vu(s)||!zu(s)||(i=i.isFlyout?i.targetWorkspace:i,!i)?!1:(s.workspace.isFlyout||i.hideChaff(),i=Gl(s)&&s.workspace==i?s.getRelativeToSurfaceXY():void 0,!!Qh(s,i))},keyCodes:[e,t]})},Zc=function(){const e=mn.registry.createSerializedKey(pn.X,[pn.CTRL]),t=mn.registry.createSerializedKey(pn.X,[pn.META]);mn.registry.register({name:du.CUT,preconditionFn(i,s){return s=s.focusedNode,!!s&&!i.isReadOnly()&&!i.isDragging()&&!l.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()&&Wu(s)},callback(i,s,c,m){return i=m.focusedNode,!i||!Wu(i)||!Vu(i)?!1:(s=Gl(i)?i.getRelativeToSurfaceXY():void 0,s=Qh(i,s),i instanceof Rn?i.checkAndDelete():xo(i)&&i.dispose(),!!s)},keyCodes:[e,t]})},Vs=function(){const e=mn.registry.createSerializedKey(pn.V,[pn.CTRL]),t=mn.registry.createSerializedKey(pn.V,[pn.META]);mn.registry.register({name:du.PASTE,preconditionFn(){var i=Pa();return!i||!i.rendered?!1:(i=i.isFlyout?i.targetWorkspace:i,!!Gn()&&!!i&&!i.isReadOnly()&&!i.isDragging()&&!l.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken())},callback(i,s){if(i=Gn(),!i)return!1;var c=Pa();if(!c||(c=c.isFlyout?c.targetWorkspace:c,!c||c.isReadOnly()))return!1;if(s instanceof PointerEvent)return s=fs(c,new Ne(s.clientX,s.clientY)),!!Cr(i,c,s);if(s=td(),!s)return!!Cr(i,c);const{left:m,top:I,width:B,height:Se}=c.getMetricsManager().getViewMetrics(!0);return new Nt(I,I+Se,m,m+B).contains(s.x,s.y)?!!Cr(i,c):(s=new Ne(m+B/2,I+Se/2),!!Cr(i,c,s))},keyCodes:[e,t]})},Ua=function(){const e=mn.registry.createSerializedKey(pn.Z,[pn.CTRL]),t=mn.registry.createSerializedKey(pn.Z,[pn.META]);mn.registry.register({name:du.UNDO,preconditionFn(i){return!i.isReadOnly()&&!i.isDragging()&&!l.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()},callback(i,s){return i.hideChaff(),i.undo(!1),s.preventDefault(),!0},keyCodes:[e,t]})},Qc=function(){const e=mn.registry.createSerializedKey(pn.Z,[pn.CTRL,pn.SHIFT]),t=mn.registry.createSerializedKey(pn.Z,[pn.META,pn.SHIFT]),i=mn.registry.createSerializedKey(pn.Y,[pn.CTRL]);mn.registry.register({name:du.REDO,preconditionFn(s){return!s.isDragging()&&!s.isReadOnly()&&!l.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()},callback(s,c){return s.hideChaff(),s.undo(!0),c.preventDefault(),!0},keyCodes:[e,t,i]})},eh=function(){Qi(),ni(),Fa(),Zc(),Vs(),Ua(),Qc()},nd=function(e){const t=e.saveState();return e.getParameters().length&&(t.parameters=e.getParameters().map(i=>i.saveState())),t},id=function(e,t,i,s){if(e=e.loadState(i,s),!i.parameters)return e;for(const[c,m]of i.parameters.entries())e.insertParameter(t.loadState(m,s),c);return e},vf=function(e){const t=Object.create(null),i=H(Re.SERIALIZER,!0);for(const s in i){let c;const m=(c=i[s])==null?void 0:c.save(e);m&&(t[s]=m)}return t},yf=function(e,t,{recordUndo:i=!1}={}){var s=H(Re.SERIALIZER,!0);if(s){s=Object.entries(s).sort((m,I)=>I[1].priority-m[1].priority);var c=_t();l.setRecordUndo$$module$build$src$core$events$utils(i),(i=l.getGroup$$module$build$src$core$events$utils())||l.setGroup$$module$build$src$core$events$utils(!0),Ln(),t instanceof Ko&&t.setResizesEnabled(!1);for(const[,m]of s.reverse()){let I;(I=m)==null||I.clear(t)}for(const[m,I]of s.reverse())if(e[m]){let B;(B=I)==null||B.load(e[m],t)}t instanceof Ko&&t.setResizesEnabled(!0),_n(),Be(new(Qe(ce.FINISHED_LOADING))(t)),l.setGroup$$module$build$src$core$events$utils(i),l.setRecordUndo$$module$build$src$core$events$utils(c)}},Sf=function(e,t){let i=null;i=typeof e=="string"?document.getElementById(e)||document.querySelector(e):e;var s;if(!document.contains(i)&&document!==((s=i)==null?void 0:s.ownerDocument))throw Error("Error: container is not in current document");e=new qs(t||{}),s=document.createElement("div"),We(s,"injectionDiv"),t!=null&&t.rtl&&We(s,"blocklyRTL"),i.appendChild(s),t=Cf(s,e);const c=od(s,t,e);return Rf(c),L(c),je(c),s.addEventListener("focusin",function(){L(c)}),_e(s,"keydown",null,ee),c},Cf=function(e,t){e.setAttribute("dir","LTR"),dt(t.hasCss,t.pathToMedia);const i=ae(le.SVG,{xmlns:Qa,"xmlns:html":ll,"xmlns:xlink":Co,version:"1.1",class:"blocklySvg"},e),s=ae(le.DEFS,{},i),c=String(Math.random()).substring(2);return t.gridPattern=vc.createDom(c,t.gridOptions,s,e),i},od=function(e,t,i){i.parentWorkspace=null,i=new Ko(i);const s=i.options;i.scale=s.zoomOptions.startScale,t.appendChild(i.createDom("blocklyMainBackground",e));var c=i.getRenderer().getClassName();return c&&We(e,c),(c=i.getTheme().getClassName())&&We(e,c),!s.hasCategories&&s.languageTree&&(e=i.addFlyout(le.SVG),Yi(e,t)),s.hasTrashcan&&i.addTrashcan(),s.zoomOptions&&s.zoomOptions.controls&&i.addZoomControls(),i.getThemeManager().subscribe(t,"workspaceBackgroundColour","background-color"),i.translate(0,0),i.addChangeListener(nl(i)),je(i),Ot(),Ml(),g(),i},Rf=function(e){const t=e.options;var i=e.getParentSvg();if(_e(i.parentNode,"contextmenu",null,function(s){rt(s)||s.preventDefault()}),i=_e(window,"resize",null,function(){W(),e.hideComponents(!0),Yr(),Oa(),je(e),Gs(e)}),e.setResizeHandlerWrapper(i),Up(),t.languageTree){i=e.getToolbox();const s=e.getFlyout(!0);i?i.init():s&&(s.init(e),s.show(t.languageTree),typeof s.scrollToStart=="function"&&s.scrollToStart())}t.hasTrashcan&&e.trashcan.init(),t.zoomOptions&&t.zoomOptions.controls&&e.zoomControls_.init(),t.moveOptions&&t.moveOptions.scrollbars?(e.scrollbar=new Gr(e,t.moveOptions.scrollbars===!0||!!t.moveOptions.scrollbars.horizontal,t.moveOptions.scrollbars===!0||!!t.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),e.scrollbar.resize()):e.setMetrics({x:.5,y:.5}),t.hasSounds&&If(t.pathToMedia,e)},Up=function(){g$||(_e(document,"scroll",null,function(){const e=Xn();for(let t=0,i;i=e[t];t++)i instanceof Ko&&i.updateInverseScreenCTM()}),Le(document,"touchend",null,be),Le(document,"touchcancel",null,be)),g$=!0},If=function(e,t){function i(){for(;c.length;){const m=c.pop();m&&Ae(m)}s.preload()}const s=t.getAudioManager();s.load([e+"click.mp3",e+"click.wav",e+"click.ogg"],"click"),s.load([e+"disconnect.wav",e+"disconnect.mp3",e+"disconnect.ogg"],"disconnect"),s.load([e+"delete.mp3",e+"delete.ogg",e+"delete.wav"],"delete");const c=[];c.push(_e(document,"pointermove",null,i,!0)),c.push(_e(document,"touchstart",null,i,!0))},Of=function(e){if(!e||!e.isSimpleReporter())return!1;let t;return(t=e.getFields().next().value)==null?void 0:t.isFullBlockField()},sd=function(){Dt.registry.register({displayText(){return l.Msg$$module$build$src$core$msg.UNDO},preconditionFn(e){return e.workspace.getUndoStack().length>0?"enabled":"disabled"},callback(e){e.workspace.undo(!1)},scopeType:Dt.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},th=function(){Dt.registry.register({displayText(){return l.Msg$$module$build$src$core$msg.REDO},preconditionFn(e){return e.workspace.getRedoStack().length>0?"enabled":"disabled"},callback(e){e.workspace.undo(!0)},scopeType:Dt.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},rd=function(){Dt.registry.register({displayText(){return l.Msg$$module$build$src$core$msg.CLEAN_UP},preconditionFn(e){return e.workspace.isMovable()?e.workspace.getTopBlocks(!1).length>1?"enabled":"disabled":"hidden"},callback(e){e.workspace.cleanUp()},scopeType:Dt.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},ld=function(e,t){function i(m){c--,m.setCollapsed(e),c===0&&l.setGroup$$module$build$src$core$events$utils(!1)}let s=0,c=0;l.setGroup$$module$build$src$core$events$utils(!0);for(let m=0;m<t.length;m++){let I=t[m];for(;I;)c++,setTimeout(i.bind(null,I),s),I=I.getNextBlock(),s+=10}},ud=function(){Dt.registry.register({displayText(){return l.Msg$$module$build$src$core$msg.COLLAPSE_ALL},preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(let t=0;t<e.length;t++){let i=e[t];for(;i;){if(!i.isCollapsed())return"enabled";i=i.getNextBlock()}}return"disabled"}return"hidden"},callback(e){ld(!0,e.workspace.getTopBlocks(!0))},scopeType:Dt.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},ad=function(){Dt.registry.register({displayText(){return l.Msg$$module$build$src$core$msg.EXPAND_ALL},preconditionFn(e){if(e.workspace.options.collapse){e=e.workspace.getTopBlocks(!1);for(let t=0;t<e.length;t++){let i=e[t];for(;i;){if(i.isCollapsed())return"enabled";i=i.getNextBlock()}}return"disabled"}return"hidden"},callback(e){ld(!1,e.workspace.getTopBlocks(!0))},scopeType:Dt.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},cd=function(e,t){if(e.isDeletable())Array.prototype.push.apply(t,e.getDescendants(!1));else{e=e.getChildren(!1);for(let i=0;i<e.length;i++)cd(e[i],t)}},hd=function(e){const t=[];e=e.getTopBlocks(!0);for(let i=0;i<e.length;i++)cd(e[i],t);return t},Ha=function(e,t){t?l.setGroup$$module$build$src$core$events$utils(t):(l.setGroup$$module$build$src$core$events$utils(!0),t=l.getGroup$$module$build$src$core$events$utils());const i=e.shift();i&&(i.isDeadOrDying()?Ha(e,t):(i.dispose(!1,!0),setTimeout(Ha,10,e,t))),l.setGroup$$module$build$src$core$events$utils(!1)},Wl=function(){Dt.registry.register({displayText(e){return e.workspace?(e=hd(e.workspace).length,e===1?l.Msg$$module$build$src$core$msg.DELETE_BLOCK:l.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${e}`)):""},preconditionFn(e){return e.workspace&&hd(e.workspace).length>0?"enabled":"disabled"},callback(e){if(e.workspace){e.workspace.cancelCurrentGesture();var t=hd(e.workspace);t.length<2?Ha(t):Il(l.Msg$$module$build$src$core$msg.DELETE_ALL_BLOCKS.replace("%1",String(t.length)),function(i){i&&Ha(t)})}},scopeType:Dt.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},Af=function(){sd(),th(),rd(),ud(),ad(),Wl()},Ga=function(){Dt.registry.register({displayText(){return l.Msg$$module$build$src$core$msg.DUPLICATE_BLOCK},preconditionFn(e){return e=e.block,!e.isInFlyout&&e.isDeletable()&&e.isMovable()?e.isDuplicatable()?"enabled":"disabled":"hidden"},callback(e){if(e.block){var t=e.block.toCopyData();t&&Cr(t,e.block.workspace)}},scopeType:Dt.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},Va=function(){Dt.registry.register({displayText(e){return e.block.hasIcon(hs.TYPE)?l.Msg$$module$build$src$core$msg.REMOVE_COMMENT:l.Msg$$module$build$src$core$msg.ADD_COMMENT},preconditionFn(e){return e=e.block,!e||e.isInFlyout||!e.workspace.options.comments||e.isCollapsed()||!e.isEditable()||!e.hasIcon(hs.TYPE)&&Of(e)?"hidden":"enabled"},callback(e){(e=e.block)&&e.hasIcon(hs.TYPE)?e.setCommentText(null):e.setCommentText("")},scopeType:Dt.ScopeType.BLOCK,id:"blockComment",weight:2})},dd=function(){Dt.registry.register({displayText(e){return e.block.getInputsInline()?l.Msg$$module$build$src$core$msg.EXTERNAL_INPUTS:l.Msg$$module$build$src$core$msg.INLINE_INPUTS},preconditionFn(e){if(e=e.block,!e.isInFlyout&&e.isMovable()&&!e.isCollapsed()){for(let t=1;t<e.inputList.length;t++)if(!(e.inputList[t-1]instanceof mg||e.inputList[t]instanceof mg))return"enabled"}return"hidden"},callback(e){e.block.setInputsInline(!e.block.getInputsInline())},scopeType:Dt.ScopeType.BLOCK,id:"blockInline",weight:3})},nh=function(){Dt.registry.register({displayText(e){return e.block.isCollapsed()?l.Msg$$module$build$src$core$msg.EXPAND_BLOCK:l.Msg$$module$build$src$core$msg.COLLAPSE_BLOCK},preconditionFn(e){return e=e.block,!e.isInFlyout&&e.isMovable()&&e.workspace.options.collapse?"enabled":"hidden"},callback(e){e.block.setCollapsed(!e.block.isCollapsed())},scopeType:Dt.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},wf=function(){Dt.registry.register({displayText(e){return e.block.hasDisabledReason(wt)?l.Msg$$module$build$src$core$msg.ENABLE_BLOCK:l.Msg$$module$build$src$core$msg.DISABLE_BLOCK},preconditionFn(e){if(e=e.block,!e.isInFlyout&&e.workspace.options.disable&&e.isEditable()){var t=e.getDisabledReasons();return t=t.size>(t.has(wt)?1:0),e.getInheritedDisabled()||t?"disabled":"enabled"}return"hidden"},callback(e){e=e.block;const t=l.getGroup$$module$build$src$core$events$utils();t||l.setGroup$$module$build$src$core$events$utils(!0),e.setDisabledReason(!e.hasDisabledReason(wt),wt),l.setGroup$$module$build$src$core$events$utils(t)},scopeType:Dt.ScopeType.BLOCK,id:"blockDisable",weight:5})},fd=function(){Dt.registry.register({displayText(e){var t=e.block;return e=t.getDescendants(!1).length,(t=t.getNextBlock())&&(e-=t.getDescendants(!1).length),e===1?l.Msg$$module$build$src$core$msg.DELETE_BLOCK:l.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${e}`)},preconditionFn(e){return!e.block.isInFlyout&&e.block.isDeletable()?"enabled":"hidden"},callback(e){e.block&&e.block.checkAndDelete()},scopeType:Dt.ScopeType.BLOCK,id:"blockDelete",weight:6})},pd=function(){Dt.registry.register({displayText(){return l.Msg$$module$build$src$core$msg.HELP},preconditionFn(e){return e=e.block,(typeof e.helpUrl=="function"?e.helpUrl():e.helpUrl)?"enabled":"hidden"},callback(e){e.block.showHelp()},scopeType:Dt.ScopeType.BLOCK,id:"blockHelp",weight:7})},gd=function(){Dt.registry.register({displayText:()=>l.Msg$$module$build$src$core$msg.REMOVE_COMMENT,preconditionFn(e){let t;return(t=e.comment)!=null&&t.isDeletable()?"enabled":"hidden"},callback(e){l.setGroup$$module$build$src$core$events$utils(!0);let t;(t=e.comment)==null||t.dispose(),l.setGroup$$module$build$src$core$events$utils(!1)},scopeType:Dt.ScopeType.COMMENT,id:"commentDelete",weight:6})},$d=function(){Dt.registry.register({displayText:()=>l.Msg$$module$build$src$core$msg.DUPLICATE_COMMENT,preconditionFn(e){let t;return(t=e.comment)!=null&&t.isMovable()?"enabled":"hidden"},callback(e){if(e.comment){var t=e.comment.toCopyData();t&&Cr(t,e.comment.workspace)}},scopeType:Dt.ScopeType.COMMENT,id:"commentDuplicate",weight:1})},md=function(){Dt.registry.register({displayText:()=>l.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:e=>{let t;return(t=e.workspace)!=null&&t.isMutator?"hidden":"enabled"},callback:(e,t,i,s)=>{(e=e.workspace)&&(l.setGroup$$module$build$src$core$events$utils(!0),t=new As(e),t.setPlaceholderText(l.Msg$$module$build$src$core$msg.WORKSPACE_COMMENT_DEFAULT_TEXT),t.moveTo(fs(e,new Ne(s.x,s.y))),l.getFocusManager$$module$build$src$core$focus_manager().focusNode(t),l.setGroup$$module$build$src$core$events$utils(!1))},scopeType:Dt.ScopeType.WORKSPACE,id:"commentCreate",weight:8})},_d=function(){Ga(),Va(),dd(),nh(),wf(),fd(),pd()},Nf=function(){$d(),gd(),md()},bd=function(){Af(),_d()},Ed=function(e){return e&&typeof e.paste=="function"},kf=function(e){return e&&typeof e.getSvgRoot=="function"},Mf=function(e){return e.isSelectable()},Hp=function(e){v().hideChaff(e)},ge=ge||{},ge.scope={},ge.ASSUME_ES5=!1,ge.ASSUME_ES6=!1,ge.ASSUME_ES2020=!1,ge.ASSUME_NO_NATIVE_MAP=!1,ge.ASSUME_NO_NATIVE_SET=!1,ge.ISOLATE_POLYFILLS=!1,ge.FORCE_POLYFILL_PROMISE=!1,ge.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,ge.INSTRUMENT_ASYNC_CONTEXT=!0,ge.objectCreate=ge.ASSUME_ES5||typeof Object.create=="function"?Object.create:function(e){var t=function(){};return t.prototype=e,new t},ge.defineProperty=ge.ASSUME_ES5||typeof Object.defineProperties=="function"?Object.defineProperty:function(e,t,i){return e==Array.prototype||e==Object.prototype||(e[t]=i.value),e},ge.getGlobal=function(e){e=[typeof globalThis=="object"&&globalThis,e,typeof window=="object"&&window,typeof self=="object"&&self,typeof commonjsGlobal=="object"&&commonjsGlobal];for(var t=0;t<e.length;++t){var i=e[t];if(i&&i.Math==Math)return i}throw Error("Cannot find global object")},ge.global=ge.ASSUME_ES2020?globalThis:ge.getGlobal(this),ge.IS_SYMBOL_NATIVE=typeof Symbol=="function"&&typeof Symbol("x")=="symbol",ge.TRUST_ES6_POLYFILLS=!ge.ISOLATE_POLYFILLS||ge.IS_SYMBOL_NATIVE,ge.polyfills={},ge.propertyToPolyfillSymbol={},ge.POLYFILL_PREFIX="$jscp$",ge.polyfill=function(e,t,i,s){t&&(ge.ISOLATE_POLYFILLS?ge.polyfillIsolated(e,t,i,s):ge.polyfillUnisolated(e,t,i,s))},ge.polyfillUnisolated=function(e,t,i,s){for(i=ge.global,e=e.split("."),s=0;s<e.length-1;s++){var c=e[s];if(!(c in i))return;i=i[c]}e=e[e.length-1],s=i[e],t=t(s),t!=s&&t!=null&&ge.defineProperty(i,e,{configurable:!0,writable:!0,value:t})},ge.polyfillIsolated=function(e,t,i,s){var c=e.split(".");e=c.length===1,s=c[0],s=!e&&s in ge.polyfills?ge.polyfills:ge.global;for(var m=0;m<c.length-1;m++){var I=c[m];if(!(I in s))return;s=s[I]}c=c[c.length-1],i=ge.IS_SYMBOL_NATIVE&&i==="es6"?s[c]:null,t=t(i),t!=null&&(e?ge.defineProperty(ge.polyfills,c,{configurable:!0,writable:!0,value:t}):t!==i&&(ge.propertyToPolyfillSymbol[c]===void 0&&(i=Math.random()*1e9>>>0,ge.propertyToPolyfillSymbol[c]=ge.IS_SYMBOL_NATIVE?ge.global.Symbol(c):ge.POLYFILL_PREFIX+i+"$"+c),ge.defineProperty(s,ge.propertyToPolyfillSymbol[c],{configurable:!0,writable:!0,value:t})))},ge.getConstructImplementation=function(){function e(){function i(){}return Reflect.construct(i,[],function(){}),new i instanceof i}if(ge.TRUST_ES6_POLYFILLS&&typeof Reflect<"u"&&Reflect.construct){if(e())return Reflect.construct;var t=Reflect.construct;return function(i,s,c){return i=t(i,s),c&&Reflect.setPrototypeOf(i,c.prototype),i}}return function(i,s,c){return c===void 0&&(c=i),c=ge.objectCreate(c.prototype||Object.prototype),Function.prototype.apply.call(i,c,s)||c}},ge.construct={valueOf:ge.getConstructImplementation}.valueOf(),ge.underscoreProtoCanBeSet=function(){var e={a:!0},t={};try{return t.__proto__=e,t.a}catch{}return!1},ge.setPrototypeOf=ge.ASSUME_ES6||ge.TRUST_ES6_POLYFILLS&&typeof Object.setPrototypeOf=="function"?Object.setPrototypeOf:ge.underscoreProtoCanBeSet()?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null,ge.inherits=function(e,t){if(e.prototype=ge.objectCreate(t.prototype),e.prototype.constructor=e,ge.ASSUME_ES6||ge.setPrototypeOf){var i=ge.setPrototypeOf;i(e,t)}else for(i in t)if(i!="prototype")if(Object.defineProperties){var s=Object.getOwnPropertyDescriptor(t,i);s&&Object.defineProperty(e,i,s)}else e[i]=t[i];e.superClass_=t.prototype},ge.arrayIteratorImpl=function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}},ge.arrayIterator=function(e){return{next:ge.arrayIteratorImpl(e)}},ge.makeIterator=function(e){var t=typeof Symbol<"u"&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if(typeof e.length=="number")return ge.arrayIterator(e);throw Error(String(e)+" is not an iterable or ArrayLike")},ge.arrayFromIterator=function(e){for(var t,i=[];!(t=e.next()).done;)i.push(t.value);return i},ge.arrayFromIterable=function(e){return e instanceof Array?e:ge.arrayFromIterator(ge.makeIterator(e))},ge.generator={},ge.generator.ensureIteratorResultIsObject_=function(e){if(!(e instanceof Object))throw new TypeError("Iterator result "+e+" is not an object")},ge.generator.Context=function(){this.isRunning_=!1,this.yieldAllIterator_=null,this.yieldResult=void 0,this.nextAddress=1,this.finallyAddress_=this.catchAddress_=0,this.finallyContexts_=this.abruptCompletion_=null},ge.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0},ge.generator.Context.prototype.stop_=function(){this.isRunning_=!1},ge.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_},ge.generator.Context.prototype.next_=function(e){this.yieldResult=e},ge.generator.Context.prototype.throw_=function(e){this.abruptCompletion_={exception:e,isException:!0},this.jumpToErrorHandler_()},ge.generator.Context.prototype.return=function(e){this.abruptCompletion_={return:e},this.nextAddress=this.finallyAddress_},ge.generator.Context.prototype.jumpThroughFinallyBlocks=function(e){this.abruptCompletion_={jumpTo:e},this.nextAddress=this.finallyAddress_},ge.generator.Context.prototype.yield=function(e,t){return this.nextAddress=t,{value:e}},ge.generator.Context.prototype.yieldAll=function(e,t){e=ge.makeIterator(e);var i=e.next();if(ge.generator.ensureIteratorResultIsObject_(i),i.done)this.yieldResult=i.value,this.nextAddress=t;else return this.yieldAllIterator_=e,this.yield(i.value,t)},ge.generator.Context.prototype.jumpTo=function(e){this.nextAddress=e},ge.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0},ge.generator.Context.prototype.setCatchFinallyBlocks=function(e,t){this.catchAddress_=e,t!=null&&(this.finallyAddress_=t)},ge.generator.Context.prototype.setFinallyBlock=function(e){this.catchAddress_=0,this.finallyAddress_=e||0},ge.generator.Context.prototype.leaveTryBlock=function(e,t){this.nextAddress=e,this.catchAddress_=t||0},ge.generator.Context.prototype.enterCatchBlock=function(e){return this.catchAddress_=e||0,e=this.abruptCompletion_.exception,this.abruptCompletion_=null,e},ge.generator.Context.prototype.enterFinallyBlock=function(e,t,i){i?this.finallyContexts_[i]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_],this.catchAddress_=e||0,this.finallyAddress_=t||0},ge.generator.Context.prototype.leaveFinallyBlock=function(e,t){if(t=this.finallyContexts_.splice(t||0)[0],t=this.abruptCompletion_=this.abruptCompletion_||t){if(t.isException)return this.jumpToErrorHandler_();t.jumpTo!=null&&this.finallyAddress_<t.jumpTo?(this.nextAddress=t.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=e},ge.generator.Context.prototype.forIn=function(e){return new ge.generator.Context.PropertyIterator(e)},ge.generator.Context.PropertyIterator=function(e){this.object_=e,this.properties_=[];for(var t in e)this.properties_.push(t);this.properties_.reverse()},ge.generator.Context.PropertyIterator.prototype.getNext=function(){for(;this.properties_.length>0;){var e=this.properties_.pop();if(e in this.object_)return e}return null},ge.generator.Engine_=function(e){this.context_=new ge.generator.Context,this.program_=e},ge.generator.Engine_.prototype.next_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.next,e,this.context_.next_):(this.context_.next_(e),this.nextStep_())},ge.generator.Engine_.prototype.return_=function(e){this.context_.start_();var t=this.context_.yieldAllIterator_;return t?this.yieldAllStep_("return"in t?t.return:function(i){return{value:i,done:!0}},e,this.context_.return):(this.context_.return(e),this.nextStep_())},ge.generator.Engine_.prototype.throw_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.throw,e,this.context_.next_):(this.context_.throw_(e),this.nextStep_())},ge.generator.Engine_.prototype.yieldAllStep_=function(e,t,i){try{var s=e.call(this.context_.yieldAllIterator_,t);if(ge.generator.ensureIteratorResultIsObject_(s),!s.done)return this.context_.stop_(),s;var c=s.value}catch(m){return this.context_.yieldAllIterator_=null,this.context_.throw_(m),this.nextStep_()}return this.context_.yieldAllIterator_=null,i.call(this.context_,c),this.nextStep_()},ge.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var e=this.program_(this.context_);if(e)return this.context_.stop_(),{value:e.value,done:!1}}catch(t){this.context_.yieldResult=void 0,this.context_.throw_(t)}if(this.context_.stop_(),this.context_.abruptCompletion_){if(e=this.context_.abruptCompletion_,this.context_.abruptCompletion_=null,e.isException)throw e.exception;return{value:e.return,done:!0}}return{value:void 0,done:!0}},ge.generator.Generator_=function(e){this.next=function(t){return e.next_(t)},this.throw=function(t){return e.throw_(t)},this.return=function(t){return e.return_(t)},this[Symbol.iterator]=function(){return this}},ge.generator.createGenerator=function(e,t){return t=new ge.generator.Generator_(new ge.generator.Engine_(t)),ge.setPrototypeOf&&e.prototype&&ge.setPrototypeOf(t,e.prototype),t},ge.asyncExecutePromiseGenerator=function(e){function t(s){return e.next(s)}function i(s){return e.throw(s)}return new Promise(function(s,c){function m(I){I.done?s(I.value):Promise.resolve(I.value).then(t,i).then(m,c)}m(e.next())})},ge.asyncExecutePromiseGeneratorFunction=function(e){return ge.asyncExecutePromiseGenerator(e())},ge.asyncExecutePromiseGeneratorProgram=function(e){return ge.asyncExecutePromiseGenerator(new ge.generator.Generator_(new ge.generator.Engine_(e)))},ge.polyfill("globalThis",function(e){return e||ge.global},"es_2020","es3"),ge.polyfill("Array.prototype.includes",function(e){return e||function(t,i){var s=this;s instanceof String&&(s=String(s));var c=s.length;for(i=i||0,i<0&&(i=Math.max(i+c,0));i<c;i++){var m=s[i];if(m===t||Object.is(m,t))return!0}return!1}},"es7","es3"),ge.checkEs6ConformanceViaProxy=function(){try{var e={},t=Object.create(new ge.global.Proxy(e,{get:function(i,s,c){return i==e&&s=="q"&&c==t}}));return t.q===!0}catch{return!1}},ge.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1,ge.ES6_CONFORMANCE=ge.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&ge.checkEs6ConformanceViaProxy(),ge.initSymbol=function(){},ge.iteratorPrototype=function(e){return e={next:e},e[Symbol.iterator]=function(){return this},e},ge.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},ge.MapEntry=function(){},ge.polyfill("Set.prototype.difference",function(e){return e||function(t){ge.checkIsSetInstance(this),ge.checkIsSetLike(t);var i=ge.getSmallerAndLargerSets(this,t);t=new Set(this);var s=i.smallerSetIterator;i=i.largerSet;for(var c=s.next();!c.done;)i.has(c.value)&&t.delete(c.value),c=s.next();return t}},"es_next","es6"),ge.checkIsSetLike=function(e){if(typeof e!="object"||e===null||typeof e.size!="number"||e.size<0||typeof e.keys!="function"||typeof e.has!="function")throw new TypeError("Argument must be set-like")},ge.checkIsValidIterator=function(e){if(typeof e!="object"||e===null||typeof e.next!="function")throw new TypeError("Invalid iterator.");return e},ge.getSmallerAndLargerSets=function(e,t){return e.size<=t.size?{smallerSetIterator:e.keys(),largerSet:t}:{smallerSetIterator:ge.checkIsValidIterator(t.keys()),largerSet:e}},ge.checkIsSetInstance=function(e){if(!(e instanceof Set))throw new TypeError("Method must be called on an instance of Set.")},ge.iteratorFromArray=function(e,t){if(ge.ASSUME_ES6)return e[Symbol.iterator]();e instanceof String&&(e+="");var i=0,s=!1,c={next:function(){if(!s&&i<e.length){var m=i++;return{value:t(m,e[m]),done:!1}}return s=!0,{done:!0,value:void 0}}};return c[Symbol.iterator]=function(){return c},c},ge.polyfill("Array.prototype.values",function(e){return e||function(){return ge.iteratorFromArray(this,function(t,i){return i})}},"es8","es3"),ge.polyfill("Array.prototype.flatMap",function(e){return e||function(t,i){var s=[];return Array.prototype.forEach.call(this,function(c,m){c=t.call(i,c,m,this),Array.isArray(c)?s.push.apply(s,c):s.push(c)}),s}},"es9","es5"),ge.polyfill("Array.prototype.flat",function(e){return e||function(t){t=t===void 0?1:t;var i=[];return Array.prototype.forEach.call(this,function(s){Array.isArray(s)&&t>0?(s=Array.prototype.flat.call(s,t-1),i.push.apply(i,s)):i.push(s)}),i}},"es9","es5"),ge.polyfill("Object.entries",function(e){return e||function(t){var i=[],s;for(s in t)ge.owns(t,s)&&i.push([s,t[s]]);return i}},"es8","es3"),ge.polyfill("Object.values",function(e){return e||function(t){var i=[],s;for(s in t)ge.owns(t,s)&&i.push(t[s]);return i}},"es8","es3");var sl=Object.create(null),Gp={typeMap:sl},za=Object.create(null),Po="default",Re=class{constructor(e){this.name=e}toString(){return this.name}};Re.CONNECTION_CHECKER=new Re("connectionChecker"),Re.CONNECTION_PREVIEWER=new Re("connectionPreviewer"),Re.CURSOR=new Re("cursor"),Re.EVENT=new Re("event"),Re.FIELD=new Re("field"),Re.INPUT=new Re("input"),Re.RENDERER=new Re("renderer"),Re.TOOLBOX=new Re("toolbox"),Re.THEME=new Re("theme"),Re.TOOLBOX_ITEM=new Re("toolboxItem"),Re.FLYOUTS_VERTICAL_TOOLBOX=new Re("flyoutsVerticalToolbox"),Re.FLYOUTS_HORIZONTAL_TOOLBOX=new Re("flyoutsHorizontalToolbox"),Re.FLYOUT_INFLATER=new Re("flyoutInflater"),Re.METRICS_MANAGER=new Re("metricsManager"),Re.BLOCK_DRAGGER=new Re("blockDragger"),Re.SERIALIZER=new Re("serializer"),Re.ICON=new Re("icon"),Re.PASTER=new Re("paster"),Re.VARIABLE_MODEL=new Re("variableModel"),Re.VARIABLE_MAP=new Re("variableMap");var rl={DEFAULT:Po,TEST_ONLY:Gp};rl.Type=Re,rl.getAllItems=H,rl.getClass=N,rl.getClassFromOptions=D,rl.getObject=O,rl.hasItem=A,rl.register=a,rl.unregister=E;var Vn=Object.create(null),Vp=750,Wa="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),ja=null,Rr={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]},ih=0,jl={TOUCH_ENABLED:Wa,TOUCH_MAP:Rr};jl.checkTouchIdentifier=Ke,jl.clearTouchIdentifier=Oe,jl.getTouchIdentifierFromEvent=Xe,jl.longStart=j,jl.longStop=be,jl.shouldHandleEvent=ve;var ju,Lf,Td,Df,Xa,Ya,vd,xf,Xl,Bf;(function(e){function t(s){return i.includes(s.toUpperCase())}ju=e;const i=ju.toUpperCase();Lf=t("JavaFX"),Td=t("WebKit"),Df=t("Gecko")&&!Td,Xa=t("Android"),e=globalThis.navigator&&globalThis.navigator.maxTouchPoints,Ya=t("iPad")||t("Macintosh")&&e>0,vd=t("iPhone")&&!Ya,xf=t("Macintosh"),Xl=Ya||Xa&&!t("Mobile")||t("Silk"),Bf=!Xl&&(vd||Xa)})(globalThis.navigator&&globalThis.navigator.userAgent||"");var zp=ju,Pf=Lf,oh=Df,yd=Xa,Ka=Ya,Ff=vd,Sd=xf,Wp=Bf,Uf={ANDROID:yd,GECKO:oh,IPAD:Ka,IPHONE:Ff,JavaFx:Pf,MAC:Sd,MOBILE:Wp,raw:zp},pi=40,Ui=125,Ir={};Ir.bind=Le,Ir.conditionalBind=_e,Ir.getScrollDeltaPixels=at,Ir.isRightButton=De,Ir.isTargetInput=rt,Ir.mouseToSvg=xe,Ir.unbind=Ae;var ce;(function(e){e.BLOCK_CREATE="create",e.BLOCK_DELETE="delete",e.BLOCK_CHANGE="change",e.BLOCK_FIELD_INTERMEDIATE_CHANGE="block_field_intermediate_change",e.BLOCK_MOVE="move",e.VAR_CREATE="var_create",e.VAR_DELETE="var_delete",e.VAR_RENAME="var_rename",e.VAR_TYPE_CHANGE="var_type_change",e.UI="ui",e.BLOCK_DRAG="drag",e.SELECTED="selected",e.CLICK="click",e.MARKER_MOVE="marker_move",e.BUBBLE_OPEN="bubble_open",e.TRASHCAN_OPEN="trashcan_open",e.TOOLBOX_ITEM_SELECT="toolbox_item_select",e.THEME_CHANGE="theme_change",e.VIEWPORT_CHANGE="viewport_change",e.COMMENT_CREATE="comment_create",e.COMMENT_DELETE="comment_delete",e.COMMENT_CHANGE="comment_change",e.COMMENT_MOVE="comment_move",e.COMMENT_RESIZE="comment_resize",e.COMMENT_DRAG="comment_drag",e.COMMENT_COLLAPSE="comment_collapse",e.FINISHED_LOADING="finished_loading"})(ce||(ce={}));var Hf=[ce.BLOCK_CREATE,ce.BLOCK_MOVE,ce.COMMENT_CREATE,ce.COMMENT_MOVE],Gf="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",qa={genUid:()=>{const e=Gf.length,t=[];for(let i=0;i<20;i++)t[i]=Gf.charAt(Math.random()*e);return t.join("")}},jp=0,Ja={TEST_ONLY:qa};Ja.genUid=ot,Ja.getNextUniqueId=ht;var Vf="",sh=!0,Za=0,rh="ORPHANED_BLOCK",Or=[],zf={FIRE_QUEUE:Or,enqueueEvent:He,fireNow:Ce,fireInternal:J,setGroupInternal:Pt};l.disable$$module$build$src$core$events$utils,l.enable$$module$build$src$core$events$utils,l.getGroup$$module$build$src$core$events$utils,l.setGroup$$module$build$src$core$events$utils,l.setRecordUndo$$module$build$src$core$events$utils;var Qa="http://www.w3.org/2000/svg",ll="http://www.w3.org/1999/xhtml",Co="http://www.w3.org/1999/xlink",zs;(function(e){e[e.ELEMENT_NODE=1]="ELEMENT_NODE",e[e.TEXT_NODE=3]="TEXT_NODE",e[e.COMMENT_NODE=8]="COMMENT_NODE"})(zs||(zs={}));var Os=null,lh=0,Yl=null,bi={HTML_NS:ll};bi.NodeType=zs,bi.SVG_NS=Qa,bi.XLINK_NS=Co,bi.addClass=We,bi.createSvgElement=ae,bi.getFastTextWidth=so,bi.getFastTextWidthWithSizeString=In,bi.getTextWidth=bn,bi.hasClass=Si,bi.insertAfter=Yi,bi.measureFontMetrics=X,bi.removeClass=vt,bi.removeClasses=Mn,bi.removeNode=Wt,bi.setCssTransform=Ki,bi.startTextWidthCache=Ln,bi.stopTextWidthCache=_n;var Ai=class{static findFocusedNode(e){var t=e.getRootFocusableNode();if(!t.canBeFocused())return null;var i=t.getFocusableElement();return Si(i,Ai.ACTIVE_CLASS_NAME)||Si(i,Ai.PASSIVE_CSS_CLASS_NAME)||(t=i.querySelector(this.ACTIVE_FOCUS_NODE_CSS_SELECTOR),(t instanceof HTMLElement||t instanceof SVGElement)&&(t=Ai.findFocusableNodeFor(t,e)))?t:(i=i.querySelector(this.PASSIVE_FOCUS_NODE_CSS_SELECTOR),(i instanceof HTMLElement||i instanceof SVGElement)&&(e=Ai.findFocusableNodeFor(i,e))?e:null)}static findFocusableNodeFor(e,t){if(!e.id||e.id==="null"||t.getNestedTrees().map(c=>Ai.findFocusableNodeFor(e,c)).findIndex(c=>!!c)!==-1)return null;var i=t.getRootFocusableNode();if(i.canBeFocused()&&e===i.getFocusableElement())return i;var s;return(i=(s=t.lookUpFocusableNode(e.id))!=null?s:null)?i:(s=e.parentElement,!i&&s?Ai.findFocusableNodeFor(s,t):null)}};Ai.ACTIVE_CLASS_NAME="blocklyActiveFocus",Ai.PASSIVE_CSS_CLASS_NAME="blocklyPassiveFocus",Ai.ACTIVE_FOCUS_NODE_CSS_SELECTOR=`.${Ai.ACTIVE_CLASS_NAME}`,Ai.PASSIVE_FOCUS_NODE_CSS_SELECTOR=`.${Ai.PASSIVE_CSS_CLASS_NAME}`;var Wf=class{constructor(e,t){this.tree=e,this.rootShouldBeAutoTabbable=t}},Hi=class{constructor(e){this.previouslyFocusedNode=this.focusedNode=null,this.registeredTrees=[],this.isUpdatingFocusedNode=this.recentlyLostAllFocus=this.lockFocusStateChanges=this.currentlyHoldsEphemeralFocus=!1;const t=i=>{if(!this.isUpdatingFocusedNode){this.recentlyLostAllFocus=!i;var s=null;if(i instanceof HTMLElement||i instanceof SVGElement){for(var c of this.registeredTrees)if(s=Ai.findFocusableNodeFor(i,c.tree))break}if(s&&s.canBeFocused()){i=s.getFocusableTree();let m;c=(m=this.focusedNode)==null?void 0:m.getFocusableTree(),s===i.getRootFocusableNode()&&i!==c?this.focusTree(i):this.focusNode(s)}else this.defocusCurrentFocusedNode()}};e("focusin",i=>{i instanceof FocusEvent&&t(document.activeElement)}),e("focusout",i=>{i instanceof FocusEvent&&t(i.relatedTarget)})}registerTree(e,t=!1){if(this.ensureManagerIsUnlocked(),this.isRegistered(e))throw Error(`Attempted to re-register already registered tree: ${e}.`);this.registeredTrees.push(new Wf(e,t));const i=e.getRootFocusableNode().getFocusableElement();if(!i.id||i.id==="null")throw Error(`Attempting to register a tree with a root element that has an invalid ID: ${e}.`);t&&(i.tabIndex=0)}isRegistered(e){return!!this.lookUpRegistration(e)}lookUpRegistration(e){let t;return(t=this.registeredTrees.find(i=>i.tree===e))!=null?t:null}unregisterTree(e){if(this.ensureManagerIsUnlocked(),!this.isRegistered(e))throw Error(`Attempted to unregister not registered tree: ${e}.`);var t=this.registeredTrees.findIndex(c=>c.tree===e);const i=this.registeredTrees[t];this.registeredTrees.splice(t,1),t=Ai.findFocusedNode(e);const s=e.getRootFocusableNode();t&&this.removeHighlight(t),this.focusedNode!==t&&this.focusedNode!==s||this.updateFocusedNode(null),this.removeHighlight(s),i.rootShouldBeAutoTabbable&&e.getRootFocusableNode().getFocusableElement().removeAttribute("tabindex")}getFocusedTree(){let e,t;return(t=(e=this.focusedNode)==null?void 0:e.getFocusableTree())!=null?t:null}getFocusedNode(){return this.focusedNode}focusTree(e){if(this.ensureManagerIsUnlocked(),!this.isRegistered(e))throw Error(`Attempted to focus unregistered tree: ${e}.`);const t=Ai.findFocusedNode(e),i=e.getRestoredFocusableNode(t);e=e.getRootFocusableNode();let s;this.focusNode((s=i??t)!=null?s:e)}focusNode(e){this.ensureManagerIsUnlocked();const t=!this.currentlyHoldsEphemeralFocus;t&&(this.isUpdatingFocusedNode=!0);var i,s=((i=this.focusedNode)==null?void 0:i.getFocusableElement())!==document.activeElement;if(this.focusedNode!==e||s)if(e.canBeFocused()){if(i=e.getFocusableTree(),!this.isRegistered(i))throw Error(`Attempted to focus unregistered node: ${e}.`);s=e.getFocusableElement(),s.id&&s.id!=="null"||console.warn("Trying to focus a node that has an invalid ID.");var c=Ai.findFocusableNodeFor(s,i);s=Ai.findFocusedNode(i);var m=e;if(c!==e){m=i.getRestoredFocusableNode(s),e=i.getRootFocusableNode();var I;m=(I=m??s)!=null?I:e}e=this.focusedNode,I=e?.getFocusableTree(),e&&this.passivelyFocusNode(e,i),i=i.getRootFocusableNode(),s&&this.removeHighlight(s),i!==m&&this.removeHighlight(i),this.currentlyHoldsEphemeralFocus||this.activelyFocusNode(m,I??null),this.updateFocusedNode(m)}else console.warn("Trying to focus a node that can't be focused.");t&&(this.isUpdatingFocusedNode=!1)}takeEphemeralFocus(e){if(this.ensureManagerIsUnlocked(),this.currentlyHoldsEphemeralFocus)throw Error(`Attempted to take ephemeral focus when it's already held, with new element: ${e}.`);this.currentlyHoldsEphemeralFocus=!0,this.focusedNode&&this.passivelyFocusNode(this.focusedNode,null),e.focus({preventScroll:!0});let t=!1;return()=>{if(t)throw Error(`Attempted to finish ephemeral focus twice for element: ${e}.`);if(t=!0,this.currentlyHoldsEphemeralFocus=!1,this.focusedNode){this.activelyFocusNode(this.focusedNode,null);const i=this.focusedNode;setTimeout(()=>{!this.focusedNode&&this.previouslyFocusedNode===i&&this.recentlyLostAllFocus&&this.focusNode(i)},0)}}}ephemeralFocusTaken(){return this.currentlyHoldsEphemeralFocus}ensureManagerIsUnlocked(){if(this.lockFocusStateChanges)throw Error("FocusManager state changes cannot happen in a tree/node focus/blur callback.")}updateFocusedNode(e){this.previouslyFocusedNode=this.focusedNode,this.focusedNode=e}defocusCurrentFocusedNode(){this.focusedNode&&!this.currentlyHoldsEphemeralFocus&&(this.passivelyFocusNode(this.focusedNode,null),this.updateFocusedNode(null))}activelyFocusNode(e,t){this.lockFocusStateChanges=!0;const i=e.getFocusableTree(),s=e.getFocusableElement();let c;const m=(c=this.lookUpRegistration(i))==null?void 0:c.rootShouldBeAutoTabbable;i!==t&&(i.onTreeFocus(e,t),m&&(i.getRootFocusableNode().getFocusableElement().tabIndex=-1)),e.onNodeFocus(),this.lockFocusStateChanges=!1,m&&e===i.getRootFocusableNode()||s.hasAttribute("tabindex")||(s.tabIndex=-1),this.setNodeToVisualActiveFocus(e),s.focus({preventScroll:!0})}passivelyFocusNode(e,t){this.lockFocusStateChanges=!0;const i=e.getFocusableTree();if(i!==t){i.onTreeBlur(t);let s;(s=this.lookUpRegistration(i))!=null&&s.rootShouldBeAutoTabbable&&(i.getRootFocusableNode().getFocusableElement().tabIndex=0)}e.onNodeBlur(),this.lockFocusStateChanges=!1,i!==t&&this.setNodeToVisualPassiveFocus(e)}setNodeToVisualActiveFocus(e){e=e.getFocusableElement(),We(e,Hi.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),vt(e,Hi.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}setNodeToVisualPassiveFocus(e){e=e.getFocusableElement(),vt(e,Hi.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),We(e,Hi.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}removeHighlight(e){e=e.getFocusableElement(),vt(e,Hi.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),vt(e,Hi.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}static getFocusManager(){return Hi.focusManager||(Hi.focusManager=new Hi(document.addEventListener)),Hi.focusManager}};Hi.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME="blocklyActiveFocus",Hi.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME="blocklyPassiveFocus",Hi.focusManager=null,l.getFocusManager$$module$build$src$core$focus_manager;var Ar={};Ar.deepMerge=Ht;var mn=class{constructor(){this.shortcuts=new Map,this.keyMap=new Map,this.reset()}reset(){this.shortcuts.clear(),this.keyMap.clear()}register(e,t){if(this.shortcuts.get(e.name)&&!t)throw Error(`Shortcut named "${e.name}" already exists.`);if(this.shortcuts.set(e.name,e),t=e.keyCodes,t!=null&&t.length)for(const i of t)this.addKeyMapping(i,e.name,!!e.allowCollision)}unregister(e){return this.shortcuts.get(e)?(this.removeAllKeyMappings(e),this.shortcuts.delete(e),!0):(console.warn(`Keyboard shortcut named "${e}" not found.`),!1)}addKeyMapping(e,t,i){e=`${e}`;const s=this.keyMap.get(e);if(s&&!i)throw Error(`Shortcut named "${t}" collides with shortcuts "${s}"`);s&&i?s.unshift(t):this.keyMap.set(e,[t])}removeKeyMapping(e,t,i){const s=this.keyMap.get(e);if(!s)return i||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),!1;const c=s.indexOf(t);return c>-1?(s.splice(c,1),s.length===0&&this.keyMap.delete(e),!0):(i||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),!1)}removeAllKeyMappings(e){for(const t of this.keyMap.keys())this.removeKeyMapping(t,e,!0)}setKeyMap(e){this.keyMap.clear();for(const t in e)this.keyMap.set(t,e[t])}getKeyMap(){const e=Object.create(null);for(const[t,i]of this.keyMap)e[t]=i;return e}getRegistry(){const e=Object.create(null);for(const[t,i]of this.shortcuts)e[t]=i;return Ht(Object.create(null),e)}onKeyDown(e,t){var i=this.serializeKeyEvent(t);if(i=this.getShortcutNamesByKeyCode(i),!i)return!1;for(const s of i){i=this.shortcuts.get(s);let c;if(!i||i.preconditionFn&&!i.preconditionFn(e,{focusedNode:(c=l.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode())!=null?c:void 0}))continue;let m,I,B;if((I=(m=i).callback)!=null&&I.call(m,e,t,i,{focusedNode:(B=l.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode())!=null?B:void 0}))return!0}return!1}getShortcutNamesByKeyCode(e){let t;return((t=this.keyMap.get(e))==null?void 0:t.slice())||[]}getKeyCodesByShortcutName(e){const t=[];for(const[i,s]of this.keyMap)s.indexOf(e)>-1&&t.push(i);return t}serializeKeyEvent(e){let t="";for(const i in mn.modifierKeys)e.getModifierState(i)&&(t!==""&&(t+="+"),t+=i);return t!==""&&e.keyCode?t+="+"+e.keyCode:e.keyCode&&(t=String(e.keyCode)),t}checkModifiers(e){for(const t of e)if(!(t in mn.modifierKeys))throw Error(t+" is not a valid modifier key.")}createSerializedKey(e,t){let i="";if(t){this.checkModifiers(t);for(const s in mn.modifierKeys)t.includes(mn.modifierKeys[s])&&(i!==""&&(i+="+"),i+=s)}return i!==""&&e?i+="+"+e:e&&(i=`${e}`),i}};mn.registry=new mn,(function(e){e=e.modifierKeys||(e.modifierKeys={}),e[e.Shift=16]="Shift",e[e.Control=17]="Control",e[e.Alt=18]="Alt",e[e.Meta=91]="Meta"})(mn||(mn={}));var uh=Object.create(null),jf,wr,Xu=[],Xf={defineBlocksWithJsonArrayInternal:G},li={TEST_ONLY:Xf};li.createBlockDefinitionsFromJsonArray=l.createBlockDefinitionsFromJsonArray$$module$build$src$core$common,li.defineBlocks=l.defineBlocks$$module$build$src$core$common,li.defineBlocksWithJsonArray=M,li.draggingConnections=Xu,li.fireSelectedEvent=Fe,li.getAllWorkspaces=Xn,li.getBlockTypeCounts=$i,li.getMainWorkspace=v,li.getParentContainer=Ft,li.getSelected=Y,li.getWorkspaceById=sn,li.globalShortcutHandler=ee,li.registerWorkspace=qt,li.setMainWorkspace=L,li.setParentContainer=ki,li.setSelected=F,li.svgResize=je,li.unregisterWorkpace=Yn;var Nr=class{constructor(){this.workspaceId=void 0,this.isUiEvent=!1,this.type="",this.group=l.getGroup$$module$build$src$core$events$utils(),this.recordUndo=_t()}toJson(){return{type:this.type,group:this.group}}static fromJson(e,t,i){return i.isBlank=!1,i.group=e.group||"",i.workspaceId=t.id,i}isNull(){return!1}run(e){}getEventWorkspace_(){let e;if(this.workspaceId&&(e=sn(this.workspaceId)),!e)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return e}},tn=class extends Nr{constructor(e){super(),this.recordUndo=!1,this.isUiEvent=!0,this.isBlank=typeof e>"u",this.workspaceId=e||""}},Yf=class extends tn{constructor(e,t,i){t=e?e.workspace.id:t,t===null&&(t=void 0),super(t),this.type=ce.CLICK,this.blockId=e?e.id:void 0,this.targetType=i}toJson(){const e=super.toJson();if(!this.targetType)throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson");return e.targetType=this.targetType,e.blockId=this.blockId,e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new Yf),t.targetType=e.targetType,t.blockId=e.blockId,t}},Kf;(function(e){e.BLOCK="block",e.WORKSPACE="workspace",e.ZOOM_CONTROLS="zoom_controls"})(Kf||(Kf={})),a(Re.EVENT,ce.CLICK,Yf);var qf={};qf.removeElem=Te;var ls=class{constructor(e){this.name=e}toString(){return this.name}};ls.POSITIONABLE=new ls("positionable"),ls.DRAG_TARGET=new ls("drag_target"),ls.DELETE_AREA=new ls("delete_area"),ls.AUTOHIDEABLE=new ls("autohideable");var un=class{constructor(){this.componentData=new Map,this.capabilityToComponentIds=new Map}addComponent(e,t){const i=e.component.id;if(!t&&this.componentData.has(i)){var s;throw Error('Plugin "'+i+'" with capabilities "'+((s=this.componentData.get(i))==null?void 0:s.capabilities)+'" already added.')}for(this.componentData.set(i,e),t=[],s=0;s<e.capabilities.length;s++){const c=String(e.capabilities[s]).toLowerCase();if(t.push(c),this.capabilityToComponentIds.has(c)){let m;(m=this.capabilityToComponentIds.get(c))==null||m.push(i)}else this.capabilityToComponentIds.set(c,[i])}this.componentData.get(i).capabilities=t}removeComponent(e){const t=this.componentData.get(e);if(t){for(let i=0;i<t.capabilities.length;i++){const s=String(t.capabilities[i]).toLowerCase();Te(this.capabilityToComponentIds.get(s),e)}this.componentData.delete(e)}}addCapability(e,t){if(!this.getComponent(e))throw Error('Cannot add capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');if(this.hasCapability(e,t))console.warn('Plugin "'+e+'already has capability "'+t+'"');else{t=`${t}`.toLowerCase();var i;(i=this.componentData.get(e))==null||i.capabilities.push(t);var s;(s=this.capabilityToComponentIds.get(t))==null||s.push(e)}}removeCapability(e,t){if(!this.getComponent(e))throw Error('Cannot remove capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');this.hasCapability(e,t)?(t=`${t}`.toLowerCase(),Te(this.componentData.get(e).capabilities,t),Te(this.capabilityToComponentIds.get(t),e)):console.warn('Plugin "'+e+`doesn't have capability "`+t+'" to remove')}hasCapability(e,t){return t=`${t}`.toLowerCase(),this.componentData.has(e)&&this.componentData.get(e).capabilities.includes(t)}getComponent(e){let t;return(t=this.componentData.get(e))==null?void 0:t.component}getComponents(e,t){if(e=`${e}`.toLowerCase(),e=this.capabilityToComponentIds.get(e),!e)return[];const i=[];if(t){const s=[];e.forEach(c=>{s.push(this.componentData.get(c))}),s.sort(function(c,m){return c.weight-m.weight}),s.forEach(function(c){i.push(c.component)})}else e.forEach(s=>{i.push(this.componentData.get(s).component)});return i}};un.Capability=ls,(function(e){e=e.ComponentWeight||(e.ComponentWeight={}),e[e.TOOLBOX_WEIGHT=0]="TOOLBOX_WEIGHT",e[e.FLYOUT_WEIGHT=1]="FLYOUT_WEIGHT",e[e.TRASHCAN_WEIGHT=2]="TRASHCAN_WEIGHT",e[e.ZOOM_CONTROLS_WEIGHT=3]="ZOOM_CONTROLS_WEIGHT"})(un||(un={})),un.ComponentWeight;var Cd=!1,Rd=`
.blocklySvg {
  background-color: #fff;
  outline: none;
  overflow: hidden;  /* IE overflows by default. */
  position: absolute;
  display: block;
}

.blocklyWidgetDiv {
  display: none;
  position: absolute;
  z-index: 99999;  /* big value for bootstrap3 compatibility */
}

.injectionDiv {
  height: 100%;
  position: relative;
  overflow: hidden;  /* So blocks in drag surface disappear at edges */
  touch-action: none;
  user-select: none;
  -webkit-user-select: none;
}

.blocklyBlockCanvas.blocklyCanvasTransitioning,
.blocklyBubbleCanvas.blocklyCanvasTransitioning {
  transition: transform .5s;
}

.blocklyEmboss {
  filter: var(--blocklyEmbossFilter);
}

.blocklyTooltipDiv {
  background-color: #ffffc7;
  border: 1px solid #ddc;
  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);
  color: #000;
  display: none;
  font: 9pt sans-serif;
  opacity: .9;
  padding: 2px;
  position: absolute;
  z-index: 100000;  /* big value for bootstrap3 compatibility */
}

.blocklyDropDownDiv {
  position: absolute;
  left: 0;
  top: 0;
  z-index: 1000;
  display: none;
  border: 1px solid;
  border-color: #dadce0;
  background-color: #fff;
  border-radius: 2px;
  padding: 4px;
  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);
}

.blocklyDropDownDiv:focus {
  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);
}

.blocklyDropDownContent {
  max-height: 300px;  /* @todo: spec for maximum height. */
}

.blocklyDropDownArrow {
  position: absolute;
  left: 0;
  top: 0;
  width: 16px;
  height: 16px;
  z-index: -1;
  background-color: inherit;
  border-color: inherit;
  border-top: 1px solid;
  border-left: 1px solid;
  border-top-left-radius: 4px;
  border-color: inherit;
}

.blocklyHighlighted>.blocklyPath {
  filter: var(--blocklyEmbossFilter);
}

.blocklyHighlightedConnectionPath {
  fill: none;
  stroke: #fc3;
  stroke-width: 4px;
}

.blocklyPathLight {
  fill: none;
  stroke-linecap: round;
  stroke-width: 1;
}

.blocklySelected>.blocklyPathLight {
  display: none;
}

.blocklyDraggable {
  cursor: grab;
  cursor: -webkit-grab;
}

.blocklyDragging {
  cursor: grabbing;
  cursor: -webkit-grabbing;
  /* Drag surface disables events to not block the toolbox, so we have to
   * reenable them here for the cursor values to work. */
  pointer-events: auto;
}

  /* Changes cursor on mouse down. Not effective in Firefox because of
     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */
.blocklyDraggable:active {
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

.blocklyDragging.blocklyDraggingDelete,
.blocklyDragging.blocklyDraggingDelete .blocklyField {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyDragging>.blocklyPath,
.blocklyDragging>.blocklyPathLight {
  fill-opacity: .8;
  stroke-opacity: .8;
}

.blocklyDragging>.blocklyPathDark {
  display: none;
}

.blocklyDisabledPattern>.blocklyPath {
  fill: var(--blocklyDisabledPattern);
  fill-opacity: .5;
  stroke-opacity: .5;
}

.blocklyDisabled>.blocklyPathLight,
.blocklyDisabled>.blocklyPathDark {
  display: none;
}

.blocklyInsertionMarker>.blocklyPath,
.blocklyInsertionMarker>.blocklyPathLight,
.blocklyInsertionMarker>.blocklyPathDark {
  fill-opacity: .2;
  stroke: none;
}

.blocklyNonEditableField>text {
  pointer-events: none;
}

.blocklyFlyout {
  position: absolute;
  z-index: 20;
}

.blocklyText text {
  cursor: default;
}

/*
  Don't allow users to select text.  It gets annoying when trying to
  drag a block and selected text moves instead.
*/
.blocklySvg text {
  user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
  cursor: inherit;
}

.blocklyIconGroup {
  cursor: default;
}

.blocklyIconGroup:not(:hover):not(:focus),
.blocklyIconGroupReadonly {
  opacity: .6;
}

.blocklyIconShape {
  fill: #00f;
  stroke: #fff;
  stroke-width: 1px;
}

.blocklyIconSymbol {
  fill: #fff;
}

.blocklyMinimalBody {
  margin: 0;
  padding: 0;
  height: 100%;
}

.blocklyHtmlInput {
  border: none;
  border-radius: 4px;
  height: 100%;
  margin: 0;
  outline: none;
  padding: 0;
  width: 100%;
  text-align: center;
  display: block;
  box-sizing: border-box;
}

/* Remove the increase and decrease arrows on the field number editor */
input.blocklyHtmlInput[type=number]::-webkit-inner-spin-button,
input.blocklyHtmlInput[type=number]::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

input[type=number] {
  -moz-appearance: textfield;
}

.blocklyMainBackground {
  stroke-width: 1;
  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */
}

.blocklyMutatorBackground {
  fill: #fff;
  stroke: #ddd;
  stroke-width: 1;
}

.blocklyFlyoutBackground {
  fill: #ddd;
  fill-opacity: .8;
}

.blocklyMainWorkspaceScrollbar {
  z-index: 20;
}

.blocklyFlyoutScrollbar {
  z-index: 30;
}

.blocklyScrollbarHorizontal,
.blocklyScrollbarVertical {
  position: absolute;
  outline: none;
}

.blocklyScrollbarBackground {
  opacity: 0;
  pointer-events: none;
}

.blocklyScrollbarHandle {
  fill: #ccc;
}

.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,
.blocklyScrollbarHandle:hover {
  fill: #bbb;
}

/* Darken flyout scrollbars due to being on a grey background. */
/* By contrast, workspace scrollbars are on a white background. */
.blocklyFlyout .blocklyScrollbarHandle {
  fill: #bbb;
}

.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,
.blocklyFlyout .blocklyScrollbarHandle:hover {
  fill: #aaa;
}

.blocklyInvalidInput {
  background: #faa;
}

.blocklyVerticalMarker {
  stroke-width: 3px;
  fill: rgba(255,255,255,.5);
  pointer-events: none;
}

.blocklyComputeCanvas {
  position: absolute;
  width: 0;
  height: 0;
}

.blocklyNoPointerEvents {
  pointer-events: none;
}

.blocklyContextMenu {
  border-radius: 4px;
  max-height: 100%;
}

.blocklyDropdownMenu {
  border-radius: 2px;
  padding: 0 !important;
}

.blocklyDropdownMenu .blocklyMenuItem {
  /* 28px on the left for icon or checkbox. */
  padding-left: 28px;
}

/* BiDi override for the resting state. */
.blocklyDropdownMenu .blocklyMenuItemRtl {
  /* Flip left/right padding for BiDi. */
  padding-left: 5px;
  padding-right: 28px;
}

.blocklyWidgetDiv .blocklyMenu {
  user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
  background: #fff;
  border: 1px solid transparent;
  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);
  font: normal 13px Arial, sans-serif;
  margin: 0;
  outline: none;
  padding: 4px 0;
  position: absolute;
  overflow-y: auto;
  overflow-x: hidden;
  max-height: 100%;
  z-index: 20000;  /* Arbitrary, but some apps depend on it... */
}

.blocklyWidgetDiv .blocklyMenu:focus {
  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);
}

.blocklyDropDownDiv .blocklyMenu {
  user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
  background: inherit;  /* Compatibility with gapi, reset from goog-menu */
  border: inherit;  /* Compatibility with gapi, reset from goog-menu */
  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;
  outline: none;
  overflow-y: auto;
  overflow-x: hidden;
  max-height: 100%;
  z-index: 20000;  /* Arbitrary, but some apps depend on it... */
}

/* State: resting. */
.blocklyMenuItem {
  border: none;
  color: #000;
  cursor: pointer;
  list-style: none;
  margin: 0;
  /* 7em on the right for shortcut. */
  min-width: 7em;
  padding: 6px 15px;
  white-space: nowrap;
}

/* State: disabled. */
.blocklyMenuItemDisabled {
  color: #ccc;
  cursor: inherit;
}

/* State: hover. */
.blocklyMenuItemHighlight {
  background-color: rgba(0,0,0,.1);
}

/* State: selected/checked. */
.blocklyMenuItemCheckbox {
  height: 16px;
  position: absolute;
  width: 16px;
}

.blocklyMenuItemSelected .blocklyMenuItemCheckbox {
  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;
  float: left;
  margin-left: -24px;
  position: static;  /* Scroll with the menu. */
}

.blocklyMenuItemRtl .blocklyMenuItemCheckbox {
  float: right;
  margin-right: -24px;
}

.blocklyMenuSeparator {
  background-color: #ccc;
  height: 1px;
  border: 0;
  margin-left: 4px;
  margin-right: 4px;
}

.blocklyBlockDragSurface, .blocklyAnimationLayer {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: visible !important;
  z-index: 80;
  pointer-events: none;
}

.blocklyField {
  cursor: default;
}

.blocklyInputField {
  cursor: text;
}

.blocklyDragging .blocklyField,
.blocklyDragging .blocklyIconGroup {
  cursor: grabbing;
}

.blocklyActiveFocus:is(
  .blocklyFlyout,
  .blocklyWorkspace,
  .blocklyField,
  .blocklyPath,
  .blocklyHighlightedConnectionPath,
  .blocklyComment,
  .blocklyBubble,
  .blocklyIconGroup,
  .blocklyTextarea
) {
  outline: none;
}
`,Yu={};Yu.inject=dt,Yu.register=qe;var Ne=class{constructor(e,t){this.x=e,this.y=t}clone(){return new Ne(this.x,this.y)}scale(e){return this.x*=e,this.y*=e,this}translate(e,t){return this.x+=e,this.y+=t,this}static equals(e,t){return e===t?!0:e&&t?e.x===t.x&&e.y===t.y:!1}static distance(e,t){const i=e.x-t.x;return e=e.y-t.y,Math.sqrt(i*i+e*e)}static magnitude(e){return Math.sqrt(e.x*e.x+e.y*e.y)}static difference(e,t){return new Ne(e.x-t.x,e.y-t.y)}static sum(e,t){return new Ne(e.x+t.x,e.y+t.y)}},le=class{constructor(e){this.tagName=e}toString(){return this.tagName}};le.ANIMATE=new le("animate"),le.CIRCLE=new le("circle"),le.CLIPPATH=new le("clipPath"),le.DEFS=new le("defs"),le.FECOMPOSITE=new le("feComposite"),le.FECOMPONENTTRANSFER=new le("feComponentTransfer"),le.FEFLOOD=new le("feFlood"),le.FEFUNCA=new le("feFuncA"),le.FEGAUSSIANBLUR=new le("feGaussianBlur"),le.FEPOINTLIGHT=new le("fePointLight"),le.FESPECULARLIGHTING=new le("feSpecularLighting"),le.FILTER=new le("filter"),le.FOREIGNOBJECT=new le("foreignObject"),le.G=new le("g"),le.IMAGE=new le("image"),le.LINE=new le("line"),le.PATH=new le("path"),le.PATTERN=new le("pattern"),le.POLYGON=new le("polygon"),le.RECT=new le("rect"),le.SVG=new le("svg"),le.TEXT=new le("text"),le.TSPAN=new le("tspan");var Nt=class{constructor(e,t,i,s){this.top=e,this.bottom=t,this.left=i,this.right=s}static from(e){return new Nt(e.y,e.y+e.height,e.x,e.x+e.width)}clone(){return new Nt(this.top,this.bottom,this.left,this.right)}getHeight(){return this.bottom-this.top}getWidth(){return this.right-this.left}getOrigin(){return new Ne(this.left,this.top)}contains(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom}intersects(e){return this.left<=e.right&&this.right>=e.left&&this.bottom>=e.top&&this.top<=e.bottom}static equals(e,t){return e===t?!0:e&&t?e.top===t.top&&e.bottom===t.bottom&&e.left===t.left&&e.right===t.right:!1}static createFromPoint(e,t,i){const s=e.x;return e=e.y,new Nt(e,e+i,s,s+t)}},Mt=class{constructor(e,t){this.width=e,this.height=t}static equals(e,t){return e===t?!0:e&&t?e.width===t.width&&e.height===t.height:!1}static max(e,t){return new Mt(Math.max(e.width,t.width),Math.max(e.height,t.height))}static min(e,t){return new Mt(Math.min(e.width,t.width),Math.min(e.height,t.height))}},Id={getSizeInternal:En},kr={TEST_ONLY:Id};kr.getBorderBox=ro,kr.getComputedStyle=St,kr.getContainerOffsetToScrollInto=mo,kr.getPageOffset=jt,kr.getSize=Qt,kr.getViewportPageOffset=qo,kr.scrollIntoContainerView=Mi;var ah=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,Jf=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,ul={XY_REGEX:ah,XY_STYLE_REGEX:Jf},Pn={TEST_ONLY:ul};Pn.getDocumentScroll=qi,Pn.getInjectionDivXY=Tn,Pn.getRelativeXY=Li,Pn.getViewportBBox=Qn,Pn.screenToWsCoordinates=fs,Pn.wsToScreenCoordinates=vl;var qn=class{constructor(e,t,i,s,c){this.workspace=e,this.horizontal=t,this.oldHostMetrics=null,this.ratio=1,this.origin=new Ne(0,0),this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0,this.containerVisible=this.isHandleVisible=!0,this.position=new Ne(0,0),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.pair=i||!1,this.margin=c!==void 0?c:qn.DEFAULT_SCROLLBAR_MARGIN,e="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical"),s&&(e+=" "+s),this.outerSvg=ae(le.SVG,{class:e}),s=ae(le.G,{},this.outerSvg),this.svgBackground=ae(le.RECT,{class:"blocklyScrollbarBackground"},s),e=Math.floor((qn.scrollbarThickness-5)/2),this.svgHandle=ae(le.RECT,{class:"blocklyScrollbarHandle",rx:e,ry:e},s),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill"),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity"),Yi(this.outerSvg,this.workspace.getParentSvg()),this.setInitialThickness(),t?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=_e(this.svgBackground,"pointerdown",this,this.onMouseDownBar),this.onMouseDownHandleWrapper_=_e(this.svgHandle,"pointerdown",this,this.onMouseDownHandle)}setInitialThickness(){const e=qn.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(e)),this.outerSvg.setAttribute("height",String(e)),this.svgHandle.setAttribute("height",String(e-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(e)),this.outerSvg.setAttribute("width",String(e)),this.svgHandle.setAttribute("width",String(e-5)),this.svgHandle.setAttribute("x","2.5"))}dispose(){this.cleanUp(),Ae(this.onMouseDownBarWrapper_),Ae(this.onMouseDownHandleWrapper_),Wt(this.outerSvg),this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(e){return e=e<=0||isNaN(e)?0:Math.min(e,this.scrollbarLength)}setHandleLength(e){this.handleLength=e,this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(e){return e=e<=0||isNaN(e)?0:Math.min(e,this.scrollbarLength-this.handleLength)}setHandlePosition(e){this.handlePosition=e,this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition))}setScrollbarLength(e){this.scrollbarLength=e,this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength)),this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(e,t){this.position.x=e,this.position.y=t,Ki(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)")}resize(e){!e&&(e=this.workspace.getMetrics(),!e)||this.oldHostMetrics&&qn.metricsAreEquivalent(e,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(e):this.resizeVertical(e),this.oldHostMetrics=e,this.updateMetrics())}requiresViewResize(e){return this.oldHostMetrics?this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft||this.oldHostMetrics.absoluteTop!==e.absoluteTop:!0}resizeHorizontal(e){this.requiresViewResize(e)?this.resizeViewHorizontal(e):this.resizeContentHorizontal(e)}resizeViewHorizontal(e){var t=e.viewWidth-this.margin*2;this.pair&&(t-=qn.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),t=e.absoluteLeft+this.margin,this.pair&&this.workspace.RTL&&(t+=qn.scrollbarThickness),this.setPosition(t,e.absoluteTop+e.viewHeight-qn.scrollbarThickness-this.margin),this.resizeContentHorizontal(e)}resizeContentHorizontal(e){if(e.viewWidth>=e.scrollWidth)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var t=this.scrollbarLength*e.viewWidth/e.scrollWidth;t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollWidth-e.viewWidth;var i=this.scrollbarLength-this.handleLength;e=(e.viewLeft-e.scrollLeft)/t*i,e=this.constrainHandlePosition(e),this.setHandlePosition(e),this.ratio=i/t}}resizeVertical(e){this.requiresViewResize(e)?this.resizeViewVertical(e):this.resizeContentVertical(e)}resizeViewVertical(e){let t=e.viewHeight-this.margin*2;this.pair&&(t-=qn.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),this.setPosition(this.workspace.RTL?e.absoluteLeft+this.margin:e.absoluteLeft+e.viewWidth-qn.scrollbarThickness-this.margin,e.absoluteTop+this.margin),this.resizeContentVertical(e)}resizeContentVertical(e){if(e.viewHeight>=e.scrollHeight)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var t=this.scrollbarLength*e.viewHeight/e.scrollHeight;t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollHeight-e.viewHeight;var i=this.scrollbarLength-this.handleLength;e=(e.viewTop-e.scrollTop)/t*i,e=this.constrainHandlePosition(e),this.setHandlePosition(e),this.ratio=i/t}}isVisible(){return this.isHandleVisible}setContainerVisible(e){const t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay_()}setVisible(e){if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.setVisibleInternal(e)}setVisibleInternal(e){const t=e!==this.isVisible();this.isHandleVisible=e,t&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none")}onMouseDownBar(e){if(this.workspace.markFocused(),Oe(),this.cleanUp(),De(e))e.stopPropagation();else{var t=xe(e,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM());t=this.horizontal?t.x:t.y;var i=Tn(this.svgHandle);i=this.horizontal?i.x:i.y;var s=this.handlePosition,c=this.handleLength*.95;t<=i?s-=c:t>=i+this.handleLength&&(s+=c),this.setHandlePosition(this.constrainHandlePosition(s)),this.updateMetrics(),e.stopPropagation(),e.preventDefault()}}onMouseDownHandle(e){this.workspace.markFocused(),this.cleanUp(),De(e)?e.stopPropagation():(this.startDragHandle=this.handlePosition,this.startDragMouse=this.horizontal?e.clientX:e.clientY,this.onMouseUpWrapper_=_e(document,"pointerup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=_e(document,"pointermove",this,this.onMouseMoveHandle),e.stopPropagation(),e.preventDefault())}onMouseMoveHandle(e){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?e.clientX:e.clientY)-this.startDragMouse))),this.updateMetrics()}onMouseUpHandle(){Oe(),this.cleanUp()}cleanUp(){this.workspace.hideChaff(!0),this.onMouseUpWrapper_&&(Ae(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(Ae(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let e=this.handlePosition/(this.scrollbarLength-this.handleLength);return isNaN(e)&&(e=0),e}updateMetrics(){const e=this.getRatio_();this.horizontal?this.workspace.setMetrics({x:e}):this.workspace.setMetrics({y:e})}set(e,t){this.setHandlePosition(this.constrainHandlePosition(e*this.ratio)),(t||t===void 0)&&this.updateMetrics()}setOrigin(e,t){this.origin=new Ne(e,t)}static metricsAreEquivalent(e,t){return e.viewWidth===t.viewWidth&&e.viewHeight===t.viewHeight&&e.viewLeft===t.viewLeft&&e.viewTop===t.viewTop&&e.absoluteTop===t.absoluteTop&&e.absoluteLeft===t.absoluteLeft&&e.scrollWidth===t.scrollWidth&&e.scrollHeight===t.scrollHeight&&e.scrollLeft===t.scrollLeft&&e.scrollTop===t.scrollTop}};qn.scrollbarThickness=Wa?25:15,qn.DEFAULT_SCROLLBAR_MARGIN=.5;var ch={parseFromString:function(){throw Error("DOMParser was not found in the global scope and was not properly injected using injectDependencies")}},Ei={serializeToString:function(){throw Error("XMLSerializer was not foundin the global scope and was not properly injected using injectDependencies")}},{document:Od,DOMParser:ec,XMLSerializer:tc}=globalThis;ec&&(ch=new ec),tc&&(Ei=new tc);var zn="https://developers.google.com/blockly/xml",Fo=/[\x00-\x09\x0B\x0C\x0E-\x1F]/g,Uo={NAME_SPACE:zn};Uo.createElement=l.createElement$$module$build$src$core$utils$xml,Uo.createTextNode=l.createTextNode$$module$build$src$core$utils$xml,Uo.domToText=Qs,Uo.injectDependencies=Ns,Uo.textToDom=l.textToDom$$module$build$src$core$utils$xml;var Ad="categoryToolbox",Zf="flyoutToolbox",Lt;(function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM",e[e.LEFT=2]="LEFT",e[e.RIGHT=3]="RIGHT"})(Lt||(Lt={}));var Xp={hasCategoriesInternal:Ji},Ws={};Ws.Position=Lt,Ws.TEST_ONLY=Xp,Ws.convertFlyoutDefToJsonArray=rn,Ws.convertToolboxDefToJson=zr,Ws.hasCategories=lo,Ws.isCategoryCollapsible=Kn,Ws.parseToolboxTree=ps;var ui;(function(e){e[e.TOP=0]="TOP",e[e.BOTTOM=1]="BOTTOM"})(ui||(ui={}));var po;(function(e){e[e.LEFT=0]="LEFT",e[e.RIGHT=1]="RIGHT"})(po||(po={}));var al;(function(e){e[e.UP=0]="UP",e[e.DOWN=1]="DOWN"})(al||(al={}));var Ti={};Ti.bumpDirection=al,Ti.bumpPositionRect=nr,Ti.getCornerOppositeToolbox=yl,Ti.getStartPositionRect=gs,Ti.horizontalPosition=po,Ti.verticalPosition=ui;var go={width:96,height:124,url:"sprites.png"},Mr=class{constructor(e){this.workspace=e,this.id="zoomControls",this.boundEvents=[],this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=null,this.HEIGHT=this.WIDTH=32,this.SMALL_SPACING=2,this.LARGE_SPACING=11,this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20,this.svgGroup=null,this.top=this.left=0,this.initialized=!1}createDom(){this.svgGroup=ae(le.G,{});const e=String(Math.random()).substring(2);return this.createZoomOutSvg(e),this.createZoomInSvg(e),this.workspace.isMovable()&&this.createZoomResetSvg(e),this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:un.ComponentWeight.ZOOM_CONTROLS_WEIGHT,capabilities:[un.Capability.POSITIONABLE]}),this.initialized=!0}dispose(){this.workspace.getComponentManager().removeComponent("zoomControls"),this.svgGroup&&Wt(this.svgGroup);for(const e of this.boundEvents)Ae(e);this.boundEvents.length=0}getBoundingRectangle(){let e=this.SMALL_SPACING+2*this.HEIGHT;return this.zoomResetGroup&&(e+=this.LARGE_SPACING+this.HEIGHT),new Nt(this.top,this.top+e,this.left,this.left+this.WIDTH)}position(e,t){if(this.initialized){var i=yl(this.workspace,e),s=this.SMALL_SPACING+2*this.HEIGHT;if(this.zoomResetGroup&&(s+=this.LARGE_SPACING+this.HEIGHT),e=gs(i,new Mt(this.WIDTH,s),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,e,this.workspace),i=i.vertical,t=nr(e,this.MARGIN_VERTICAL,i===ui.TOP?al.DOWN:al.UP,t),i===ui.TOP){var c=this.SMALL_SPACING+this.HEIGHT,m;(m=this.zoomInGroup)==null||m.setAttribute("transform","translate(0, "+c+")"),this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(c+this.LARGE_SPACING+this.HEIGHT)+")")}else{m=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0;let B;(B=this.zoomInGroup)==null||B.setAttribute("transform","translate(0, "+m+")"),m=m+this.SMALL_SPACING+this.HEIGHT,(c=this.zoomOutGroup)==null||c.setAttribute("transform","translate(0, "+m+")")}this.top=t.top,this.left=t.left;var I;(I=this.svgGroup)==null||I.setAttribute("transform","translate("+this.left+","+this.top+")")}}createZoomOutSvg(e){this.zoomOutGroup=ae(le.G,{class:"blocklyZoom blocklyZoomOut"},this.svgGroup);const t=ae(le.CLIPPATH,{id:"blocklyZoomoutClipPath"+e},this.zoomOutGroup);ae(le.RECT,{width:32,height:32},t),ae(le.IMAGE,{width:go.width,height:go.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+e+")"},this.zoomOutGroup).setAttributeNS(Co,"xlink:href",this.workspace.options.pathToMedia+go.url),this.boundEvents.push(_e(this.zoomOutGroup,"pointerdown",null,this.zoom.bind(this,-1)))}createZoomInSvg(e){this.zoomInGroup=ae(le.G,{class:"blocklyZoom blocklyZoomIn"},this.svgGroup);const t=ae(le.CLIPPATH,{id:"blocklyZoominClipPath"+e},this.zoomInGroup);ae(le.RECT,{width:32,height:32},t),ae(le.IMAGE,{width:go.width,height:go.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+e+")"},this.zoomInGroup).setAttributeNS(Co,"xlink:href",this.workspace.options.pathToMedia+go.url),this.boundEvents.push(_e(this.zoomInGroup,"pointerdown",null,this.zoom.bind(this,1)))}zoom(e,t){this.workspace.markFocused(),this.workspace.zoomCenter(e),this.fireZoomEvent(),Oe(),t.stopPropagation(),t.preventDefault()}createZoomResetSvg(e){this.zoomResetGroup=ae(le.G,{class:"blocklyZoom blocklyZoomReset"},this.svgGroup);const t=ae(le.CLIPPATH,{id:"blocklyZoomresetClipPath"+e},this.zoomResetGroup);ae(le.RECT,{width:32,height:32},t),ae(le.IMAGE,{width:go.width,height:go.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+e+")"},this.zoomResetGroup).setAttributeNS(Co,"xlink:href",this.workspace.options.pathToMedia+go.url),this.boundEvents.push(_e(this.zoomResetGroup,"pointerdown",null,this.resetZoom.bind(this)))}resetZoom(e){this.workspace.markFocused();const t=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition(),this.workspace.zoomCenter(t),this.workspace.scrollCenter(),setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500),this.fireZoomEvent(),Oe(),e.stopPropagation(),e.preventDefault()}fireZoomEvent(){const e=new(Qe(ce.CLICK))(null,this.workspace.id,"zoom_controls");Be(e)}};qe(`
.blocklyZoom>image, .blocklyZoom>svg>image {
  opacity: .4;
}

.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {
  opacity: .6;
}

.blocklyZoom>image:active, .blocklyZoom>svg>image:active {
  opacity: .8;
}
`);var Kl=100,Lr=75,wd=50,Nd=25,js={BLOCKS:wd,PROCEDURES:Lr,VARIABLES:Kl,WORKSPACE_COMMENTS:Nd},kd={};kd.register=Sl,kd.unregister=Ut;var Ku=class{constructor(){this.priority=Nd}save(e){const t=[];for(const i of e.getTopComments())(e=$s(i,{addCoordinates:!0,saveIds:!0}))&&t.push(e);return t.length?t:null}load(e,t){for(const i of e)uo(i,t,{recordUndo:_t()})}clear(e){for(const t of e.getTopComments())t.dispose()}};Sl("workspaceComments",new Ku);var ql={};ql.WorkspaceCommentSerializer=Ku,ql.append=uo,ql.save=$s;var qu={};qu.register=mi,qu.unregister=Wr;var cl=class{paste(e,t,i){e=e.commentState,i&&(e.x=i.x,e.y=i.y),l.disable$$module$build$src$core$events$utils();let s;try{s=uo(e,t),Ic(s)}finally{l.enable$$module$build$src$core$events$utils()}return s?(Ze()&&Be(new(Qe(ce.COMMENT_CREATE))(s)),l.getFocusManager$$module$build$src$core$focus_manager().focusNode(s),s):null}};cl.TYPE="workspace-comment",mi(cl.TYPE,new cl);var Md;Md=28,l.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:Md,connectingSnapRadius:Md,currentConnectionPreference:8,bumpDelay:250},l.config$$module$build$src$core$config;var Yp="aria-",hh="role",Ho;(function(e){e.GRID="grid",e.GRIDCELL="gridcell",e.GROUP="group",e.LISTBOX="listbox",e.MENU="menu",e.MENUITEM="menuitem",e.MENUITEMCHECKBOX="menuitemcheckbox",e.OPTION="option",e.PRESENTATION="presentation",e.ROW="row",e.TREE="tree",e.TREEITEM="treeitem",e.SEPARATOR="separator",e.STATUS="status"})(Ho||(Ho={}));var Wn;(function(e){e.ACTIVEDESCENDANT="activedescendant",e.COLCOUNT="colcount",e.DISABLED="disabled",e.EXPANDED="expanded",e.INVALID="invalid",e.LABEL="label",e.LABELLEDBY="labelledby",e.LEVEL="level",e.ORIENTATION="orientation",e.POSINSET="posinset",e.ROWCOUNT="rowcount",e.SELECTED="selected",e.SETSIZE="setsize",e.VALUEMAX="valuemax",e.VALUEMIN="valuemin",e.LIVE="live",e.HIDDEN="hidden"})(Wn||(Wn={}));var nc={};nc.Role=Ho,nc.State=Wn,nc.setRole=No,nc.setState=It;var Ld=class{constructor(e,t){this.content=e,this.opt_value=t,this.enabled=!0,this.element=null,this.rightToLeft=!1,this.roleName=null,this.highlight=this.checked=this.checkable=!1,this.actionHandler=null}createDom(){const e=document.createElement("div");e.id=ht(),this.element=e,e.className="blocklyMenuItem "+(this.enabled?"":"blocklyMenuItemDisabled ")+(this.checked?"blocklyMenuItemSelected ":"")+(this.highlight?"blocklyMenuItemHighlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl ":"");const t=document.createElement("div");if(t.className="blocklyMenuItemContent",this.checkable){var i=document.createElement("div");i.className="blocklyMenuItemCheckbox ",t.appendChild(i)}return i=this.content,typeof this.content=="string"&&(i=document.createTextNode(this.content)),t.appendChild(i),e.appendChild(t),this.roleName&&No(e,this.roleName),It(e,Wn.SELECTED,this.checkable&&this.checked||!1),It(e,Wn.DISABLED,!this.enabled),e}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){let e;return(e=this.opt_value)!=null?e:null}setRightToLeft(e){this.rightToLeft=e}setRole(e){this.roleName=e}setCheckable(e){this.checkable=e}setChecked(e){this.checked=e}setHighlighted(e){this.highlight=e;const t=this.getElement();t&&this.isEnabled()&&(e?We(t,"blocklyMenuItemHighlight"):vt(t,"blocklyMenuItemHighlight"))}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}performAction(e){this.isEnabled()&&this.actionHandler&&this.actionHandler(this,e)}onAction(e,t){this.actionHandler=e.bind(t)}},Qf=class{constructor(){this.menuItems=[],this.roleName=this.element=this.onKeyDownHandler=this.pointerLeaveHandler=this.pointerEnterHandler=this.clickHandler=this.pointerMoveHandler=this.highlightedItem=this.openingCoords=null}addChild(e){this.menuItems.push(e)}render(e){const t=document.createElement("div");t.className="blocklyMenu",t.tabIndex=0,this.roleName&&No(t,this.roleName),this.element=t;for(let i=0,s;s=this.menuItems[i];i++)t.appendChild(s.createDom());return this.pointerMoveHandler=_e(t,"pointermove",this,this.handlePointerMove,!0),this.clickHandler=_e(t,"pointerup",this,this.handleClick,!0),this.pointerEnterHandler=_e(t,"pointerenter",this,this.handlePointerEnter,!0),this.pointerLeaveHandler=_e(t,"pointerleave",this,this.handlePointerLeave,!0),this.onKeyDownHandler=_e(t,"keydown",this,this.handleKeyEvent),e.appendChild(t),t}getElement(){return this.element}focus(){const e=this.getElement();e&&e.focus({preventScroll:!0})}blur(){const e=this.getElement();e&&e.blur()}setRole(e){this.roleName=e}dispose(){this.pointerMoveHandler&&(Ae(this.pointerMoveHandler),this.pointerMoveHandler=null),this.clickHandler&&(Ae(this.clickHandler),this.clickHandler=null),this.pointerEnterHandler&&(Ae(this.pointerEnterHandler),this.pointerEnterHandler=null),this.pointerLeaveHandler&&(Ae(this.pointerLeaveHandler),this.pointerLeaveHandler=null),this.onKeyDownHandler&&(Ae(this.onKeyDownHandler),this.onKeyDownHandler=null);for(let e=0,t;t=this.menuItems[e];e++)t.dispose();this.element=null}getMenuItem(e){const t=this.getElement();for(;e&&e!==t;){if(e.classList.contains("blocklyMenuItem")){const i=this.getMenuItems();for(let s=0,c;c=i[s];s++)if(c.getElement()===e)return c}e=e.parentElement}return null}setHighlighted(e){var t=this.highlightedItem;if(t&&(t.setHighlighted(!1),this.highlightedItem=null),e){e.setHighlighted(!0),this.highlightedItem=e,t=this.getElement();const i=e.getElement();t&&i&&(Mi(i,t),It(t,Wn.ACTIVEDESCENDANT,e.getId()))}}highlightNext(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e,1)}highlightPrevious(){const e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e<0?this.menuItems.length:e,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(e,t){e+=t;let i;const s=this.getMenuItems();for(;i=s[e];){if(i.isEnabled()){this.setHighlighted(i);break}e+=t}}handlePointerMove(e){Math.max(Math.abs(e.movementX),Math.abs(e.movementY))!==0&&(e=this.getMenuItem(e.target))&&(e.isEnabled()?this.highlightedItem!==e&&this.setHighlighted(e):this.setHighlighted(null))}handleClick(e){var t=this.openingCoords;if(this.openingCoords=null,t&&typeof e.clientX=="number"){const i=new Ne(e.clientX,e.clientY);if(Ne.distance(t,i)<1)return}(t=this.getMenuItem(e.target))&&t.performAction(e)}handlePointerEnter(e){this.focus()}handlePointerLeave(e){this.getElement()&&this.setHighlighted(null)}handleKeyEvent(e){if(this.menuItems.length&&!(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){var t=this.highlightedItem;switch(e.key){case"Enter":case" ":t&&t.performAction(e);break;case"ArrowUp":this.highlightPrevious();break;case"ArrowDown":this.highlightNext();break;case"PageUp":case"Home":this.highlightFirst();break;case"PageDown":case"End":this.highlightLast();break;default:return}e.preventDefault(),e.stopPropagation()}}getSize(){const e=this.getElement(),t=Qt(e);return t.height=e.scrollHeight,t}getMenuItems(){return this.menuItems.filter(e=>e instanceof Ld)}},an=class{constructor(){this.element=null}createDom(){return this.element=document.createElement("hr"),this.element.className="blocklyMenuSeparator",No(this.element,Ho.SEPARATOR),this.element}dispose(){let e;(e=this.element)==null||e.remove(),this.element=null}},hn="_TEMP_COLLAPSED_INPUT",Gt="_TEMP_COLLAPSED_FIELD",wt="MANUALLY_DISABLED",Sn={COLLAPSED_FIELD_NAME:Gt,COLLAPSED_INPUT_NAME:hn,MANUALLY_DISABLED:wt};(function(e){e[e.VALUE=1]="VALUE",e[e.STATEMENT=3]="STATEMENT",e[e.DUMMY=5]="DUMMY",e[e.CUSTOM=6]="CUSTOM",e[e.END_ROW=7]="END_ROW"})(l.inputTypes$$module$build$src$core$inputs$input_types||(l.inputTypes$$module$build$src$core$inputs$input_types={})),l.inputTypes$$module$build$src$core$inputs$input_types;var $o=new Set,Dr=new WeakSet,Jl=new WeakMap,Zl=null,Xs=null,ii=0,Ys={};Ys.finishQueuedRenders=Ci,Ys.queueRender=_i,Ys.triggerQueuedRenders=Zo;var hl,Dd;l.Msg$$module$build$src$core$msg=Object.create(null),hl=function(e){Object.keys(e).forEach(function(t){l.Msg$$module$build$src$core$msg[t]=e[t]})},Dd={Msg:l.Msg$$module$build$src$core$msg,setLocale:hl};var eo="blocklyToast",Ju="blocklyToastMessage",ic="blocklyToastCloseButton",vi=class{static show(e,t){if(t.oncePerSession&&t.id){if(this.shownIds.has(t.id))return;this.shownIds.add(t.id)}this.hide(e);const i=this.createDom(e,t);requestAnimationFrame(()=>{i.style.bottom="2rem"})}static createDom(e,t){const{message:i,duration:s=5,assertiveness:c=vi.Assertiveness.POLITE}=t,m=document.createElement("div");e.getInjectionDiv().appendChild(m),m.dataset.toastId=t.id,m.className=eo,No(m,Ho.STATUS),It(m,Wn.LIVE,c),t=m.appendChild(document.createElement("div")),t.className=Ju,t.innerText=i,t=m.appendChild(document.createElement("button")),t.className=ic,It(t,Wn.LABEL,l.Msg$$module$build$src$core$msg.CLOSE);var I=ae(le.SVG,{width:24,height:24,viewBox:"0 0 24 24",fill:"none"},t);It(I,Wn.HIDDEN,!0),ae(le.RECT,{x:19.7782,y:2.80762,width:2,height:24,transform:"rotate(45, 19.7782, 2.80762)",fill:"black"},I),ae(le.RECT,{x:2.80762,y:4.22183,width:2,height:24,transform:"rotate(-45, 2.80762, 4.22183)",fill:"black"},I),t.addEventListener("click",()=>{m.remove(),e.markFocused()});let B;return t=()=>{B=setTimeout(()=>m.remove(),s*1e3)},I=()=>clearTimeout(B),m.addEventListener("focusin",I),m.addEventListener("focusout",t),m.addEventListener("mouseenter",I),m.addEventListener("mousemove",I),m.addEventListener("mouseleave",t),t(),m}static hide(e,t){e=e.getInjectionDiv().querySelector(`.${eo}`),e instanceof HTMLElement&&(!t||t===e.dataset.toastId)&&e.remove()}};vi.shownIds=new Set,(function(e){e=e.Assertiveness||(e.Assertiveness={}),e.ASSERTIVE="assertive",e.POLITE="polite"})(vi||(vi={})),qe(`
.${eo} {
  font-size: 1.2rem;
  position: absolute;
  bottom: -10rem;
  right: 2rem;
  padding: 1rem;
  color: black;
  background-color: white;
  border: 2px solid black;
  border-radius: 0.4rem;
  z-index: 999;
  display: flex;
  align-items: center;
  gap: 0.8rem;
  line-height: 1.5;
  transition: bottom 0.3s ease-out;
}

.${eo} .${Ju} {
  maxWidth: 18rem;
}

.${eo} .${ic} {
  margin: 0;
  padding: 0.2rem;
  background-color: transparent;
  color: black;
  border: none;
  cursor: pointer;
}
`);var xd=function(e,t){window.alert(e),t&&t()},dh=xd,ep=function(e,t){t(window.confirm(e))},fh=ep,ph=function(e,t,i){i(window.prompt(e,t))},dl=ph,yi=vi.show.bind(vi),fl=yi,Go={};Go.alert=zt,Go.confirm=Il,Go.prompt=Di,Go.setAlert=pa,Go.setConfirm=xh,Go.setPrompt=ms,Go.setToast=es,Go.toast=_o;var xr=new Set,Bd={};Bd.warn=gn;var gh="VARIABLE",Pd="ijkmnopqrstuvwxyzabcdefgh",oc={generateUniqueNameInternal:bu},Jn={CATEGORY_NAME:gh,TEST_ONLY:oc,VAR_LETTER_OPTIONS:Pd};Jn.allDeveloperVariables=l.allDeveloperVariables$$module$build$src$core$variables,Jn.allUsedVarModels=l.allUsedVarModels$$module$build$src$core$variables,Jn.compareByName=lr,Jn.createVariableButtonHandler=Mo,Jn.deleteVariable=l.deleteVariable$$module$build$src$core$variables,Jn.flyoutCategory=sr,Jn.flyoutCategoryBlocks=xi,Jn.generateUniqueName=ko,Jn.generateUniqueNameFromOptions=Ds,Jn.generateVariableFieldDom=ao,Jn.getAddedVariables=Bs,Jn.getOrCreateVariablePackage=l.getOrCreateVariablePackage$$module$build$src$core$variables,Jn.getVariable=l.getVariable$$module$build$src$core$variables,Jn.getVariableUsesById=Es,Jn.internalFlyoutCategory=_s,Jn.jsonFlyoutCategoryBlocks=di,Jn.nameUsedWithAnyType=$a,Jn.nameUsedWithConflictingParam=oi,Jn.promptName=xs,Jn.renameVariable=l.renameVariable$$module$build$src$core$variables;var Gi=class extends Error{},tp=class extends Gi{constructor(e){super("Expected to find a 'type' property, defining the block type"),this.state=e}},Vi=class extends Gi{constructor(e,t,i){super(`The block ${t.toDevString()} is missing a(n) ${e}
connection`),this.block=t,this.state=i}},np=class extends Gi{constructor(e,t,i,s){super(`The block ${i.toDevString()} could not connect its
${t} to its parent, because: ${e}`),this.childBlock=i,this.childState=s}},ip=class extends Gi{constructor(e){super(`Encountered a real block which is defined as a child of a shadow
block. It is an invariant of Blockly that shadow blocks only have shadow
children`),this.state=e}},Kp=class extends Gi{constructor(e,t,i){super(`Cannot add an icon of type '${e}' to the block ${t.toDevString()}, because there is no icon registered with type '${e}'. Make sure that all of your icons have been registered.`),this.block=t,this.state=i}},Vo={};Vo.BadConnectionCheck=np,Vo.DeserializationError=Gi,Vo.MissingBlockType=tp,Vo.MissingConnection=Vi,Vo.RealChildOfShadow=ip,Vo.UnregisteredIcon=Kp;var $h=class{constructor(){this.priority=wd}save(e){const t=[];for(const i of e.getTopBlocks(!1))(e=Zi(i,{addCoordinates:!0,doFullSerialization:!1}))&&t.push(e);return t.length?{languageVersion:0,blocks:t}:null}load(e,t){e=e.blocks;for(const i of e)bo(i,t,{recordUndo:_t()})}clear(e){for(const t of e.getTopBlocks(!1))t.dispose(!1)}};Sl("blocks",new $h);var Zu={};Zu.BlockSerializer=$h,Zu.append=bo,Zu.appendInternal=ur,Zu.save=Zi;var jn=class{constructor(e){this.name=e}toString(){return this.name}equals(e){return this.name===e.toString()}};jn.MUTATOR=new jn("mutator"),jn.WARNING=new jn("warning"),jn.COMMENT=new jn("comment");var Ql=class extends Nr{constructor(e){super(),this.isBlank=!e,e&&(this.blockId=e.id,this.workspaceId=e.workspace.id)}toJson(){const e=super.toJson();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.blockId=this.blockId,e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new Ql),t.blockId=e.blockId,t}},eu=class extends Ql{constructor(e,t,i,s,c){super(e),this.type=ce.BLOCK_CHANGE,e&&(this.element=t,this.name=i||void 0,this.oldValue=s,this.newValue=c)}toJson(){const e=super.toJson();if(!this.element)throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson");return e.element=this.element,e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,this.disabledReason&&(e.disabledReason=this.disabledReason),e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new eu),t.element=e.element,t.name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,e.disabledReason!==void 0&&(t.disabledReason=e.disabledReason),t}setDisabledReason(e){if(this.element!=="disabled")throw Error('Cannot set the disabled reason for a BlockChange event if the element is not "disabled".');this.disabledReason=e}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(t=t.getBlockById(this.blockId),!t)throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");const i=t.getIcon(jn.MUTATOR);switch(i&&Eo(i)&&i.bubbleIsVisible()&&i.setBubbleVisible(!1),e=e?this.newValue:this.oldValue,this.element){case"field":(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name);break;case"comment":t.setCommentText(e||null);break;case"collapsed":t.setCollapsed(!!e);break;case"disabled":var s;t.setDisabledReason(!!e,(s=this.disabledReason)!=null?s:wt);break;case"inline":t.setInputsInline(!!e);break;case"mutation":s=eu.getExtraBlockState_(t),t.loadExtraState?t.loadExtraState(JSON.parse(e||"{}")):t.domToMutation&&t.domToMutation(l.textToDom$$module$build$src$core$utils$xml(e||"<mutation/>")),Be(new eu(t,"mutation",null,s,e));break;default:console.warn("Unknown change type: "+this.element)}}static getExtraBlockState_(e){return e.saveExtraState?(e=e.saveExtraState(!0))?JSON.stringify(e):"":e.mutationToDom&&(e=e.mutationToDom())?xn(e):""}};a(Re.EVENT,ce.BLOCK_CHANGE,eu);var mh={};mh.clamp=Ps,mh.toDegrees=va,mh.toRadians=kl;var _h=16,bh=1,Fd=12,op=16,Ud=.25,sp=null,tu=null,rp="",Qu="",Fn,sc,nu,Hd=null,pl=null,lp=null,Eh=null,ea=null,Gd={getBoundsInfo:function(){const e=jt(Hd),t=Qt(Hd);return{left:e.x,right:e.x+t.width,top:e.y,bottom:e.y+t.height,width:t.width,height:t.height}},getPositionMetrics:function(e,t,i,s){const c=Gd.getBoundsInfo(),m=Qt(Fn);return t+m.height<c.bottom?Ra(e,t,c,m):s-m.height>c.top?xc(i,s,c,m):t+m.height<document.documentElement.clientHeight?Ra(e,t,c,m):s-m.height>document.documentElement.clientTop?xc(i,s,c,m):Bc(e,c,m)}},to={ANIMATION_TIME:Ud,ARROW_HORIZONTAL_PADDING:Fd,ARROW_SIZE:_h,BORDER_SIZE:bh,PADDING_Y:op,TEST_ONLY:Gd};to.clearContent=ts,to.createDom=Ml,to.getContentDiv=cr,to.getOwner=Lc,to.getPositionX=hr,to.hide=dr,to.hideIfOwner=Us,to.hideWithoutAnimation=Ts,to.isVisible=Ou,to.repositionForWindowResize=Yr,to.setBoundsElement=ya,to.setColour=Dc,to.show=Fs,to.showPositionedByBlock=Ru,to.showPositionedByField=Ll;var nn={};nn.commonWordPrefix=Nn,nn.commonWordSuffix=fr,nn.isNumber=l.isNumber$$module$build$src$core$utils$string,nn.shortestStringLength=co,nn.wrap=l.wrap$$module$build$src$core$utils$string;var rc=void 0,Th=!1,ta=!1,qp=50,Jp=0,na=0,lc=0,iu=0,zo=null,ou=null,vh=0,Br=10,Ks=10,uc=750,Vd=5,gi=null,Wo={HOVER_MS:uc,LIMIT:qp,MARGINS:Vd,OFFSET_X:vh,OFFSET_Y:Br,RADIUS_OK:Ks};Wo.bindMouseEvents=b,Wo.block=q,Wo.createDom=g,Wo.dispose=U,Wo.getCustomTooltip=Ia,Wo.getDiv=Hs,Wo.getTooltipOfObject=fi,Wo.hide=W,Wo.isVisible=Kr,Wo.setCustomTooltip=pr,Wo.unbindMouseEvents=y,Wo.unblock=ie;var zd=.45,Wd=.65,Zp={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},jo={};jo.blend=Pe,jo.getHsvSaturation=ne,jo.getHsvValue=ue,jo.hexToRgb=ze,jo.hsvToHex=nt,jo.hueToHex=Ye,jo.names=Zp,jo.parse=ye,jo.rgbToHex=ke,jo.setHsvSaturation=oe,jo.setHsvValue=$e;var ac={};ac.checkMessageReferences=Tt,ac.parseBlockColour=Ct,ac.replaceMessageReferences=Ge,ac.tokenizeInterpolation=Ue;var dn=class{get size_(){return this.size}set size_(e){this.size=e}constructor(e,t,i){this.DEFAULT_VALUE=null,this.name=void 0,this.tooltip=this.validator_=null,this.size=new Mt(0,0),this.constants_=this.mouseDownWrapper=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=null,this.disposed=!1,this.maxDisplayLength=50,this.sourceBlock_=null,this.enabled_=this.visible_=this.isDirty_=!0,this.suffixField=this.prefixField=this.clickTarget_=null,this.EDITABLE=!0,this.SERIALIZABLE=!1,this.id_=null,this.value_="DEFAULT_VALUE"in new.target.prototype?new.target.prototype.DEFAULT_VALUE:this.DEFAULT_VALUE,this.size_=new Mt(0,0),e!==dn.SKIP_SETUP&&(i&&this.configure_(i),this.setValue(e),t&&this.setValidator(t))}configure_(e){e.tooltip&&this.setTooltip(Ge(e.tooltip))}setSourceBlock(e){if(this.sourceBlock_)throw Error("Field already bound to a block");if(this.sourceBlock_=e,e.id.includes("_field"))throw Error(`Field ID indicator is contained in block ID. This may cause problems with focus: ${e.id}.`);this.id_=`${e.id}_field_${ht()}`}getConstants(){return!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_}getSourceBlock(){return this.sourceBlock_}init(){if(!this.fieldGroup_){var e=this.id_;if(!e)throw Error("Expected ID to be defined prior to init.");this.fieldGroup_=ae(le.G,{id:e}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip),this.bindEvents_(),this.initModel(),this.applyColour()}}initView(){this.createBorderRect_(),this.createTextElement_(),this.fieldGroup_&&We(this.fieldGroup_,"blocklyField")}initModel(){}isFullBlockField(){return!this.borderRect_}createBorderRect_(){this.borderRect_=ae(le.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)}createTextElement_(){this.textElement_=ae(le.TEXT,{class:"blocklyText blocklyFieldText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)}bindEvents_(){const e=this.getClickTarget_();if(!e)throw Error("A click target has not been set.");b(e),this.mouseDownWrapper=_e(e,"pointerdown",this,this.onMouseDown_)}fromXml(e){this.setValue(e.textContent)}toXml(e){return e.textContent=this.getValue(),e}saveState(e){return e=this.saveLegacyState(dn),e!==null?e:this.getValue()}loadState(e){this.loadLegacyState(dn,e)||this.setValue(e)}saveLegacyState(e){return e.prototype.saveState===this.saveState&&e.prototype.toXml!==this.toXml?(e=l.createElement$$module$build$src$core$utils$xml("field"),e.setAttribute("name",this.name||""),Qs(this.toXml(e)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null}loadLegacyState(e,t){return e.prototype.loadState===this.loadState&&e.prototype.fromXml!==this.fromXml?(this.fromXml(l.textToDom$$module$build$src$core$utils$xml(t)),!0):!1}dispose(){Us(this),Dn(this);let e;(e=this.getSourceBlock())!=null&&e.isDeadOrDying()||Wt(this.fieldGroup_),this.disposed=!0}updateEditable(){const e=this.fieldGroup_,t=this.getSourceBlock();this.EDITABLE&&e&&t&&(this.enabled_&&t.isEditable()?(We(e,"blocklyEditableField"),vt(e,"blocklyNonEditableField")):(We(e,"blocklyNonEditableField"),vt(e,"blocklyEditableField")))}setEnabled(e){this.enabled_=e,this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==dn.prototype.showEditor_}isClickableInFlyout(e){return!e}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let e=!1;return this.name&&(this.SERIALIZABLE?e=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),e=!0)),e}isVisible(){return this.visible_}setVisible(e){if(this.visible_!==e){this.visible_=e;var t=this.fieldGroup_;t&&(t.style.display=e?"block":"none")}}setValidator(e){this.validator_=e}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(!this.borderRect_)throw Error(`The border rectangle is ${this.borderRect_}.`);return this.borderRect_}getTextElement(){if(!this.textElement_)throw Error(`The text element is ${this.textElement_}.`);return this.textElement_}getTextContent(){if(!this.textContent_)throw Error(`The text content is ${this.textContent_}.`);return this.textContent_}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()}showEditor(e){this.isClickable()&&this.showEditor_(e)}showEditor_(e){}repositionForWindowResize(){return!1}updateSize_(e){const t=this.getConstants();e=e!==void 0?e:this.isFullBlockField()?0:this.getConstants().FIELD_BORDER_RECT_X_PADDING;let i=e*2,s=t.FIELD_TEXT_HEIGHT,c=0;this.textElement_&&(c=bn(this.textElement_),i+=c),this.isFullBlockField()||(s=Math.max(s,t.FIELD_BORDER_RECT_HEIGHT)),this.size_=new Mt(i,s),this.positionTextElement_(e,c),this.positionBorderRect_()}positionTextElement_(e,t){if(this.textElement_){var i=this.getConstants(),s=this.size_.height/2,c;this.textElement_.setAttribute("x",String((c=this.getSourceBlock())!=null&&c.RTL?this.size_.width-t-e:e)),this.textElement_.setAttribute("y",String(i.FIELD_TEXT_BASELINE_CENTER?s:s-i.FIELD_TEXT_HEIGHT/2+i.FIELD_TEXT_BASELINE))}}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width",String(this.size_.width)),this.borderRect_.setAttribute("height",String(this.size_.height)),this.borderRect_.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.borderRect_.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}getSize(){return this.isVisible()?(this.isDirty_&&(this.render_(),this.isDirty_=!1),this.size_):new Mt(0,0)}getScaledBBox(){let e;var t=this.getSourceBlock();if(!t)throw new ai;if(this.isFullBlockField()){var i=this.sourceBlock_.getHeightWidth();const s=t.workspace.scale;e=this.getAbsoluteXY_(),t=(i.width+1)*s,i=(i.height+1)*s,oh?(e.x+=1.5*s,e.y+=1.5*s):(e.x-=.5*s,e.y-=.5*s)}else i=this.borderRect_.getBoundingClientRect(),e=jt(this.borderRect_),t=i.width,i=i.height;return new Nt(e.y,e.y+i,e.x,e.x+t)}onLocationChange(e){}getDisplayText_(){let e=this.getText();return e.length>this.maxDisplayLength&&(e=e.substring(0,this.maxDisplayLength-2)+"…"),e=e.replace(/\s/g,dn.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(e+="‏"),e}getText(){const e=this.getText_();return String(e!==null?e:this.getValue())}getText_(){return null}markDirty(){this.isDirty_=!0,this.constants_=null}forceRerender(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&this.sourceBlock_.queueRender()}setValue(e,t=!0){if(e!==null){var i=l.getGroup$$module$build$src$core$events$utils();i||l.setGroup$$module$build$src$core$events$utils(!0);try{const Se=this.doClassValidation_(e),mt=this.processValidation(e,Se,t);if(!(mt instanceof Error)){var s,c=(s=this.getValidator())==null?void 0:s.call(this,mt),m=this.processValidation(mt,c,t);if(!(m instanceof Error)){var I=this.sourceBlock_;if(!I||!I.disposed){var B=this.getValue();B===m?this.doValueUpdate_(m):(this.doValueUpdate_(m),t&&I&&Ze()&&Be(new(Qe(ce.BLOCK_CHANGE))(I,"field",this.name||null,B,m)),this.isDirty_&&this.forceRerender())}}}}finally{l.setGroup$$module$build$src$core$events$utils(i)}}}processValidation(e,t,i){return t===null?(this.doValueInvalid_(e,i),this.isDirty_&&this.forceRerender(),Error()):t===void 0?e:t}getValue(){return this.value_}doClassValidation_(e){return e??null}doValueUpdate_(e){this.value_=e,this.isDirty_=!0}doValueInvalid_(e,t){}onMouseDown_(e){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(e=this.sourceBlock_.workspace.getGesture(e))&&e.setStartField(this)}setTooltip(e){e||e===""||(e=this.sourceBlock_);const t=this.getClickTarget_();t?t.tooltip=e:this.tooltip=e}getTooltip(){const e=this.getClickTarget_();return fi(e||{tooltip:this.tooltip})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return jt(this.getClickTarget_())}referencesVariables(){return!1}refreshVariableName(){}getParentInput(){let e=null;const t=this.getSourceBlock();if(!t)throw new ai;const i=t.inputList;for(let s=0;s<t.inputList.length;s++){const c=i[s],m=c.fieldRow;for(let I=0;I<m.length;I++)if(m[I]===this){e=c;break}}return e}getFlipRtl(){return!1}onShortcut(e){return!1}getFocusableElement(){if(!this.fieldGroup_)throw Error("This field currently has no representative DOM element.");return this.fieldGroup_}getFocusableTree(){const e=this.getSourceBlock();if(!e)throw new ai;return e.workspace}onNodeFocus(){const e=this.getSourceBlock();e.workspace.scrollBoundsIntoView(e.getBoundingRectangleWithoutChildren())}onNodeBlur(){}canBeFocused(){return!0}static fromJson(e){throw Error("Attempted to instantiate a field from the registry that hasn't defined a 'fromJson' method.")}};dn.NBSP=" ",dn.SKIP_SETUP=Symbol("SKIP_SETUP");var ai=class extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}},su=null,jd=null,Xd=null,up="blocklyWidgetDiv",Pr="",cc="",Xo,Vt=null,us={};us.createDom=Ot,us.getDiv=At,us.hide=vn,us.hideIfOwner=Dn,us.hideIfOwnerIsInWorkspace=Bi,us.isVisible=qr,us.positionWithAnchor=To,us.repositionForWindowResize=Oa,us.show=ei,us.testOnly_setDiv=Ii;var ia=null,Yd={},yh=null,gl={};gl.callbackFactory=l.callbackFactory$$module$build$src$core$contextmenu,gl.dispose=Aa,gl.getCurrentBlock=Bl,gl.hide=$r,gl.setCurrentBlock=Fc,gl.show=Nu;var Dt=class{constructor(){this.registeredItems=new Map,this.reset()}reset(){this.registeredItems.clear()}register(e){if(this.registeredItems.has(e.id))throw Error('Menu item with ID "'+e.id+'" is already registered.');this.registeredItems.set(e.id,e)}unregister(e){if(!this.registeredItems.has(e))throw Error('Menu item with ID "'+e+'" not found.');this.registeredItems.delete(e)}getItem(e){let t;return(t=this.registeredItems.get(e))!=null?t:null}getContextMenuOptions(e,t){const i=[];for(const s of this.registeredItems.values()){if(s.scopeType&&(s.scopeType===hc.BLOCK&&!e.block||s.scopeType===hc.COMMENT&&!e.comment||s.scopeType===hc.WORKSPACE&&!e.workspace))continue;let c;if(c={scope:e,weight:s.weight},s.separator)c=Object.assign({},c,{separator:!0});else{const m=s.preconditionFn(e,t);if(m==="hidden")continue;const I=typeof s.displayText=="function"?s.displayText(e):s.displayText;c=Object.assign({},c,{text:I,callback:s.callback,enabled:m==="enabled"})}i.push(c)}return i.sort(function(s,c){return s.weight-c.weight}),i}};(function(e){var t=e.ScopeType||(e.ScopeType={});t.BLOCK="block",t.WORKSPACE="workspace",t.COMMENT="comment",e.registry=new e})(Dt||(Dt={}));var hc=Dt.ScopeType,ru=50,Sh=100,_g={BLOCK:ru,BUBBLE:Sh},Qp=class{constructor(e){this.comment=e,this.startLoc=null,this.workspace=e.workspace}isMovable(){return this.comment.isOwnMovable()&&!this.comment.isDeadOrDying()&&!this.workspace.isReadOnly()}startDrag(){this.fireDragStartEvent(),this.startLoc=this.comment.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1);let e;(e=this.workspace.getLayerManager())==null||e.moveToDragLayer(this.comment),this.comment.setDragging(!0)}drag(e){this.comment.moveDuringDrag(e)}endDrag(){this.fireDragEndEvent(),this.fireMoveEvent();let e;(e=this.workspace.getLayerManager())==null||e.moveOffDragLayer(this.comment,ru),this.comment.setDragging(!1),this.comment.snapToGrid(),this.workspace.setResizesEnabled(!0)}fireDragStartEvent(){const e=new(Qe(ce.COMMENT_DRAG))(this.comment,!0);Be(e)}fireDragEndEvent(){const e=new(Qe(ce.COMMENT_DRAG))(this.comment,!1);Be(e)}fireMoveEvent(){if(!this.comment.isDeadOrDying()){var e=new(Qe(ce.COMMENT_MOVE))(this.comment);e.setReason(["drag"]),e.oldCoordinate_=this.startLoc,e.recordNew(),Be(e)}}revertDrag(){this.startLoc&&this.comment.moveDuringDrag(this.startLoc)}},ap=new WeakMap,Ch=class{constructor(e,t,i,s){this.id=e,this.workspace=t,this.container=i,this.commentView=s}isVisible(){return this.icon.checkVisibility()}getCommentView(){return this.commentView}getSize(e=!1){var t=this.icon.getBBox();return t=Nt.from(t),e&&(e=this.getMargin(),t.left-=e,t.top-=e,t.bottom+=e,t.right+=e),t}getMargin(){return(this.container.getBBox().height-this.icon.getBBox().height)/2}getFocusableElement(){return this.icon}getFocusableTree(){return this.workspace}onNodeFocus(){const e=this.getCommentView();var t=e.getRelativeToSurfaceXY();const i=e.getSize();t=new Nt(t.y,t.y+i.height,t.x,t.x+i.width),e.workspace.scrollBoundsIntoView(t)}onNodeBlur(){}canBeFocused(){return this.isVisible()}},Cn="_collapse_bar_button",Kd=class extends Ch{constructor(e,t,i,s){super(e,t,i,s),this.id=e,this.workspace=t,this.container=i,this.commentView=s,this.icon=ae(le.IMAGE,{class:"blocklyFoldoutIcon",href:`${this.workspace.options.pathToMedia}foldout-icon.svg`,id:`${this.id}${Cn}`},this.container),this.bindId=_e(this.icon,"pointerdown",this,this.performAction.bind(this))}dispose(){Ae(this.bindId)}reposition(){const e=this.getMargin();this.icon.setAttribute("y",`${e}`),this.icon.setAttribute("x",`${e}`)}performAction(e){Oe(),this.getCommentView().bringToFront(),e&&e instanceof PointerEvent&&De(e)?e.stopPropagation():(this.getCommentView().setCollapsed(!this.getCommentView().isCollapsed()),this.workspace.hideChaff(),e?.stopPropagation())}},wi="_comment_textarea_",qd=class{constructor(e,t,i){this.workspace=e,this.onFinishEditing=i,this.textChangeListeners=[],this.text="",this.foreignObject=ae(le.FOREIGNOBJECT,{class:"blocklyCommentForeignObject"}),e=document.createElementNS(ll,"body"),e.setAttribute("xmlns",ll),e.className="blocklyMinimalBody",this.textArea=document.createElementNS(ll,"textarea"),this.textArea.setAttribute("tabindex","-1"),this.textArea.setAttribute("dir",this.workspace.RTL?"RTL":"LTR"),We(this.textArea,"blocklyCommentText"),We(this.textArea,"blocklyTextarea"),We(this.textArea,"blocklyText"),e.appendChild(this.textArea),this.foreignObject.appendChild(e),t&&(this.id=t+wi,this.textArea.setAttribute("id",this.id)),_e(this.textArea,"change",this,this.onTextChange),_e(this.textArea,"pointerdown",this,s=>{s.stopPropagation(),l.getFocusManager$$module$build$src$core$focus_manager().focusNode(this),Oe()}),_e(this.textArea,"wheel",this,s=>{s.stopPropagation()}),_e(this.textArea,"keydown",this,this.handleKeyDown)}getDom(){return this.foreignObject}getText(){return this.text}setText(e){this.textArea.value=e,this.onTextChange()}onTextChange(){const e=this.text;this.text=this.textArea.value;for(let t=this.textChangeListeners.length-1;t>=0;t--)this.textChangeListeners[t](e,this.text)}handleKeyDown(e){(e.key==="Escape"||e.key==="Enter"&&(e.ctrlKey||e.metaKey))&&(this.onFinishEditing&&this.onFinishEditing(),e.stopPropagation())}addTextChangeListener(e){this.textChangeListeners.push(e)}removeTextChangeListener(e){this.textChangeListeners.splice(this.textChangeListeners.indexOf(e),1)}setPlaceholderText(e){this.textArea.placeholder=e}setEditable(e){e?this.textArea.removeAttribute("readonly"):this.textArea.setAttribute("readonly","true")}updateSize(e,t){this.foreignObject.setAttribute("height",`${e.height-t.height}`),this.foreignObject.setAttribute("width",`${e.width}`),this.foreignObject.setAttribute("y",`${t.height}`),this.workspace.RTL&&this.foreignObject.setAttribute("x",`${-e.width}`)}getFocusableElement(){return this.textArea}getFocusableTree(){return this.workspace}onNodeFocus(){const e=Nt.from(this.foreignObject.getBoundingClientRect());this.workspace.scrollBoundsIntoView(Nt.createFromPoint(fs(this.workspace,e.getOrigin()),e.getWidth(),e.getHeight()))}onNodeBlur(){}canBeFocused(){return!!this.id}},cp="_delete_bar_button",eg=class extends Ch{constructor(e,t,i,s){super(e,t,i,s),this.id=e,this.workspace=t,this.container=i,this.commentView=s,this.icon=ae(le.IMAGE,{class:"blocklyDeleteIcon",href:`${this.workspace.options.pathToMedia}delete-icon.svg`,id:`${this.id}${cp}`},i),this.bindId=_e(this.icon,"pointerdown",this,this.performAction.bind(this))}dispose(){Ae(this.bindId)}reposition(){const e=this.getMargin();this.icon.setAttribute("x","0");const t=this.container.getBBox();this.icon.setAttribute("y",`${e}`),this.icon.setAttribute("x",`${t.width-this.getSize(!0).getWidth()}`)}performAction(e){Oe(),e&&e instanceof PointerEvent&&De(e)?e.stopPropagation():(this.getCommentView().dispose(),e?.stopPropagation(),l.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.workspace))}},oa=class{constructor(e,t){this.workspace=e,this.commentId=t,this.collapsed=!1,this.editable=!0,this.location=new Ne(0,0),this.sizeChangeListeners=[],this.disposeListeners=[],this.collapseChangeListeners=[],this.resizePointerMoveListener=this.resizePointerUpListener=null,this.disposed=this.disposing=!1,this.svgRoot=ae(le.G,{class:"blocklyComment blocklyEditable blocklyDraggable"}),this.highlightRect=this.createHighlightRect(this.svgRoot),{topBarGroup:this.topBarGroup,topBarBackground:this.topBarBackground,deleteButton:this.deleteButton,foldoutButton:this.foldoutButton,textPreview:this.textPreview,textPreviewNode:this.textPreviewNode}=this.createTopBar(this.svgRoot),this.commentEditor=this.createTextArea(),this.resizeHandle=this.createResizeHandle(this.svgRoot,e);let i;(i=e.getLayerManager())==null||i.append(this,ru),this.size=oa.defaultCommentSize,this.setSizeWithoutFiringEvents(this.size),this.moveTo(new Ne(0,0))}createHighlightRect(e){return ae(le.RECT,{class:"blocklyCommentHighlight"},e)}createTopBar(e){e=ae(le.G,{class:"blocklyCommentTopbar"},e);const t=ae(le.RECT,{class:"blocklyCommentTopbarBackground"},e),i=new eg(this.commentId,this.workspace,e,this),s=new Kd(this.commentId,this.workspace,e,this);this.addDisposeListener(()=>{i.dispose(),s.dispose()});const c=ae(le.TEXT,{class:"blocklyCommentPreview blocklyCommentText blocklyText"},e),m=document.createTextNode("");return c.appendChild(m),{topBarGroup:e,topBarBackground:t,deleteButton:i,foldoutButton:s,textPreview:c,textPreviewNode:m}}createTextArea(){const e=new qd(this.workspace,this.commentId,()=>this.svgRoot.focus());return this.svgRoot.appendChild(e.getDom()),e.addTextChangeListener((t,i)=>{this.updateTextPreview(i),this.setSize(this.size)}),e}getEditorFocusableNode(){return this.commentEditor}createResizeHandle(e,t){return e=ae(le.IMAGE,{class:"blocklyResizeHandle",href:`${t.options.pathToMedia}resize-handle.svg`},e),_e(e,"pointerdown",this,this.onResizePointerDown),e}getSvgRoot(){return this.svgRoot}getSize(){return this.collapsed?this.topBarBackground.getBBox():this.size}setSizeWithoutFiringEvents(e){const t=this.topBarBackground.getBBox(),i=this.textPreview.getBBox(),s=this.resizeHandle.getBBox();this.size=e=Mt.max(e,this.calcMinSize(t)),this.svgRoot.setAttribute("height",`${e.height}`),this.svgRoot.setAttribute("width",`${e.width}`),this.updateHighlightRect(e),this.updateTopBarSize(e),this.commentEditor.updateSize(e,t),this.deleteButton.reposition(),this.foldoutButton.reposition(),this.updateTextPreviewSize(e,t,i),this.updateResizeHandlePosition(e,s)}setSize(e){const t=this.preResizeSize||this.size;this.setSizeWithoutFiringEvents(e),this.onSizeChange(t,this.size)}calcMinSize(e){var t;this.updateTextPreview((t=this.commentEditor.getText())!=null?t:"");let i=t=bn(this.textPreview);return this.foldoutButton.isVisible()?i+=this.foldoutButton.getSize(!0).getWidth():t&&(i+=4),this.deleteButton.isVisible()?i+=this.deleteButton.getSize(!0).getWidth():t&&(i+=4),new Mt(i,e.height+20)}updateHighlightRect(e){this.highlightRect.setAttribute("height",`${e.height}`),this.highlightRect.setAttribute("width",`${e.width}`),this.workspace.RTL&&this.highlightRect.setAttribute("x",`${-e.width}`)}updateTopBarSize(e){this.topBarBackground.setAttribute("width",`${e.width}`)}updateTextPreviewSize(e,t,i){t=(t.height-i.height)/2;const s=this.foldoutButton.getSize(!0),c=this.deleteButton.getSize(!0);e=e.width-s.getWidth()-c.getWidth(),this.textPreview.setAttribute("x",`${(this.workspace.RTL?-1:1)*s.getWidth()}`),this.textPreview.setAttribute("y",`${t+i.height/2}`),this.textPreview.setAttribute("width",`${e}`)}updateResizeHandlePosition(e,t){this.resizeHandle.setAttribute("y",`${e.height-t.height}`),this.resizeHandle.setAttribute("x",`${e.width-t.width}`)}onSizeChange(e,t){for(let i=this.sizeChangeListeners.length-1;i>=0;i--)this.sizeChangeListeners[i](e,t)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}removeSizeChangeListener(e){this.sizeChangeListeners.splice(this.sizeChangeListeners.indexOf(e),1)}onResizePointerDown(e){this.isEditable()&&(this.bringToFront(),De(e)||(this.preResizeSize=this.getSize(),vo(this.workspace,e,new Ne(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=_e(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=_e(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation())}onResizePointerUp(e){Oe(),this.resizePointerUpListener&&(Ae(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(Ae(this.resizePointerMoveListener),this.resizePointerMoveListener=null),this.setSize(this.size),this.preResizeSize=void 0}onResizePointerMove(e){e=yo(this.workspace,e),this.setSizeWithoutFiringEvents(new Mt(this.workspace.RTL?-e.x:e.x,e.y))}isCollapsed(){return this.collapsed}setCollapsed(e){(this.collapsed=e)?We(this.svgRoot,"blocklyCollapsed"):vt(this.svgRoot,"blocklyCollapsed"),this.setSizeWithoutFiringEvents(this.size),this.onCollapse()}onCollapse(){for(let e=this.collapseChangeListeners.length-1;e>=0;e--)this.collapseChangeListeners[e](this.collapsed)}addOnCollapseListener(e){this.collapseChangeListeners.push(e)}removeOnCollapseListener(e){this.collapseChangeListeners.splice(this.collapseChangeListeners.indexOf(e),1)}isEditable(){return this.editable}setEditable(e){(this.editable=e)?(We(this.svgRoot,"blocklyEditable"),vt(this.svgRoot,"blocklyReadonly")):(vt(this.svgRoot,"blocklyEditable"),We(this.svgRoot,"blocklyReadonly")),this.commentEditor.setEditable(e)}getRelativeToSurfaceXY(){return this.location}moveTo(e){this.location=e,this.svgRoot.setAttribute("transform",`translate(${e.x}, ${e.y})`)}getText(){return this.commentEditor.getText()}setText(e){this.commentEditor.setText(e)}setPlaceholderText(e){this.commentEditor.setPlaceholderText(e)}addTextChangeListener(e){this.commentEditor.addTextChangeListener(e)}removeTextChangeListener(e){this.commentEditor.removeTextChangeListener(e)}updateTextPreview(e){this.textPreviewNode.textContent=this.truncateText(e)}truncateText(e){return e.length>=12?`${e.substring(0,9)}...`:e}bringToFront(){const e=this.svgRoot.parentNode,t=e.childNodes;t[t.length-1]!==this.svgRoot&&e.appendChild(this.svgRoot)}onDeleteDown(e){Oe(),De(e)||this.dispose(),e.stopPropagation()}dispose(){this.disposing=!0,Wt(this.svgRoot);for(let e=this.disposeListeners.length-1;e>=0;e--)this.disposeListeners[e]();this.disposeListeners.length=0,this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}addDisposeListener(e){this.disposeListeners.push(e)}removeDisposeListener(e){this.disposeListeners.splice(this.disposeListeners.indexOf(e),1)}getCommentBarButtons(){return[this.foldoutButton,this.deleteButton]}};oa.defaultCommentSize=new Mt(120,100),qe(`
.injectionDiv {
  --commentFillColour: #FFFCC7;
  --commentBorderColour: #F2E49B;
}

.blocklyComment .blocklyTextarea {
  background-color: var(--commentFillColour);
  border: 1px solid var(--commentBorderColour);
  box-sizing: border-box;
  display: block;
  outline: 0;
  padding: 5px;
  resize: none;
  width: 100%;
  height: 100%;
}

.blocklyReadonly.blocklyComment .blocklyTextarea {
  cursor: inherit;
}

.blocklyDeleteIcon {
  width: 20px;
  height: 20px;
  display: none;
  cursor: pointer;
}

.blocklyFoldoutIcon {
  width: 20px;
  height: 20px;
  transform-origin: 12px 12px;
  cursor: pointer;
}
.blocklyResizeHandle {
  width: 12px;
  height: 12px;
  cursor: se-resize;
}
.blocklyReadonly.blocklyComment .blocklyResizeHandle {
  cursor: inherit;
}

.blocklyCommentTopbarBackground {
  fill: var(--commentBorderColour);
  height: 24px;
}

.blocklyComment .blocklyCommentPreview.blocklyText {
  fill: #000;
  dominant-baseline: middle;
  visibility: hidden;
}

.blocklyCollapsed.blocklyComment .blocklyCommentPreview {
  visibility: visible;
}

.blocklyCollapsed.blocklyComment .blocklyCommentForeignObject,
.blocklyCollapsed.blocklyComment .blocklyResizeHandle {
  display: none;
}

.blocklyCollapsed.blocklyComment .blocklyFoldoutIcon {
  transform: rotate(-90deg);
}

.blocklyRTL .blocklyCommentTopbar {
  transform: scale(-1, 1);
}

.blocklyRTL .blocklyCommentForeignObject {
  direction: rtl;
}

.blocklyRTL .blocklyCommentPreview {
  /* Revert the scale and control RTL using direction instead. */
  transform: scale(-1, 1);
  direction: rtl;
}

.blocklyRTL .blocklyResizeHandle {
  transform: scale(-1, 1);
  cursor: sw-resize;
}

.blocklyCommentHighlight {
  fill: none;
}

.blocklyCommentText.blocklyActiveFocus {
  border-color: #fc3;
  border-width: 2px;
}

.blocklySelected .blocklyCommentHighlight {
  stroke: #fc3;
  stroke-width: 3px;
}

.blocklyCollapsed.blocklySelected .blocklyCommentHighlight {
  stroke: none;
}

.blocklyCollapsed.blocklySelected .blocklyCommentTopbarBackground {
  stroke: #fc3;
  stroke-width: 3px;
}
`);var dc=class{constructor(e,t){this.workspace=e,this.text="",this.collapsed=!1,this.deletable=this.movable=this.editable=!0,this.location=new Ne(0,0),this.disposing=this.disposed=!1,this.id=t&&!e.getCommentById(t)?t:ot(),this.size=oa.defaultCommentSize,e.addTopComment(this),this.fireCreateEvent()}fireCreateEvent(){Ze()&&Be(new(Qe(ce.COMMENT_CREATE))(this))}fireDeleteEvent(){Ze()&&Be(new(Qe(ce.COMMENT_DELETE))(this))}fireChangeEvent(e,t){Ze()&&Be(new(Qe(ce.COMMENT_CHANGE))(this,e,t))}fireCollapseEvent(e){Ze()&&Be(new(Qe(ce.COMMENT_COLLAPSE))(this,e))}setText(e){const t=this.text;this.text=e,this.fireChangeEvent(t,e)}getText(){return this.text}setSize(e){const t=new(Qe(ce.COMMENT_RESIZE))(this);this.size=e,t.recordCurrentSizeAsNewSize(),Be(t)}getSize(){return this.size}setCollapsed(e){this.collapsed=e,this.fireCollapseEvent(e)}isCollapsed(){return this.collapsed}setEditable(e){this.editable=e}isEditable(){return this.isOwnEditable()&&!this.workspace.isReadOnly()}isOwnEditable(){return this.editable}setMovable(e){this.movable=e}isMovable(){return this.isOwnMovable()&&!this.workspace.isReadOnly()&&!this.workspace.isFlyout}isOwnMovable(){return this.movable}setDeletable(e){this.deletable=e}isDeletable(){return this.isOwnDeletable()&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()&&!this.workspace.isFlyout}isOwnDeletable(){return this.deletable}moveTo(e,t){const i=new(Qe(ce.COMMENT_MOVE))(this);t&&i.setReason(t),this.location=e,i.recordNew(),Be(i)}getRelativeToSurfaceXY(){return this.location}dispose(){this.disposing=!0,this.fireDeleteEvent(),this.workspace.removeTopComment(this),this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}},As=class extends dc{constructor(e,t){super(e,t),this.dragStrategy=new Qp(this),this.workspace=e,this.view=new oa(e,this.id),this.view.setSize(this.getSize()),this.view.setEditable(this.isEditable()),this.view.getSvgRoot().setAttribute("data-id",this.id),this.view.getSvgRoot().setAttribute("id",this.id),this.addModelUpdateBindings(),_e(this.view.getSvgRoot(),"pointerdown",this,this.startGesture)}addModelUpdateBindings(){this.view.addTextChangeListener((e,t)=>void super.setText(t)),this.view.addSizeChangeListener((e,t)=>void super.setSize(t)),this.view.addOnCollapseListener(()=>void super.setCollapsed(this.view.isCollapsed())),this.view.addDisposeListener(()=>{this.isDeadOrDying()||this.dispose()})}setText(e){this.view.setText(e)}setPlaceholderText(e){this.view.setPlaceholderText(e)}setSize(e){this.view.setSize(e)}setCollapsed(e){this.view.setCollapsed(e)}setEditable(e){super.setEditable(e),this.view.setEditable(this.isEditable())}getSvgRoot(){return this.view.getSvgRoot()}getSize(){return super.getSize()}getBoundingRectangle(){const e=this.getRelativeToSurfaceXY();var t,i;const s=(i=(t=this.view)==null?void 0:t.getSize())!=null?i:this.getSize();return this.workspace.RTL?(t=e.x-s.width,i=e.x):(t=e.x,i=e.x+s.width),new Nt(e.y,e.y+s.height,t,i)}moveBy(e,t,i){const s=this.getRelativeToSurfaceXY();e=new Ne(s.x+e,s.y+t),this.moveTo(e,i)}moveTo(e,t){super.moveTo(e,t),this.view.moveTo(e)}moveDuringDrag(e){this.location=e,this.view.moveTo(e)}setDragging(e){e?We(this.getSvgRoot(),"blocklyDragging"):vt(this.getSvgRoot(),"blocklyDragging")}dispose(){this.disposing=!0;const e=l.getFocusManager$$module$build$src$core$focus_manager();e.getFocusedNode()===this&&setTimeout(()=>e.focusTree(this.workspace),0),this.view.isDeadOrDying()||this.view.dispose(),super.dispose()}startGesture(e){const t=this.workspace.getGesture(e);t&&(t.handleCommentStart(e,this),l.getFocusManager$$module$build$src$core$focus_manager().focusNode(this))}setDeleteStyle(e){e?We(this.getSvgRoot(),"blocklyDraggingDelete"):vt(this.getSvgRoot(),"blocklyDraggingDelete")}isCopyable(){return this.isOwnMovable()&&this.isOwnDeletable()}isMovable(){return this.dragStrategy.isMovable()}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){We(this.getSvgRoot(),"blocklySelected"),Fe(this)}unselect(){vt(this.getSvgRoot(),"blocklySelected"),Fe(null)}toCopyData(){return{paster:cl.TYPE,commentState:$s(this,{addCoordinates:!0,saveIds:!1})}}showContextMenu(e){const t=Dt.registry.getContextMenuOptions({comment:this,focusedNode:this},e);let i;i=e instanceof PointerEvent?new Ne(e.clientX,e.clientY):vl(this.workspace,this.getRelativeToSurfaceXY()).translate(10,10),Nu(e,t,this.workspace.RTL,this.workspace,i)}snapToGrid(){if(!this.isDeadOrDying()){var e=this.workspace.getGrid();if(e!=null&&e.shouldSnap()){var t=this.getRelativeToSurfaceXY();e=e.alignXY(t),e!==t&&this.moveTo(e,["snap"])}}}getEditorFocusableNode(){return this.view.getEditorFocusableNode()}getFocusableElement(){return this.getSvgRoot()}getFocusableTree(){return this.workspace}onNodeFocus(){this.select();let e;(e=this.workspace.getLayerManager())==null||e.append(this,ru),this.workspace.scrollBoundsIntoView(this.getBoundingRectangle())}onNodeBlur(){this.unselect()}canBeFocused(){return!0}},no={};no.appendDomToWorkspace=os,no.blockToDom=mr,no.blockToDomWithXY=is,no.clearWorkspaceAndLoadFromXml=Kt,no.deleteNext=Er,no.domToBlock=l.domToBlock$$module$build$src$core$xml,no.domToBlockInternal=Zr,no.domToPrettyText=Bn,no.domToText=xn,no.domToVariables=br,no.domToWorkspace=l.domToWorkspace$$module$build$src$core$xml,no.loadWorkspaceComment=_r,no.saveWorkspaceComment=Lo,no.variablesToDom=vs,no.workspaceToDom=Jr;var Jd=class extends Ql{constructor(e){super(e),this.type=ce.BLOCK_CREATE,e&&(e.isShadow()&&(this.recordUndo=!1),this.xml=is(e),this.ids=An(e),this.json=Zi(e,{addCoordinates:!0}))}toJson(){const e=super.toJson();if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=xn(this.xml),e.ids=this.ids,e.json=this.json,this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new Jd),t.xml=l.textToDom$$module$build$src$core$utils$xml(e.xml),t.ids=e.ids,t.json=e.json,e.recordUndo!==void 0&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!hp(t,this.ids))if(e)bo(this.json,t);else for(e=0;e<this.ids.length;e++){const i=this.ids[e],s=t.getBlockById(i);s?s.dispose(!1):i===this.blockId&&console.warn("Can't uncreate non-existent block: "+i)}}},hp=function(e,t){return t.map(i=>e.getBlockById(i)).filter(i=>i&&i.isShadow()).length===t.length};a(Re.EVENT,ce.BLOCK_CREATE,Jd);var Rh=class extends tn{constructor(e,t){super(t),this.type=ce.THEME_CHANGE,this.themeName=e}toJson(){const e=super.toJson();if(!this.themeName)throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson");return e.themeName=this.themeName,e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new Rh),t.themeName=e.themeName,t}};a(Re.EVENT,ce.THEME_CHANGE,Rh);var dp=class extends tn{constructor(e,t,i,s,c){super(s),this.type=ce.VIEWPORT_CHANGE,this.viewTop=e,this.viewLeft=t,this.scale=i,this.oldScale=c}toJson(){const e=super.toJson();if(this.viewTop===void 0)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(this.viewLeft===void 0)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(this.scale===void 0)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(this.oldScale===void 0)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");return e.viewTop=this.viewTop,e.viewLeft=this.viewLeft,e.scale=this.scale,e.oldScale=this.oldScale,e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new dp),t.viewTop=e.viewTop,t.viewLeft=e.viewLeft,t.scale=e.scale,t.oldScale=e.oldScale,t}};a(Re.EVENT,ce.VIEWPORT_CHANGE,dp);var fp={fromJsonInternal:Hc},Zd={TEST_ONLY:fp};Zd.fromJson=l.fromJson$$module$build$src$core$field_registry,Zd.register=Ss,Zd.unregister=xu;var zi=class extends dn{constructor(e,t,i){super(dn.SKIP_SETUP),this.svgArrow=this.arrow=this.imageElement=this.menu_=this.selectedMenuItem=null,this.SERIALIZABLE=!0,this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions=null,e!==dn.SKIP_SETUP&&(this.setOptions(e),i&&this.configure_(i),t&&this.setValidator(t))}fromXml(e){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e.textContent)}loadState(e){this.loadLegacyState(zi,e)||(this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement=ae(le.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&We(this.borderRect_,"blocklyDropdownRect"),this.fieldGroup_&&(We(this.fieldGroup_,"blocklyField"),We(this.fieldGroup_,"blocklyDropdownField"))}shouldAddBorderRect_(){let e;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!((e=this.getSourceBlock())!=null&&e.isShadow())}createTextArrow_(){this.arrow=ae(le.TSPAN,{},this.textElement_);let e;this.arrow.appendChild(document.createTextNode((e=this.getSourceBlock())!=null&&e.RTL?zi.ARROW_CHAR+" ":" "+zi.ARROW_CHAR)),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.arrow.setAttribute("dominant-baseline","central");let t;(t=this.getSourceBlock())!=null&&t.RTL?this.getTextElement().insertBefore(this.arrow,this.textContent_):this.getTextElement().appendChild(this.arrow)}createSVGArrow_(){this.svgArrow=ae(le.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow.setAttributeNS(Co,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(e){var t=this.getSourceBlock();if(!t)throw new ai;this.dropdownCreate(),this.menu_&&(this.menu_.openingCoords=e&&typeof e.clientX=="number"?new Ne(e.clientX,e.clientY):null,ts(),e=this.menu_.render(cr()),We(e,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(t=t.getColour(),e=this.sourceBlock_.getColourTertiary(),Dc(t,e)),Ll(this,this.dropdownDispose_.bind(this)),cr().style.height=`${this.menu_.getSize().height}px`,this.menu_.focus(),this.selectedMenuItem&&this.menu_.setHighlighted(this.selectedMenuItem),this.applyColour())}dropdownCreate(){const e=this.getSourceBlock();if(!e)throw new ai;const t=new Qf;t.setRole(Ho.LISTBOX),this.menu_=t;const i=this.getOptions(!1);this.selectedMenuItem=null;for(let c=0;c<i.length;c++){var s=i[c];if(s===zi.SEPARATOR){t.addChild(new an);continue}const[m,I]=s;Cs(m)?(s=new Image(m.width,m.height),s.src=m.src,s.alt=m.alt):s=m,s=new Ld(s,I),s.setRole(Ho.OPTION),s.setRightToLeft(e.RTL),s.setCheckable(!0),t.addChild(s),s.setChecked(I===this.value_),I===this.value_&&(this.selectedMenuItem=s),s.onAction(this.handleMenuActionEvent,this)}}dropdownDispose_(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem=this.menu_=null,this.applyColour()}handleMenuActionEvent(e){Us(this,!0),this.onItemSelected_(this.menu_,e)}onItemSelected_(e,t){this.setValue(t.getValue())}isOptionListDynamic(){return typeof this.menuGenerator_=="function"}getOptions(e){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");return Array.isArray(this.menuGenerator_)?this.menuGenerator_:e&&this.generatedOptions?this.generatedOptions:(this.generatedOptions=this.menuGenerator_(),this.validateOptions(this.generatedOptions),this.generatedOptions)}setOptions(e){Array.isArray(e)?(this.validateOptions(e),e=this.trimOptions(e),this.menuGenerator_=e.options,this.prefixField=e.prefix||null,this.suffixField=e.suffix||null):this.menuGenerator_=e,this.selectedOption=this.getOptions(!1)[0],this.setValue(this.selectedOption[1])}doClassValidation_(e){return this.getOptions(!0).some(t=>t[1]===e)?e:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+e),null)}doValueUpdate_(e){super.doValueUpdate_(e),e=this.getOptions(!0);for(let t=0,i;i=e[t];t++)i[1]===this.value_&&(this.selectedOption=i)}applyColour(){const e=this.sourceBlock_;this.borderRect_&&(this.borderRect_.setAttribute("stroke",e.getColourTertiary()),this.menu_?this.borderRect_.setAttribute("fill",e.getColourTertiary()):this.borderRect_.setAttribute("fill","transparent")),e&&this.arrow&&(e.isShadow()?this.arrow.style.fill=e.getColourSecondary():this.arrow.style.fill=e.getColour())}render_(){this.getTextContent().nodeValue="",this.imageElement.style.display="none";const e=this.selectedOption&&this.selectedOption[0];Cs(e)?this.renderSelectedImage(e):this.renderSelectedText(),this.positionBorderRect_()}renderSelectedImage(e){const t=this.getSourceBlock();if(!t)throw new ai;this.imageElement.style.display="",this.imageElement.setAttributeNS(Co,"xlink:href",e.src),this.imageElement.setAttribute("height",String(e.height)),this.imageElement.setAttribute("width",String(e.width));const i=Number(e.height);e=Number(e.width);var s=!!this.borderRect_;const c=Math.max(s?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,i+zi.IMAGE_Y_PADDING);s=s?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let m;m=this.svgArrow?this.positionSVGArrow(e+s,c/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):bn(this.arrow),this.size_=new Mt(e+m+s*2,c);let I=0;t.RTL?this.imageElement.setAttribute("x",`${s+m}`):(I=e+m,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement.setAttribute("x",`${s}`)),this.imageElement.setAttribute("y",String(c/2-i/2)),this.positionTextElement_(I+s,e+m)}renderSelectedText(){this.getTextContent().nodeValue=this.getDisplayText_();var e=this.getTextElement();We(e,"blocklyDropdownText"),e.setAttribute("text-anchor","start");var t=!!this.borderRect_;e=Math.max(t?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT);const i=bn(this.getTextElement());t=t?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let s=0;this.svgArrow&&(s=this.positionSVGArrow(i+t,e/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_=new Mt(i+s+t*2,e),this.positionTextElement_(t,i)}positionSVGArrow(e,t){if(!this.svgArrow)return 0;const i=this.getSourceBlock();if(!i)throw new ai;const s=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,c=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,m=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow.setAttribute("transform","translate("+(i.RTL?s:e+c)+","+t+")"),m+c}getText_(){if(!this.selectedOption)return null;const e=this.selectedOption[0];if(Cs(e))return e.alt;if(typeof HTMLElement<"u"&&e instanceof HTMLElement){let t,i;return(i=(t=e.title)!=null?t:e.ariaLabel)!=null?i:e.innerText}return typeof e=="string"?e:(console.warn("Can't get text for existing dropdown option. If you're using HTMLElement dropdown options in node, ensure you're using jsdom-global or similar."),null)}static fromJson(e){if(!e.options)throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.");return new this(e.options,void 0,e)}trimOptions(e){let t=!1;const i=e.map(I=>{if(I===zi.SEPARATOR)return t=!0,I;const[B,Se]=I;return typeof B=="string"?[Ge(B),Se]:(t=!0,[Cs(B)?Object.assign({},B,{alt:Ge(B.alt)}):B,Se])});if(t||e.length<2)return{options:i};var s=i.map(([I])=>I),c=co(s);e=Nn(s,c);const m=fr(s,c);return!e&&!m||c<=e+m?{options:i}:(c=e?s[0].substring(0,e-1):void 0,s=m?s[0].substr(1-m):void 0,{options:this.applyTrim(i,e,m),prefix:c,suffix:s})}applyTrim(e,t,i){return e.map(([s,c])=>[s.substring(t,s.length-i),c])}validateOptions(e){if(!Array.isArray(e))throw TypeError("FieldDropdown options must be an array.");if(!e.length)throw TypeError("FieldDropdown options must not be an empty array.");let t=!1;for(let i=0;i<e.length;i++){const s=e[i];Array.isArray(s)||s===zi.SEPARATOR?typeof s[1]!="string"?(t=!0,console.error(`Invalid option[${i}]: Each FieldDropdown option id must be a string.
          Found ${s[1]} in: ${s}`)):!s[0]||typeof s[0]=="string"||Cs(s[0])||typeof HTMLElement<"u"&&s[0]instanceof HTMLElement||(t=!0,console.error(`Invalid option[${i}]: Each FieldDropdown option must have a string
          label, image description, or HTML element. Found ${s[0]} in: ${s}`)):(t=!0,console.error(`Invalid option[${i}]: Each FieldDropdown option must be an array or
          the string literal 'separator'. Found: ${s}`))}if(t)throw TypeError("Found invalid FieldDropdown options.")}};zi.SEPARATOR="separator",zi.ARROW_CHAR="▾",zi.IMAGE_Y_OFFSET=5,zi.IMAGE_Y_PADDING=zi.IMAGE_Y_OFFSET*2,Ss("field_dropdown",zi);var sa=class{constructor(e,t,i,s){this.name=e,this.startHats=!1,this.blockStyles=t||Object.create(null),this.categoryStyles=i||Object.create(null),this.componentStyles=s||Object.create(null),this.fontStyle=Object.create(null),a(Re.THEME,e,this,!0)}getClassName(){return this.name+"-theme"}setBlockStyle(e,t){this.blockStyles[e]=t}setCategoryStyle(e,t){this.categoryStyles[e]=t}getComponentStyle(e){if(e=this.componentStyles[e],!e)return null;if(typeof e=="string"){const t=this.getComponentStyle(e);if(t)return t}return`${e}`}setComponentStyle(e,t){this.componentStyles[e]=t}setFontStyle(e){this.fontStyle=e}setStartHats(e){this.startHats=e}static defineTheme(e,t){e=e.toLowerCase();const i=new sa(e);let s=t.base;if(s){if(typeof s=="string"){let c;s=(c=O(Re.THEME,s))!=null?c:void 0}s instanceof sa&&(Ht(i,s),i.name=e)}return Ht(i.blockStyles,t.blockStyles),Ht(i.categoryStyles,t.categoryStyles),Ht(i.componentStyles,t.componentStyles),Ht(i.fontStyle,t.fontStyle),t.startHats!==null&&(i.startHats=t.startHats),i}},bg={colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},lu={colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}},Ih=new sa("classic",bg,lu),qs=class{constructor(e){this.gridPattern=null,this.getMetrics=this.setMetrics=void 0;let t=null,i=!1;var s=!1,c=!1,m=!1,I=!1,B=!1;const Se=!!e.readOnly;if(!Se){var mt;t=zr((mt=e.toolbox)!=null?mt:null),i=lo(t),s=e.trashcan,s=s===void 0?i:s,c=e.collapse,c=c===void 0?i:c,m=e.comments,m=m===void 0?i:m,I=e.disable,I=I===void 0?i:I,B=e.sounds,B=B===void 0?!0:B}mt=e.maxTrashcanContents,s?mt===void 0&&(mt=32):mt=0;const ci=!!e.rtl;let Un=e.horizontalLayout;Un===void 0&&(Un=!1);var Ao=e.toolboxPosition!=="end";Ao=Un?Ao?Lt.TOP:Lt.BOTTOM:Ao===ci?Lt.RIGHT:Lt.LEFT;let fa=e.css;fa===void 0&&(fa=!0);let mu="https://blockly-demo.appspot.com/static/media/";e.media&&(mu=e.media.endsWith("/")?e.media:e.media+"/");const sm=e.oneBasedIndex,km=e.renderer||"geras",Mm=e.plugins||{};let qg=e.modalInputs;qg===void 0&&(qg=!0),this.RTL=ci,this.oneBasedIndex=sm===void 0?!0:sm,this.collapse=c,this.comments=m,this.disable=I,this.readOnly=Se,this.maxBlocks=e.maxBlocks||1/0;let rm;this.maxInstances=(rm=e.maxInstances)!=null?rm:null,this.modalInputs=qg,this.pathToMedia=mu,this.hasCategories=i,this.moveOptions=qs.parseMoveOptions(e,i),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=s,this.maxTrashcanContents=mt,this.hasSounds=B,this.hasCss=fa,this.horizontalLayout=Un,this.languageTree=t,this.gridOptions=qs.parseGridOptions(e),this.zoomOptions=qs.parseZoomOptions(e),this.toolboxPosition=Ao,this.theme=qs.parseThemeOptions(e),this.renderer=km;let lm;this.rendererOverrides=(lm=e.rendererOverrides)!=null?lm:null;let um;this.parentWorkspace=(um=e.parentWorkspace)!=null?um:null,this.plugins=Mm}static parseMoveOptions(e,t){const i=e.move||{},s={};return i.scrollbars===void 0&&e.scrollbars===void 0?s.scrollbars=t:typeof i.scrollbars=="object"?(s.scrollbars={horizontal:!!i.scrollbars.horizontal,vertical:!!i.scrollbars.vertical},s.scrollbars.horizontal&&s.scrollbars.vertical?s.scrollbars=!0:s.scrollbars.horizontal||s.scrollbars.vertical||(s.scrollbars=!1)):s.scrollbars=!!i.scrollbars||!!e.scrollbars,s.wheel=s.scrollbars&&i.wheel!==void 0?!!i.wheel:typeof s.scrollbars=="object",s.drag=s.scrollbars?i.drag===void 0?!0:!!i.drag:!1,s}static parseZoomOptions(e){e=e.zoom||{};const t={};return t.controls=e.controls===void 0?!1:!!e.controls,t.wheel=e.wheel===void 0?!1:!!e.wheel,t.startScale=e.startScale===void 0?1:Number(e.startScale),t.maxScale=e.maxScale===void 0?3:Number(e.maxScale),t.minScale=e.minScale===void 0?.3:Number(e.minScale),t.scaleSpeed=e.scaleSpeed===void 0?1.2:Number(e.scaleSpeed),t.pinch=e.pinch===void 0?t.wheel||t.controls:!!e.pinch,t}static parseGridOptions(e){e=e.grid||{};const t={};return t.spacing=Number(e.spacing)||0,t.colour=e.colour||"#888",t.length=e.length===void 0?1:Number(e.length),t.snap=t.spacing>0&&!!e.snap,t}static parseThemeOptions(e){return e=e.theme||Ih,typeof e=="string"?O(Re.THEME,e):e instanceof sa?e:sa.defineTheme(e.name||"builtin"+ht(),e)}},Qd=class{constructor(e,t){this.bubble=e,this.workspace=t,this.startLoc=null}isMovable(){return!0}startDrag(){this.startLoc=this.bubble.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1);let e;(e=this.workspace.getLayerManager())==null||e.moveToDragLayer(this.bubble),this.bubble.setDragging&&this.bubble.setDragging(!0)}drag(e){this.bubble.moveDuringDrag(e)}endDrag(){this.workspace.setResizesEnabled(!0);let e;(e=this.workspace.getLayerManager())==null||e.moveOffDragLayer(this.bubble,Sh),this.bubble.setDragging(!1)}revertDrag(){this.startLoc&&this.bubble.moveDuringDrag(this.startLoc)}},as,fn=class{constructor(e,t,i,s,c){this.workspace=e,this.anchor=t,this.ownerRect=i,this.owner=c,this.size=new Mt(0,0),this.colour="#ffffff",this.disposed=!1,this.relativeLeft=this.relativeTop=0,this.dragStrategy=new Qd(this,this.workspace),this.id=ht(),this.svgRoot=ae(le.G,{class:"blocklyBubble"},e.getBubbleCanvas()),e=ae(le.G,{class:"blocklyEmboss"},this.svgRoot),this.tail=ae(le.PATH,{class:"blocklyBubbleTail"},e),this.background=ae(le.RECT,{class:"blocklyDraggable",x:0,y:0,rx:as.BORDER_WIDTH,ry:as.BORDER_WIDTH},e),this.contentContainer=ae(le.G,{},this.svgRoot),this.focusableElement=s??this.svgRoot,this.focusableElement.setAttribute("id",this.id),_e(this.background,"pointerdown",this,this.onMouseDown),_e(this.focusableElement,"keydown",this,this.onKeyDown)}dispose(){Wt(this.svgRoot),this.disposed=!0}setAnchorLocation(e,t=!1){this.anchor=e,t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}setPositionRelativeToAnchor(e,t){this.relativeLeft=e,this.relativeTop=t,this.positionRelativeToAnchor(),this.renderTail()}getSize(){return this.size}setSize(e,t=!1){e.width=Math.max(e.width,as.MIN_SIZE),e.height=Math.max(e.height,as.MIN_SIZE),this.size=e,this.background.setAttribute("width",`${e.width}`),this.background.setAttribute("height",`${e.height}`),t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}getColour(){return this.colour}setColour(e){this.colour=e,this.tail.setAttribute("fill",e),this.background.setAttribute("fill",e)}onMouseDown(e){let t;(t=this.workspace.getGesture(e))==null||t.handleBubbleStart(e,this),l.getFocusManager$$module$build$src$core$focus_manager().focusNode(this)}onKeyDown(e){e.key==="Escape"&&this.owner&&(this.owner.setBubbleVisible(!1),l.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.owner))}positionRelativeToAnchor(){let e=this.anchor.x;e=this.workspace.RTL?e-(this.relativeLeft+this.size.width):e+this.relativeLeft,this.moveTo(e,this.relativeTop+this.anchor.y)}moveTo(e,t){this.svgRoot.setAttribute("transform",`translate(${e}, ${t})`)}positionByRect(e=new Nt(0,0,0,0)){var t=this.workspace.getMetricsManager().getViewMetrics(!0),i=this.getOptimalRelativeLeft(t),s=this.getOptimalRelativeTop(t);const c={x:i,y:-this.size.height-this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT},m={x:-this.size.width-30,y:s};s={x:e.getWidth(),y:s};var I={x:i,y:e.getHeight()};i=e.getWidth()<e.getHeight()?s:I,e=e.getWidth()<e.getHeight()?I:s,s=this.getOverlap(c,t),I=this.getOverlap(m,t);const B=this.getOverlap(i,t);t=this.getOverlap(e,t),t=Math.max(s,I,B,t),s===t?(this.relativeLeft=c.x,this.relativeTop=c.y):I===t?(this.relativeLeft=m.x,this.relativeTop=m.y):B===t?(this.relativeLeft=i.x,this.relativeTop=i.y):(this.relativeLeft=e.x,this.relativeTop=e.y),this.positionRelativeToAnchor()}getOverlap(e,t){var i=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x+this.anchor.x;return e=e.y+this.anchor.y,Math.max(0,Math.min(1,(Math.min(i+this.size.width,t.left+t.width)-Math.max(i,t.left))*(Math.min(e+this.size.height,t.top+t.height)-Math.max(e,t.top))/(this.size.width*this.size.height)))}getOptimalRelativeLeft(e){let t=-this.size.width/4;if(this.size.width>e.width)return t;if(e=this.getWorkspaceViewRect(e),this.workspace.RTL){var i=this.anchor.x-t;i-this.size.width<e.left?t=-(e.left-this.anchor.x+this.size.width):i>e.right&&(t=-(e.right-this.anchor.x))}else{i=t+this.anchor.x;const s=i+this.size.width;i<e.left?t=e.left-this.anchor.x:s>e.right&&(t=e.right-this.anchor.x-this.size.width)}return t}getOptimalRelativeTop(e){let t=-this.size.height/4;if(this.size.height>e.height)return t;const i=this.anchor.y+t,s=i+this.size.height;return e=this.getWorkspaceViewRect(e),i<e.top?t=e.top-this.anchor.y:s>e.bottom&&(t=e.bottom-this.anchor.y-this.size.height),t}getWorkspaceViewRect(e){const t=e.top;let i=e.top+e.height,s=e.left;return e=e.left+e.width,i-=this.getScrollbarThickness(),this.workspace.RTL?s-=this.getScrollbarThickness():e-=this.getScrollbarThickness(),new Nt(t,i,s,e)}getScrollbarThickness(){return qn.scrollbarThickness/this.workspace.scale}renderTail(){const e=[];var t=this.size.width/2,i=this.size.height/2,s=-this.relativeLeft,c=-this.relativeTop;if(t===s&&i===c)e.push("M "+t+","+i);else{c-=i,s-=t,this.workspace.RTL&&(s*=-1);var m=Math.sqrt(c*c+s*s),I=Math.acos(s/m);c<0&&(I=2*Math.PI-I);var B=I+Math.PI/2;B>Math.PI*2&&(B-=Math.PI*2);var Se=Math.sin(B);const ci=Math.cos(B);let Un=(this.size.width+this.size.height)/as.TAIL_THICKNESS;Un=Math.min(Un,this.size.width,this.size.height)/4,B=1-as.ANCHOR_RADIUS/m,s=t+B*s,c=i+B*c,B=t+Un*ci;const Ao=i+Un*Se;t-=Un*ci,i-=Un*Se,Se=kl(this.workspace.RTL?-as.TAIL_ANGLE:as.TAIL_ANGLE),Se=I+Se,Se>Math.PI*2&&(Se-=Math.PI*2),I=Math.sin(Se)*m/as.TAIL_BEND,m=Math.cos(Se)*m/as.TAIL_BEND,e.push("M"+B+","+Ao),e.push("C"+(B+m)+","+(Ao+I)+" "+s+","+c+" "+s+","+c),e.push("C"+s+","+c+" "+(t+m)+","+(i+I)+" "+t+","+i)}e.push("z");let mt;(mt=this.tail)==null||mt.setAttribute("d",e.join(" "))}bringToFront(){let e;const t=(e=this.svgRoot)==null?void 0:e.parentNode;return this.svgRoot&&t?.lastChild!==this.svgRoot?(t?.appendChild(this.svgRoot),!0):!1}getRelativeToSurfaceXY(){return new Ne(this.workspace.RTL?-this.relativeLeft+this.anchor.x-this.size.width:this.anchor.x+this.relativeLeft,this.anchor.y+this.relativeTop)}getSvgRoot(){return this.svgRoot}moveDuringDrag(e){this.moveTo(e.x,e.y),this.relativeLeft=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x-this.anchor.x,this.relativeTop=e.y-this.anchor.y,this.renderTail()}setDragging(e){}setDeleteStyle(e){}isDeletable(){return!1}showContextMenu(e){}isMovable(){return!0}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){Fe(this)}unselect(){Fe(null)}getFocusableElement(){return this.focusableElement}getFocusableTree(){return this.workspace}onNodeFocus(){this.select(),this.bringToFront();var e=this.getRelativeToSurfaceXY();const t=this.getSize();e=new Nt(e.y,e.y+t.height,e.x,e.x+t.width),this.workspace.scrollBoundsIntoView(e)}onNodeBlur(){this.unselect()}canBeFocused(){return!0}getOwner(){return this.owner}};as=fn,fn.BORDER_WIDTH=6,fn.DOUBLE_BORDER=as.BORDER_WIDTH*2,fn.MIN_SIZE=as.DOUBLE_BORDER,fn.TAIL_THICKNESS=1,fn.TAIL_ANGLE=20,fn.TAIL_BEND=4,fn.ANCHOR_RADIUS=8;var Fr=class extends fn{constructor(e,t,i,s){super(t,i,s),this.workspace=t,this.anchor=i,this.ownerRect=s,this.autoLayout=!0,t=new qs(e),this.validateWorkspaceOptions(t),this.svgDialog=ae(le.SVG,{x:fn.BORDER_WIDTH,y:fn.BORDER_WIDTH},this.contentContainer),e.parentWorkspace=this.workspace,this.miniWorkspace=this.newWorkspaceSvg(new qs(e)),this.miniWorkspace.internalIsMutator=!0,e=this.miniWorkspace.createDom("blocklyMutatorBackground"),this.svgDialog.appendChild(e),t.languageTree&&(e.insertBefore(this.miniWorkspace.addFlyout(le.G),this.miniWorkspace.getCanvas()),e=this.miniWorkspace.getFlyout(),e?.init(this.miniWorkspace),e?.show(t.languageTree)),We(this.svgRoot,"blocklyMiniWorkspaceBubble"),this.miniWorkspace.addChangeListener(this.onWorkspaceChange.bind(this));let c,m;(c=this.miniWorkspace.getFlyout())==null||(m=c.getWorkspace())==null||m.addChangeListener(this.onWorkspaceChange.bind(this)),this.updateBubbleSize()}dispose(){this.miniWorkspace.dispose(),super.dispose()}getWorkspace(){return this.miniWorkspace}addWorkspaceChangeListener(e){this.miniWorkspace.addChangeListener(e)}validateWorkspaceOptions(e){if(e.hasCategories)throw Error("The miniworkspace bubble does not support toolboxes with categories");if(e.hasTrashcan)throw Error("The miniworkspace bubble does not support trashcans");if(e.zoomOptions.controls||e.zoomOptions.wheel||e.zoomOptions.pinch)throw Error("The miniworkspace bubble does not support zooming");if(e.moveOptions.scrollbars||e.moveOptions.wheel||e.moveOptions.drag)throw Error("The miniworkspace bubble does not scrolling/moving the workspace");if(e.horizontalLayout)throw Error("The miniworkspace bubble does not support horizontal layouts")}onWorkspaceChange(){this.bumpBlocksIntoBounds(),this.updateBubbleSize()}bumpBlocksIntoBounds(){if(!this.miniWorkspace.isDragging()||this.miniWorkspace.keyboardMoveInProgress)for(const e of this.miniWorkspace.getTopBlocks(!1)){const t=e.getRelativeToSurfaceXY();if(t.y<20&&e.moveBy(0,20-t.y),e.RTL){let i=-20;const s=this.miniWorkspace.getFlyout();s&&(i-=s.getWidth()),t.x>i&&e.moveBy(i-t.x,0)}else t.x<20&&e.moveBy(20-t.x,0)}}updateBubbleSize(){if(!this.miniWorkspace.isDragging()||this.miniWorkspace.keyboardMoveInProgress){this.autoLayout&&(this.autoLayout=!this.miniWorkspace.keyboardMoveInProgress);var e=this.getSize(),t=this.calculateWorkspaceSize();Math.abs(e.width-t.width)<Fr.MINIMUM_VIEW_CHANGE&&Math.abs(e.height-t.height)<Fr.MINIMUM_VIEW_CHANGE||(this.svgDialog.setAttribute("width",`${t.width}px`),this.svgDialog.setAttribute("height",`${t.height}px`),this.miniWorkspace.setCachedParentSvgSize(t.width,t.height),this.miniWorkspace.RTL&&this.miniWorkspace.getCanvas().setAttribute("transform",`translate(${t.width}, 0)`),this.setSize(new Mt(t.width+fn.DOUBLE_BORDER,t.height+fn.DOUBLE_BORDER),this.autoLayout),this.miniWorkspace.resize(),this.miniWorkspace.recordDragTargets())}}calculateWorkspaceSize(){var e=this.miniWorkspace.getCanvas().getBBox();let t=e.width+Fr.MARGIN;e=e.height+Fr.MARGIN;const i=this.miniWorkspace.getFlyout();if(i){const s=i.getWorkspace().getMetricsManager().getScrollMetrics();e=Math.max(e,s.height+20),t+=i.getWidth()}return new Mt(t,e)}updateBlockStyles(){for(var e of this.miniWorkspace.getAllBlocks(!1))e.setStyle(e.getStyleName());let t;if(e=(t=this.miniWorkspace.getFlyout())==null?void 0:t.getWorkspace())for(const i of e.getAllBlocks(!1))i.setStyle(i.getStyleName())}moveDuringDrag(e){super.moveDuringDrag(e),this.autoLayout=!1}moveTo(e,t){super.moveTo(e,t),this.miniWorkspace.recordDragTargets()}newWorkspaceSvg(e){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts")}};Fr.MINIMUM_VIEW_CHANGE=10,Fr.MARGIN=fn.DOUBLE_BORDER*3;var ra=class{constructor(e){this.sourceBlock=e,this.offsetInBlock=new Ne(0,0),this.workspaceLocation=new Ne(0,0),this.svgRoot=null,this.tooltip=e,this.id=ht()}getType(){throw Error("Icons must implement getType")}initView(e){if(!this.svgRoot){var t=this.sourceBlock;this.svgRoot=ae(le.G,{class:"blocklyIconGroup",id:this.id}),t.getSvgRoot().appendChild(this.svgRoot),this.updateSvgRootOffset(),_e(this.svgRoot,"pointerdown",this,e),this.svgRoot.tooltip=this,b(this.svgRoot)}}dispose(){y(this.svgRoot),Wt(this.svgRoot)}getWeight(){return-1}getSize(){return new Mt(0,0)}setTooltip(e){this.tooltip=e??this.sourceBlock}getTooltip(){return this.tooltip}applyColour(){}updateEditable(){}updateCollapsed(){this.svgRoot&&(this.sourceBlock.isCollapsed()?this.svgRoot.style.display="none":this.svgRoot.style.display="block",Eo(this)&&this.setBubbleVisible(!1))}hideForInsertionMarker(){this.svgRoot&&(this.svgRoot.style.display="none")}isShownWhenCollapsed(){return!1}setOffsetInBlock(e){this.offsetInBlock=e,this.updateSvgRootOffset()}updateSvgRootOffset(){let e;(e=this.svgRoot)==null||e.setAttribute("transform",`translate(${this.offsetInBlock.x}, ${this.offsetInBlock.y})`)}onLocationChange(e){this.workspaceLocation=Ne.sum(e,this.offsetInBlock)}onClick(){}isClickableInFlyout(e){return!0}getFocusableElement(){const e=this.svgRoot;if(!e)throw Error("Attempting to focus uninitialized icon.");return e}getFocusableTree(){return this.sourceBlock.workspace}onNodeFocus(){var e=this.sourceBlock.getBoundingRectangle();e=new Nt(e.top+this.offsetInBlock.y,e.top+this.offsetInBlock.y+this.getSize().height,e.left+this.offsetInBlock.x,e.left+this.offsetInBlock.x+this.getSize().width),this.sourceBlock.workspace.scrollBoundsIntoView(e)}onNodeBlur(){}canBeFocused(){return!0}getSourceBlock(){return this.sourceBlock}},fc,ef;fc=17,ef=16,l.MutatorIcon$$module$build$src$core$icons$mutator_icon=class extends ra{constructor(e,t){super(t),this.flyoutBlockTypes=e,this.sourceBlock=t,this.saveConnectionsListener=this.updateWorkspacePid=this.rootBlock=this.miniWorkspaceBubble=null}getType(){return l.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE}initView(e){this.svgRoot||(super.initView(e),ae(le.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},this.svgRoot),ae(le.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},this.svgRoot),ae(le.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},this.svgRoot),We(this.svgRoot,"blocklyMutatorIcon"))}dispose(){super.dispose();let e;(e=this.miniWorkspaceBubble)==null||e.dispose()}getWeight(){return l.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT}getSize(){return new Mt(fc,fc)}applyColour(){super.applyColour();let e;(e=this.miniWorkspaceBubble)==null||e.setColour(this.sourceBlock.getColour());let t;(t=this.miniWorkspaceBubble)==null||t.updateBlockStyles()}updateCollapsed(){super.updateCollapsed(),this.sourceBlock.isCollapsed()&&this.setBubbleVisible(!1)}onLocationChange(e){super.onLocationChange(e);let t;(t=this.miniWorkspaceBubble)==null||t.setAnchorLocation(this.getAnchorLocation())}onClick(){super.onClick(),this.sourceBlock.isEditable()&&this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.miniWorkspaceBubble}setBubbleVisible(e){const t=this;return(0,ge.asyncExecutePromiseGeneratorFunction)(function*(){if(t.bubbleIsVisible()!==e){if(yield Ci(),e){t.miniWorkspaceBubble=new Fr(t.getMiniWorkspaceConfig(),t.sourceBlock.workspace,t.getAnchorLocation(),t.getBubbleOwnerRect()),t.applyColour(),t.createRootBlock(),t.addSaveConnectionsListener();let i;(i=t.miniWorkspaceBubble)==null||i.addWorkspaceChangeListener(t.createMiniWorkspaceChangeListener())}else{let i;(i=t.miniWorkspaceBubble)==null||i.dispose(),t.miniWorkspaceBubble=null,t.saveConnectionsListener&&t.sourceBlock.workspace.removeChangeListener(t.saveConnectionsListener),t.saveConnectionsListener=null}Be(new(Qe(ce.BUBBLE_OPEN))(t.sourceBlock,e,"mutator"))}})}getBubble(){return this.miniWorkspaceBubble}getMiniWorkspaceConfig(){let e;const t={disable:!1,media:this.sourceBlock.workspace.options.pathToMedia,rtl:this.sourceBlock.RTL,renderer:this.sourceBlock.workspace.options.renderer,rendererOverrides:(e=this.sourceBlock.workspace.options.rendererOverrides)!=null?e:void 0};return this.flyoutBlockTypes.length&&(t.toolbox={kind:"flyoutToolbox",contents:this.flyoutBlockTypes.map(i=>({kind:"block",type:i}))}),t}getAnchorLocation(){const e=fc/2;return Ne.sum(this.workspaceLocation,new Ne(e,e))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new Nt(e.y,e.y+e.height,e.x,e.x+e.width)}createRootBlock(){if(!this.sourceBlock.decompose)throw Error("Blocks with mutator icons must include a decompose method");this.rootBlock=this.sourceBlock.decompose(this.miniWorkspaceBubble.getWorkspace());for(var e of this.rootBlock.getDescendants(!1))e.queueRender();this.rootBlock.setMovable(!1),this.rootBlock.setDeletable(!1);let t,i,s,c;e=(c=(t=this.miniWorkspaceBubble)==null||(i=t.getWorkspace())==null||(s=i.getFlyout())==null?void 0:s.getWidth())!=null?c:0,this.rootBlock.moveBy(this.rootBlock.RTL?-(e+ef):ef,ef)}addSaveConnectionsListener(){this.sourceBlock.saveConnections&&this.rootBlock&&(this.saveConnectionsListener=()=>{this.sourceBlock.saveConnections&&this.rootBlock&&this.sourceBlock.saveConnections(this.rootBlock)},this.saveConnectionsListener(),this.sourceBlock.workspace.addChangeListener(this.saveConnectionsListener))}createMiniWorkspaceChangeListener(){return e=>{l.MutatorIcon$$module$build$src$core$icons$mutator_icon.isIgnorableMutatorEvent(e)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout(()=>{this.updateWorkspacePid=null,this.recomposeSourceBlock()},0))}}static isIgnorableMutatorEvent(e){return e.isUiEvent||Je(e)||Bt(e)&&e.element==="disabled"}recomposeSourceBlock(){if(this.rootBlock){if(!this.sourceBlock.compose)throw Error("Blocks with mutator icons must include a compose method");var e=l.getGroup$$module$build$src$core$events$utils();e||l.setGroup$$module$build$src$core$events$utils(!0);var t=eu.getExtraBlockState_(this.sourceBlock);this.sourceBlock.compose(this.rootBlock);var i=eu.getExtraBlockState_(this.sourceBlock);t!==i&&Be(new(Qe(ce.BLOCK_CHANGE))(this.sourceBlock,"mutation",null,t,i)),l.setGroup$$module$build$src$core$events$utils(e)}}getWorkspace(){let e;return(e=this.miniWorkspaceBubble)==null?void 0:e.getWorkspace()}},l.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE=jn.MUTATOR,l.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT=1,l.MutatorIcon$$module$build$src$core$icons$mutator_icon;var io=Object.create(null),pp={allExtensions:io};l.register$$module$build$src$core$extensions("parent_tooltip_when_inline",Pp);var ws={TEST_ONLY:pp};ws.apply=Gc,ws.buildTooltipForDropdown=l.buildTooltipForDropdown$$module$build$src$core$extensions,ws.buildTooltipWithFieldText=l.buildTooltipWithFieldText$$module$build$src$core$extensions,ws.isRegistered=wa,ws.register=l.register$$module$build$src$core$extensions,ws.registerMixin=l.registerMixin$$module$build$src$core$extensions,ws.registerMutator=l.registerMutator$$module$build$src$core$extensions,ws.runAfterPageLoad=Pu,ws.unregister=Pi;var pn;(function(e){e[e.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX",e[e.MAC_ENTER=3]="MAC_ENTER",e[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.NUM_CENTER=12]="NUM_CENTER",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESC=27]="ESC",e[e.SPACE=32]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT=37]="LEFT",e[e.UP=38]="UP",e[e.RIGHT=39]="RIGHT",e[e.DOWN=40]="DOWN",e[e.PLUS_SIGN=43]="PLUS_SIGN",e[e.PRINT_SCREEN=44]="PRINT_SCREEN",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.ZERO=48]="ZERO",e[e.ONE=49]="ONE",e[e.TWO=50]="TWO",e[e.THREE=51]="THREE",e[e.FOUR=52]="FOUR",e[e.FIVE=53]="FIVE",e[e.SIX=54]="SIX",e[e.SEVEN=55]="SEVEN",e[e.EIGHT=56]="EIGHT",e[e.NINE=57]="NINE",e[e.FF_SEMICOLON=59]="FF_SEMICOLON",e[e.FF_EQUALS=61]="FF_EQUALS",e[e.FF_DASH=173]="FF_DASH",e[e.FF_HASH=163]="FF_HASH",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.AT_SIGN=64]="AT_SIGN",e[e.A=65]="A",e[e.B=66]="B",e[e.C=67]="C",e[e.D=68]="D",e[e.E=69]="E",e[e.F=70]="F",e[e.G=71]="G",e[e.H=72]="H",e[e.I=73]="I",e[e.J=74]="J",e[e.K=75]="K",e[e.L=76]="L",e[e.M=77]="M",e[e.N=78]="N",e[e.O=79]="O",e[e.P=80]="P",e[e.Q=81]="Q",e[e.R=82]="R",e[e.S=83]="S",e[e.T=84]="T",e[e.U=85]="U",e[e.V=86]="V",e[e.W=87]="W",e[e.X=88]="X",e[e.Y=89]="Y",e[e.Z=90]="Z",e[e.META=91]="META",e[e.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT",e[e.CONTEXT_MENU=93]="CONTEXT_MENU",e[e.NUM_ZERO=96]="NUM_ZERO",e[e.NUM_ONE=97]="NUM_ONE",e[e.NUM_TWO=98]="NUM_TWO",e[e.NUM_THREE=99]="NUM_THREE",e[e.NUM_FOUR=100]="NUM_FOUR",e[e.NUM_FIVE=101]="NUM_FIVE",e[e.NUM_SIX=102]="NUM_SIX",e[e.NUM_SEVEN=103]="NUM_SEVEN",e[e.NUM_EIGHT=104]="NUM_EIGHT",e[e.NUM_NINE=105]="NUM_NINE",e[e.NUM_MULTIPLY=106]="NUM_MULTIPLY",e[e.NUM_PLUS=107]="NUM_PLUS",e[e.NUM_MINUS=109]="NUM_MINUS",e[e.NUM_PERIOD=110]="NUM_PERIOD",e[e.NUM_DIVISION=111]="NUM_DIVISION",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NUMLOCK=144]="NUMLOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY",e[e.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY",e[e.SEMICOLON=186]="SEMICOLON",e[e.DASH=189]="DASH",e[e.EQUALS=187]="EQUALS",e[e.COMMA=188]="COMMA",e[e.PERIOD=190]="PERIOD",e[e.SLASH=191]="SLASH",e[e.APOSTROPHE=192]="APOSTROPHE",e[e.TILDE=192]="TILDE",e[e.SINGLE_QUOTE=222]="SINGLE_QUOTE",e[e.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET",e[e.BACKSLASH=220]="BACKSLASH",e[e.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET",e[e.WIN_KEY=224]="WIN_KEY",e[e.MAC_FF_META=224]="MAC_FF_META",e[e.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT",e[e.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT",e[e.WIN_IME=229]="WIN_IME",e[e.VK_NONAME=252]="VK_NONAME",e[e.PHANTOM=255]="PHANTOM"})(pn||(pn={}));var Ur={};Ur.arc=kn,Ur.curve=Do,Ur.line=el,Ur.lineOnAxis=$t,Ur.lineTo=Rs,Ur.moveBy=yn,Ur.moveTo=Oi,Ur.point=pt;var On={};On.Coordinate=Ne,On.KeyCodes=pn,On.Rect=Nt,On.Size=Mt,On.Svg=le,On.aria=nc,On.array=qf,On.browserEvents=Ir,On.colour=jo,On.deprecation=Bd,On.dom=bi,On.extensions=ws,On.idGenerator=Ja,On.math=mh,On.object=Ar,On.parsing=ac,On.string=nn,On.style=kr,On.svgMath=Pn,On.svgPaths=Ur,On.toolbox=Ws,On.userAgent=Uf,On.xml=Uo;var Ro=class extends fn{constructor(e,t,i,s){super(e,t,i,void 0,s),this.workspace=e,this.anchor=t,this.ownerRect=i,this.owner=s,this.resizePointerMoveListener=this.resizePointerUpListener=null,this.sizeChangeListeners=[],this.locationChangeListeners=[],this.DEFAULT_SIZE=new Mt(160+fn.DOUBLE_BORDER,80+fn.DOUBLE_BORDER),this.MIN_SIZE=new Mt(45+fn.DOUBLE_BORDER,20+fn.DOUBLE_BORDER),this.editable=!0,We(this.svgRoot,"blocklyTextInputBubble"),this.editor=new qd(e,this.id,()=>{l.getFocusManager$$module$build$src$core$focus_manager().focusNode(this)}),this.contentContainer.appendChild(this.editor.getDom()),this.resizeGroup=this.createResizeHandle(this.svgRoot,e),this.setSize(this.DEFAULT_SIZE,!0)}getText(){return this.editor.getText()}setText(e){this.editor.setText(e)}setEditable(e){this.editable=e,this.editor.setEditable(e)}isEditable(){return this.editable}addTextChangeListener(e){this.editor.addTextChangeListener(e)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}addLocationChangeListener(e){this.locationChangeListeners.push(e)}createResizeHandle(e,t){return e=ae(le.IMAGE,{class:"blocklyResizeHandle",href:`${t.options.pathToMedia}resize-handle.svg`},e),_e(e,"pointerdown",this,this.onResizePointerDown),e}setSize(e,t=!1){e.width=Math.max(e.width,this.MIN_SIZE.width),e.height=Math.max(e.height,this.MIN_SIZE.height);const i=e.width-fn.DOUBLE_BORDER,s=e.height-fn.DOUBLE_BORDER;this.editor.updateSize(new Mt(i,s),new Mt(0,0)),this.editor.getDom().setAttribute("x",`${fn.DOUBLE_BORDER/2}`),this.editor.getDom().setAttribute("y",`${fn.DOUBLE_BORDER/2}`),this.resizeGroup.setAttribute("y",`${s}`),this.workspace.RTL?this.resizeGroup.setAttribute("x",`${-fn.DOUBLE_BORDER}`):this.resizeGroup.setAttribute("x",`${i}`),super.setSize(e,t),this.onSizeChange()}getSize(){return super.getSize()}moveDuringDrag(e){super.moveDuringDrag(e),this.onLocationChange()}setPositionRelativeToAnchor(e,t){super.setPositionRelativeToAnchor(e,t),this.onLocationChange()}positionByRect(e=new Nt(0,0,0,0)){super.positionByRect(e),this.onLocationChange()}onResizePointerDown(e){this.bringToFront(),De(e)||(vo(this.workspace,e,new Ne(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=_e(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=_e(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation()}onResizePointerUp(e){Oe(),this.resizePointerUpListener&&(Ae(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(Ae(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(e){e=yo(this.workspace,e),this.setSize(new Mt(this.workspace.RTL?-e.x:e.x,e.y),!1),this.onSizeChange()}onSizeChange(){for(const e of this.sizeChangeListeners)e()}onLocationChange(){for(const e of this.locationChangeListeners)e()}getEditor(){return this.editor}};qe(`
.blocklyTextInputBubble .blocklyTextarea {
  background-color: var(--commentFillColour);
  border: 0;
  box-sizing: border-box;
  display: block;
  outline: 0;
  padding: 5px;
  resize: none;
  width: 100%;
  height: 100%;
}
`);var lt;(function(e){e[e.INPUT_VALUE=1]="INPUT_VALUE",e[e.OUTPUT_VALUE=2]="OUTPUT_VALUE",e[e.NEXT_STATEMENT=3]="NEXT_STATEMENT",e[e.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT"})(lt||(lt={}));var $l=class{constructor(e){this.connectionChecker=e,this.connections=[]}addConnection(e,t){t=this.calculateIndexForYPos(t),this.connections.splice(t,0,e)}findIndexOfConnection(e,t){if(!this.connections.length)return-1;const i=this.calculateIndexForYPos(t);if(i>=this.connections.length)return-1;t=e.y;let s=i;for(;s>=0&&this.connections[s].y===t;){if(this.connections[s]===e)return s;s--}for(s=i;s<this.connections.length&&this.connections[s].y===t;){if(this.connections[s]===e)return s;s++}return-1}calculateIndexForYPos(e){if(!this.connections.length)return 0;let t=0,i=this.connections.length;for(;t<i;){const s=Math.floor((t+i)/2);if(this.connections[s].y<e)t=s+1;else if(this.connections[s].y>e)i=s;else{t=s;break}}return t}removeConnection(e,t){if(e=this.findIndexOfConnection(e,t),e===-1)throw Error("Unable to find connection in connectionDB.");this.connections.splice(e,1)}getNeighbours(e,t){function i(mt){const ci=c-s[mt].x,Un=m-s[mt].y;return Math.sqrt(ci*ci+Un*Un)<=t&&Se.push(s[mt]),Un<t}const s=this.connections,c=e.x,m=e.y;e=0;let I=s.length-2,B=I;for(;e<B;)s[B].y<m?e=B:I=B,B=Math.floor((e+I)/2);const Se=[];if(I=e=B,s.length){for(;e>=0&&i(e);)e--;do I++;while(I<s.length&&i(I))}return Se}isInYRange(e,t,i){return Math.abs(this.connections[e].y-t)<=i}searchForClosest(e,t,i){if(!this.connections.length)return{connection:null,radius:t};const s=e.y,c=e.x;e.x=c+i.x,e.y=s+i.y;var m=this.calculateIndexForYPos(e.y);i=null;let I=t,B,Se=m-1;for(;Se>=0&&this.isInYRange(Se,e.y,t);)B=this.connections[Se],this.connectionChecker.canConnect(e,B,!0,I)&&(i=B,I=B.distanceFrom(e)),Se--;for(;m<this.connections.length&&this.isInYRange(m,e.y,t);)B=this.connections[m],this.connectionChecker.canConnect(e,B,!0,I)&&(i=B,I=B.distanceFrom(e)),m++;return e.x=c,e.y=s,{connection:i,radius:I}}static init(e){const t=[];return t[lt.INPUT_VALUE]=new $l(e),t[lt.OUTPUT_VALUE]=new $l(e),t[lt.NEXT_STATEMENT]=new $l(e),t[lt.PREVIOUS_STATEMENT]=new $l(e),t}},Js=class extends tn{constructor(e,t,i){super(i),this.type=ce.SELECTED,this.oldElementId=e??void 0,this.newElementId=t??void 0}toJson(){const e=super.toJson();return e.oldElementId=this.oldElementId,e.newElementId=this.newElementId,e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new Js),t.oldElementId=e.oldElementId,t.newElementId=e.newElementId,t}};a(Re.EVENT,ce.SELECTED,Js);var gp=class extends Ql{constructor(e){if(super(e),this.type=ce.BLOCK_DELETE,e){if(e.getParent())throw Error("Connected blocks cannot be deleted.");e.isShadow()&&(this.recordUndo=!1),this.oldXml=is(e),this.ids=An(e),this.wasShadow=e.isShadow(),this.oldJson=Zi(e,{addCoordinates:!0})}}toJson(){const e=super.toJson();if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(this.wasShadow===void 0)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.oldXml=xn(this.oldXml),e.ids=this.ids,e.wasShadow=this.wasShadow,e.oldJson=this.oldJson,this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new gp),t.oldXml=l.textToDom$$module$build$src$core$utils$xml(e.oldXml),t.ids=e.ids,t.wasShadow=e.wasShadow||t.oldXml.tagName.toLowerCase()==="shadow",t.oldJson=e.oldJson,e.recordUndo!==void 0&&(t.recordUndo=e.recordUndo),t}run(e){const t=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(e)for(e=0;e<this.ids.length;e++){const i=this.ids[e],s=t.getBlockById(i);s?s.dispose(!1):i===this.blockId&&console.warn("Can't delete non-existent block: "+i)}else bo(this.oldJson,t)}};a(Re.EVENT,ce.BLOCK_DELETE,gp);var Jt=class{constructor(e,t){if(this.type=t,this.targetConnection=null,this.disposed=!1,this.shadowDom=this.check=null,this.y=this.x=0,this.shadowState=null,this.sourceBlock_=e,e.id.includes("_connection"))throw Error(`Connection ID indicator is contained in block ID. This will cause problems with focus: ${e.id}.`);this.id=`${e.id}_connection_${ht()}`}connect_(e){const t=lt.INPUT_VALUE,i=this.getSourceBlock();var s=e.getSourceBlock();e.isConnected()&&e.disconnectInternal(!1);let c;if(this.isConnected()){const I=this.stashShadowState(),B=this.targetBlock();B.isShadow()?B.dispose(!1):(this.disconnectInternal(),c=B),this.applyShadowState(I)}let m;Ze()&&(m=new(Qe(ce.BLOCK_MOVE))(s),m.setReason(["connect"])),zh(this,e),s.setParent(i),m&&(m.recordNew(),Be(m)),c&&(e=this.type===t?c.outputConnection:c.previousConnection)&&((s=Jt.getConnectionForOrphanedConnection(s,e))?e.connect(s):e.onFailedConnect(this))}dispose(){if(this.isConnected()){this.isSuperior()&&this.setShadowStateInternal();const e=this.targetBlock();e&&!e.isDeadOrDying()&&e.unplug()}this.disposed=!0}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===lt.INPUT_VALUE||this.type===lt.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(e){}connect(e){if(this.targetConnection===e)return!0;if(this.getConnectionChecker().canConnect(this,e,!1)){const t=l.getGroup$$module$build$src$core$events$utils();t||l.setGroup$$module$build$src$core$events$utils(!0),this.isSuperior()?this.connect_(e):e.connect_(this),l.setGroup$$module$build$src$core$events$utils(t)}return this.isConnected()}disconnect(){this.disconnectInternal()}disconnectInternal(e=!0){const{parentConnection:t,childConnection:i}=this.getParentAndChildConnections();if(!t||!i)throw Error("Source connection not connected.");const s=l.getGroup$$module$build$src$core$events$utils();s||l.setGroup$$module$build$src$core$events$utils(!0);let c;Ze()&&(c=new(Qe(ce.BLOCK_MOVE))(i.getSourceBlock()),c.setReason(["disconnect"]));const m=this.targetConnection;m&&(m.targetConnection=null),this.targetConnection=null,e&&i.getSourceBlock().setParent(null),c&&(c.recordNew(),Be(c)),i.getSourceBlock().isShadow()||t.respawnShadow_(),l.setGroup$$module$build$src$core$events$utils(s)}getParentAndChildConnections(){return this.targetConnection?this.isSuperior()?{parentConnection:this,childConnection:this.targetConnection}:{parentConnection:this.targetConnection,childConnection:this}:{}}respawnShadow_(){this.createShadowBlock(!0)}reconnect(e,t){if(this.getSourceBlock().isDeadOrDying())return!1;var i;return t=(i=e.getInput(t))==null?void 0:i.connection,i=this.targetBlock(),i&&i!==e||!t||t.targetConnection===this?!1:(t.isConnected()&&t.disconnect(),t.connect(this),!0)}targetBlock(){if(this.isConnected()){let e,t;return(t=(e=this.targetConnection)==null?void 0:e.getSourceBlock())!=null?t:null}return null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return e?(Array.isArray(e)||(e=[e]),this.check=e,this.onCheckChanged_()):this.check=null,this}getCheck(){return this.check}setShadowDom(e){this.setShadowStateInternal({shadowDom:e})}getShadowDom(e){return e&&this.targetBlock().isShadow()?mr(this.targetBlock()):this.shadowDom}setShadowState(e){this.setShadowStateInternal({shadowState:e})}getShadowState(e){return e&&this.targetBlock()&&this.targetBlock().isShadow()?Zi(this.targetBlock()):this.shadowState}neighbours(e){return[]}getParentInput(){let e=null;const t=this.sourceBlock_.inputList;for(let i=0;i<t.length;i++)if(t[i].connection===this){e=t[i];break}return e}toString(){const e=this.sourceBlock_;if(!e)return"Orphan Connection";if(e.outputConnection===this)var t="Output Connection of ";else if(e.previousConnection===this)t="Previous Connection of ";else if(e.nextConnection===this)t="Next Connection of ";else{t=null;for(let i=0,s;s=e.inputList[i];i++)if(s.connection===this){t=s;break}if(t)t='Input "'+t.name+'" connection on ';else return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection"}return t+e.toDevString()}stashShadowState(){const e=this.getShadowDom(!0),t=this.getShadowState(!0);return this.shadowState=this.shadowDom=null,{shadowDom:e,shadowState:t}}applyShadowState({shadowDom:e,shadowState:t}){this.shadowDom=e,this.shadowState=t}setShadowStateInternal({shadowDom:e=null,shadowState:t=null}={}){this.shadowDom=e,this.shadowState=t,this.getSourceBlock().isDeadOrDying()||((e=this.targetBlock())?e.isShadow()?(e.dispose(!1),this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())):(e=this.createShadowBlock(!1),this.serializeShadow(e),e&&e.dispose(!1)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())))}createShadowBlock(e){var t=this.getSourceBlock();const i=this.getShadowState(),s=this.getShadowDom();if(t.isDeadOrDying()||!i&&!s)return null;if(i)return t=ur(i,t.workspace,{parentConnection:e?this:void 0,isShadow:!0,recordUndo:!1});if(s){if(t=Zr(s,t.workspace),e)if(this.type===lt.INPUT_VALUE){if(!t.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(t.outputConnection))throw Error("Could not connect shadow block to connection")}else if(this.type===lt.NEXT_STATEMENT){if(!t.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(t.previousConnection))throw Error("Could not connect shadow block to connection")}else throw Error("Cannot connect a shadow block to a previous/output connection");return t}return null}serializeShadow(e){e&&(this.shadowDom=mr(e),this.shadowState=Zi(e))}static getConnectionForOrphanedConnection(e,t){if(t.type===lt.OUTPUT_VALUE)return zc(e,t.getSourceBlock());e=e.lastConnectionInStack(!0);const i=t.getConnectionChecker();return e&&i.canConnect(t,e,!1)?e:null}};Jt.CAN_CONNECT=0,Jt.REASON_SELF_CONNECTION=1,Jt.REASON_WRONG_TYPE=2,Jt.REASON_TARGET_NULL=3,Jt.REASON_CHECKS_FAILED=4,Jt.REASON_DIFFERENT_WORKSPACES=5,Jt.REASON_SHADOW_PARENT=6,Jt.REASON_DRAG_CHECKS_FAILED=7,Jt.REASON_PREVIOUS_AND_OUTPUT=8;var la=class extends Error{constructor(e){super(`Tried to append an icon of type ${e.getType()} when an icon of that type already exists on the block. Use getIcon to access the existing icon.`),this.icon=e}},$p={};$p.DuplicateIconType=la,(function(e){e[e.LEFT=-1]="LEFT",e[e.CENTRE=0]="CENTRE",e[e.RIGHT=1]="RIGHT"})(l.Align$$module$build$src$core$inputs$align||(l.Align$$module$build$src$core$inputs$align={})),l.Align$$module$build$src$core$inputs$align;var ua=class extends dn{constructor(e,t,i){super(dn.SKIP_SETUP),this.class=null,this.EDITABLE=!1,this.maxDisplayLength=1/0,e!==dn.SKIP_SETUP&&(i?this.configure_(i):this.class=t||null,this.setValue(e))}configure_(e){super.configure_(e),e.class&&(this.class=e.class)}initView(){this.createTextElement_(),this.class&&We(this.getTextElement(),this.class),this.fieldGroup_&&We(this.fieldGroup_,"blocklyLabelField")}doClassValidation_(e){return e==null?null:`${e}`}setClass(e){this.textElement_&&(this.class&&vt(this.textElement_,this.class),e&&We(this.textElement_,e)),this.class=e}static fromJson(e){return new this(Ge(e.text),void 0,e)}};Ss("field_label",ua),ua.prototype.DEFAULT_VALUE="";var tg=30,aa=[];aa[lt.INPUT_VALUE]=lt.OUTPUT_VALUE,aa[lt.OUTPUT_VALUE]=lt.INPUT_VALUE,aa[lt.NEXT_STATEMENT]=lt.PREVIOUS_STATEMENT,aa[lt.PREVIOUS_STATEMENT]=lt.NEXT_STATEMENT;var mp="RENAME_VARIABLE_ID",_p="DELETE_VARIABLE_ID",ng=10,Wi=class extends Jt{constructor(e,t){super(e,t),this.highlighted=!1,this.targetConnection=null,this.db=e.workspace.connectionDBList[t],this.dbOpposite=e.workspace.connectionDBList[aa[t]],this.offsetInBlock=new Ne(0,0),this.trackedState=Wi.TrackedState.WILL_TRACK}dispose(){super.dispose(),this.trackedState===Wi.TrackedState.TRACKED&&this.db.removeConnection(this,this.y);let e,t;(t=(e=this.sourceBlock_.pathObject).removeConnectionHighlight)==null||t.call(e,this)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(e){const t=this.x-e.x;return e=this.y-e.y,Math.sqrt(t*t+e*e)}bumpAwayFrom(e,t=!1){if(!this.sourceBlock_.workspace.isDragging()){var i=l.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*ng),s=l.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*ng),c=e.sourceBlock_.getRootBlock(),m=this.sourceBlock_.getRootBlock();if(!c.isInFlyout&&!m.isInFlyout){var I=!0;if(m.isMovable())c.isMovable()&&t&&(s=-s);else if(c.isMovable())I=!1,i=-i,s=-s;else return;t=I?e:this,e=I?this:e,c=I?m:c,c.RTL&&(i=-i),c.moveBy(t.x+i-e.x,t.y+s-e.y,["bump"])}}}moveTo(e,t){let i=!1;return this.trackedState===Wi.TrackedState.WILL_TRACK?(this.db.addConnection(this,t),this.trackedState=Wi.TrackedState.TRACKED,i=!0):this.trackedState===Wi.TrackedState.TRACKED&&(this.db.removeConnection(this,this.y),this.db.addConnection(this,t),i=!0),this.x=e,this.y=t,i}moveBy(e,t){return this.moveTo(this.x+e,this.y+t)}moveToOffset(e){return this.moveTo(e.x+this.offsetInBlock.x,e.y+this.offsetInBlock.y)}setOffsetInBlock(e,t){this.offsetInBlock.x=e,this.offsetInBlock.y=t}getOffsetInBlock(){return this.offsetInBlock}tightenEfficiently(){var e=this.targetConnection;const t=this.targetBlock();e&&t&&(e=Ne.difference(this.offsetInBlock,e.offsetInBlock),t.translate(e.x,e.y))}closest(e,t){return this.dbOpposite.searchForClosest(this,e,t)}highlight(){this.highlighted=!0;const e=this.findHighlightSvg();e&&(e.style.display="")}unhighlight(){this.highlighted=!1;const e=this.findHighlightSvg();e&&(e.style.display="none")}isHighlighted(){return this.highlighted}setTracking(e){e&&this.trackedState===Wi.TrackedState.TRACKED||!e&&this.trackedState===Wi.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(e?(this.db.addConnection(this,this.y),this.trackedState=Wi.TrackedState.TRACKED):(this.trackedState===Wi.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.trackedState=Wi.TrackedState.UNTRACKED))}stopTrackingAll(){if(this.setTracking(!1),this.targetConnection){const e=this.targetBlock().getDescendants(!1);for(let t=0;t<e.length;t++){const i=e[t],s=i.getConnections_(!0);for(let c=0;c<s.length;c++)s[c].setTracking(!1);for(const c of i.getIcons())Eo(c)&&c.setBubbleVisible(!1)}}}startTrackingAll(){this.setTracking(!0);let e=[];if(this.type!==lt.INPUT_VALUE&&this.type!==lt.NEXT_STATEMENT)return e;const t=this.targetBlock();if(t){let i;t.isCollapsed()?(i=[],t.outputConnection&&i.push(t.outputConnection),t.nextConnection&&i.push(t.nextConnection),t.previousConnection&&i.push(t.previousConnection)):i=t.getConnections_(!0);for(let s=0;s<i.length;s++)e.push(...i[s].startTrackingAll());e.length||(e=[t])}return e}onFailedConnect(e){const t=this.getSourceBlock();if(_t()){const i=l.getGroup$$module$build$src$core$events$utils();setTimeout((function(){t.isDisposed()||t.getParent()||(l.setGroup$$module$build$src$core$events$utils(i),this.bumpAwayFrom(e),l.setGroup$$module$build$src$core$events$utils(!1))}).bind(this),l.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal(e=!0){const{parentConnection:t,childConnection:i}=this.getParentAndChildConnections();if(t&&i){var s=l.getGroup$$module$build$src$core$events$utils();s||l.setGroup$$module$build$src$core$events$utils(!0);var c=t.getSourceBlock(),m=i.getSourceBlock();super.disconnectInternal(e),c.queueRender(),m.updateDisabled(),m.queueRender(),m.getSvgRoot().style.display="block",l.setGroup$$module$build$src$core$events$utils(s)}}respawnShadow_(){super.respawnShadow_();const e=this.targetBlock();e&&(e.initSvg(),e.queueRender())}neighbours(e){return this.dbOpposite.getNeighbours(this,e)}connect_(e){super.connect_(e);var t=this.getSourceBlock();e=e.getSourceBlock(),t.updateDisabled(),e.updateDisabled(),e.queueRender(),(t=t.getInputWithBlock(e))&&(t=t.isVisible(),e.getSvgRoot().style.display=t?"block":"none")}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return super.setCheck(e),this.sourceBlock_.queueRender(),this}showContextMenu(e){const t=Dt.registry.getContextMenuOptions({focusedNode:this},e);if(t.length){var i=this.getSourceBlock(),s=i.workspace;if(e instanceof PointerEvent)var c=new Ne(e.clientX,e.clientY);else c=new Ne(this.x,this.y),c=vl(s,c).translate(i.RTL?-5:5,5);Nu(e,t,i.RTL,s,c)}}getFocusableElement(){const e=this.findHighlightSvg();if(e)return e;throw Error("No highlight SVG found corresponding to this connection.")}getFocusableTree(){return this.getSourceBlock().workspace}onNodeFocus(){this.highlight(),this.getSourceBlock().workspace.scrollBoundsIntoView(this.getSourceBlock().getBoundingRectangleWithoutChildren())}onNodeBlur(){this.unhighlight()}canBeFocused(){return!0}findHighlightSvg(){return document.getElementById(this.id)}};(function(e){e=e.TrackedState||(e.TrackedState={}),e[e.WILL_TRACK=-1]="WILL_TRACK",e[e.UNTRACKED=0]="UNTRACKED",e[e.TRACKED=1]="TRACKED"})(Wi||(Wi={})),Wi.TrackedState;var ca=class{constructor(e,t){this.name=e,this.sourceBlock=t,this.fieldRow=[],this.align=l.Align$$module$build$src$core$inputs$align.LEFT,this.visible=!0,this.type=l.inputTypes$$module$build$src$core$inputs$input_types.CUSTOM,this.connection=null}getSourceBlock(){return this.sourceBlock}appendField(e,t){return this.insertFieldAt(this.fieldRow.length,e,t),this}insertFieldAt(e,t,i){if(e<0||e>this.fieldRow.length)throw Error("index "+e+" out of bounds.");return(t||t===""&&i)&&(typeof t=="string"&&(t=l.fromJson$$module$build$src$core$field_registry({type:"field_label",text:t})),t.setSourceBlock(this.sourceBlock),this.sourceBlock.initialized&&this.initField(t),t.name=i,t.setVisible(this.isVisible()),t.prefixField&&(e=this.insertFieldAt(e,t.prefixField)),this.fieldRow.splice(e,0,t),e++,t.suffixField&&(e=this.insertFieldAt(e,t.suffixField)),this.sourceBlock.rendered&&this.sourceBlock.queueRender()),e}removeField(e,t){for(let i=0,s;s=this.fieldRow[i];i++)if(s.name===e)return s.dispose(),this.fieldRow.splice(i,1),this.sourceBlock.rendered&&this.sourceBlock.queueRender(),!0;if(t)return!1;throw Error('Field "'+e+'" not found.')}isVisible(){return this.visible}setVisible(e){let t=[];if(this.visible===e)return t;this.visible=e;for(let i=0,s;s=this.fieldRow[i];i++)s.setVisible(e);if(this.connection&&this.connection instanceof Wi){e?t=this.connection.startTrackingAll():this.connection.stopTrackingAll();const i=this.connection.targetBlock();i&&(i.getSvgRoot().style.display=e?"block":"none")}return t}markDirty(){for(let e=0,t;t=this.fieldRow[e];e++)t.markDirty()}setCheck(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(e),this}setAlign(e){return this.align=e,this.sourceBlock.rendered&&this.sourceBlock.queueRender(),this}setShadowDom(e){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(e),this}getShadowDom(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()}init(){for(const e of this.fieldRow)e.init()}initModel(){for(const e of this.fieldRow)e.initModel()}initField(e){this.sourceBlock.rendered?e.init():e.initModel()}dispose(){for(let e=0,t;t=this.fieldRow[e];e++)t.dispose();this.connection&&this.connection.dispose()}makeConnection(e){return this.sourceBlock.makeConnection_(e)}},Io=class extends ca{constructor(e,t){super(e,t),this.name=e,this.type=l.inputTypes$$module$build$src$core$inputs$input_types.DUMMY}},cs=class extends ca{constructor(e,t){super(e,t),this.name=e,this.type=l.inputTypes$$module$build$src$core$inputs$input_types.END_ROW}},Yo=class extends ca{constructor(e,t){if(!e)throw Error("Statement inputs must have a non-empty name");super(e,t),this.name=e,this.type=l.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT,this.connection=this.makeConnection(lt.NEXT_STATEMENT)}},ig;l.ValueInput$$module$build$src$core$inputs$value_input=class extends ca{constructor(e,t){if(!e)throw Error("Value inputs must have a non-empty name");super(e,t),this.name=e,this.type=l.inputTypes$$module$build$src$core$inputs$input_types.VALUE,this.connection=this.makeConnection(lt.INPUT_VALUE)}},ig={},ig.ValueInput=l.ValueInput$$module$build$src$core$inputs$value_input;var Zs=class{constructor(e,t,i){if(this.data=null,this.disposed=!1,this.hue=null,this.colour_="#000000",this.styleName_="",this.suppressPrefixSuffix=!1,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.icons=[],this.disabledReasons=new Set,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable=this.movable=this.deletable=!0,this.collapsed_=this.shadow=!1,this.outputShape_=null,this.rendered=this.isInsertionMarker_=this.initialized=this.disposing=!1,this.onchangeWrapper=this.helpUrl=null,this.statementInputCount=0,this.workspace=e,this.id=i&&!e.getBlockById(i)?i:ot(),e.setBlockById(this.id,this),this.xy=new Ne(0,0),this.isInFlyout=e.isFlyout,this.isInMutator=e.isMutator,this.RTL=e.RTL,t){if(this.type=t,i=Vn[t],!i||typeof i!="object")throw TypeError("Invalid block definition for type: "+t);Object.assign(this,i)}e.addTopBlock(this),e.addTypedBlock(this),new.target===Zs&&this.doInit_()}doInit_(){const e=l.getGroup$$module$build$src$core$events$utils();e||l.setGroup$$module$build$src$core$events$utils(!0);const t=_t();try{typeof this.init=="function"&&(l.setRecordUndo$$module$build$src$core$events$utils(!1),this.init(),l.setRecordUndo$$module$build$src$core$events$utils(t)),Ze()&&Be(new(Qe(ce.BLOCK_CREATE))(this))}finally{l.setGroup$$module$build$src$core$events$utils(e),l.setRecordUndo$$module$build$src$core$events$utils(t)}this.inputsInlineDefault=this.inputsInline,typeof this.onchange=="function"&&this.setOnChange(this.onchange)}dispose(e=!1){this.disposing=!0,this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.unplug(e),Ze()&&Be(new(Qe(ce.BLOCK_DELETE))(this)),this.workspace.removeTopBlock(this),this.disposeInternal()}disposeInternal(){this.disposing=!0,this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),typeof this.destroy=="function"&&this.destroy(),this.childBlocks_.forEach(e=>e.disposeInternal()),this.inputList.forEach(e=>e.dispose()),this.inputList.length=0,this.getConnections_(!0).forEach(e=>e.dispose()),this.disposed=!0}isDeadOrDying(){return this.disposing||this.disposed}initModel(){if(!this.initialized){for(const e of this.inputList)e.initModel();this.initialized=!0}}unplug(e){this.outputConnection&&this.unplugFromRow(e),this.previousConnection&&this.unplugFromStack(e)}unplugFromRow(e){let t=null,i;(i=this.outputConnection)!=null&&i.isConnected()&&(t=this.outputConnection.targetConnection,this.outputConnection.disconnect()),t&&e&&(e=this.getOnlyValueConnection())&&e.isConnected()&&!e.targetBlock().isShadow()&&(e=e.targetConnection,e?.disconnect(),this.workspace.connectionChecker.canConnect(e,t,!1)?t.connect(e):e?.onFailedConnect(t))}getOnlyValueConnection(){let e=null;for(let t=0;t<this.inputList.length;t++){const i=this.inputList[t].connection;if(i&&i.type===lt.INPUT_VALUE&&i.targetConnection){if(e)return null;e=i}}return e}unplugFromStack(e){let t=null,i;if((i=this.previousConnection)!=null&&i.isConnected()&&(t=this.previousConnection.targetConnection,this.previousConnection.disconnect()),e){for(e=this.getNextBlock();e&&(e.isShadow()||!e.isMovable());)e=e.getNextBlock();if(e){var s,c,m,I;e=(I=(s=e.previousConnection)==null||(c=s.targetBlock())==null||(m=c.nextConnection)==null?void 0:m.targetConnection)!=null?I:null,e?.disconnect(),t&&this.workspace.connectionChecker.canConnect(t,e,!1)&&t.connect(e)}}}getConnections_(e){e=[],this.outputConnection&&e.push(this.outputConnection),this.previousConnection&&e.push(this.previousConnection),this.nextConnection&&e.push(this.nextConnection);for(let t=0,i;i=this.inputList[t];t++)i.connection&&e.push(i.connection);return e}lastConnectionInStack(e){let t=this.nextConnection;for(;t;){const i=t.targetBlock();if(!i||e&&i.isShadow())return t;t=i.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(e){for(let t=0,i;i=this.inputList[t];t++)if(i.connection&&i.connection.targetBlock()===e)return i;return null}getSurroundParent(){let e=this,t;do if(t=e,e=e.getParent(),!e)return null;while(e.getNextBlock()===t);return e}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getRootBlock(){let e,t=this;do e=t,t=e.parentBlock_;while(t);return e}getTopStackBlock(){let e=this,t;do t=e.getPreviousBlock();while(t&&t.getNextBlock()===e&&(e=t));return e}getChildren(e){if(!e)return this.childBlocks_;e=[];for(let i=0,s;s=this.inputList[i];i++)if(s.connection){var t=s.connection.targetBlock();t&&e.push(t)}return(t=this.getNextBlock())&&e.push(t),e}setParent(e){if(e!==this.parentBlock_){var t=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),i=!!t;if(i&&e&&t!==e)throw Error("Block connected to superior one that is not new parent.");if(!i&&e)throw Error("Block not connected to new parent.");if(i&&!e)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?Te(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=e)?e.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(e){const t=[this],i=this.getChildren(e);for(let s,c=0;s=i[c];c++)t.push(...s.getDescendants(e));return t}isDeletable(){return this.deletable&&!this.isInFlyout&&!this.shadow&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnDeletable(){return this.deletable}setDeletable(e){this.deletable=e}isMovable(){return this.movable&&!this.isInFlyout&&!this.shadow&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnMovable(){return this.movable}setMovable(e){this.movable=e}isDuplicatable(){return this.workspace.hasBlockLimits()?this.workspace.isCapacityAvailable($i(this,!0)):!0}isShadow(){return this.shadow}setShadow(e){this.shadow=e}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(e){this.isInsertionMarker_=e}isEditable(){return this.editable&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnEditable(){return this.editable}setEditable(e){this.editable=e;for(const t of this.getFields())t.updateEditable()}isDisposed(){return this.disposed}isSimpleReporter(){if(!this.outputConnection)return!1;for(const e of this.inputList)if(e.connection||e.fieldRow.length>1)return!1;return!0}getMatchingConnection(e,t){const i=this.getConnections_(!0);if(e=e.getConnections_(!0),i.length!==e.length)throw Error("Connection lists did not match in length.");for(let s=0;s<e.length;s++)if(e[s]===t)return i[s];return null}setHelpUrl(e){this.helpUrl=e}setTooltip(e){this.tooltip=e}getTooltip(){return fi(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue}setColour(e){e=Ct(e),this.hue=e.hue,this.colour_=e.hex}setStyle(e){this.styleName_=e}setOnChange(e){if(e&&typeof e!="function")throw Error("onchange must be a function.");this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.onchange=e,this.onchangeWrapper=e.bind(this),this.workspace.addChangeListener(this.onchangeWrapper)}getField(e){if(typeof e!="string")throw TypeError("Block.prototype.getField expects a string with the field name but received "+(e===void 0?"nothing":e+" of type "+typeof e)+" instead");for(const t of this.getFields())if(t.name===e)return t;return null}*getFields(){for(const e of this.inputList)for(const t of e.fieldRow)yield t}getVars(){const e=[];for(const t of this.getFields())t.referencesVariables()&&e.push(t.getValue());return e}getVarModels(){const e=[];for(const t of this.getFields())if(t.referencesVariables()){const i=this.workspace.getVariableById(t.getValue());i&&e.push(i)}return e}updateVarName(e){for(const t of this.getFields())t.referencesVariables()&&e.getId()===t.getValue()&&t.refreshVariableName()}renameVarById(e,t){for(const i of this.getFields())i.referencesVariables()&&e===i.getValue()&&i.setValue(t)}getFieldValue(e){return(e=this.getField(e))?e.getValue():null}setFieldValue(e,t){const i=this.getField(t);if(!i)throw Error('Field "'+t+'" not found.');i.setValue(e)}setPreviousStatement(e,t){if(e)t===void 0&&(t=null),this.previousConnection||(this.previousConnection=this.makeConnection_(lt.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(t);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}}setNextStatement(e,t){if(e)t===void 0&&(t=null),this.nextConnection||(this.nextConnection=this.makeConnection_(lt.NEXT_STATEMENT)),this.nextConnection.setCheck(t);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}}setOutput(e,t){if(e)t===void 0&&(t=null),this.outputConnection||(this.outputConnection=this.makeConnection_(lt.OUTPUT_VALUE)),this.outputConnection.setCheck(t);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}}setInputsInline(e){this.inputsInline!==e&&(Be(new(Qe(ce.BLOCK_CHANGE))(this,"inline",null,this.inputsInline,e)),this.inputsInline=e)}getInputsInline(){if(this.inputsInline!==void 0)return this.inputsInline;for(var e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof Io&&this.inputList[e]instanceof Io)return!1;for(e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof l.ValueInput$$module$build$src$core$inputs$value_input&&this.inputList[e]instanceof Io)return!0;for(e=0;e<this.inputList.length;e++)if(this.inputList[e]instanceof cs)return!0;return!1}setOutputShape(e){this.outputShape_=e}getOutputShape(){return this.outputShape_}isEnabled(){return this.disabledReasons.size===0}setDisabledReason(e,t){e||this.workspace.options.disable||!this.hasDisabledReason(wt)||t==wt||this.setDisabledReason(!1,wt),this.disabledReasons.has(t)!==e&&(e?this.disabledReasons.add(t):this.disabledReasons.delete(t),e=new(Qe(ce.BLOCK_CHANGE))(this,"disabled",null,!e,e),e.setDisabledReason(t),Be(e))}getInheritedDisabled(){let e=this.getSurroundParent();for(;e;){if(!e.isEnabled())return!0;e=e.getSurroundParent()}return!1}hasDisabledReason(e){return this.disabledReasons.has(e)}getDisabledReasons(){return this.disabledReasons}isCollapsed(){return this.collapsed_}setCollapsed(e){this.collapsed_!==e&&(Be(new(Qe(ce.BLOCK_CHANGE))(this,"collapsed",null,this.collapsed_,e)),this.collapsed_=e)}toString(e,t){t=this.toTokens(t);for(let s=2;s<t.length;s++)t[s-2]==="("&&t[s]===")"&&(t[s-2]=t[s-1],t.splice(s-1,2));let i="";return t=t.reduce((s,c)=>(s=s+(i==="("||c===")"?"":" ")+c,i=c[c.length-1],s),""),t=t.trim()||"???",e&&t.length>e&&(t=t.substring(0,e-3)+"..."),t}toTokens(e="?"){const t=[];for(const s of this.inputList)if(s.name!=hn){for(const c of s.fieldRow)t.push(c.getText());if(s.connection){const c=s.connection.targetBlock();if(c){var i=s.connection;let m=i.getCheck();!m&&i.targetConnection&&(m=i.targetConnection.getCheck()),(i=!!m&&(m.includes("Boolean")||m.includes("Number")))&&t.push("("),t.push(...c.toTokens(e)),i&&t.push(")")}else t.push(e)}}return t}appendValueInput(e){return this.appendInput(new l.ValueInput$$module$build$src$core$inputs$value_input(e,this))}appendStatementInput(e){return this.statementInputCount++,this.appendInput(new Yo(e,this))}appendDummyInput(e=""){return this.appendInput(new Io(e,this))}appendEndRowInput(e=""){return this.appendInput(new cs(e,this))}appendInput(e){return this.inputList.push(e),e}appendInputFromRegistry(e,t){return(e=N(Re.INPUT,e,!1))?this.appendInput(new e(t,this)):null}jsonInit(e){var t=e.type?'Block "'+e.type+'": ':"";if(e.output&&e.previousStatement)throw Error(t+"Must not have both an output and a previousStatement.");for(var i=0;e["args"+i];){if(e["message"+i]===void 0)throw Error(t+`args${i} must have a corresponding message (message${i}).`);i++}if(e.style&&e.style.hat&&(this.hat=e.style.hat,e.style=null),e.style&&e.colour)throw Error(t+"Must not have both a colour and a style.");for(e.style?this.jsonInitStyle(e,t):this.jsonInitColour(e,t),i=0;e["message"+i]!==void 0;)this.interpolate(e["message"+i],e["args"+i]||[],e["implicitAlign"+i]||e["lastDummyAlign"+i],t),i++;if(e.inputsInline!==void 0&&(l.disable$$module$build$src$core$events$utils(),this.setInputsInline(e.inputsInline),l.enable$$module$build$src$core$events$utils()),e.output!==void 0&&this.setOutput(!0,e.output),e.outputShape!==void 0&&this.setOutputShape(e.outputShape),e.previousStatement!==void 0&&this.setPreviousStatement(!0,e.previousStatement),e.nextStatement!==void 0&&this.setNextStatement(!0,e.nextStatement),e.tooltip!==void 0&&(i=Ge(e.tooltip),this.setTooltip(i)),e.enableContextMenu!==void 0&&(this.contextMenu=!!e.enableContextMenu),e.suppressPrefixSuffix!==void 0&&(this.suppressPrefixSuffix=!!e.suppressPrefixSuffix),e.helpUrl!==void 0&&(i=Ge(e.helpUrl),this.setHelpUrl(i)),typeof e.extensions=="string"&&(console.warn(t+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+e.type+"' block."),e.extensions=[e.extensions]),e.mutator!==void 0&&Gc(e.mutator,this,!0),e=e.extensions,Array.isArray(e))for(t=0;t<e.length;t++)Gc(e[t],this,!1)}jsonInitColour(e,t){if("colour"in e)if(e.colour===void 0)console.warn(t+"Undefined colour value.");else{e=e.colour;try{this.setColour(e)}catch{console.warn(t+"Illegal colour value: ",e)}}}jsonInitStyle(e,t){e=e.style;try{this.setStyle(e)}catch{console.warn(t+"Style does not exist: ",e)}}mixin(e,t){if(t!==void 0&&typeof t!="boolean")throw Error("opt_disableCheck must be a boolean if provided");if(!t){t=[];for(const i in e)this[i]!==void 0&&t.push(i);if(t.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(t))}Object.assign(this,e)}interpolate(e,t,i,s){e=Ue(e),this.validateTokens(e,t.length),t=this.interpolateArguments(e,t,i),i=[];for(let c=0,m;m=t[c];c++)if(this.isInputKeyword(m.type)){if(e=this.inputFromJson(m,s)){for(let I=0,B;B=i[I];I++)e.appendField(B[0],B[1]);i.length=0}}else(e=this.fieldFromJson(m))&&i.push([e,m.name])}validateTokens(e,t){const i=[];let s=0;for(let c=0;c<e.length;c++){const m=e[c];if(typeof m=="number"){if(m<1||m>t)throw Error('Block "'+this.type+'": Message index %'+m+" out of range.");if(i[m])throw Error('Block "'+this.type+'": Message index %'+m+" duplicated.");i[m]=!0,s++}}if(s!==t)throw Error('Block "'+this.type+'": Message does not reference all '+t+" arg(s).")}interpolateArguments(e,t,i){const s=[];for(let m=0;m<e.length;m++){var c=e[m];if(typeof c=="number"&&(c=t[c-1]),typeof c=="string"){if(c===`
`)c={type:"input_end_row"},i&&(c.align=i);else if(c=this.stringToFieldJson(c),!c)continue}s.push(c)}return(e=s.length)&&!this.isInputKeyword(s[e-1].type)&&(e={type:"input_dummy"},i&&(e.align=i),s.push(e)),s}fieldFromJson(e){const t=l.fromJson$$module$build$src$core$field_registry(e);return!t&&e.alt?typeof e.alt=="string"?(e=this.stringToFieldJson(e.alt))?this.fieldFromJson(e):null:this.fieldFromJson(e.alt):t}inputFromJson(e,t){var i={LEFT:l.Align$$module$build$src$core$inputs$align.LEFT,RIGHT:l.Align$$module$build$src$core$inputs$align.RIGHT,CENTRE:l.Align$$module$build$src$core$inputs$align.CENTRE,CENTER:l.Align$$module$build$src$core$inputs$align.CENTRE};let s;switch(e.type){case"input_value":s=this.appendValueInput(e.name);break;case"input_statement":s=this.appendStatementInput(e.name);break;case"input_dummy":s=this.appendDummyInput(e.name);break;case"input_end_row":s=this.appendEndRowInput(e.name);break;default:s=this.appendInputFromRegistry(e.type,e.name)}return s?(e.check&&s.setCheck(e.check),e.align&&(i=i[e.align.toUpperCase()],i===void 0?console.warn(t+"Illegal align value: ",e.align):s.setAlign(i)),s):null}isInputKeyword(e){return e==="input_value"||e==="input_statement"||e==="input_dummy"||e==="input_end_row"||A(Re.INPUT,e)}stringToFieldJson(e){return(e=e.trim())?{type:"field_label",text:e}:null}moveInputBefore(e,t){if(e!==t){var i=-1,s=t?-1:this.inputList.length;for(let c=0,m;m=this.inputList[c];c++)if(m.name===e){if(i=c,s!==-1)break}else if(t&&m.name===t&&(s=c,i!==-1))break;if(i===-1)throw Error('Named input "'+e+'" not found.');if(s===-1)throw Error('Reference input "'+t+'" not found.');this.moveNumberedInputBefore(i,s)}}moveNumberedInputBefore(e,t){if(e===t)throw Error("Can't move input to itself.");if(e>=this.inputList.length)throw RangeError("Input index "+e+" out of bounds.");if(t>this.inputList.length)throw RangeError("Reference input "+t+" out of bounds.");const i=this.inputList[e];this.inputList.splice(e,1),e<t&&t--,this.inputList.splice(t,0,i)}removeInput(e,t){for(let i=0,s;s=this.inputList[i];i++)if(s.name===e)return s instanceof Yo&&this.statementInputCount--,s.dispose(),this.inputList.splice(i,1),!0;if(t)return!1;throw Error("Input not found: "+e)}getInput(e){for(let t=0,i;i=this.inputList[t];t++)if(i.name===e)return i;return null}getInputTargetBlock(e){return(e=this.getInput(e))&&e.connection&&e.connection.targetBlock()}getCommentText(){let e,t;return(t=(e=this.getIcon(jn.COMMENT))==null?void 0:e.getText())!=null?t:null}setCommentText(e){var t;let i;const s=(i=(t=this.getIcon(jn.COMMENT))==null?void 0:t.getText())!=null?i:null;if(s!==e){if(e!==null){if(t=this.getIcon(jn.COMMENT),!t){if(t=N(Re.ICON,jn.COMMENT.toString(),!1),!t)throw Error("No comment icon class is registered, so a comment cannot be set");if(t=new t(this),!bf(t))throw Error("The class registered as a comment icon does not conform to the ICommentIcon interface");t=this.addIcon(t)}l.disable$$module$build$src$core$events$utils(),t.setText(e),l.enable$$module$build$src$core$events$utils()}else this.removeIcon(jn.COMMENT);Be(new(Qe(ce.BLOCK_CHANGE))(this,"comment",null,s,e))}}setWarningText(e,t){}setMutator(e){}addIcon(e){if(this.hasIcon(e.getType()))throw new la(e);return this.icons.push(e),this.icons.sort((t,i)=>t.getWeight()-i.getWeight()),e}removeIcon(e){if(!this.hasIcon(e))return!1;let t;return(t=this.getIcon(e))==null||t.dispose(),this.icons=this.icons.filter(i=>!i.getType().equals(e)),!0}hasIcon(e){return this.icons.some(t=>t.getType().equals(e))}getIcon(e){return e instanceof jn?this.icons.find(t=>t.getType().equals(e)):this.icons.find(t=>t.getType().toString()===e)}getIcons(){return[...this.icons]}getRelativeToSurfaceXY(){return this.xy}moveBy(e,t,i){if(this.parentBlock_)throw Error("Block has parent");const s=new(Qe(ce.BLOCK_MOVE))(this);i&&s.setReason(i),this.xy.translate(e,t),s.recordNew(),Be(s)}makeConnection_(e){return new Jt(this,e)}allInputsFilled(e){if(e===void 0&&(e=!0),!e&&this.isShadow())return!1;for(let i=0,s;s=this.inputList[i];i++)if(s.connection){var t=s.connection.targetBlock();if(!t||!t.allInputsFilled(e))return!1}return(t=this.getNextBlock())?t.allInputsFilled(e):!0}toDevString(){let e=this.type?'"'+this.type+'" block':"Block";return this.id&&(e+=' (id="'+this.id+'")'),e}};Zs.COLLAPSED_INPUT_NAME=hn,Zs.COLLAPSED_FIELD_NAME=Gt;var uu=null,pc=null,au={};au.connectionUiEffect=jh,au.disconnectUiEffect=Xh,au.disconnectUiStop=vr,au.disposeUiEffect=Tr;var ha=class{paste(e,t,i){if(!t.isCapacityAvailable(e.typeCounts))return null;i&&(e.blockState.x=i.x,e.blockState.y=i.y),i=i||new Ne(e.blockState.x||0,e.blockState.y||0),l.disable$$module$build$src$core$events$utils();let s;try{s=bo(e.blockState,t),Wc(s,i)}finally{l.enable$$module$build$src$core$events$utils()}if(!s)return s;Ze()&&!s.isShadow()&&Be(new(Qe(ce.BLOCK_CREATE))(s));const c=s;return Ci().then(()=>l.getFocusManager$$module$build$src$core$focus_manager().focusNode(c)),s}};ha.TYPE="block",mi(ha.TYPE,new ha);var gc={};gc.bumpIntoBounds=Uu,gc.bumpIntoBoundsHandler=nl,gc.bumpTopObjectsIntoBounds=Gs;var Oh=class{constructor(e){this.block=e,this.connectionPreviewer=this.connectionCandidate=this.startLoc=this.startChildConn=this.startParentConn=null,this.dragging=!1,this.dragOffset=new Ne(0,0),this.originalEventGroup="",this.workspace=e.workspace}isMovable(){if(this.block.isShadow()){let e,t;return(t=(e=this.block.getParent())==null?void 0:e.isMovable())!=null?t:!1}return this.block.isOwnMovable()&&!this.block.isDeadOrDying()&&!this.workspace.isReadOnly()&&!this.block.isInFlyout}startDrag(e){if(this.block.isShadow())this.startDraggingShadow(e);else{this.dragging=!0,this.fireDragStartEvent(),this.startLoc=this.block.getRelativeToSurfaceXY(),this.connectionCandidate=null,this.connectionPreviewer=new(D(Re.CONNECTION_PREVIEWER,this.workspace.options))(this.block),Ln(),this.workspace.setResizesEnabled(!1),vr(),e=this.shouldHealStack(e),this.shouldDisconnect(e)&&this.disconnectBlock(e),this.block.setDragging(!0);var t;(t=this.workspace.getLayerManager())==null||t.moveToDragLayer(this.block)}}shouldHealStack(e){return!!e&&(e.altKey||e.ctrlKey||e.metaKey)}startDraggingShadow(e){const t=this.block.getParent();if(!t)throw Error("Tried to drag a shadow block with no parent. Shadow blocks should always have parents.");this.dragOffset=Ne.difference(t.getRelativeToSurfaceXY(),this.block.getRelativeToSurfaceXY()),t.startDrag(e)}shouldDisconnect(e){return!!(this.block.getParent()||e&&this.block.nextConnection&&this.block.nextConnection.targetBlock())}disconnectBlock(e){let t,i,s;if(this.startParentConn=(s=(t=this.block.outputConnection)==null?void 0:t.targetConnection)!=null?s:(i=this.block.previousConnection)==null?void 0:i.targetConnection,e){let c;this.startChildConn=(c=this.block.nextConnection)==null?void 0:c.targetConnection}this.block.unplug(e),Xh(this.block)}fireDragStartEvent(){const e=new(Qe(ce.BLOCK_DRAG))(this.block,!0,this.block.getDescendants(!1));Be(e)}fireDragEndEvent(){const e=new(Qe(ce.BLOCK_DRAG))(this.block,!1,this.block.getDescendants(!1));Be(e)}fireMoveEvent(){if(!this.block.isDeadOrDying()){var e=new(Qe(ce.BLOCK_MOVE))(this.block);e.setReason(["drag"]),e.oldCoordinate=this.startLoc,e.recordNew(),Be(e)}}drag(e){if(this.block.isShadow()){let t;(t=this.block.getParent())==null||t.drag(Ne.sum(e,this.dragOffset))}else this.block.moveDuringDrag(e),this.updateConnectionPreview(this.block,Ne.difference(e,this.startLoc))}updateConnectionPreview(e,t){var i=this.connectionCandidate;const s=this.getConnectionCandidate(e,t);if(s){this.connectionCandidate=t=i&&this.currCandidateIsBetter(i,t,s)?i:s;var{local:c,neighbour:m}=t;t=c.type===lt.OUTPUT_VALUE||c.type===lt.PREVIOUS_STATEMENT;var I;if(i=m.isConnected()&&!((I=m.targetBlock())!=null&&I.isInsertionMarker()),t&&i&&!this.orphanCanConnectAtEnd(e,m.targetBlock(),c.type)){let Se;(Se=this.connectionPreviewer)==null||Se.previewReplacement(c,m,m.targetBlock())}else{var B;(B=this.connectionPreviewer)==null||B.previewConnection(c,m)}}else{let Se;(Se=this.connectionPreviewer)==null||Se.hidePreview(),this.connectionCandidate=null}}orphanCanConnectAtEnd(e,t,i){return!!Jt.getConnectionForOrphanedConnection(e,i===lt.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}currCandidateIsBetter(e,t,i){const{local:s,neighbour:c}=e;e=new Ne(s.x,s.y);const m=new Ne(c.x,c.y);return t=Ne.distance(Ne.sum(e,t),m),i.distance>t-l.config$$module$build$src$core$config.currentConnectionPreference}getConnectionCandidate(e,t){e=this.getLocalConnections(e);let i=this.getSearchRadius(),s=null;for(const c of e){const{connection:m,radius:I}=c.closest(i,t);m&&(s={local:c,neighbour:m,distance:I},i=I)}return s}getSearchRadius(){return this.connectionCandidate?l.config$$module$build$src$core$config.connectingSnapRadius:l.config$$module$build$src$core$config.snapRadius}getLocalConnections(e){const t=e.getConnections_(!1),i=e.lastConnectionInStack(!0);return i&&i!==e.nextConnection&&t.push(i),t}endDrag(e){if(this.block.isShadow()){let i;(i=this.block.getParent())==null||i.endDrag(e)}else{this.originalEventGroup=l.getGroup$$module$build$src$core$events$utils(),this.fireDragEndEvent(),this.fireMoveEvent(),_n(),vr();var t;if((t=this.connectionPreviewer)==null||t.hidePreview(),!this.block.isDeadOrDying()&&this.dragging){let i;(i=this.workspace.getLayerManager())==null||i.moveOffDragLayer(this.block,ru),this.block.setDragging(!1)}this.connectionCandidate?(this.applyConnections(this.connectionCandidate),this.disposeStep()):this.block.queueRender().then(()=>this.disposeStep())}}disposeStep(){const e=l.getGroup$$module$build$src$core$events$utils();l.setGroup$$module$build$src$core$events$utils(this.originalEventGroup),this.block.snapToGrid();let t;(t=this.connectionPreviewer)==null||t.dispose(),this.workspace.setResizesEnabled(!0),l.setGroup$$module$build$src$core$events$utils(e)}applyConnections(e){const{local:t,neighbour:i}=e;t.connect(i);const s=t.isSuperior()?i:t,c=this.block.getRootBlock();Ci().then(()=>{jh(s.getSourceBlock()),setTimeout(()=>{c.bringToFront()},0)})}revertDrag(){if(this.block.isShadow()){let i;(i=this.block.getParent())==null||i.revertDrag()}else{var e;(e=this.connectionPreviewer)==null||e.hidePreview(),this.connectionCandidate=null;var t;if((t=this.startChildConn)==null||t.connect(this.block.nextConnection),this.startParentConn)switch(this.startParentConn.type){case lt.INPUT_VALUE:this.startParentConn.connect(this.block.outputConnection);break;case lt.NEXT_STATEMENT:this.startParentConn.connect(this.block.previousConnection)}else{this.block.moveTo(this.startLoc,["drag"]);let i;(i=this.workspace.getLayerManager())==null||i.moveOffDragLayer(this.block,ru),Uu(this.workspace,this.workspace.getMetricsManager().getScrollMetrics(!0),this.block)}this.startParentConn=this.startChildConn=null,this.block.setDragging(!1),this.dragging=!1}}},bp=class extends fn{constructor(e,t,i,s){super(t,i,s),this.text=e,this.workspace=t,this.anchor=i,this.ownerRect=s,this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize(),We(this.svgRoot,"blocklyTextBubble")}getText(){return this.text}setText(e){this.text=e,Wt(this.paragraph),this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize()}stringToSvg(e,t){return t=this.createParagraph(t),e=this.createTextFragments(t,e),this.workspace.RTL&&this.rightAlignTextFragments(t.getBBox().width,e),t}createParagraph(e){return ae(le.G,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",transform:`translate(0,${fn.BORDER_WIDTH})`,style:`direction: ${this.workspace.RTL?"rtl":"ltr"}`},e)}createTextFragments(e,t){let i=1;return t.split(`
`).map(s=>{const c=ae(le.TEXT,{y:`${i}em`,x:fn.BORDER_WIDTH},e);return s=document.createTextNode(s),c.appendChild(s),i+=1,c})}rightAlignTextFragments(e,t){for(const i of t)i.setAttribute("text-anchor","start"),i.setAttribute("x",`${e+fn.BORDER_WIDTH}`)}updateBubbleSize(){const e=this.paragraph.getBBox();this.setSize(new Mt(e.width+fn.BORDER_WIDTH*2,e.height+fn.BORDER_WIDTH*2),!0)}},tf=17,Hr=class extends ra{constructor(e){super(e),this.sourceBlock=e,this.textMap=new Map,this.textBubble=null}getType(){return Hr.TYPE}initView(e){this.svgRoot||(super.initView(e),ae(le.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},this.svgRoot),ae(le.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},this.svgRoot),ae(le.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},this.svgRoot),We(this.svgRoot,"blocklyWarningIcon"))}dispose(){super.dispose();let e;(e=this.textBubble)==null||e.dispose()}getWeight(){return Hr.WEIGHT}getSize(){return new Mt(tf,tf)}applyColour(){super.applyColour();let e;(e=this.textBubble)==null||e.setColour(this.sourceBlock.getColour())}updateCollapsed(){}isShownWhenCollapsed(){return!0}onLocationChange(e){super.onLocationChange(e);let t;(t=this.textBubble)==null||t.setAnchorLocation(this.getAnchorLocation())}addMessage(e,t){if(this.textMap.get(t)===e)return this;e?this.textMap.set(t,e):this.textMap.delete(t);let i;return(i=this.textBubble)==null||i.setText(this.getText()),this}getText(){return[...this.textMap.values()].join(`
`)}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.textBubble}setBubbleVisible(e){const t=this;return(0,ge.asyncExecutePromiseGeneratorFunction)(function*(){if(t.bubbleIsVisible()!==e){if(yield Ci(),e)t.textBubble=new bp(t.getText(),t.sourceBlock.workspace,t.getAnchorLocation(),t.getBubbleOwnerRect()),t.applyColour();else{let i;(i=t.textBubble)==null||i.dispose(),t.textBubble=null}Be(new(Qe(ce.BUBBLE_OPEN))(t.sourceBlock,e,"warning"))}})}getBubble(){return this.textBubble}getAnchorLocation(){const e=tf/2;return Ne.sum(this.workspaceLocation,new Ne(e,e))}getBubbleOwnerRect(){const e=this.sourceBlock.getSvgRoot().getBBox();return new Nt(e.y,e.y+e.height,e.x,e.x+e.width)}};Hr.TYPE=jn.WARNING,Hr.WEIGHT=2;var Rn=class extends Zs{constructor(e,t,i){if(super(e,t,i),this.childlessWidth=this.width=this.height=0,this.warningTextDb=new Map,this.mutator=null,this.rendered=!0,this.visuallyDisabled=!1,this.translation="",this.dragging=!1,this.relativeCoords=new Ne(0,0),this.dragStrategy=new Oh(this),!e.rendered)throw TypeError("Cannot create a rendered block in a headless workspace");this.workspace=e,this.svgGroup=ae(le.G,{}),t&&We(this.svgGroup,t),this.style=e.getRenderer().getConstants().getBlockStyle(null),this.pathObject=e.getRenderer().makePathObject(this.svgGroup,this.style),e=this.pathObject.svgPath,e.tooltip=this,b(e),this.svgGroup.setAttribute("data-id",this.id),e.id=ht(),this.doInit_()}initSvg(){if(!this.initialized){for(var e of this.inputList)e.init();for(const t of this.getIcons())t.initView(this.createIconPointerDownListener(t)),t.updateEditable();this.applyColour(),this.pathObject.updateMovable(this.isMovable()||this.isInFlyout),(e=this.getSvgRoot())&&_e(e,"pointerdown",this,this.onMouseDown),e.parentNode||this.workspace.getCanvas().appendChild(e),this.initialized=!0}}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){this.addSelect(),Fe(this)}unselect(){this.removeSelect(),Fe(null)}setParent(e){var t=this.parentBlock_;if(e!==t){Ln(),super.setParent(e),_n();var i=this.getSvgRoot();if(!this.workspace.isClearing&&i){var s=this.getRelativeToSurfaceXY(),c=l.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode(),m,I=this.getSvgRoot().contains((m=c?.getFocusableElement())!=null?m:null);e?(e.getSvgRoot().appendChild(i),I&&c&&l.getFocusManager$$module$build$src$core$focus_manager().focusNode(c)):t&&(e=this.workspace.getCanvas().querySelector(".blocklyDragging"),t=e?.parentElement,m=this.workspace.getCanvas(),t===m?m.insertBefore(i,e):(m.appendChild(i),I&&c&&l.getFocusManager$$module$build$src$core$focus_manager().focusNode(c)),this.translate(s.x,s.y)),this.applyColour()}}}getRelativeToSurfaceXY(){const e=this.workspace.getLayerManager();if(!e)throw Error("Cannot calculate position because the workspace has not been appended");let t=0,i=0,s=this.getSvgRoot();if(s)do{const c=Li(s);t+=c.x,i+=c.y,s=s.parentNode}while(s&&!e.hasLayer(s));return new Ne(t,i)}moveBy(e,t,i){if(this.parentBlock_)throw Error("Block has parent");const s=Ze();let c=null;s&&(c=new(Qe(ce.BLOCK_MOVE))(this),i&&c.setReason(i)),e=new Ne(e,t),t=this.getRelativeToSurfaceXY(),e=Ne.sum(t,e),this.translate(e.x,e.y),this.updateComponentLocations(e),s&&c&&(c.recordNew(),Be(c)),this.workspace.resizeContents()}translate(e,t){this.translation=`translate(${e}, ${t})`,this.relativeCoords=new Ne(e,t),this.getSvgRoot().setAttribute("transform",this.getTranslation())}getTranslation(){return this.translation}moveTo(e,t){const i=this.getRelativeToSurfaceXY();this.moveBy(e.x-i.x,e.y-i.y,t)}moveDuringDrag(e){this.translate(e.x,e.y),this.getSvgRoot().setAttribute("transform",this.getTranslation()),this.updateComponentLocations(e)}snapToGrid(){if(!this.isDeadOrDying()&&!this.getParent()&&!this.isInFlyout){var e=this.workspace.getGrid();if(e!=null&&e.shouldSnap()){var t=this.getRelativeToSurfaceXY();e=e.alignXY(t),e!==t&&this.moveTo(e,["snap"])}}}getBoundingRectangle(){return this.getBoundingRectangleWithDimensions(this.getHeightWidth())}getBoundingRectangleWithoutChildren(){return this.getBoundingRectangleWithDimensions({height:this.height,width:this.childlessWidth})}getBoundingRectangleWithDimensions(e){const t=this.getRelativeToSurfaceXY();let i,s;return this.RTL?(i=t.x-e.width,s=t.x):(i=t.x,s=t.x+e.width),new Nt(t.y,t.y+e.height,i,s)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let e=0,t;t=this.inputList[e];e++)t.markDirty()}setCollapsed(e){this.collapsed_!==e&&(super.setCollapsed(e),this.updateCollapsed())}childHasWarning(){const e=this.getChildren(!1);for(const t of e)if(t.getIcon(Hr.TYPE)||t.childHasWarning())return!0;return!1}updateCollapsed(){var e=this.isCollapsed();const t=hn,i=Gt;for(let c=0,m;m=this.inputList[c];c++)m.name!==t&&m.setVisible(!e);for(var s of this.getIcons())s.updateCollapsed();e?(We(this.svgGroup,"blocklyCollapsed"),this.childHasWarning()&&this.setWarningText(l.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,Rn.COLLAPSED_WARNING_ID),e=this.toString(tg),(s=this.getField(i))?s.setValue(e):(this.getInput(t)||this.appendDummyInput(t)).appendField(new ua(e),i)):(this.updateDisabled(),this.removeInput(t),vt(this.svgGroup,"blocklyCollapsed"),this.setWarningText(null,Rn.COLLAPSED_WARNING_ID))}onMouseDown(e){if(!this.workspace.isReadOnly()){var t=this.workspace.getGesture(e);t&&t.handleBlockStart(e,this)}}showHelp(){const e=typeof this.helpUrl=="function"?this.helpUrl():this.helpUrl;e&&window.open(e)}generateContextMenu(e){return this.workspace.isReadOnly()||!this.contextMenu?null:(e=Dt.registry.getContextMenuOptions({block:this,focusedNode:this},e),this.customContextMenu&&this.customContextMenu(e),e)}calculateContextMenuLocation(e){if(e instanceof PointerEvent)return new Ne(e.clientX,e.clientY);e=vl(this.workspace,this.getRelativeToSurfaceXY());let t,i;const s=(t=this.inputList.filter(c=>c.isVisible()).flatMap(c=>c.fieldRow).find(c=>c.isVisible()))==null||(i=t.getSvgRoot())==null?void 0:i.getBoundingClientRect();return new Ne(this.RTL?e.x-5:e.x+5,(s&&s.height?s.y+s.height:e.y+this.height)+5)}showContextMenu(e){const t=this.generateContextMenu(e),i=this.calculateContextMenuLocation(e);t&&t.length&&(Nu(e,t,this.RTL,this.workspace,i),Fc(this))}updateComponentLocations(e){this.dragging||this.updateConnectionLocations(e),this.updateIconLocations(e),this.updateFieldLocations(e);for(const t of this.getChildren(!1))t.updateComponentLocations(Ne.sum(e,t.relativeCoords))}updateConnectionLocations(e){for(const t of this.getConnections_(!1))t.moveToOffset(e)}updateIconLocations(e){for(const t of this.getIcons())t.onLocationChange(e)}updateFieldLocations(e){for(const t of this.inputList)for(const i of t.fieldRow)i.onLocationChange(e)}addClass(e){We(this.svgGroup,e)}removeClass(e){vt(this.svgGroup,e)}setDragging(e){(this.dragging=e)?(this.translation="",Xu.push(...this.getConnections_(!0)),this.addClass("blocklyDragging")):(Xu.length=0,this.removeClass("blocklyDragging"));for(let t=0;t<this.childBlocks_.length;t++)this.childBlocks_[t].setDragging(e)}setMovable(e){super.setMovable(e),this.pathObject.updateMovable(e)}setEditable(e){super.setEditable(e),e?vt(this.svgGroup,"blocklyNotEditable"):We(this.svgGroup,"blocklyNotEditable"),e=this.getIcons();for(let t=0;t<e.length;t++)e[t].updateEditable()}setShadow(e){super.setShadow(e),this.applyColour()}setInsertionMarker(e){this.isInsertionMarker_!==e&&(this.isInsertionMarker_=e)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))}getSvgRoot(){return this.svgGroup}dispose(e,t){this.disposing=!0,U(),$r();const i=l.getFocusManager$$module$build$src$core$focus_manager();var s,c;if(this.getSvgRoot().contains((c=(s=i.getFocusedNode())==null?void 0:s.getFocusableElement())!=null?c:null)){if(s=this.getParent(),!s){let m;if(c=(m=this.outputConnection)!=null?m:this.previousConnection){let I;s=(I=c.closest(0,new Ne(0,0)).connection)==null?void 0:I.getSourceBlock()}}s?i.focusNode(s):setTimeout(()=>i.focusTree(this.workspace),0)}t&&(this.unplug(e),Tr(this)),super.dispose(!!e),Wt(this.svgGroup)}disposeInternal(){this.disposing=!0,super.disposeInternal(),l.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()===this&&this.workspace.cancelCurrentGesture(),[...this.warningTextDb.values()].forEach(e=>clearTimeout(e)),this.warningTextDb.clear(),this.getIcons().forEach(e=>e.dispose())}checkAndDelete(){this.workspace.isFlyout||(l.setGroup$$module$build$src$core$events$utils(!0),this.workspace.hideChaff(),this.outputConnection?this.dispose(!1,!0):this.dispose(!0,!0),l.setGroup$$module$build$src$core$events$utils(!1))}toCopyData(e=!1){return this.isInsertionMarker_?null:{paster:ha.TYPE,blockState:Zi(this,{addCoordinates:!0,addNextBlocks:e,saveIds:!1}),typeCounts:$i(this,!0)}}applyColour(){var e,t;for((t=(e=this.pathObject).applyColour)==null||t.call(e,this),e=this.getIcons(),t=0;t<e.length;t++)e[t].applyColour();for(const i of this.getFields())i.applyColour()}updateDisabled(){const e=!this.isEnabled()||this.getInheritedDisabled();if(this.visuallyDisabled===e){let t;(t=this.getNextBlock())==null||t.updateDisabled()}else{this.applyColour(),this.visuallyDisabled=e;for(const t of this.getChildren(!1))t.updateDisabled()}}setWarningText(e,t=""){if(t)this.warningTextDb.has(t)&&(clearTimeout(this.warningTextDb.get(t)),this.warningTextDb.delete(t));else{for(var i of this.warningTextDb.values())clearTimeout(i);this.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(t,setTimeout(()=>{this.isDeadOrDying()||(this.warningTextDb.delete(t),this.setWarningText(e,t))},100));else if(this.isInFlyout&&(e=null),i=this.getIcon(Hr.TYPE),e){let s=this.getSurroundParent(),c=null;for(;s;)s.isCollapsed()&&(c=s),s=s.getSurroundParent();c&&c.setWarningText(l.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,Rn.COLLAPSED_WARNING_ID),i?i.addMessage(e,t):this.addIcon(new Hr(this).addMessage(e,t))}else i&&(t?(i.addMessage("",t),i.getText()||this.removeIcon(Hr.TYPE)):this.removeIcon(Hr.TYPE))}setMutator(e){this.removeIcon(l.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE),e&&this.addIcon(e)}addIcon(e){return super.addIcon(e),e instanceof l.MutatorIcon$$module$build$src$core$icons$mutator_icon&&(this.mutator=e),e.initView(this.createIconPointerDownListener(e)),e.applyColour(),e.updateEditable(),this.queueRender(),e}createIconPointerDownListener(e){return t=>{this.isDeadOrDying()||(t=this.workspace.getGesture(t))&&t.setStartIcon(e)}}removeIcon(e){const t=super.removeIcon(e);return e.equals(l.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE)&&(this.mutator=null),this.queueRender(),t}setDisabledReason(e,t){const i=this.isEnabled();super.setDisabledReason(e,t),this.isEnabled()===i||this.getInheritedDisabled()||this.updateDisabled()}setDeletable(e){super.setDeletable(e),e?vt(this.svgGroup,"blocklyNotDeletable"):We(this.svgGroup,"blocklyNotDeletable")}setHighlighted(e){this.pathObject.updateHighlighted(e)}addSelect(){this.pathObject.updateSelected(!0)}removeSelect(){this.pathObject.updateSelected(!1)}setDeleteStyle(e){this.pathObject.updateDraggingDelete(e)}getColour(){return this.style.colourPrimary}setColour(e){super.setColour(e),e=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_);let t,i;(i=(t=this.pathObject).setStyle)==null||i.call(t,e.style),this.style=e.style,this.styleName_=e.name,this.applyColour()}setStyle(e){const t=this.workspace.getRenderer().getConstants().getBlockStyle(e);if(this.styleName_&&vt(this.svgGroup,this.styleName_),t){this.hat=t.hat;let i,s;(s=(i=this.pathObject).setStyle)==null||s.call(i,t),this.colour_=t.colourPrimary,this.style=t,this.applyColour(),We(this.svgGroup,e),this.styleName_=e}else throw Error("Invalid style name: "+e)}getStyle(){return this.style}bringToFront(e=!1){const t=l.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode();let i=this;if(!i.isDeadOrDying()){do{const s=i.getSvgRoot(),c=s.parentNode,m=c.childNodes;if(m[m.length-1]!==s&&c.appendChild(s),e)break;i=i.getParent()}while(i);t&&l.getFocusManager$$module$build$src$core$focus_manager().focusNode(t)}}setPreviousStatement(e,t){super.setPreviousStatement(e,t),this.queueRender()}setNextStatement(e,t){super.setNextStatement(e,t),this.queueRender()}setOutput(e,t){super.setOutput(e,t),this.queueRender()}setInputsInline(e){super.setInputsInline(e),this.queueRender()}removeInput(e,t){return e=super.removeInput(e,t),this.queueRender(),e}moveNumberedInputBefore(e,t){super.moveNumberedInputBefore(e,t),this.queueRender()}appendInput(e){return super.appendInput(e),this.queueRender(),e}setConnectionTracking(e){if(this.previousConnection&&this.previousConnection.setTracking(e),this.outputConnection&&this.outputConnection.setTracking(e),this.nextConnection){this.nextConnection.setTracking(e);var t=this.nextConnection.targetBlock();t&&t.setConnectionTracking(e)}if(!this.collapsed_)for(t=0;t<this.inputList.length;t++){var i=this.inputList[t].connection;i&&(i.setTracking(e),(i=i.targetBlock())&&i.setConnectionTracking(e))}}getConnections_(e){const t=[];if(this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection),e||!this.collapsed_)for(let i=0,s;s=this.inputList[i];i++)s.connection&&t.push(s.connection);return t}lastConnectionInStack(e){return super.lastConnectionInStack(e)}getMatchingConnection(e,t){return super.getMatchingConnection(e,t)}makeConnection_(e){return new Wi(this,e)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){const e=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||e.isInFlyout))for(const t of this.getConnections_(!1)){if(t.isSuperior()){let i;(i=t.targetBlock())==null||i.bumpNeighbours()}for(const i of t.neighbours(l.config$$module$build$src$core$config.snapRadius))i.getSourceBlock().getRootBlock()!==e&&(t.isConnected()&&i.isConnected()||(t.isSuperior()?i.bumpAwayFrom(t,!1):t.bumpAwayFrom(i,!0)))}}scheduleSnapAndBump(){this.snapToGrid(),this.bumpNeighbours()}positionNearConnection(e,t,i){if(e.type===lt.NEXT_STATEMENT||e.type===lt.INPUT_VALUE){let s=t.x;t=t.y,s+=i.x-e.getOffsetInBlock().x,t+=i.y-e.getOffsetInBlock().y,this.moveBy(s,t)}}getChildren(e){return super.getChildren(e)}queueRender(){return _i(this)}render(){this.queueRender(),Zo()}renderEfficiently(){Ln(),this.isCollapsed()&&this.updateCollapsed(),this.isEnabled()||this.updateDisabled(),this.workspace.getRenderer().render(this),this.tightenChildrenEfficiently(),_n()}tightenChildrenEfficiently(){for(const e of this.inputList){const t=e.connection;t&&t.tightenEfficiently()}this.nextConnection&&this.nextConnection.tightenEfficiently()}getHeightWidth(){let e=this.height,t=this.width;var i=this.getNextBlock();if(i){i=i.getHeightWidth();const s=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;e+=i.height-s,t=Math.max(t,i.width)}return{height:e,width:t}}fadeForReplacement(e){this.pathObject.updateReplacementFade(e)}highlightShapeForInput(e,t){this.pathObject.updateShapeForInputHighlight(e,t)}getDragStrategy(){return this.dragStrategy}setDragStrategy(e){this.dragStrategy=e}isCopyable(){return this.isOwnDeletable()&&this.isOwnMovable()}isMovable(){return this.dragStrategy.isMovable()}startDrag(e){this.dragStrategy.startDrag(e)}drag(e,t){this.dragStrategy.drag(e,t)}endDrag(e){this.dragStrategy.endDrag(e)}revertDrag(){this.dragStrategy.revertDrag()}toFlyoutInfo(){const e=Object.assign({},{kind:"BLOCK"},Zi(this)),t=new Set(["id","height","width","pinned","enabled"]),i=function(s){for(const c in s)t.has(c)?delete s[c]:typeof s[c]=="object"&&i(s[c])};return i(e),[e]}jsonInit(e){super.jsonInit(e),e.classes&&this.addClass(Array.isArray(e.classes)?e.classes.join(" "):e.classes)}getFocusableElement(){return this.pathObject.svgPath}getFocusableTree(){return this.workspace}onNodeFocus(){this.select(),this.workspace.scrollBoundsIntoView(this.getBoundingRectangleWithoutChildren())}onNodeBlur(){this.unselect()}canBeFocused(){return!0}};Rn.INLINE=-1,Rn.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_";var og=class{constructor(){}onDragEnter(e){}onDragOver(e){}onDragExit(e){}onDrop(e){}getClientRect(){return null}shouldPreventMove(e){return!1}},$c=class extends og{constructor(){super(),this.wouldDelete_=!1}wouldDelete(e){return e instanceof Rn?(e=!e.getParent()&&e.isDeletable(),this.updateWouldDelete_(e)):this.updateWouldDelete_(xo(e)&&e.isDeletable()),this.wouldDelete_}updateWouldDelete_(e){this.wouldDelete_=e}},mc=class{constructor(e,t){this.element=e,this.type=t}getElement(){return this.element}getType(){return this.type}},_c=class{constructor(e){this.workspace_=e}getDimensionsPx_(e){let t=0,i=0;return e&&(t=e.getWidth(),i=e.getHeight()),new Mt(t,i)}getFlyoutMetrics(e){return e=this.getDimensionsPx_(this.workspace_.getFlyout(e)),{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){const e=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){let e=0,t=0;const i=this.getToolboxMetrics(),s=this.getFlyoutMetrics(),c=!!this.workspace_.getToolbox();var m;const I=!((m=this.workspace_.getFlyout())!=null&&m.autoClose);m=c?i.position:s.position;const B=m===Lt.TOP;return m===Lt.LEFT&&(c&&(e+=i.width),I&&(e+=s.width)),B&&(c&&(t+=i.height),I&&(t+=s.height)),{top:t,left:e}}getViewMetrics(e){e=e?this.workspace_.scale:1;const t=this.getSvgMetrics(),i=this.getToolboxMetrics(),s=this.getFlyoutMetrics(),c=!!this.workspace_.getToolbox();var m;const I=!((m=this.workspace_.getFlyout())!=null&&m.autoClose);m=c?i.position:s.position;const B=m===Lt.LEFT||m===Lt.RIGHT;return(m===Lt.TOP||m===Lt.BOTTOM)&&(c&&(t.height-=i.height),I&&(t.height-=s.height)),B&&(c&&(t.width-=i.width),I&&(t.width-=s.width)),{height:t.height/e,width:t.width/e,top:-this.workspace_.scrollY/e,left:-this.workspace_.scrollX/e}}getContentMetrics(e){e=e?1:this.workspace_.scale;const t=this.workspace_.getBlocksBoundingBox();return{height:(t.bottom-t.top)*e,width:(t.right-t.left)*e,top:t.top*e,left:t.left*e}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(e){if(!this.hasFixedEdges())return{};const t=this.workspace_.isMovableHorizontally(),i=this.workspace_.isMovableVertically();e=e||this.getViewMetrics(!1);const s={};return i||(s.top=e.top,s.bottom=e.top+e.height),t||(s.left=e.left,s.right=e.left+e.width),s}getPaddedContent_(e,t){const i=t.top+t.height,s=t.left+t.width,c=e.width;e=e.height;const m=c/2,I=e/2;return{top:Math.min(t.top-I,i-e),bottom:Math.max(i+I,t.top+e),left:Math.min(t.left-m,s-c),right:Math.max(s+m,t.left+c)}}getScrollMetrics(e,t,i){e=e?this.workspace_.scale:1,t=t||this.getViewMetrics(!1);var s=i||this.getContentMetrics();i=this.getComputedFixedEdges_(t),t=this.getPaddedContent_(t,s),s=i.top!==void 0?i.top:t.top;const c=i.left!==void 0?i.left:t.left;return{top:s/e,left:c/e,width:((i.right!==void 0?i.right:t.right)-c)/e,height:((i.bottom!==void 0?i.bottom:t.bottom)-s)/e}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){const e=this.getToolboxMetrics(),t=this.getFlyoutMetrics(!0),i=this.getSvgMetrics(),s=this.getAbsoluteMetrics(),c=this.getViewMetrics(),m=this.getContentMetrics(),I=this.getScrollMetrics(!1,c,m);return{contentHeight:m.height,contentWidth:m.width,contentTop:m.top,contentLeft:m.left,scrollHeight:I.height,scrollWidth:I.width,scrollTop:I.top,scrollLeft:I.left,viewHeight:c.height,viewWidth:c.width,viewTop:c.top,viewLeft:c.left,absoluteTop:s.top,absoluteLeft:s.left,svgHeight:i.height,svgWidth:i.width,toolboxWidth:e.width,toolboxHeight:e.height,toolboxPosition:e.position,flyoutWidth:t.width,flyoutHeight:t.height}}};a(Re.METRICS_MANAGER,Po,_c);var Ah=class extends _c{constructor(e,t){super(e),this.flyout_=t}getBoundingBox(){let e;try{e=this.workspace_.getCanvas().getBBox()}catch{e={height:0,y:0,width:0,x:0}}return e}getContentMetrics(e){const t=this.getBoundingBox();return e=e?1:this.workspace_.scale,{height:t.height*e,width:t.width*e,top:t.y*e,left:t.x*e}}getScrollMetrics(e,t,i){return t=i||this.getContentMetrics(),i=this.flyout_.MARGIN*this.workspace_.scale,e=e?this.workspace_.scale:1,{height:(t.height+2*i)/e,width:(t.width+t.left+i)/e,top:0,left:0}}},ji=class{constructor(e,t,i,s){this.workspace=e,this.targetWorkspace=t,this.isFlyoutLabel=s,this.height=this.width=0,this.cursorSvg=this.svgText=null,this.text=i.text,this.position=new Ne(0,0),this.callbackKey=i.callbackKey||i.callbackkey,this.cssClass=i["web-class"]||null,this.info=i,e=this.isFlyoutLabel?"blocklyFlyoutLabel":"blocklyFlyoutButton",this.cssClass&&(e+=" "+this.cssClass),this.id=ht(),this.svgGroup=ae(le.G,{id:this.id,class:e},this.workspace.getCanvas());let c;this.isFlyoutLabel||(c=ae(le.RECT,{class:"blocklyFlyoutButtonShadow",rx:ji.BORDER_RADIUS,ry:ji.BORDER_RADIUS,x:1,y:1},this.svgGroup)),e=ae(le.RECT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:ji.BORDER_RADIUS,ry:ji.BORDER_RADIUS},this.svgGroup),t=ae(le.TEXT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup),i=Ge(this.text),this.workspace.RTL&&(i+="‏"),t.textContent=i,this.isFlyoutLabel&&(this.svgText=t,this.workspace.getThemeManager().subscribe(this.svgText,"flyoutForegroundColour","fill")),s=St(t,"fontSize");const m=St(t,"fontWeight"),I=St(t,"fontFamily");if(this.width=In(t,s,m,I),i=X(i,s,m,I),this.height=this.height||i.height,!this.isFlyoutLabel){this.width+=2*ji.TEXT_MARGIN_X,this.height+=2*ji.TEXT_MARGIN_Y;let B;(B=c)==null||B.setAttribute("width",String(this.width));let Se;(Se=c)==null||Se.setAttribute("height",String(this.height))}e.setAttribute("width",String(this.width)),e.setAttribute("height",String(this.height)),t.setAttribute("x",String(this.width/2)),t.setAttribute("y",String(this.height/2-i.height/2+i.baseline)),this.updateTransform(),this.onMouseDownWrapper=_e(this.svgGroup,"pointerdown",this,this.onMouseDown),this.onMouseUpWrapper=_e(this.svgGroup,"pointerup",this,this.onMouseUp)}createDom(){return this.svgGroup}show(){this.updateTransform(),this.svgGroup.setAttribute("display","block")}updateTransform(){this.svgGroup.setAttribute("transform","translate("+this.position.x+","+this.position.y+")")}moveTo(e,t){this.position.x=e,this.position.y=t,this.updateTransform()}moveBy(e,t,i){this.moveTo(this.position.x+e,this.position.y+t)}isLabel(){return this.isFlyoutLabel}getPosition(){return this.position}getBoundingRectangle(){return new Nt(this.position.y,this.position.y+this.height,this.position.x,this.position.x+this.width)}getButtonText(){return this.text}getTargetWorkspace(){return this.targetWorkspace}getWorkspace(){return this.workspace}dispose(){Ae(this.onMouseDownWrapper),Ae(this.onMouseUpWrapper),this.svgGroup&&Wt(this.svgGroup),this.svgText&&this.workspace.getThemeManager().unsubscribe(this.svgText)}setCursorSvg(e){e?this.svgGroup&&(this.svgGroup.appendChild(e),this.cursorSvg=e):this.cursorSvg=null}onMouseUp(e){(e=this.targetWorkspace.getGesture(e))&&e.cancel(),this.isFlyoutLabel&&this.callbackKey?console.warn("Labels should not have callbacks. Label text: "+this.text):this.isFlyoutLabel||this.callbackKey&&this.targetWorkspace.getButtonCallback(this.callbackKey)?this.isFlyoutLabel||(e=this.targetWorkspace.getButtonCallback(this.callbackKey))&&e(this):console.warn("Buttons should have callbacks. Button text: "+this.text)}onMouseDown(e){const t=this.targetWorkspace.getGesture(e),i=this.targetWorkspace.getFlyout();t&&i&&t.handleFlyoutStart(e,i)}getSvgRoot(){return this.svgGroup}getFocusableElement(){return this.svgGroup}getFocusableTree(){return this.workspace}onNodeFocus(){var e=this.getPosition();e=new Nt(e.y,e.y+this.height,e.x,e.x+this.width),this.workspace.scrollBoundsIntoView(e)}onNodeBlur(){}canBeFocused(){return!0}};ji.TEXT_MARGIN_X=5,ji.TEXT_MARGIN_Y=2,ji.BORDER_RADIUS=4,qe(`
.blocklyFlyoutButton {
  fill: #888;
  cursor: default;
}

.blocklyFlyoutButtonShadow {
  fill: #666;
}

.blocklyFlyoutButton:hover {
  fill: #aaa;
}

.blocklyFlyoutLabel {
  cursor: default;
}

.blocklyFlyoutLabelBackground {
  opacity: 0;
}
`);var sg=class{getFirstChild(e){return null}getParent(e){return e.getWorkspace()}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof ji}},bc=class{constructor(e,t){this.policy=e,this.flyout=t}getFirstChild(e){return null}getParent(e){return this.policy.getParent(e)}getNextSibling(e){const t=this.flyout.getContents();if(!t)return null;let i=t.findIndex(s=>s.getElement()===e);return i===-1?null:(i++,i>=t.length&&(i=0),t[i].getElement())}getPreviousSibling(e){const t=this.flyout.getContents();if(!t)return null;let i=t.findIndex(s=>s.getElement()===e);return i===-1?null:(i--,i<0&&(i=t.length-1),t[i].getElement())}isNavigable(e){return this.policy.isNavigable(e)}isApplicable(e){return this.policy.isApplicable(e)}},nf=class{constructor(e,t){this.gap=e,this.axis=t,this.y=this.x=0}getBoundingRectangle(){switch(this.axis){case"x":return new Nt(this.y,this.y,this.x,this.x+this.gap);case"y":return new Nt(this.y,this.y+this.gap,this.x,this.x)}}moveBy(e,t,i){this.x+=e,this.y+=t}isNavigable(){return!1}getFocusableElement(){throw Error("Cannot be focused")}getFocusableTree(){throw Error("Cannot be focused")}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!1}},Ep=class{getFirstChild(e){return null}getParent(e){return null}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return!1}isApplicable(e){return e instanceof nf}},rg=class{getFirstChild(e){return e.getEditor()}getParent(e){let t;return(t=e.getOwner())!=null?t:null}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof Ro}},Tp=class{getFirstChild(e){return Xc(e,!0)[0]}getParent(e){var t;if((t=e.previousConnection)!=null&&t.targetBlock()){if(t=e.getSurroundParent())return t}else{let i;if((i=e.outputConnection)!=null&&i.targetBlock())return e.outputConnection.targetBlock()}return e.workspace}getNextSibling(e){let t;if((t=e.nextConnection)!=null&&t.targetBlock()){let s;return(s=e.nextConnection)==null?void 0:s.targetBlock()}let i;return(i=e.outputConnection)!=null&&i.targetBlock()?Fi(e,1):e.getSurroundParent()?Fi(e.getTopStackBlock(),1):this.getParent(e)instanceof Ko?ss(e,1):null}getPreviousSibling(e){let t;if((t=e.previousConnection)!=null&&t.targetBlock()){let s;return(s=e.previousConnection)==null?void 0:s.targetBlock()}let i;return(i=e.outputConnection)!=null&&i.targetBlock()?Fi(e,-1):this.getParent(e)instanceof Ko?ss(e,-1):null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof Rn}},lg=class{getFirstChild(e){return null}getParent(e){return e.getCommentView().workspace.getCommentById(e.getCommentView().commentId)}getNextSibling(e){const t=e.getCommentView().getCommentBarButtons();return e=t.indexOf(e),e>=0&&e+1<t.length?t[e+1]:null}getPreviousSibling(e){const t=e.getCommentView().getCommentBarButtons();return e=t.indexOf(e),e>0?t[e-1]:null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof Ch}},vp=class{getFirstChild(e){return null}getParent(e){return null}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof qd}},yp=class{getFirstChild(e){return e.getParentInput()?e.targetConnection:null}getParent(e){return e.getSourceBlock()}getNextSibling(e){if(e.getParentInput())return Fi(e,1);if(e.type===lt.NEXT_STATEMENT){const i=e.targetConnection;var t=e.getSourceBlock();if(!i&&t.getRootBlock().lastConnectionInStack(!1)===e){e=t.workspace.getTopBlocks(!0),t=e.indexOf(t.getRootBlock())+1,t>=e.length&&(t=0),t=e[t];let s;return(s=this.getParentConnection(t))!=null?s:t}return i}return e.getSourceBlock()}getPreviousSibling(e){if(e.getParentInput())return Fi(e,-1);if(e.type===lt.PREVIOUS_STATEMENT||e.type===lt.OUTPUT_VALUE){const i=e.targetConnection&&!e.targetConnection.getParentInput()?e.targetConnection:null;var t=e.getSourceBlock();if(!i&&this.getParentConnection(t.getRootBlock())===e){e=t.workspace.getTopBlocks(!0),t=e.indexOf(t.getRootBlock())-1,t<0&&(t=e.length-1),t=e[t];let s;return(s=t.lastConnectionInStack(!1))!=null?s:t}return i}return e.type===lt.NEXT_STATEMENT?e.getSourceBlock():null}getParentConnection(e){let t;return!e.outputConnection||(t=e.previousConnection)!=null&&t.isConnected()?e.previousConnection:e.outputConnection}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof Wi}},Sp=class{getFirstChild(e){return null}getParent(e){return e.getSourceBlock()}getNextSibling(e){return Fi(e,1)}getPreviousSibling(e){return Fi(e,-1)}isNavigable(e){let t;return e.canBeFocused()&&e.isVisible()&&(e.isClickable()||e.isCurrentlyEditable())&&!((t=e.getSourceBlock())!=null&&t.isSimpleReporter()&&e.isFullBlockField())&&e.getParentInput().isVisible()}isApplicable(e){return e instanceof dn}},Ec={};Ec.register=Hu,Ec.unregister=Yh;var Cp=17,ug=160,of=80,hs=class extends ra{constructor(e){super(e),this.sourceBlock=e,this.textInputBubble=null,this.text="",this.bubbleSize=new Mt(ug,of),this.bubbleVisiblity=!1}getType(){return hs.TYPE}initView(e){this.svgRoot||(super.initView(e),ae(le.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},this.svgRoot),ae(le.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},this.svgRoot),ae(le.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},this.svgRoot),We(this.svgRoot,"blocklyCommentIcon"))}dispose(){super.dispose();let e;(e=this.textInputBubble)==null||e.dispose()}getWeight(){return hs.WEIGHT}getSize(){return new Mt(Cp,Cp)}applyColour(){super.applyColour();const e=this.sourceBlock.getColour();let t;(t=this.textInputBubble)==null||t.setColour(e)}updateEditable(){const e=this,t=()=>super.updateEditable;return(0,ge.asyncExecutePromiseGeneratorFunction)(function*(){t().call(e),e.bubbleIsVisible()&&(yield e.setBubbleVisible(!1),yield e.setBubbleVisible(!0))})}onLocationChange(e){const t=this.workspaceLocation;super.onLocationChange(e),this.bubbleLocation&&(e=Ne.difference(this.workspaceLocation,t),this.bubbleLocation=Ne.sum(this.bubbleLocation,e)),e=this.getAnchorLocation();let i;(i=this.textInputBubble)==null||i.setAnchorLocation(e)}setText(e){const t=this.text;Be(new(Qe(ce.BLOCK_CHANGE))(this.sourceBlock,"comment",null,t,e)),this.text=e;let i;(i=this.textInputBubble)==null||i.setText(this.text)}getText(){return this.text}setBubbleSize(e){this.bubbleSize=e;let t;(t=this.textInputBubble)==null||t.setSize(this.bubbleSize,!0)}getBubbleSize(){return this.bubbleSize}setBubbleLocation(e){this.bubbleLocation=e;let t;(t=this.textInputBubble)==null||t.moveDuringDrag(e)}getBubbleLocation(){return this.bubbleLocation}saveState(){if(this.text){const e={text:this.text,pinned:this.bubbleIsVisible(),height:this.bubbleSize.height,width:this.bubbleSize.width},t=this.getBubbleLocation();return t&&(e.x=this.sourceBlock.workspace.RTL?this.sourceBlock.workspace.getWidth()-(t.x+this.bubbleSize.width):t.x,e.y=t.y),e}return null}loadState(e){let t;this.text=(t=e.text)!=null?t:"";let i,s;this.bubbleSize=new Mt((i=e.width)!=null?i:ug,(s=e.height)!=null?s:of);let c;this.bubbleVisiblity=(c=e.pinned)!=null?c:!1,this.setBubbleVisible(this.bubbleVisiblity);let m=e.x;const I=e.y;Ci().then(()=>{m&&I&&(m=this.sourceBlock.workspace.RTL?this.sourceBlock.workspace.getWidth()-(m+this.bubbleSize.width):m,this.setBubbleLocation(new Ne(m,I)))})}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}onTextChange(){if(this.textInputBubble){var e=this.textInputBubble.getText();this.text!==e&&(Be(new(Qe(ce.BLOCK_CHANGE))(this.sourceBlock,"comment",null,this.text,e)),this.text=e)}}onSizeChange(){this.textInputBubble&&(this.bubbleSize=this.textInputBubble.getSize())}onBubbleLocationChange(){this.textInputBubble&&(this.bubbleLocation=this.textInputBubble.getRelativeToSurfaceXY())}bubbleIsVisible(){return this.bubbleVisiblity}setBubbleVisible(e){const t=this;return(0,ge.asyncExecutePromiseGeneratorFunction)(function*(){t.bubbleVisiblity!==e&&(t.bubbleVisiblity=e,yield Ci(),!t.sourceBlock.rendered||t.sourceBlock.isInFlyout||t.sourceBlock.isInsertionMarker()||(e?(t.sourceBlock.isEditable()?t.showEditableBubble():t.showNonEditableBubble(),t.applyColour()):t.hideBubble(),Be(new(Qe(ce.BUBBLE_OPEN))(t.sourceBlock,e,"comment"))))})}getBubble(){return this.textInputBubble}showEditableBubble(){this.createBubble();let e;(e=this.textInputBubble)==null||e.addTextChangeListener(()=>this.onTextChange());let t;(t=this.textInputBubble)==null||t.addSizeChangeListener(()=>this.onSizeChange())}showNonEditableBubble(){this.createBubble();let e;(e=this.textInputBubble)==null||e.setEditable(!1)}createBubble(){this.textInputBubble=new Ro(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect(),this),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0),this.bubbleLocation&&this.textInputBubble.moveDuringDrag(this.bubbleLocation),this.textInputBubble.addTextChangeListener(()=>this.onTextChange()),this.textInputBubble.addSizeChangeListener(()=>this.onSizeChange()),this.textInputBubble.addLocationChangeListener(()=>this.onBubbleLocationChange())}hideBubble(){let e;(e=this.textInputBubble)==null||e.dispose(),this.textInputBubble=null}getAnchorLocation(){const e=Cp/2;return Ne.sum(this.workspaceLocation,new Ne(e,e))}getBubbleOwnerRect(){return this.sourceBlock.getBoundingRectangleWithoutChildren()}};hs.TYPE=jn.COMMENT,hs.WEIGHT=3,Hu(hs.TYPE,hs);var sf=class{getFirstChild(e){if(e instanceof l.MutatorIcon$$module$build$src$core$icons$mutator_icon&&e.bubbleIsVisible()&&l.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()===e){let t,i;return(i=(t=e.getBubble())==null?void 0:t.getWorkspace())!=null?i:null}if(e instanceof hs&&e.bubbleIsVisible()&&l.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()===e){let t,i;return(i=(t=e.getBubble())==null?void 0:t.getEditor())!=null?i:null}return null}getParent(e){return e.getSourceBlock()}getNextSibling(e){return Fi(e,1)}getPreviousSibling(e){return Fi(e,-1)}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof ra}},Rp=class{getFirstChild(e){return e.view.getCommentBarButtons()[0]}getParent(e){return e.workspace}getNextSibling(e){return ss(e,1)}getPreviousSibling(e){return ss(e,-1)}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof As}},Ip=class{getFirstChild(e){return e=e.getTopBlocks(!0),e.length?e[0]:null}getParent(e){return null}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return e.canBeFocused()&&!e.isMutator}isApplicable(e){return e instanceof Ko}},wh=class{constructor(){this.rules=[new Tp,new Sp,new yp,new Ip,new sf,new Rp,new lg,new rg,new vp]}addNavigationPolicy(e){this.rules.push(e)}get(e){return this.rules.find(t=>t.isApplicable(e))}getFirstChild(e){let t;const i=(t=this.get(e))==null?void 0:t.getFirstChild(e);if(!i)return null;let s;return(s=this.get(i))!=null&&s.isNavigable(i)?i:this.getFirstChild(i)||this.getNextSibling(i)}getParent(e){let t;const i=(t=this.get(e))==null?void 0:t.getParent(e);if(!i)return null;let s;return(s=this.get(i))!=null&&s.isNavigable(i)?i:this.getParent(i)}getNextSibling(e){let t;const i=(t=this.get(e))==null?void 0:t.getNextSibling(e);if(!i)return null;let s;return(s=this.get(i))!=null&&s.isNavigable(i)?i:this.getNextSibling(i)}getPreviousSibling(e){let t;const i=(t=this.get(e))==null?void 0:t.getPreviousSibling(e);if(!i)return null;let s;return(s=this.get(i))!=null&&s.isNavigable(i)?i:this.getPreviousSibling(i)}},ml=class extends wh{constructor(e){super(),this.rules.push(new sg,new Ep),this.rules=this.rules.map(t=>new bc(t,e))}},Gr=class{constructor(e,t,i,s,c){this.workspace=e,this.oldHostMetrics=this.corner_=this.vScroll=this.hScroll=null,t=t===void 0?!0:t,i=i===void 0?!0:i;const m=t&&i;t&&(this.hScroll=new qn(e,!0,m,s,c)),i&&(this.vScroll=new qn(e,!1,m,s,c)),m&&(this.corner_=ae(le.RECT,{height:qn.scrollbarThickness,width:qn.scrollbarThickness,class:"blocklyScrollbarBackground"}),Yi(this.corner_,e.getBubbleCanvas()))}dispose(){Wt(this.corner_),this.oldHostMetrics=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){const e=this.workspace.getMetrics();if(e){var t=!1,i=!1;if(this.oldHostMetrics&&this.oldHostMetrics.viewWidth===e.viewWidth&&this.oldHostMetrics.viewHeight===e.viewHeight&&this.oldHostMetrics.absoluteTop===e.absoluteTop&&this.oldHostMetrics.absoluteLeft===e.absoluteLeft?(this.oldHostMetrics&&this.oldHostMetrics.scrollWidth===e.scrollWidth&&this.oldHostMetrics.viewLeft===e.viewLeft&&this.oldHostMetrics.scrollLeft===e.scrollLeft||(t=!0),this.oldHostMetrics&&this.oldHostMetrics.scrollHeight===e.scrollHeight&&this.oldHostMetrics.viewTop===e.viewTop&&this.oldHostMetrics.scrollTop===e.scrollTop||(i=!0)):i=t=!0,t||i){try{l.disable$$module$build$src$core$events$utils(),this.hScroll&&t&&this.hScroll.resize(e),this.vScroll&&i&&this.vScroll.resize(e)}finally{l.enable$$module$build$src$core$events$utils()}this.workspace.maybeFireViewportChangeEvent()}if(this.hScroll&&this.vScroll){if(!this.oldHostMetrics||this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft){let s;(s=this.corner_)==null||s.setAttribute("x",String(this.vScroll.position.x))}if(!this.oldHostMetrics||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteTop!==e.absoluteTop){let s;(s=this.corner_)==null||s.setAttribute("y",String(this.hScroll.position.y))}}this.oldHostMetrics=e}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(e,t){this.hScroll&&this.hScroll.setOrigin(e,t),this.vScroll&&this.vScroll.setOrigin(e,t)}set(e,t,i){this.hScroll&&this.hScroll.set(e,!1),this.vScroll&&this.vScroll.set(t,!1),(i||i===void 0)&&(e={},this.hScroll&&(e.x=this.hScroll.getRatio_()),this.vScroll&&(e.y=this.vScroll.getRatio_()),this.workspace.setMetrics(e))}setX(e){this.hScroll&&this.hScroll.set(e,!0)}setY(e){this.vScroll&&this.vScroll.set(e,!0)}setContainerVisible(e){this.hScroll&&this.hScroll.setContainerVisible(e),this.vScroll&&this.vScroll.setContainerVisible(e)}isVisible(){let e=!1;return this.hScroll&&(e=this.hScroll.isVisible()),this.vScroll&&(e=e||this.vScroll.isVisible()),e}setVisible(e){this.hScroll&&this.hScroll.setVisibleInternal(e),this.vScroll&&this.vScroll.setVisibleInternal(e)}resizeContent(e){this.hScroll&&this.hScroll.resizeContentHorizontal(e),this.vScroll&&this.vScroll.resizeContentVertical(e)}resizeView(e){this.hScroll&&this.hScroll.resizeViewHorizontal(e),this.vScroll&&this.vScroll.resizeViewVertical(e)}},ds="sep",Tc=class{load(e,t){return e=new nf(0,t.horizontalLayout?"x":"y"),new mc(e,ds)}gapForItem(e,t){let i;return(i=parseInt(String(e.gap)))!=null?i:t}disposeItem(e){}getType(){return ds}};a(Re.FLYOUT_INFLATER,ds,Tc);var cu=class extends $c{constructor(e){super(),this.horizontalLayout=!1,this.boundEvents=[],this.reflowWrapper=null,this.contents=[],this.autoClose=!0,this.visible=!1,this.containerVisible=!0,this.CORNER_RADIUS=8,this.SCROLLBAR_MARGIN=2.5,this.height_=this.width_=0,this.dragAngleRange_=70,this.svgGroup_=this.svgBackground_=null,this.inflaters=new Map,e.setMetrics=this.setMetrics_.bind(this),this.workspace_=new Ko(e),this.workspace_.setMetricsManager(new Ah(this.workspace_,this)),this.workspace_.internalIsFlyout=!0,this.workspace_.setVisible(this.visible),this.workspace_.setNavigator(new ml(this)),this.id=ot(),this.RTL=!!e.RTL,this.toolboxPosition_=e.toolboxPosition,this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.MARGIN=this.CORNER_RADIUS,this.GAP_X=this.MARGIN*3,this.GAP_Y=this.MARGIN*3}createDom(e){return this.svgGroup_=ae(e,{class:"blocklyFlyout"}),this.svgGroup_.style.display="none",this.svgBackground_=ae(le.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_}init(e){this.targetWorkspace=e,this.workspace_.targetWorkspace=e,this.workspace_.scrollbar=new Gr(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),this.boundEvents.push(_e(this.svgGroup_,"wheel",this,this.wheel_)),this.boundEvents.push(_e(this.svgBackground_,"pointerdown",this,this.onMouseDown)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),e.getComponentManager().addComponent({component:this,weight:un.ComponentWeight.FLYOUT_WEIGHT,capabilities:[un.Capability.AUTOHIDEABLE,un.Capability.DELETE_AREA,un.Capability.DRAG_TARGET]})}dispose(){this.hide(),this.targetWorkspace.getComponentManager().removeComponent(this.id);for(const e of this.boundEvents)Ae(e);this.boundEvents.length=0,this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose()),this.svgGroup_&&Wt(this.svgGroup_)}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}setAutoClose(e){this.autoClose=e,this.targetWorkspace.recordDragTargets(),this.targetWorkspace.resizeContents()}autoHide(e){!e&&this.targetWorkspace.getFlyout(!0)===this&&this.autoClose&&this.hide()}getTargetWorkspace(){return this.targetWorkspace}isVisible(){return this.visible}setVisible(e){const t=e!==this.isVisible();this.visible=e,t&&(this.autoClose||this.targetWorkspace.recordDragTargets(),this.updateDisplay())}setContainerVisible(e){const t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay()}getContents(){return this.contents}setContents(e){this.contents=e}updateDisplay(){let e;e=this.containerVisible?this.isVisible():!1,this.svgGroup_&&(this.svgGroup_.style.display=e?"block":"none");let t;(t=this.workspace_.scrollbar)==null||t.setContainerVisible(e)}positionAt_(e,t,i,s){let c;(c=this.svgGroup_)==null||c.setAttribute("width",`${e}`);let m;(m=this.svgGroup_)==null||m.setAttribute("height",`${t}`),this.workspace_.setCachedParentSvgSize(e,t),this.svgGroup_&&Ki(this.svgGroup_,"translate("+i+"px,"+s+"px)"),(e=this.workspace_.scrollbar)&&(e.setOrigin(i,s),e.resize(),e.hScroll&&e.hScroll.setPosition(e.hScroll.position.x,e.hScroll.position.y),e.vScroll&&e.vScroll.setPosition(e.vScroll.position.x,e.vScroll.position.y))}hide(){this.isVisible()&&(this.setVisible(!1),this.reflowWrapper&&(this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowWrapper=null))}show(e){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks(),typeof e=="string"&&(e=this.getDynamicCategoryContents(e)),this.setVisible(!0),e=rn(e),e=this.createFlyoutInfo(e),Zo(this.workspace_),this.setContents(e),this.layout_(e),this.horizontalLayout?this.height_=0:this.width_=0,this.reflow(),this.workspace_.setResizesEnabled(!0),this.reflowWrapper=t=>{t.type!==ce.BLOCK_CHANGE&&t.type!==ce.BLOCK_FIELD_INTERMEDIATE_CHANGE||this.reflow()},this.workspace_.addChangeListener(this.reflowWrapper)}createFlyoutInfo(e){const t=[],i=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(const s of e)"custom"in s&&(e=this.getDynamicCategoryContents(s.custom),e=rn(e),t.push(...this.createFlyoutInfo(e))),e=s.kind.toLowerCase(),(e=this.getInflaterForType(e))&&(t.push(e.load(s,this)),(e=e.gapForItem(s,i))&&t.push(new mc(new nf(e,this.horizontalLayout?"x":"y"),ds)));return this.normalizeSeparators(t)}normalizeSeparators(e){for(let t=e.length-1;t>0;t--){const i=e[t].getType().toLowerCase(),s=e[t-1].getType().toLowerCase();i===ds&&s===ds&&e.splice(t-1,1)}return e}getDynamicCategoryContents(e){if(e=this.workspace_.targetWorkspace.getToolboxCategoryCallback(e),typeof e!="function")throw TypeError("Couldn't find a callback function when opening a toolbox category.");return e(this.workspace_.targetWorkspace)}clearOldBlocks(){this.getContents().forEach(t=>{let i;(i=this.getInflaterForType(t.getType()))==null||i.disposeItem(t)});let e;(e=this.workspace_.getPotentialVariableMap())==null||e.clear()}onMouseDown(e){const t=this.targetWorkspace.getGesture(e);t&&t.handleFlyoutStart(e,this)}isBlockCreatable(e){return e.isEnabled()&&!this.getTargetWorkspace().isReadOnly()}createBlock(e){let t=null;l.disable$$module$build$src$core$events$utils();var i=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{t=this.placeNewBlock(e)}finally{l.enable$$module$build$src$core$events$utils()}if(this.targetWorkspace.hideChaff(),e=Bs(this.targetWorkspace,i),Ze()){for(l.setGroup$$module$build$src$core$events$utils(!0),i=0;i<e.length;i++){const s=e[i];Be(new(Qe(ce.VAR_CREATE))(s))}Be(new(Qe(ce.BLOCK_CREATE))(t))}return this.autoClose&&this.hide(),t}reflow(){this.reflowWrapper&&this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowInternal_(),this.reflowWrapper&&this.workspace_.addChangeListener(this.reflowWrapper)}isScrollable(){return this.workspace_.scrollbar?this.workspace_.scrollbar.isVisible():!1}placeNewBlock(e){var t=this.targetWorkspace;if(!e.getSvgRoot())throw Error("oldBlock is not rendered");const i=this.serializeBlock(e);return t.setResizesEnabled(!1),t=bo(i,t),this.positionNewBlock(e,t),t}serializeBlock(e){return Zi(e)}positionNewBlock(e,t){const i=this.targetWorkspace;var s=i.getOriginOffsetInPixels(),c=this.workspace_.getOriginOffsetInPixels();e=e.getRelativeToSurfaceXY(),e.scale(this.workspace_.scale),c=Ne.sum(c,e),s=Ne.difference(c,s),s.scale(1/i.scale),t.moveTo(new Ne(s.x,s.y))}getInflaterForType(e){if(this.inflaters.has(e)){var t;return(t=this.inflaters.get(e))!=null?t:null}return(t=N(Re.FLYOUT_INFLATER,e))?(t=new t,this.inflaters.set(e,t),t):null}getFocusableElement(){throw Error("Flyouts are not directly focusable.")}getFocusableTree(){throw Error("Flyouts are not directly focusable.")}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!1}getRootFocusableNode(){throw Error("Flyouts are not directly focusable.")}getRestoredFocusableNode(e){throw Error("Flyouts are not directly focusable.")}getNestedTrees(){throw Error("Flyouts are not directly focusable.")}lookUpFocusableNode(e){throw Error("Flyouts are not directly focusable.")}onTreeFocus(e,t){}onTreeBlur(e){throw Error("Flyouts are not directly focusable.")}},_l=class{constructor(){this.isActive=!1,this.activeClassName="blocklyKeyboardNavigation"}setIsActive(e=!0){this.isActive=e,this.updateActiveVisualization()}getIsActive(){return this.isActive}updateActiveVisualization(){this.isActive?document.body.classList.add(this.activeClassName):document.body.classList.remove(this.activeClassName)}},rf=new _l,Op=class{constructor(e){this.workspace=e,this.horizontalScrollEnabled=this.workspace.isMovableHorizontally(),this.verticalScrollEnabled=this.workspace.isMovableVertically(),this.startScrollXY_=new Ne(e.scrollX,e.scrollY)}dispose(){this.workspace=null}startDrag(){}endDrag(e){this.drag(e)}drag(e){if(e=Ne.sum(this.startScrollXY_,e),this.horizontalScrollEnabled&&this.verticalScrollEnabled)this.workspace.scroll(e.x,e.y);else if(this.horizontalScrollEnabled)this.workspace.scroll(e.x,this.workspace.scrollY);else if(this.verticalScrollEnabled)this.workspace.scroll(this.workspace.scrollX,e.y);else throw new TypeError("Invalid state.")}},Nh=5,Eg=6,kh=class{constructor(e,t){this.creatorWorkspace=t,this.mouseDownXY=new Ne(0,0),this.startWorkspace_=this.targetBlock=this.startComment=this.startBlock=this.startIcon=this.startField=this.startBubble=null,this.hasExceededDragRadius=!1,this.boundEvents=[],this.workspaceDragger=this.dragger=null,this.dragging=!1,this.flyout=null,this.multiTouch=this.isEnding_=this.gestureHasStarted=this.calledUpdateIsDragging=!1,this.cachedPoints=new Map,this.startDistance=this.previousScale=0,this.currentDropdownOwner=this.isPinchZoomEnabled=null,this.mostRecentEvent=e,this.currentDragDeltaXY=new Ne(0,0)}dispose(){Oe(),ie(),this.creatorWorkspace.clearGesture();for(const e of this.boundEvents)Ae(e);this.boundEvents.length=0,this.workspaceDragger&&this.workspaceDragger.dispose()}updateFromEvent(e){const t=new Ne(e.clientX,e.clientY);this.updateDragDelta(t)&&(this.updateIsDragging(e),be()),this.mostRecentEvent=e}updateDragDelta(e){return this.currentDragDeltaXY=Ne.difference(e,this.mouseDownXY),this.hasExceededDragRadius?!1:this.hasExceededDragRadius=Ne.magnitude(this.currentDragDeltaXY)>(this.flyout?l.config$$module$build$src$core$config.flyoutDragRadius:l.config$$module$build$src$core$config.dragRadius)}updateIsDraggingFromFlyout(){let e;if(!this.targetBlock||(e=this.flyout)==null||!e.isBlockCreatable(this.targetBlock))return!1;if(!this.flyout.targetWorkspace)throw Error(`Cannot update dragging from the flyout because the ' +
          'flyout's target workspace is undefined`);return!this.flyout.isScrollable()||this.flyout.isDragTowardWorkspace(this.currentDragDeltaXY)?(this.startWorkspace_=this.flyout.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),l.getGroup$$module$build$src$core$events$utils()||l.setGroup$$module$build$src$core$events$utils(!0),this.startBlock=null,this.targetBlock=this.flyout.createBlock(this.targetBlock),l.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.targetBlock),!0):!1}updateIsDraggingWorkspace(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");(this.flyout?this.flyout.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.dragging=!0,this.workspaceDragger=new Op(this.startWorkspace_),this.workspaceDragger.startDrag())}updateIsDragging(e){if(!this.startWorkspace_)throw Error("Cannot update dragging because the start workspace is undefined");if(this.calledUpdateIsDragging)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging=!0,this.flyout&&this.updateIsDraggingFromFlyout();const t=Y();t&&Gl(t)&&t.isMovable()?(this.dragging=!0,this.dragger=this.createDragger(t,this.startWorkspace_),this.dragger.onDragStart(e),this.dragger.onDrag(e,this.currentDragDeltaXY)):this.updateIsDraggingWorkspace()}createDragger(e,t){return new(D(Re.BLOCK_DRAGGER,this.creatorWorkspace.options,!0))(e,t)}doStart(e){if(!this.startWorkspace_)throw Error("Cannot start the touch gesture becauase the start workspace is undefined");this.isPinchZoomEnabled=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,rt(e)?this.cancel():(this.gestureHasStarted=!0,vr(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=Lc(),this.startWorkspace_.hideChaff(!!this.flyout),this.startWorkspace_.markFocused(),this.mostRecentEvent=e,q(),De(e)?this.handleRightClick(e):(e.type.toLowerCase()==="pointerdown"&&e.pointerType!=="mouse"&&j(e,this),this.mouseDownXY=new Ne(e.clientX,e.clientY),this.bindMouseEvents(e),this.isEnding_||this.handleTouchStart(e)))}bindMouseEvents(e){this.boundEvents.push(_e(document,"pointerdown",null,this.handleStart.bind(this),!0)),this.boundEvents.push(_e(document,"pointermove",null,this.handleMove.bind(this),!0)),this.boundEvents.push(_e(document,"pointerup",null,this.handleUp.bind(this),!0)),this.boundEvents.push(_e(document,"pointercancel",null,this.handleUp.bind(this),!0)),e.preventDefault(),e.stopPropagation()}handleStart(e){this.isDragging()||(this.handleTouchStart(e),this.isMultiTouch()&&be())}handleMove(e){this.isDragging()&&ve(e)||!this.isMultiTouch()?(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(e),be())}handleUp(e){if(this.isDragging()||this.handleTouchEnd(e),!this.isMultiTouch()||this.isDragging()){if(!ve(e))return;if(this.updateFromEvent(e),be(),this.isEnding_){console.log("Trying to end a gesture recursively.");return}this.isEnding_=!0,this.dragger?(rf.setIsActive(!1),this.dragger.onDragEnd(e,this.currentDragDeltaXY)):this.workspaceDragger?(rf.setIsActive(!1),this.workspaceDragger.endDrag(this.currentDragDeltaXY)):this.isBubbleClick()||this.isCommentClick()||(this.isFieldClick()?this.doFieldClick():this.isIconClick()?this.doIconClick():this.isBlockClick()?this.doBlockClick():this.isWorkspaceClick()&&this.doWorkspaceClick(e))}e.preventDefault(),e.stopPropagation(),this.dispose()}handleTouchStart(e){var t=Xe(e);this.cachedPoints.set(t,this.getTouchPoint(e));var i=Array.from(this.cachedPoints.keys());i.length===2&&(t=this.cachedPoints.get(i[0]),i=this.cachedPoints.get(i[1]),this.startDistance=Ne.distance(t,i),this.multiTouch=!0,e.preventDefault())}handleTouchMove(e){const t=Xe(e);this.cachedPoints.set(t,this.getTouchPoint(e)),this.isPinchZoomEnabled&&this.cachedPoints.size===2?this.handlePinch(e):(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation())}handlePinch(e){var t=Array.from(this.cachedPoints.keys()),i=this.cachedPoints.get(t[0]);if(t=this.cachedPoints.get(t[1]),i=Ne.distance(i,t)/this.startDistance,this.previousScale>0&&this.previousScale<1/0){if(t=i-this.previousScale,t=t>0?t*Nh:t*Eg,!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");const s=this.startWorkspace_,c=xe(e,s.getParentSvg(),s.getInverseScreenCTM());s.zoom(c.x,c.y,t)}this.previousScale=i,e.preventDefault()}handleTouchEnd(e){e=Xe(e),this.cachedPoints.has(e)&&this.cachedPoints.delete(e),this.cachedPoints.size<2&&(this.cachedPoints.clear(),this.previousScale=0)}getTouchPoint(e){return this.startWorkspace_?new Ne(e.pageX,e.pageY):null}isMultiTouch(){return this.multiTouch}cancel(){this.isEnding_||(be(),this.dragger?this.dragger.onDragEnd(this.mostRecentEvent,this.currentDragDeltaXY):this.workspaceDragger&&this.workspaceDragger.endDrag(this.currentDragDeltaXY),this.dispose())}handleRightClick(e){this.targetBlock?(this.bringBlockToFront(),this.targetBlock.workspace.hideChaff(!!this.flyout),this.targetBlock.showContextMenu(e)):this.startBubble?this.startBubble.showContextMenu(e):this.startComment?(this.startComment.workspace.hideChaff(),this.startComment.showContextMenu(e)):this.startWorkspace_&&!this.flyout&&(this.startWorkspace_.hideChaff(),l.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.startWorkspace_),this.startWorkspace_.showContextMenu(e)),e.preventDefault(),e.stopPropagation(),rf.setIsActive(!1),this.dispose()}handleWsStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace(t),this.mostRecentEvent=e,this.startBlock||this.startBubble||this.startComment?this.startBlock&&l.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.startBlock):l.getFocusManager$$module$build$src$core$focus_manager().focusNode(t),this.doStart(e)}fireWorkspaceClick(e){Be(new(Qe(ce.CLICK))(null,e.id,"workspace"))}handleFlyoutStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout(t),this.handleWsStart(e,t.getWorkspace())}handleBlockStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(t),this.mostRecentEvent=e}handleBubbleStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(t),this.mostRecentEvent=e}handleCommentStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleCommentStart, but the gesture had already been started.");this.setStartComment(t),this.mostRecentEvent=e}doFieldClick(){if(!this.startField)throw Error("Cannot do a field click because the start field is undefined");this.bringBlockToFront(),this.currentDropdownOwner!==this.startField&&this.startField.showEditor(this.mostRecentEvent)}doIconClick(){if(!this.startIcon)throw Error("Cannot do an icon click because the start icon is undefined");this.bringBlockToFront(),this.startIcon.onClick()}doBlockClick(){if(this.flyout&&this.flyout.autoClose){if(!this.targetBlock)throw Error("Cannot do a block click because the target block is undefined");if(this.flyout.isBlockCreatable(this.targetBlock)){l.getGroup$$module$build$src$core$events$utils()||l.setGroup$$module$build$src$core$events$utils(!0);var e=this.flyout.createBlock(this.targetBlock);e.snapToGrid(),e.bumpNeighbours(),l.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");e=new(Qe(ce.CLICK))(this.startBlock,this.startWorkspace_.id,"block"),Be(e)}this.bringBlockToFront(),l.setGroup$$module$build$src$core$events$utils(!1)}doWorkspaceClick(e){this.fireWorkspaceClick(this.startWorkspace_||this.creatorWorkspace)}bringBlockToFront(){this.targetBlock&&!this.flyout&&(l.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.targetBlock),this.targetBlock.bringToFront())}setStartField(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField||(this.startField=e)}setStartIcon(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartIcon, but the gesture had already been started.");this.startIcon||(this.startIcon=e)}setStartBubble(e){this.startBubble||(this.startBubble=e)}setStartComment(e){this.startComment||(this.startComment=e)}setStartBlock(e){this.startBlock||this.startBubble||(this.startBlock=e,e.isInFlyout&&e!==e.getRootBlock()?this.setTargetBlock(e.getRootBlock()):this.setTargetBlock(e))}setTargetBlock(e){e.isShadow()?this.setTargetBlock(e.getParent()):(this.targetBlock=e,l.getFocusManager$$module$build$src$core$focus_manager().focusNode(e))}setStartWorkspace(e){this.startWorkspace_||(this.startWorkspace_=e)}setStartFlyout(e){this.flyout||(this.flyout=e)}isBubbleClick(){return!!this.startBubble&&!this.hasExceededDragRadius}isCommentClick(){return!!this.startComment&&!this.hasExceededDragRadius}isBlockClick(){return!!this.startBlock&&!this.hasExceededDragRadius&&!this.isFieldClick()&&!this.isIconClick()}isFieldClick(){return this.startField?this.startField.isClickable()&&!this.hasExceededDragRadius&&(!this.flyout||this.startField.isClickableInFlyout(this.flyout.autoClose)):!1}isIconClick(){if(!this.startIcon)return!1;const e=!this.flyout||!this.startIcon.isClickableInFlyout||this.startIcon.isClickableInFlyout(this.flyout.autoClose);return!this.hasExceededDragRadius&&e}isWorkspaceClick(){return!this.startBlock&&!this.startBubble&&!this.startField&&!this.hasExceededDragRadius}getCurrentDragger(){let e,t;return(t=(e=this.workspaceDragger)!=null?e:this.dragger)!=null?t:null}isDragging(){return this.dragging}hasStarted(){return this.gestureHasStarted}static inProgress(){const e=Xn();for(let t=0,i;i=e[t];t++)if(i.currentGesture_)return!0;return!1}},vc=class{constructor(e,t){this.pattern=e,this.scale=1;let i;this.spacing=(i=t.spacing)!=null?i:0;let s;this.length=(s=t.length)!=null?s:1,this.line2=(this.line1=e.firstChild)&&this.line1.nextSibling;let c;this.snapToGrid=(c=t.snap)!=null?c:!1}setSpacing(e){this.spacing=e,this.update(this.scale)}getSpacing(){return this.spacing}setLength(e){this.length=e,this.update(this.scale)}getLength(){return this.length}setSnapToGrid(e){this.snapToGrid=e}shouldSnap(){return this.snapToGrid}getPatternId(){return this.pattern.id}update(e){this.scale=e;var t=this.spacing*e;this.pattern.setAttribute("width",`${t}`),this.pattern.setAttribute("height",`${t}`),t=Math.floor(this.spacing/2)+.5;let i=t-this.length/2,s=t+this.length/2;t*=e,i*=e,s*=e,this.setLineAttributes(this.line1,e,i,s,t,t),this.setLineAttributes(this.line2,e,t,t,i,s)}setLineAttributes(e,t,i,s,c,m){e&&(e.setAttribute("stroke-width",`${t}`),e.setAttribute("x1",`${i}`),e.setAttribute("y1",`${c}`),e.setAttribute("x2",`${s}`),e.setAttribute("y2",`${m}`))}moveTo(e,t){this.pattern.setAttribute("x",`${e}`),this.pattern.setAttribute("y",`${t}`)}alignXY(e){var t=this.getSpacing();const i=t/2,s=Math.round(Math.round((e.x-i)/t)*t+i);return t=Math.round(Math.round((e.y-i)/t)*t+i),s===e.x&&t===e.y?e:new Ne(s,t)}static createDom(e,t,i,s){e=ae(le.PATTERN,{id:"blocklyGridPattern"+e,patternUnits:"userSpaceOnUse"},i);let c,m;if(((c=t.length)!=null?c:1)>0&&((m=t.spacing)!=null?m:0)>0){ae(le.LINE,{stroke:t.colour},e);let I;(I=t.length)!=null&&I&&ae(le.LINE,{stroke:t.colour},e)}else ae(le.LINE,{},e);return s&&s.style.setProperty("--blocklyGridPattern",`url(#${e.id})`),e}},ag=class{constructor(e){this.workspace=e,this.layers=new Map,(e=e.getInjectionDiv())&&(this.dragLayer=this.createDragLayer(e),this.animationLayer=this.createAnimationLayer(e)),e=this.createLayer(ru),We(e,"blocklyBlockCanvas"),e=this.createLayer(Sh),We(e,"blocklyBubbleCanvas")}createDragLayer(e){const t=ae(le.SVG,{class:"blocklyBlockDragSurface",xmlns:Qa,"xmlns:html":ll,"xmlns:xlink":Co,version:"1.1"});return e.append(t),ae(le.G,{},t)}createAnimationLayer(e){const t=ae(le.SVG,{class:"blocklyAnimationLayer",xmlns:Qa,"xmlns:html":ll,"xmlns:xlink":Co,version:"1.1"});return e.append(t),ae(le.G,{},t)}appendToAnimationLayer(e){let t;const i=(t=this.dragLayer)==null?void 0:t.getAttribute("transform");if(i){let c;(c=this.animationLayer)==null||c.setAttribute("transform",i)}let s;(s=this.animationLayer)==null||s.appendChild(e.getSvgRoot())}translateLayers(e,t){e=`translate(${e.x}, ${e.y}) scale(${t})`;let i;(i=this.dragLayer)==null||i.setAttribute("transform",e);for(const[,s]of this.layers)s.setAttribute("transform",e)}moveToDragLayer(e){let t;(t=this.dragLayer)==null||t.appendChild(e.getSvgRoot()),e.canBeFocused()&&l.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}moveOffDragLayer(e,t){this.append(e,t),e.canBeFocused()&&l.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}append(e,t){this.layers.has(t)||this.createLayer(t),e=e.getSvgRoot();let i;if(((i=this.layers.get(t))==null?void 0:i.lastChild)!==e){let s;(s=this.layers.get(t))==null||s.appendChild(e)}}createLayer(e){const t=this.workspace.getSvgGroup(),i=ae(le.G,{});let s=!1;const c=[...this.layers].sort((m,I)=>m[0]-I[0]);for(const[m,I]of c)if(e<m){t.insertBefore(i,I),s=!0;break}return s||t.appendChild(i),this.layers.set(e,i),i}hasLayer(e){return e===this.dragLayer||new Set(this.layers.values()).has(e)}getBlockLayer(){return this.layers.get(ru)}getBubbleLayer(){return this.layers.get(Sh)}},cg=class{constructor(){this.curNode=this.colour=null,this.type="marker"}getCurNode(){return this.curNode}setCurNode(e){this.curNode=e}dispose(){this.curNode=null}getSourceBlockFromNode(e){return e instanceof Rn?e:e instanceof dn||e instanceof Wi?e.getSourceBlock():null}getSourceBlock(){return this.getSourceBlockFromNode(this.getCurNode())}},yc=class extends cg{constructor(e){super(),this.workspace=e,this.type="cursor",this.potentialNodes=null}next(){var e=this.getCurNode();return e?((e=this.getNextNode(e,t=>{let i;return t instanceof Rn&&!((i=t.outputConnection)!=null&&i.targetBlock())||t instanceof As},!0))&&this.setCurNode(e),e):null}in(){var e=this.getCurNode();return e?((e=this.getNextNode(e,()=>!0,!0))&&this.setCurNode(e),e):null}prev(){var e=this.getCurNode();return e?((e=this.getPreviousNode(e,t=>{let i;return t instanceof Rn&&!((i=t.outputConnection)!=null&&i.targetBlock())||t instanceof As},!0))&&this.setCurNode(e),e):null}out(){var e=this.getCurNode();return e?((e=this.getPreviousNode(e,()=>!0,!0))&&this.setCurNode(e),e):null}atEndOfLine(){var e=this.getCurNode();if(!e)return!1;const t=this.getNextNode(e,()=>!0,!0);return e=this.getNextNode(e,i=>{let s;return i instanceof Rn&&!((s=i.outputConnection)!=null&&s.targetBlock())},!0),t===e}getNextNodeImpl(e,t,i=new Set){if(!e||i.has(e))return null;let s=this.workspace.getNavigator().getFirstChild(e)||this.workspace.getNavigator().getNextSibling(e);for(var c=e;c&&!s&&(c=this.workspace.getNavigator().getParent(c),!!c);)s=this.workspace.getNavigator().getNextSibling(c);return t(s)?s:s?(i.add(e),this.getNextNodeImpl(s,t,i)):null}getNextNode(e,t,i){return!e||!i&&this.getLastNode()===e?null:this.getNextNodeImpl(e,t)}getPreviousNodeImpl(e,t,i=new Set){if(!e||i.has(e))return null;const s=this.getRightMostChild(this.workspace.getNavigator().getPreviousSibling(e),e)||this.workspace.getNavigator().getParent(e);return t(s)?s:s?(i.add(e),this.getPreviousNodeImpl(s,t,i)):null}getPreviousNode(e,t,i){return!e||!i&&this.getFirstNode()===e?null:this.getPreviousNodeImpl(e,t)}getRightMostChild(e,t){if(!e)return e;let i=this.workspace.getNavigator().getFirstChild(e);if(!i||i===t)return e;for(e=i;e&&e!==t;e=this.workspace.getNavigator().getNextSibling(i))i=e;return this.getRightMostChild(i,t)}preDelete(e){var t=this.getCurNode();t=t?[t]:[];var i;let s,c;const m=(c=(i=e.previousConnection)==null?void 0:i.targetConnection)!=null?c:(s=e.outputConnection)==null?void 0:s.targetConnection;m&&t.push(m),(i=e.getNextBlock())&&t.push(i),(e=e.getParent())&&t.push(e),t.push(this.workspace),this.potentialNodes=t}postDelete(){const e=this.potentialNodes;if(this.potentialNodes=null,!e)throw Error("must call preDelete first");for(const t of e){let i;if((i=this.getSourceBlockFromNode(t))==null||!i.disposed){this.setCurNode(t);return}}throw Error("no valid nodes in this.potentialNodes")}getCurNode(){return l.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()}setCurNode(e){l.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}getFirstNode(){return this.workspace.getNavigator().getFirstChild(this.workspace)}getLastNode(){const e=this.getFirstNode();return this.getPreviousNode(e,()=>!0,!0)}};a(Re.CURSOR,Po,yc);var Sc=class{constructor(e){this.workspace=e,this.markers=new Map,this.cursor=new yc(this.workspace)}registerMarker(e,t){this.markers.has(e)&&this.unregisterMarker(e),this.markers.set(e,t)}unregisterMarker(e){const t=this.markers.get(e);if(t)t.dispose(),this.markers.delete(e);else throw Error("Marker with ID "+e+" does not exist. Can only unregister markers that exist.")}getCursor(){return this.cursor}getMarker(e){return this.markers.get(e)||null}setCursor(e){this.cursor=e}dispose(){const e=Object.keys(this.markers);for(let t=0,i;i=e[t];t++)this.unregisterMarker(i);this.markers.clear(),this.cursor.dispose()}};Sc.LOCAL_MARKER="local_marker_1";var bl={};bl.CommentIcon=hs,bl.Icon=ra,bl.IconType=jn,bl.MutatorIcon=l.MutatorIcon$$module$build$src$core$icons$mutator_icon,bl.WarningIcon=Hr,bl.exceptions=$p,bl.registry=Ec,l.Names$$module$build$src$core$names=class{constructor(e,t){this.db=new Map,this.dbReverse=new Set,this.variableMap=null,this.variablePrefix=t||"",this.reservedWords=new Set(e?e.split(","):[])}reset(){this.db.clear(),this.dbReverse.clear(),this.variableMap=null}setVariableMap(e){this.variableMap=e}getNameForUserVariable(e){return this.variableMap?(e=this.variableMap.getVariableById(e))?e.getName():null:(console.warn(`Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:
Blockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());`),null)}populateVariables(e){e=l.allUsedVarModels$$module$build$src$core$variables(e);for(let t=0;t<e.length;t++)this.getName(e[t].getId(),l.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(e){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts")}getName(e,t){let i=e;t===l.NameType$$module$build$src$core$names.VARIABLE&&(e=this.getNameForUserVariable(e))&&(i=e),e=i.toLowerCase();const s=t===l.NameType$$module$build$src$core$names.VARIABLE||t===l.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"";this.db.has(t)||this.db.set(t,new Map);const c=this.db.get(t);return c.has(e)?s+c.get(e):(t=this.getDistinctName(i,t),c.set(e,t.substr(s.length)),t)}getUserNames(e){let t;return(e=(t=this.db.get(e))==null?void 0:t.keys())?Array.from(e):[]}getDistinctName(e,t){e=this.safeName(e);let i=null,s,c;for(;this.dbReverse.has(e+((s=i)!=null?s:""))||this.reservedWords.has(e+((c=i)!=null?c:""));)i=i?i+1:2;let m;return e+=(m=i)!=null?m:"",this.dbReverse.add(e),(t===l.NameType$$module$build$src$core$names.VARIABLE||t===l.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"")+e}safeName(e){return e?(e=encodeURI(e.replace(/ /g,"_")).replace(/[^\w]/g,"_"),"0123456789".includes(e[0])&&(e="my_"+e)):e=l.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed",e}static equals(e,t){return e.toLowerCase()===t.toLowerCase()}},(function(e){e=e.NameType||(e.NameType={}),e.DEVELOPER_VARIABLE="DEVELOPER_VARIABLE",e.VARIABLE="VARIABLE",e.PROCEDURE="PROCEDURE"})(l.Names$$module$build$src$core$names||(l.Names$$module$build$src$core$names={})),l.NameType$$module$build$src$core$names=l.Names$$module$build$src$core$names.NameType,l.Names$$module$build$src$core$names.DEVELOPER_VARIABLE_TYPE=l.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE,l.NameType$$module$build$src$core$names,l.Names$$module$build$src$core$names;var da=class extends Map{constructor(){super()}set(e,t){return this.get(e)===t?this:(super.set(e,t),Yc(t)&&t.startPublishing(),this)}delete(e){const t=this.get(e);return e=super.delete(e),e&&(Yc(t)&&t.stopPublishing(),e)}clear(){if(this.size)for(const e of this.keys())this.delete(e)}add(e){return this.set(e.getId(),e)}getProcedures(){return[...this.values()]}},Mh,Xi;Mh="PROCEDURE",l.DEFAULT_ARG$$module$build$src$core$procedures="x",Xi={CATEGORY_NAME:Mh,DEFAULT_ARG:l.DEFAULT_ARG$$module$build$src$core$procedures},Xi.ObservableProcedureMap=da,Xi.allProcedures=La,Xi.findLegalName=l.findLegalName$$module$build$src$core$procedures,Xi.flyoutCategory=So,Xi.getCallers=Zh,Xi.getDefinition=l.getDefinition$$module$build$src$core$procedures,Xi.internalFlyoutCategory=Da,Xi.isNameUsed=Kh,Xi.isProcedureBlock=Is,Xi.mutateCallers=l.mutateCallers$$module$build$src$core$procedures,Xi.mutatorOpenListener=yr,Xi.rename=l.rename$$module$build$src$core$procedures;var lf=class{constructor(){this.NONE=0,this.FIELD=1,this.HAT=2,this.ICON=4,this.SPACER=8,this.BETWEEN_ROW_SPACER=16,this.IN_ROW_SPACER=32,this.EXTERNAL_VALUE_INPUT=64,this.INPUT=128,this.INLINE_INPUT=256,this.STATEMENT_INPUT=512,this.CONNECTION=1024,this.PREVIOUS_CONNECTION=2048,this.NEXT_CONNECTION=4096,this.OUTPUT_CONNECTION=8192,this.CORNER=16384,this.LEFT_SQUARE_CORNER=32768,this.LEFT_ROUND_CORNER=65536,this.RIGHT_SQUARE_CORNER=131072,this.RIGHT_ROUND_CORNER=262144,this.JAGGED_EDGE=524288,this.ROW=1048576,this.TOP_ROW=2097152,this.BOTTOM_ROW=4194304,this.INPUT_ROW=8388608,this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER,this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER,this.nextTypeValue_=16777216}getType(e){return Object.prototype.hasOwnProperty.call(this,e)||(this[e]=this.nextTypeValue_,this.nextTypeValue_<<=1),this[e]}isField(e){return(e.type&this.FIELD)>=1}isHat(e){return(e.type&this.HAT)>=1}isIcon(e){return(e.type&this.ICON)>=1}isSpacer(e){return(e.type&this.SPACER)>=1}isInRowSpacer(e){return(e.type&this.IN_ROW_SPACER)>=1}isSpacerRow(e){return(e.type&this.BETWEEN_ROW_SPACER)>=1}isInput(e){return(e.type&this.INPUT)>=1}isExternalInput(e){return(e.type&this.EXTERNAL_VALUE_INPUT)>=1}isInlineInput(e){return(e.type&this.INLINE_INPUT)>=1}isStatementInput(e){return(e.type&this.STATEMENT_INPUT)>=1}isPreviousConnection(e){return(e.type&this.PREVIOUS_CONNECTION)>=1}isNextConnection(e){return(e.type&this.NEXT_CONNECTION)>=1}isPreviousOrNextConnection(e){return this.isPreviousConnection(e)||this.isNextConnection(e)}isRoundCorner(e){return(e.type&this.LEFT_ROUND_CORNER)>=1||(e.type&this.RIGHT_ROUND_CORNER)>=1}isLeftRoundedCorner(e){return this.isRoundCorner(e)&&(e.type&this.LEFT_ROUND_CORNER)>=1}isRightRoundedCorner(e){return this.isRoundCorner(e)&&(e.type&this.RIGHT_ROUND_CORNER)>=1}isLeftSquareCorner(e){return(e.type&this.LEFT_SQUARE_CORNER)>=1}isRightSquareCorner(e){return(e.type&this.RIGHT_SQUARE_CORNER)>=1}isCorner(e){return(e.type&this.CORNER)>=1}isJaggedEdge(e){return(e.type&this.JAGGED_EDGE)>=1}isRow(e){return(e.type&this.ROW)>=1}isBetweenRowSpacer(e){return(e.type&this.BETWEEN_ROW_SPACER)>=1}isTopRow(e){return(e.type&this.TOP_ROW)>=1}isBottomRow(e){return(e.type&this.BOTTOM_ROW)>=1}isTopOrBottomRow(e){return this.isTopRow(e)||this.isBottomRow(e)}isInputRow(e){return(e.type&this.INPUT_ROW)>=1}},K=new lf,Vr=class{constructor(e){this.centerline=this.xPos=this.height=this.width=0,this.constants_=e,this.type=K.NONE,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},hu=class{constructor(e){this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasStatement=this.hasExternalInput=!1,this.statementEdge=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=!1,this.align=null,this.constants_=e,this.type=K.ROW,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let e=this.elements.length-1;e>=0;e--){const t=this.elements[e];if(K.isInput(t))return t}return null}measure(){throw Error("Unexpected attempt to measure a base Row.")}startsWithElemSpacer(){return!0}endsWithElemSpacer(){return!0}getFirstSpacer(){for(let e=0;e<this.elements.length;e++){const t=this.elements[e];if(K.isInRowSpacer(t))return t}return null}getLastSpacer(){for(let e=this.elements.length-1;e>=0;e--){const t=this.elements[e];if(K.isInRowSpacer(t))return t}return null}},n=class extends hu{constructor(e){super(e),this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0,this.type|=K.BOTTOM_ROW}hasLeftSquareCorner(e){return!!e.outputConnection||!!e.getNextBlock()}hasRightSquareCorner(e){return!0}measure(){let e=0,t=0,i=0;for(let s=0;s<this.elements.length;s++){const c=this.elements[s];t+=c.width,K.isSpacer(c)||(K.isNextConnection(c)?i=Math.max(i,c.height):e=Math.max(e,c.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+i,this.descenderHeight=i,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},o=class extends Vr{constructor(e,t){super(e),this.connectionModel=t,this.type|=K.CONNECTION,this.shape=this.constants_.shapeFor(t),this.isDynamicShape="isDynamic"in this.shape&&this.shape.isDynamic,this.highlighted=t.isHighlighted()}},r=class extends o{constructor(e,t){super(e,t.connection),this.input=t,this.connectionOffsetY=this.connectionOffsetX=0,this.type|=K.INPUT,this.align=t.align,(this.connectedBlock=t.connection&&t.connection.targetBlock()?t.connection.targetBlock():null)?(e=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=e.width,this.connectedBlockHeight=e.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},u=class extends r{constructor(e,t){super(e,t),this.height=0,this.type|=K.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}},f=class extends Vr{constructor(e,t,i){super(e),this.field=t,this.parentInput=i,this.isEditable=t.EDITABLE,this.flipRtl=t.getFlipRtl(),this.type|=K.FIELD,e=this.field.getSize(),this.height=e.height,this.width=e.width}},$=class extends Vr{constructor(e){super(e),this.type|=K.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}},S=class extends Vr{constructor(e,t){super(e),this.icon=t,this.flipRtl=!1,this.type|=K.ICON,e=t.getSize(),this.height=e.height,this.width=e.width}},k=class extends Vr{constructor(e,t){super(e),this.type|=K.SPACER|K.IN_ROW_SPACER,this.width=t,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},V=class extends r{constructor(e,t){super(e,t),this.type|=K.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY="connectionOffsetY"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX="connectionOffsetX"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},fe=class extends hu{constructor(e){super(e),this.connectedBlockWidths=0,this.type|=K.INPUT_ROW}measure(){this.width=this.minWidth,this.height=this.minHeight;let e=0;for(let t=0;t<this.elements.length;t++){const i=this.elements[t];this.width+=i.width,K.isInput(i)&&(K.isStatementInput(i)?e+=i.connectedBlockWidth:K.isExternalInput(i)&&i.connectedBlockWidth!==0&&(e+=i.connectedBlockWidth-i.connectionWidth)),K.isSpacer(i)||(this.height=Math.max(this.height,i.height))}this.connectedBlockWidths=e,this.widthWithConnectedBlocks=this.width+e}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},Ie=class extends Vr{constructor(e){super(e),this.type|=K.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}},Me=class extends o{constructor(e,t){super(e,t),this.type|=K.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},me=class extends o{constructor(e,t){super(e,t),this.connectionOffsetX=0,this.type|=K.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},Ee=class extends o{constructor(e,t){super(e,t),this.type|=K.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},ct=class extends Vr{constructor(e,t){super(e),this.type=(t&&t!=="left"?K.RIGHT_ROUND_CORNER:K.LEFT_ROUND_CORNER)|K.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}},yt=class extends hu{constructor(e,t,i){super(e),this.height=t,this.width=i,this.precedesStatement=this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.type|=K.SPACER|K.BETWEEN_ROW_SPACER,this.elements=[new k(this.constants_,i)]}measure(){}},cn=class extends Vr{constructor(e,t){super(e),this.type=(t&&t!=="left"?K.RIGHT_SQUARE_CORNER:K.LEFT_SQUARE_CORNER)|K.CORNER,this.width=this.height=this.constants_.NO_PADDING}},re=class extends r{constructor(e,t){super(e,t),this.type|=K.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},Q=class extends hu{constructor(e){super(e),this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null,this.type|=K.TOP_ROW}hasLeftSquareCorner(e){const t=(e.hat?e.hat==="cap":this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection,i=e.getPreviousBlock();return!!e.outputConnection||t||(i?i.getNextBlock()===e:!1)}hasRightSquareCorner(e){return!0}measure(){let e=0,t=0,i=0;for(let s=0;s<this.elements.length;s++){const c=this.elements[s];t+=c.width,K.isSpacer(c)||(K.isHat(c)?i=Math.max(i,c.ascenderHeight):e=Math.max(e,c.height))}this.width=Math.max(this.minWidth,t),this.height=Math.max(this.minHeight,e)+i,this.capline=this.ascenderHeight=i,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},he=class{constructor(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.defs=null,this.embossFilterId="",this.embossFilter=null,this.disabledPatternId="",this.disabledPattern=null,this.debugFilterId="",this.cssNode=this.debugFilter=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2},this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=yn(0,0),this.FIELD_TEXT_BASELINE_CENTER=!0,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(e){this.blockStyles=Object.create(null);const t=e.blockStyles;for(const i in t)this.blockStyles[i]=this.validatedBlockStyle_(t[i]);this.setDynamicProperties_(e)}setDynamicProperties_(e){this.setFontConstants_(e),this.setComponentConstants_(e),this.ADD_START_HATS=e.startHats!==void 0?e.startHats:this.ADD_START_HATS}setFontConstants_(e){e.fontStyle&&e.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=e.fontStyle.family),e.fontStyle&&e.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=e.fontStyle.weight),e.fontStyle&&e.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=e.fontStyle.size),e=X("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=e.height,this.FIELD_TEXT_BASELINE=e.baseline}setComponentConstants_(e){this.CURSOR_COLOUR=e.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=e.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=e.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(e.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY}getBlockStyleForColour(e){const t="auto_"+e;return this.blockStyles[t]||(this.blockStyles[t]=this.createBlockStyle_(e)),{style:this.blockStyles[t],name:t}}getBlockStyle(e){return this.blockStyles[e||""]||(e&&e.startsWith("auto_")?this.getBlockStyleForColour(e.substring(5)).style:this.createBlockStyle_("#000000"))}createBlockStyle_(e){return this.validatedBlockStyle_({colourPrimary:e})}validatedBlockStyle_(e){const t={};return e&&Object.assign(t,e),e=Ct(t.colourPrimary||"#000"),t.colourPrimary=e.hex,t.colourSecondary=t.colourSecondary?Ct(t.colourSecondary).hex:this.generateSecondaryColour_(t.colourPrimary),t.colourTertiary=t.colourTertiary?Ct(t.colourTertiary).hex:this.generateTertiaryColour_(t.colourPrimary),t.hat=t.hat||"",t}generateSecondaryColour_(e){return Pe("#fff",e,.6)||e}generateTertiaryColour_(e){return Pe("#fff",e,.3)||e}dispose(){this.embossFilter&&Wt(this.embossFilter),this.disabledPattern&&Wt(this.disabledPattern),this.debugFilter&&Wt(this.debugFilter),this.cssNode=null}makeJaggedTeeth(){const e=this.JAGGED_TEETH_HEIGHT,t=this.JAGGED_TEETH_WIDTH,i=el([pt(t,e/4),pt(-t*2,e/2),pt(t,e/4)]);return{height:e,width:t,path:i}}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH,i=Do("c",[pt(30,-e),pt(70,-e),pt(t,0)]);return{height:e*.75,width:t,path:i}}makePuzzleTab(){function e(m){m=m?-1:1;const I=-m;var B=i/2;const Se=B+2.5,mt=B+.5,ci=pt(-t,m*B);return B=pt(t,m*B),Do("c",[pt(0,m*Se),pt(-t,I*mt),ci])+Do("s",[pt(t,I*2.5),B])}const t=this.TAB_WIDTH,i=this.TAB_HEIGHT,s=e(!0),c=e(!1);return{type:this.SHAPES.PUZZLE,width:t,height:i,pathDown:c,pathUp:s}}makeNotch(){function e(I){return el([pt(I*s,i),pt(I*3,0),pt(I*s,-i)])}const t=this.NOTCH_WIDTH,i=this.NOTCH_HEIGHT,s=(t-3)/2,c=e(1),m=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:i,pathLeft:c,pathRight:m}}makeInsideCorners(){const e=this.CORNER_RADIUS,t=kn("a","0 0,0",e,pt(-e,e)),i=kn("a","0 0,0",e,pt(e,e));return{width:e,height:e,pathTop:t,pathBottom:i}}makeOutsideCorners(){const e=this.CORNER_RADIUS,t=yn(0,e)+kn("a","0 0,1",e,pt(e,-e)),i=kn("a","0 0,1",e,pt(e,e)),s=kn("a","0 0,1",e,pt(-e,-e)),c=kn("a","0 0,1",e,pt(-e,e));return{topLeft:t,topRight:i,bottomRight:c,bottomLeft:s,rightHeight:e}}shapeFor(e){switch(e.type){case lt.INPUT_VALUE:case lt.OUTPUT_VALUE:return this.PUZZLE_TAB;case lt.PREVIOUS_STATEMENT:case lt.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}}createDom(e,t,i,s){this.injectCSS_(t,i),this.defs=ae(le.DEFS,{},e),e=ae(le.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs),ae(le.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},e),t=ae(le.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},e),ae(le.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},t),ae(le.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},e),ae(le.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},e),this.embossFilterId=e.id,this.embossFilter=e,e=ae(le.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs),ae(le.RECT,{width:10,height:10,fill:"#aaa"},e),ae(le.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},e),this.disabledPatternId=e.id,this.disabledPattern=e,this.createDebugFilter(),s&&(s.style.setProperty("--blocklyEmbossFilter",`url(#${this.embossFilterId})`),s.style.setProperty("--blocklyDisabledPattern",`url(#${this.disabledPatternId})`),s.style.setProperty("--blocklyDebugFilter",`url(#${this.debugFilterId})`))}createDebugFilter(){if(!this.debugFilter){const e=ae(le.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs),t=ae(le.FECOMPONENTTRANSFER,{result:"outBlur"},e);ae(le.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),ae(le.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},e),ae(le.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),this.debugFilterId=e.id,this.debugFilter=e}}injectCSS_(e,t){t=this.getCSS_(t),e="blockly-renderer-style-"+e,this.cssNode=document.getElementById(e);const i=t.join(`
`);this.cssNode?this.cssNode.firstChild.textContent=i:(t=document.createElement("style"),t.id=e,e=document.createTextNode(i),t.appendChild(e),document.head.insertBefore(t,document.head.firstChild),this.cssNode=t)}getCSS_(e){return[`${e} .blocklyText, `,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableField>rect,`,`${e} .blocklyEditableField>rect {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"fill-opacity: .6;","stroke: none;","}",`${e} .blocklyNonEditableField>text,`,`${e} .blocklyEditableField>text {`,"fill: #000;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #000;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #000;","}",`${e} .blocklyEditableField:not(.blocklyEditing):hover>rect {`,"stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"}",`${e} .blocklySelected>.blocklyPath {`,"stroke: #fc3;","stroke-width: 3px;","}",`${e} .blocklyHighlightedConnectionPath {`,"stroke: #fc3;","}",`${e} .blocklyReplaceable .blocklyPath {`,"fill-opacity: .5;","}",`${e} .blocklyReplaceable .blocklyPathLight,`,`${e} .blocklyReplaceable .blocklyPathDark {`,"display: none;","}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},we=class{constructor(e,t){this.inlinePath_=this.outlinePath_="",this.block_=e,this.info_=t,this.topLeft_=e.getRelativeToSurfaceXY(),this.constants_=t.getRenderer().getConstants()}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),this.block_.pathObject.setPath(this.outlinePath_+`
`+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),this.recordSizeOnBlock_()}recordSizeOnBlock_(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren,this.block_.childlessWidth=this.info_.width}drawOutline_(){this.drawTop_();for(let e=1;e<this.info_.rows.length-1;e++){const t=this.info_.rows[e];t.hasJaggedEdge?this.drawJaggedEdge_(t):t.hasStatement?this.drawStatementInput_(t):t.hasExternalInput?this.drawValueInput_(t):this.drawRightSideRow_(t)}this.drawBottom_(),this.drawLeft_()}drawTop_(){const e=this.info_.topRow,t=e.elements;this.positionPreviousConnection_(),this.outlinePath_+=yn(e.xPos,this.info_.startY);for(let i=0,s;s=t[i];i++)K.isLeftRoundedCorner(s)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:K.isRightRoundedCorner(s)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:K.isPreviousConnection(s)?this.outlinePath_+=s.shape.pathLeft:K.isHat(s)?this.outlinePath_+=this.constants_.START_HAT.path:K.isSpacer(s)&&(this.outlinePath_+=$t("h",s.width));this.outlinePath_+=$t("v",e.height-e.ascenderHeight)}drawJaggedEdge_(e){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+$t("v",e.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(e){const t=e.getLastInput();this.positionExternalValueConnection_(e);const i=fo(t.shape)?t.shape.pathDown(t.height):t.shape.pathDown;this.outlinePath_+=$t("H",t.xPos+t.width)+i+$t("v",e.height-t.connectionHeight)}drawStatementInput_(e){var t=e.getLastInput();if(t){var i=t.xPos+t.notchOffset+t.shape.width;t=t.shape.pathRight+$t("h",-(t.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var s=e.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=$t("H",i)+t+$t("v",s)+this.constants_.INSIDE_CORNERS.pathBottom+$t("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}}drawRightSideRow_(e){this.outlinePath_+=$t("V",e.yPos+e.height)}drawBottom_(){const e=this.info_.bottomRow,t=e.elements;this.positionNextConnection_();let i=0,s="";for(let c=t.length-1,m;m=t[c];c--)K.isNextConnection(m)?s+=m.shape.pathRight:K.isLeftSquareCorner(m)?s+=$t("H",e.xPos):K.isLeftRoundedCorner(m)?s+=this.constants_.OUTSIDE_CORNERS.bottomLeft:K.isRightRoundedCorner(m)?(s+=this.constants_.OUTSIDE_CORNERS.bottomRight,i=this.constants_.OUTSIDE_CORNERS.rightHeight):K.isSpacer(m)&&(s+=$t("h",m.width*-1));this.outlinePath_+=$t("V",e.baseline-i),this.outlinePath_+=s}drawLeft_(){var e=this.info_.outputConnection;if(this.positionOutputConnection_(),e){const t=e.connectionOffsetY+e.height;e=fo(e.shape)?e.shape.pathUp(e.height):e.shape.pathUp,this.outlinePath_+=$t("V",t)+e}this.outlinePath_+="z"}drawInternals_(){for(let e=0,t;t=this.info_.rows[e];e++)for(let i=0,s;s=t.elements[i];i++)K.isInlineInput(s)?this.drawInlineInput_(s):(K.isIcon(s)||K.isField(s))&&this.layoutField_(s)}layoutField_(e){const t=e.centerline-e.height/2;let i=e.xPos;var s="";this.info_.RTL&&(i=-(i+e.width),e.flipRtl&&(i+=e.width,s="scale(-1 1)")),K.isIcon(e)?(s=e.icon,s.setOffsetInBlock(new Ne(i,t)),this.info_.isInsertionMarker&&s.hideForInsertionMarker()):(e=e.field.getSvgRoot(),e.setAttribute("transform","translate("+i+","+t+")"+s),this.info_.isInsertionMarker&&e.setAttribute("display","none"))}drawInlineInput_(e){const t=e.width,i=e.height,s=e.connectionOffsetY,c=e.connectionHeight+s;this.inlinePath_+=Oi(e.xPos+e.connectionWidth,e.centerline-i/2)+$t("v",s)+e.shape.pathDown+$t("v",i-c)+$t("h",t-e.connectionWidth)+$t("v",-i)+"z",this.positionInlineInputConnection_(e)}positionInlineInputConnection_(e){const t=e.centerline-e.height/2;if(e.connectionModel){let i=e.xPos+e.connectionWidth+e.connectionOffsetX;this.info_.RTL&&(i*=-1),e.connectionModel.setOffsetInBlock(i,t+e.connectionOffsetY)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(t!=null&&t.connectionModel){let i=e.xPos+e.statementEdge+t.notchOffset;this.info_.RTL&&(i*=-1),t.connectionModel.setOffsetInBlock(i,e.yPos)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let i=e.xPos+e.width;this.info_.RTL&&(i*=-1),t.connectionModel.setOffsetInBlock(i,e.yPos)}}positionPreviousConnection_(){const e=this.info_.topRow;if(e.connection){const t=e.xPos+e.notchOffset;e.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-t:t,0)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,i=t.xPos;t.connectionModel.setOffsetInBlock(this.info_.RTL?-i:i,e.baseline)}}positionOutputConnection_(){if(this.info_.outputConnection){const e=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-e:e,this.info_.outputConnection.connectionOffsetY)}}updateConnectionHighlights(){for(const e of this.info_.rows)for(const t of e.elements){if(!(t instanceof o))continue;const i=this.drawConnectionHighlightPath(t);i&&(i.style.display=t.highlighted?"":"none")}}drawConnectionHighlightPath(e){const t=e.connectionModel;e=t.type===lt.INPUT_VALUE||t.type===lt.OUTPUT_VALUE?this.getExpressionConnectionHighlightPath(e):this.getStatementConnectionHighlightPath(e);const i=t.getSourceBlock();let s,c;return(c=(s=i.pathObject).addConnectionHighlight)==null?void 0:c.call(s,t,e,t.getOffsetInBlock(),i.RTL)}getExpressionConnectionHighlightPath(e){let t="";return fo(e.shape)?t=e.shape.pathDown(e.height):ri(e.shape)&&(t=e.shape.pathDown),e=this.constants_.TAB_OFFSET_FROM_TOP,yn(0,-e)+$t("v",e)+t+$t("v",e)}getStatementConnectionHighlightPath(e){if(!qc(e.shape))throw Error("Statement connections should have notch shapes");const t=this.constants_.NOTCH_OFFSET_LEFT-this.constants_.CORNER_RADIUS;return yn(-t,0)+$t("h",t)+e.shape.pathLeft+$t("h",t)}},bt=class{constructor(e,t){this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.startY=this.startX=0,this.renderer_=e,this.block_=t,this.constants_=this.renderer_.getConstants(),this.outputConnection=t.outputConnection?new me(this.constants_,t.outputConnection):null,this.isInline=t.getInputsInline()&&!t.isCollapsed(),this.isCollapsed=t.isCollapsed(),this.isInsertionMarker=t.isInsertionMarker(),this.RTL=t.RTL,this.topRow=new Q(this.constants_),this.bottomRow=new n(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let e=new fe(this.constants_);this.inputRows.push(e);var t=this.block_.getIcons();for(let i=0,s;s=t[i];i++){const c=new S(this.constants_,s);this.isCollapsed&&!s.isShownWhenCollapsed()||e.elements.push(c)}t=void 0;for(let i=0,s;s=this.block_.inputList[i];i++)if(s.isVisible()){this.shouldStartNewRow_(s,t)&&(this.rows.push(e),e=new fe(this.constants_),this.inputRows.push(e));for(let c=0,m;m=s.fieldRow[c];c++)e.elements.push(new f(this.constants_,m,s));this.addInput_(s,e),t=s}this.isCollapsed&&(e.hasJaggedEdge=!0,e.elements.push(new Ie(this.constants_))),(e.elements.length||e.hasDummyInput)&&this.rows.push(e),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateTopRow_(){var e=!!this.block_.previousConnection;const t=(this.block_.hat?this.block_.hat==="cap":this.constants_.ADD_START_HATS)&&!this.outputConnection&&!e;let i=this.topRow.hasLeftSquareCorner(this.block_)?cn:ct;this.topRow.elements.push(new i(this.constants_)),t?(e=new $(this.constants_),this.topRow.elements.push(e)):e&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new Ee(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.block_.inputList.length&&this.block_.inputList[0]instanceof Yo&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT,i=this.topRow.hasRightSquareCorner(this.block_)?cn:ct,this.topRow.elements.push(new i(this.constants_,"right"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof Yo?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new cn(this.constants_)):this.bottomRow.elements.push(new ct(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new Me(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new cn(this.constants_,"right")):this.bottomRow.elements.push(new ct(this.constants_,"right"))}addInput_(e,t){this.isInline&&e instanceof l.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new V(this.constants_,e)),t.hasInlineInput=!0):e instanceof Yo?(t.elements.push(new re(this.constants_,e)),t.hasStatement=!0):e instanceof l.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new u(this.constants_,e)),t.hasExternalInput=!0):(e instanceof Io||e instanceof cs)&&(t.minHeight=Math.max(t.minHeight,e.getSourceBlock()&&e.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),t.align===null&&(t.align=e.align)}shouldStartNewRow_(e,t){return t?t instanceof cs||e instanceof Yo||t instanceof Yo?!0:e instanceof l.ValueInput$$module$build$src$core$inputs$value_input||e instanceof Io||t instanceof l.ValueInput$$module$build$src$core$inputs$value_input?!this.isInline:!1:!1}addElemSpacing_(){for(let e=0,t;t=this.rows[e];e++){const i=t.elements;if(t.elements=[],t.startsWithElemSpacer()&&t.elements.push(new k(this.constants_,this.getInRowSpacing_(null,i[0]))),i.length){for(let s=0;s<i.length-1;s++){t.elements.push(i[s]);const c=this.getInRowSpacing_(i[s],i[s+1]);t.elements.push(new k(this.constants_,c))}t.elements.push(i[i.length-1]),t.endsWithElemSpacer()&&t.elements.push(new k(this.constants_,this.getInRowSpacing_(i[i.length-1],null)))}}}getInRowSpacing_(e,t){if(!e&&t&&K.isStatementInput(t))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(e&&K.isInput(e)&&!t){if(K.isExternalInput(e))return this.constants_.NO_PADDING;if(K.isInlineInput(e))return this.constants_.LARGE_PADDING;if(K.isStatementInput(e))return this.constants_.NO_PADDING}return e&&K.isLeftSquareCorner(e)&&t&&(K.isPreviousConnection(t)||K.isNextConnection(t))?t.notchOffset:e&&K.isLeftRoundedCorner(e)&&t&&(K.isPreviousConnection(t)||K.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:e&&K.isField(e)&&e.width===0?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING}computeBounds_(){let e=0,t=0,i=0;for(let c=0,m;m=this.rows[c];c++){if(m.measure(),t=Math.max(t,m.width),m.hasStatement){var s=m.getLastInput();let I,B;s=m.width-((B=(I=s)==null?void 0:I.width)!=null?B:0),e=Math.max(e,s)}i=Math.max(i,m.widthWithConnectedBlocks)}this.statementEdge=e,this.width=t;for(let c=0,m;m=this.rows[c];c++)m.hasStatement&&(m.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(t,i),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)}alignRowElements_(){for(let t=0,i;i=this.rows[t];t++)if(i.hasStatement)this.alignStatementRow_(i);else{var e=i.width;e=this.getDesiredRowWidth_(i)-e,e>0&&this.addAlignmentPadding_(i,e),K.isTopOrBottomRow(i)&&(i.widthWithConnectedBlocks=i.width)}}getDesiredRowWidth_(e){return this.width-this.startX}addAlignmentPadding_(e,t){const i=e.getFirstSpacer(),s=e.getLastSpacer();if((e.hasExternalInput||e.hasStatement)&&(e.widthWithConnectedBlocks+=t),e.align===l.Align$$module$build$src$core$inputs$align.LEFT&&s)s.width+=t;else if(e.align===l.Align$$module$build$src$core$inputs$align.CENTRE&&i&&s)i.width+=t/2,s.width+=t/2;else if(e.align===l.Align$$module$build$src$core$inputs$align.RIGHT&&i)i.width+=t;else if(s)s.width+=t;else return;e.width+=t}alignStatementRow_(e){const t=e.getLastInput();if(t){var i=e.width-t.width,s=this.statementEdge;i=s-i,i>0&&this.addAlignmentPadding_(e,i),i=e.width,s=this.getDesiredRowWidth_(e),t.width+=s-i,t.height=Math.max(t.height,e.height),e.width+=s-i,e.widthWithConnectedBlocks=Math.max(e.width,this.statementEdge+e.connectedBlockWidths)}}addRowSpacing_(){const e=this.rows;this.rows=[];for(let t=0;t<e.length;t++)this.rows.push(e[t]),t!==e.length-1&&this.rows.push(this.makeSpacerRow_(e[t],e[t+1]))}makeSpacerRow_(e,t){var i=this.getSpacerRowHeight_(e,t);const s=this.getSpacerRowWidth_(e,t);return i=new yt(this.constants_,i,s),e.hasStatement&&(i.followsStatement=!0),t.hasStatement&&(i.precedesStatement=!0),i}getSpacerRowWidth_(e,t){return this.width-this.startX}getSpacerRowHeight_(e,t){return this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){return K.isSpacer(t)?e.yPos+t.height/2:K.isBottomRow(e)?(e=e.yPos+e.height-e.descenderHeight,K.isNextConnection(t)?e+t.height/2:e-t.height/2):K.isTopRow(e)?K.isHat(t)?e.capline-t.height/2:e.capline+t.height/2:e.yPos+e.height/2}recordElemPositions_(e){let t=e.xPos;for(let i=0,s;s=e.elements[i];i++)K.isSpacer(s)&&(s.height=e.height),s.xPos=t,s.centerline=this.getElemCenterline_(e,s),t+=s.width}finalize_(){let e=0,t=0;for(let i=0,s;s=this.rows[i];i++)s.yPos=t,s.xPos=this.startX,t+=s.height,e=Math.max(e,s.widthWithConnectedBlocks),this.recordElemPositions_(s);if(this.outputConnection&&this.block_.nextConnection){const i=this.block_.nextConnection.targetBlock();i&&(e=Math.max(e,i.getHeightWidth().width))}this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline,this.bottomRow.baseline=t-this.bottomRow.descenderHeight}getMeasureableForConnection(e){let t;if(((t=this.outputConnection)==null?void 0:t.connectionModel)===e)return this.outputConnection;for(const i of this.rows)for(const s of i.elements)if(s instanceof o&&s.connectionModel===e)return s;return null}},Zt=class{constructor(e,t,i){this.connectionHighlights=new WeakMap,this.highlightOffsets=new WeakMap,this.constants=i,this.style=t,this.svgRoot=e,this.svgPath=ae(le.PATH,{class:"blocklyPath"},this.svgRoot),this.setClass_("blocklyBlock",!0)}setPath(e){this.svgPath.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)")}applyColour(e){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(e.isShadow()),this.updateDisabled_(!e.isEnabled()||e.getInheritedDisabled())}setStyle(e){this.style=e}setClass_(e,t){e&&(t?We(this.svgRoot,e):vt(this.svgRoot,e))}updateHighlighted(e){e?this.setClass_("blocklyHighlighted",!0):this.setClass_("blocklyHighlighted",!1)}updateShadow_(e){e?(this.setClass_("blocklyShadow",!0),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)):this.setClass_("blocklyShadow",!1)}updateDisabled_(e){this.setClass_("blocklyDisabled",e),this.setClass_("blocklyDisabledPattern",e)}updateSelected(e){this.setClass_("blocklySelected",e)}updateDraggingDelete(e){this.setClass_("blocklyDraggingDelete",e)}updateInsertionMarker(e){this.setClass_("blocklyInsertionMarker",e)}updateMovable(e){this.setClass_("blocklyDraggable",e)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,t){}addConnectionHighlight(e,t,i,s){return i=`translate(${i.x}, ${i.y})`+(s?" scale(-1 1)":""),(s=this.connectionHighlights.get(e))?(s.setAttribute("d",t),s.setAttribute("transform",i),s):(t=ae(le.PATH,{id:e.id,class:"blocklyHighlightedConnectionPath",style:"display: none;",d:t,transform:i},this.svgRoot),this.connectionHighlights.set(e,t),t)}removeConnectionHighlight(e){const t=this.connectionHighlights.get(e);t&&(Wt(t),this.connectionHighlights.delete(e))}},gt=class{constructor(e){this.overrides=null,this.name=e}getClassName(){return this.name+"-renderer"}init(e,t){this.constants_=this.makeConstants_(),t&&(this.overrides=t,Object.assign(this.constants_,t)),this.constants_.setTheme(e),this.constants_.init()}createDom(e,t,i){this.constants_.createDom(e,this.name+"-"+t.name,"."+this.getClassName()+"."+t.getClassName(),i)}refreshDom(e,t,i){const s=this.getConstants();s.dispose(),this.constants_=this.makeConstants_(),this.overrides&&Object.assign(this.constants_,this.overrides),this.constants_.randomIdentifier=s.randomIdentifier,this.constants_.setTheme(t),this.constants_.init(),this.createDom(e,t,i)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new he}makeRenderInfo_(e){return new bt(this,e)}makeDrawer_(e,t){return new we(e,t)}makePathObject(e,t){return new Zt(e,t,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(e){return!0}orphanCanConnectAtEnd(e,t,i){return!!Jt.getConnectionForOrphanedConnection(e,i===lt.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}render(e){const t=this.makeRenderInfo_(e);t.measure(),this.makeDrawer_(e,t).draw()}},ut={};ut.BottomRow=n,ut.Connection=o,ut.ConstantProvider=he,ut.Drawer=we,ut.ExternalValueInput=u,ut.Field=f,ut.Hat=$,ut.Icon=S,ut.InRowSpacer=k,ut.InlineInput=V,ut.InputConnection=r,ut.InputRow=fe,ut.JaggedEdge=Ie,ut.Measurable=Vr,ut.NextConnection=Me,ut.OutputConnection=me,ut.PathObject=Zt,ut.PreviousConnection=Ee,ut.RenderInfo=bt,ut.Renderer=gt,ut.RoundCorner=ct,ut.Row=hu,ut.SpacerRow=yt,ut.SquareCorner=cn,ut.StatementInput=re,ut.TopRow=Q,ut.Types=K,ut.init=$n,ut.register=rs,ut.unregister=xt;var Xt=class{constructor(e,t){this.workspace=e,this.theme=t,this.subscribedWorkspaces=[],this.componentDB=new Map}getTheme(){return this.theme}setTheme(e){var t=this.theme;this.theme=e,(e=this.workspace.getInjectionDiv())&&(t&&(t=t.getClassName())&&vt(e,t),(t=this.theme.getClassName())&&We(e,t));for(let i=0,s;s=this.subscribedWorkspaces[i];i++)s.refreshTheme();for(const[i,s]of this.componentDB)for(const c of s){e=c.element,t=c.propertyName;const m=this.theme&&this.theme.getComponentStyle(i);e.style.setProperty(t,m||"")}for(const i of this.subscribedWorkspaces)i.hideChaff()}subscribeWorkspace(e){this.subscribedWorkspaces.push(e)}unsubscribeWorkspace(e){if(!Te(this.subscribedWorkspaces,e))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")}subscribe(e,t,i){this.componentDB.has(t)||this.componentDB.set(t,[]),this.componentDB.get(t).push({element:e,propertyName:i}),t=this.theme&&this.theme.getComponentStyle(t),e.style.setProperty(i,t||"")}unsubscribe(e){if(e)for(const[t,i]of this.componentDB){for(let s=i.length-1;s>=0;s--)i[s].element===e&&i.splice(s,1);i.length||this.componentDB.delete(t)}}dispose(){this.subscribedWorkspaces.length=0,this.componentDB.clear()}},on="VARIABLE_DYNAMIC",Oo={CATEGORY_NAME:on};Oo.flyoutCategory=xa,Oo.flyoutCategoryBlocks=zl,Oo.internalFlyoutCategory=Sr,Oo.onCreateVariableButtonClick_Colour=ol,Oo.onCreateVariableButtonClick_Number=Gu,Oo.onCreateVariableButtonClick_String=ti;var hg=class{canConnect(e,t,i,s){return this.canConnectWithReason(e,t,i,s)===Jt.CAN_CONNECT}canConnectWithReason(e,t,i,s){const c=this.doSafetyChecks(e,t);return c!==Jt.CAN_CONNECT?c:this.doTypeChecks(e,t)?i&&!this.doDragChecks(e,t,s||0)?Jt.REASON_DRAG_CHECKS_FAILED:Jt.CAN_CONNECT:Jt.REASON_CHECKS_FAILED}getErrorMessage(e,t,i){switch(e){case Jt.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case Jt.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case Jt.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case Jt.REASON_TARGET_NULL:return"Target connection is null.";case Jt.REASON_CHECKS_FAILED:return"Connection checks failed. "+(t+" expected "+t.getCheck()+", found "+i.getCheck());case Jt.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case Jt.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case Jt.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}}doSafetyChecks(e,t){if(!e||!t)return Jt.REASON_TARGET_NULL;let i,s,c;return e.isSuperior()?(i=e.getSourceBlock(),s=t.getSourceBlock(),c=t):(s=e.getSourceBlock(),i=t.getSourceBlock(),c=e,e=t),i===s?Jt.REASON_SELF_CONNECTION:c.type!==aa[e.type]?Jt.REASON_WRONG_TYPE:i.workspace!==s.workspace?Jt.REASON_DIFFERENT_WORKSPACES:i.isShadow()&&!s.isShadow()?Jt.REASON_SHADOW_PARENT:c.type===lt.OUTPUT_VALUE&&s.previousConnection&&s.previousConnection.isConnected()||c.type===lt.PREVIOUS_STATEMENT&&s.outputConnection&&s.outputConnection.isConnected()?Jt.REASON_PREVIOUS_AND_OUTPUT:Jt.CAN_CONNECT}doTypeChecks(e,t){if(e=e.getCheck(),t=t.getCheck(),!e||!t)return!0;for(let i=0;i<e.length;i++)if(t.includes(e[i]))return!0;return!1}doDragChecks(e,t,i){if(e.distanceFrom(t)>i||t.getSourceBlock().isInsertionMarker())return!1;switch(t.type){case lt.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(e,t);case lt.OUTPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isInsertionMarker()||e.isConnected())return!1;break;case lt.INPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;case lt.NEXT_STATEMENT:if(t.isConnected()&&!e.getSourceBlock().nextConnection&&!t.targetBlock().isShadow()&&t.targetBlock().nextConnection||t.targetBlock()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;default:return!1}return!Xu.includes(t)}canConnectToPrevious_(e,t){return e.targetConnection||Xu.includes(t)?!1:t.targetConnection?(e=t.targetBlock(),e.isInsertionMarker()?!e.getPreviousBlock():!1):!0}};a(Re.CONNECTION_CHECKER,Po,hg);var uf=class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(e){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=!1,this.MAX_UNDO=1024,this.connectionDBList=[],this.topBlocks=[],this.topComments=[],this.commentDB=new Map,this.listeners=[],this.undoStack_=[],this.redoStack_=[],this.blockDB=new Map,this.typedBlocksDB=new Map,this.procedureMap=new da,this.readOnly=!1,this.potentialVariableMap=null,this.id=ot(),qt(this),this.options=e||new qs({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(D(Re.CONNECTION_CHECKER,this.options,!0))(this),this.variableMap=new(this.getVariableMapClass())(this),this.setIsReadOnly(this.options.readOnly)}dispose(){this.listeners.length=0,this.clear(),Yn(this)}sortObjects(e,t){const i=s=>({getBoundingRectangle:()=>{const c=s.getRelativeToSurfaceXY();return new Nt(c.y,c.y,c.x,c.x)},moveBy:()=>{}});return this.sortByOrigin(i(e),i(t))}sortByOrigin(e,t){const i=Math.sin(kl(uf.SCAN_ANGLE))*(this.RTL?-1:1);return e=e.getBoundingRectangle().getOrigin(),t=t.getBoundingRectangle().getOrigin(),e.y+i*e.x-(t.y+i*t.x)}addTopBlock(e){this.topBlocks.push(e)}removeTopBlock(e){if(!Te(this.topBlocks,e))throw Error("Block not present in workspace's list of top-most blocks.")}getTopBlocks(e=!1){const t=[].concat(this.topBlocks);return e&&t.length>1&&t.sort(this.sortObjects.bind(this)),t}addTypedBlock(e){this.typedBlocksDB.has(e.type)||this.typedBlocksDB.set(e.type,[]),this.typedBlocksDB.get(e.type).push(e)}removeTypedBlock(e){Te(this.typedBlocksDB.get(e.type),e),this.typedBlocksDB.get(e.type).length||this.typedBlocksDB.delete(e.type)}getBlocksByType(e,t=!1){return this.typedBlocksDB.has(e)?(e=this.typedBlocksDB.get(e).slice(0),t&&e&&e.length>1&&e.sort(this.sortObjects.bind(this)),e.filter(i=>!i.isInsertionMarker())):[]}addTopComment(e){this.topComments.push(e),this.commentDB.has(e.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+e.id+'"'),this.commentDB.set(e.id,e)}removeTopComment(e){if(!Te(this.topComments,e))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB.delete(e.id)}getTopComments(e=!1){const t=[].concat(this.topComments);return e&&t.length>1&&t.sort(this.sortObjects.bind(this)),t}getAllBlocks(e=!1){if(e){var t=this.getTopBlocks(!0);e=[];for(let i=0;i<t.length;i++)e.push(...t[i].getDescendants(!0))}else for(e=this.getTopBlocks(!1),t=0;t<e.length;t++)e.push(...e[t].getChildren(!1));return e.filter(i=>!i.isInsertionMarker())}clear(){this.isClearing=!0;try{const e=l.getGroup$$module$build$src$core$events$utils();for(e||l.setGroup$$module$build$src$core$events$utils(!0);this.topBlocks.length;)this.topBlocks[0].dispose(!1);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();l.setGroup$$module$build$src$core$events$utils(e),this.isFlyout||this.variableMap.clear(),this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=!1}}renameVariableById(e,t){gn("Blockly.Workspace.renameVariableById","v12","v13","Blockly.Workspace.getVariableMap().renameVariable"),(e=this.variableMap.getVariableById(e))&&this.variableMap.renameVariable(e,t)}createVariable(e,t,i){return gn("Blockly.Workspace.createVariable","v12","v13","Blockly.Workspace.getVariableMap().createVariable"),this.variableMap.createVariable(e,t??void 0,i??void 0)}getVariableUsesById(e){return gn("Blockly.Workspace.getVariableUsesById","v12","v13","Blockly.Variables.getVariableUsesById"),Es(this,e)}deleteVariableById(e){gn("Blockly.Workspace.deleteVariableById","v12","v13","Blockly.Workspace.getVariableMap().deleteVariable");const t=this.variableMap.getVariableById(e);t?l.deleteVariable$$module$build$src$core$variables(this,t):console.warn(`Can't delete non-existent variable: ${e}`)}getVariable(e,t){return gn("Blockly.Workspace.getVariable","v12","v13","Blockly.Workspace.getVariableMap().getVariable"),this.variableMap.getVariable(e,t)}getVariableById(e){return gn("Blockly.Workspace.getVariableById","v12","v13","Blockly.Workspace.getVariableMap().getVariableById"),this.variableMap.getVariableById(e)}getVariablesOfType(e){return gn("Blockly.Workspace.getVariablesOfType","v12","v13","Blockly.Workspace.getVariableMap().getVariablesOfType"),this.variableMap.getVariablesOfType(e??"")}getAllVariables(){return gn("Blockly.Workspace.getAllVariables","v12","v13","Blockly.Workspace.getVariableMap().getAllVariables"),this.variableMap.getAllVariables()}getAllVariableNames(){return gn("Blockly.Workspace.getAllVariableNames","v12","v13","Blockly.Workspace.getVariableMap().getAllVariables"),this.variableMap.getAllVariables().map(e=>e.getName())}getWidth(){return 0}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(e){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}remainingCapacity(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length}remainingCapacityOfType(e){return this.options.maxInstances?(this.options.maxInstances[e]!==void 0?this.options.maxInstances[e]:1/0)-this.getBlocksByType(e,!1).length:1/0}isCapacityAvailable(e){if(!this.hasBlockLimits())return!0;let t=0;for(const i in e){if(e[i]>this.remainingCapacityOfType(i))return!1;t+=e[i]}return!(t>this.remainingCapacity())}hasBlockLimits(){return this.options.maxBlocks!==1/0||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(e){var t=e?this.redoStack_:this.undoStack_,i=e?this.undoStack_:this.redoStack_;const s=t.pop();if(s){for(var c=[s];t.length&&s.group&&s.group===t[t.length-1].group;){const m=t.pop();m&&c.push(m)}for(t=0;t<c.length;t++)i.push(c[t]);l.setRecordUndo$$module$build$src$core$events$utils(!1);try{for(i=0;i<c.length;i++)c[i].run(e)}finally{l.setRecordUndo$$module$build$src$core$events$utils(!0)}}}clearUndo(){this.undoStack_.length=0,this.redoStack_.length=0,Et()}addChangeListener(e){return this.listeners.push(e),e}removeChangeListener(e){Te(this.listeners,e)}fireChangeListener(e){if(e.recordUndo)for(this.undoStack_.push(e),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&this.MAX_UNDO>=0;)this.undoStack_.shift();for(let t=0;t<this.listeners.length;t++)(0,this.listeners[t])(e)}getBlockById(e){return this.blockDB.get(e)||null}setBlockById(e,t){this.blockDB.set(e,t)}removeBlockById(e){this.blockDB.delete(e)}getCommentById(e){let t;return(t=this.commentDB.get(e))!=null?t:null}allInputsFilled(e){const t=this.getTopBlocks(!1);for(let i=0;i<t.length;i++)if(!t[i].allInputsFilled(e))return!1;return!0}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new(this.getVariableMapClass())(this,!0)}getVariableMap(){return this.variableMap}setVariableMap(e){this.variableMap=e}getProcedureMap(){return this.procedureMap}getRootWorkspace(){let e=null;const t=this.options.parentWorkspace;return this.isFlyout?t&&t.options&&(e=t.options.parentWorkspace):t&&(e=t),e}static getById(e){return sn(e)}static getAll(){return Xn()}getVariableMapClass(){const e=D(Re.VARIABLE_MAP,this.options,!0);if(!e)throw Error("No variable map is registered.");return e}isReadOnly(){return this.readOnly}setIsReadOnly(e){this.readOnly=e,this.options.readOnly=e}};uf.SCAN_ANGLE=3;var am=100,Jg=class{constructor(e){this.parentWorkspace=e,this.sounds=new Map,this.lastSound=null,this.muted=!1}dispose(){this.sounds.clear()}load(e,t){if(e.length){try{var i=new globalThis.Audio}catch{return}for(let c=0;c<e.length;c++){const m=e[c],I=m.match(/\.(\w+)$/);if(I&&i.canPlayType("audio/"+I[1])){var s=new globalThis.Audio(m);break}}s&&this.sounds.set(t,s)}}preload(){for(const e of this.sounds.values()){e.volume=.01;const t=e.play();if(t!==void 0?t.then(e.pause).catch(function(){}):e.pause(),Ka||Ff)break}}play(e,t){if(!this.muted){var i=this.sounds.get(e);i?(e=new Date,this.lastSound!==null&&e.getTime()-this.lastSound.getTime()<am||(this.lastSound=e,i=Ka||yd?i:i.cloneNode(),i.volume=t===void 0?1:t,i.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(e,t)}}setMuted(e){this.muted=e}getMuted(){return this.muted}},cm=20,Ko=class extends uf{constructor(e){super(e),this.resizeHandlerWrapper=null,this.resizesEnabled=this.visible=this.rendered=!0,this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0,this.oldScale=this.scale=1,this.oldLeft=this.oldTop=0,this.inverseScreenCTM=this.targetWorkspace=this.dummyWheelListener=this.configureContextMenu=this.lastRecordedPageScroll=this.injectionDiv=this.currentGesture_=this.toolbox=this.flyout=this.scrollbar=this.trashcan=null,this.inverseScreenCTMDirty=!0,this.highlightedBlocks=[],this.toolboxCategoryCallbacks=new Map,this.flyoutButtonCallbacks=new Map,this.cachedParentSvg=null,this.keyboardMoveInProgress=this.keyboardAccessibilityMode=!1,this.topBoundedElements=[],this.dragTargetAreas=[],this.zoomControls_=this.layerManager=null,this.navigator=new wh,this.metricsManager=new(D(Re.METRICS_MANAGER,e,!0))(this),this.getMetrics=e.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager),this.setMetrics=e.setMetrics||Ko.setTopLevelWorkspaceMetrics,this.componentManager=new un,this.connectionDBList=$l.init(this.connectionChecker),this.audioManager=new Jg(e.parentWorkspace),this.grid=this.options.gridPattern?new vc(this.options.gridPattern,e.gridOptions):null,this.markerManager=new Sc(this),Jn&&_s&&this.registerToolboxCategoryCallback(gh,_s),Oo&&Sr&&this.registerToolboxCategoryCallback(on,Sr),Xi&&Da&&(this.registerToolboxCategoryCallback(Mh,Da),this.addChangeListener(yr)),this.addChangeListener(this.variableChangeCallback.bind(this)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new Xt(this,this.options.theme||Ih),this.themeManager_.subscribeWorkspace(this);let t;this.renderer=$n(this.options.renderer||"geras",this.getTheme(),(t=this.options.rendererOverrides)!=null?t:void 0),this.cachedParentSvgSize=new Mt(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(e){this.metricsManager=e,this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}getMarker(e){return this.markerManager.getMarker(e)}getCursor(){return this.markerManager.getCursor()}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(e){e||(e=Ih),this.themeManager_.setTheme(e)}refreshTheme(){if(this.svgGroup_){var e=this.options.parentWorkspace===null;this.renderer.refreshDom(this.svgGroup_,this.getTheme(),e?this.getInjectionDiv():void 0)}this.updateBlockStyles(this.getAllBlocks(!1).filter(t=>!!t.getStyleName())),this.refreshToolboxSelection(),this.toolbox&&this.toolbox.refreshTheme(),this.isVisible()&&this.setVisible(!0),e=new(Qe(ce.THEME_CHANGE))(this.getTheme().name,this.id),Be(e)}updateBlockStyles(e){for(let t=0,i;i=e[t];t++){const s=i.getStyleName();s&&i.setStyle(s)}}getInverseScreenCTM(){if(this.inverseScreenCTMDirty){const e=this.getParentSvg().getScreenCTM();e&&(this.inverseScreenCTM=e.inverse(),this.inverseScreenCTMDirty=!1)}return this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=!0}isVisible(){return this.visible}getSvgXY(e){let t=0,i=0,s=1;(this.getCanvas().contains(e)||this.getBubbleCanvas().contains(e))&&(s=this.scale);do{const c=Li(e);(e===this.getCanvas()||e===this.getBubbleCanvas())&&(s=1),t+=c.x*s,i+=c.y*s,e=e.parentNode}while(e&&e!==this.getParentSvg()&&e!==this.getInjectionDiv());return new Ne(t,i)}getCachedParentSvgSize(){const e=this.cachedParentSvgSize;return new Mt(e.width,e.height)}getOriginOffsetInPixels(){return Tn(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let e=this.svgGroup_;for(;e;){if((" "+(e.getAttribute("class")||"")+" ").includes(" injectionDiv ")){this.injectionDiv=e;break}e=e.parentNode}}return this.injectionDiv}getSvgGroup(){return this.svgGroup_}getBlockCanvas(){return this.getCanvas()}setResizeHandlerWrapper(e){this.resizeHandlerWrapper=e}createDom(e,t){return this.injectionDiv||(this.injectionDiv=t??null),this.svgGroup_=ae(le.G,{class:"blocklyWorkspace",id:this.id}),t&&It(this.svgGroup_,Wn.LABEL,l.Msg$$module$build$src$core$msg.WORKSPACE_ARIA_LABEL),e&&(this.svgBackground_=ae(le.RECT,{height:"100%",width:"100%",class:e},this.svgGroup_),e==="blocklyMainBackground"&&this.grid?this.svgBackground_.style.fill="var(--blocklyGridPattern)":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.layerManager=new ag(this),this.svgBlockCanvas_=this.layerManager.getBlockLayer(),this.svgBubbleCanvas_=this.layerManager.getBubbleLayer(),this.isFlyout||(_e(this.svgGroup_,"pointerdown",this,this.onMouseDown,!1),this.dummyWheelListener=()=>{},document.body.addEventListener("wheel",this.dummyWheelListener),_e(this.svgGroup_,"wheel",this,this.onMouseWheel)),this.options.hasCategories&&(this.toolbox=new(D(Re.TOOLBOX,this.options,!0))(this)),this.grid&&this.grid.update(this.scale),this.recordDragTargets(),(e=D(Re.CURSOR,this.options))&&this.markerManager.setCursor(new e(this)),e=this.options.parentWorkspace===null,this.renderer.createDom(this.svgGroup_,this.getTheme(),e?this.getInjectionDiv():void 0),l.getFocusManager$$module$build$src$core$focus_manager().registerTree(this,!!this.injectionDiv||this.isFlyout),this.svgGroup_}dispose(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&Wt(this.svgGroup_),this.toolbox&&(this.toolbox.dispose(),this.toolbox=null),this.flyout&&(this.flyout.dispose(),this.flyout=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&this.zoomControls_.dispose(),this.audioManager&&this.audioManager.dispose(),this.grid&&(this.grid=null),this.renderer.dispose(),this.markerManager.dispose(),super.dispose(),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose()),this.connectionDBList.length=0,this.toolboxCategoryCallbacks.clear(),this.flyoutButtonCallbacks.clear(),!this.options.parentWorkspace){const e=this.getParentSvg();e&&e.parentNode&&Wt(e.parentNode)}this.resizeHandlerWrapper&&(Ae(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null),this.dummyWheelListener&&(document.body.removeEventListener("wheel",this.dummyWheelListener),this.dummyWheelListener=null),l.getFocusManager$$module$build$src$core$focus_manager().isRegistered(this)&&l.getFocusManager$$module$build$src$core$focus_manager().unregisterTree(this)}addTrashcan(){this.trashcan=Ko.newTrashcan(this);const e=this.trashcan.createDom();this.svgGroup_.insertBefore(e,this.getCanvas())}static newTrashcan(e){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts")}addZoomControls(){this.zoomControls_=new Mr(this);const e=this.zoomControls_.createDom();this.svgGroup_.appendChild(e)}copyOptionsForFlyout(){return new qs({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,plugins:this.options.plugins,modalInputs:this.options.modalInputs,move:{scrollbars:!0}})}addFlyout(e){const t=this.copyOptionsForFlyout();return t.toolboxPosition=this.options.toolboxPosition,this.flyout=this.horizontalLayout?new(D(Re.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(t):new(D(Re.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(t),this.flyout.autoClose=!1,this.flyout.getWorkspace().setVisible(!0),this.flyout.createDom(e)}getFlyout(e){return this.flyout||e?this.flyout:this.toolbox?this.toolbox.getFlyout():null}getToolbox(){return this.toolbox}updateScreenCalculations(){this.updateInverseScreenCTM(),this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox?this.toolbox.position():this.flyout&&this.flyout.position();const e=this.componentManager.getComponents(un.Capability.POSITIONABLE,!0),t=this.getMetricsManager().getUiMetrics(),i=[];for(let s=0,c;c=e[s];s++){c.position(t,i);const m=c.getBoundingRectangle();m&&i.push(m)}this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations()}updateScreenCalculationsIfScrolled(){const e=qi();Ne.equals(this.lastRecordedPageScroll,e)||(this.lastRecordedPageScroll=e,this.updateScreenCalculations())}getLayerManager(){return this.layerManager}getCanvas(){return this.layerManager.getBlockLayer()}setCachedParentSvgSize(e,t){const i=this.getParentSvg();e!=null&&(this.cachedParentSvgSize.width=e,i.setAttribute("data-cached-width",`${e}`)),t!=null&&(this.cachedParentSvgSize.height=t,i.setAttribute("data-cached-height",`${t}`))}getBubbleCanvas(){return this.layerManager.getBubbleLayer()}getParentSvg(){if(!this.cachedParentSvg){let e=this.svgGroup_;for(;e;){if(e.tagName==="svg"){this.cachedParentSvg=e;break}e=e.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){if(Ze()){var e=this.scale,t=-this.scrollY,i=-this.scrollX;if(!(e===this.oldScale&&Math.abs(t-this.oldTop)<1&&Math.abs(i-this.oldLeft)<1)){var s=new(Qe(ce.VIEWPORT_CHANGE))(t,i,e,this.id,this.oldScale);this.oldScale=e,this.oldTop=t,this.oldLeft=i,Be(s)}}}translate(e,t){let i;(i=this.layerManager)==null||i.translateLayers(new Ne(e,t),this.scale);let s;(s=this.grid)==null||s.moveTo(e,t),this.maybeFireViewportChangeEvent()}getWidth(){const e=this.getMetrics();return e?e.viewWidth/this.scale:0}setVisible(e){this.visible=e,this.svgGroup_&&(this.scrollbar&&this.scrollbar.setContainerVisible(e),this.getFlyout()&&this.getFlyout().setContainerVisible(e),this.getParentSvg().style.display=e?"block":"none",this.toolbox&&this.toolbox.setVisible(e),e||this.hideChaff(!0))}render(){const e=this.getAllBlocks(!1);for(let t=e.length-1;t>=0;t--)e[t].queueRender();this.getTopBlocks().flatMap(t=>t.getDescendants(!1)).filter(t=>t.isInsertionMarker()).forEach(t=>t.queueRender())}highlightBlock(e,t){if(t===void 0){for(let i=0,s;s=this.highlightedBlocks[i];i++)s.setHighlighted(!1);this.highlightedBlocks.length=0}(e=e?this.getBlockById(e):null)&&((t=t===void 0||t)?this.highlightedBlocks.includes(e)||this.highlightedBlocks.push(e):Te(this.highlightedBlocks,e),e.setHighlighted(t))}variableChangeCallback(e){switch(e.type){case ce.VAR_CREATE:case ce.VAR_DELETE:case ce.VAR_RENAME:case ce.VAR_TYPE_CHANGE:this.refreshToolboxSelection()}}refreshToolboxSelection(){const e=this.isFlyout?this.targetWorkspace:this;e&&!e.currentGesture_&&e.toolbox&&e.toolbox.getFlyout()&&e.toolbox.refreshSelection()}recordDragTargets(){const e=this.componentManager.getComponents(un.Capability.DRAG_TARGET,!0);this.dragTargetAreas=[];for(let t=0,i;i=e[t];t++){const s=i.getClientRect();s&&this.dragTargetAreas.push({component:i,clientRect:s})}}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(e){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}getDragTarget(e){for(let t=0,i;i=this.dragTargetAreas[t];t++)if(i.clientRect.contains(e.clientX,e.clientY))return i.component;return null}onMouseDown(e){const t=this.getGesture(e);t&&t.handleWsStart(e,this)}startDrag(e,t){vo(this,e,t)}moveDrag(e){return yo(this,e)}setKeyboardMoveInProgress(e){this.keyboardMoveInProgress=e}isDragging(){return this.keyboardMoveInProgress||this.currentGesture_!==null&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollHorizontally())}isMovableVertically(){const e=!!this.scrollbar;return this.isMovable()&&(!e||e&&this.scrollbar.canScrollVertically())}onMouseWheel(e){if(kh.inProgress())e.preventDefault(),e.stopPropagation();else{var t=this.options.zoomOptions&&this.options.zoomOptions.wheel,i=this.options.moveOptions&&this.options.moveOptions.wheel;if(t||i){var s=at(e);if(Sd)var c=e.metaKey;t&&(e.ctrlKey||c||!i)?(s=-s.y/50,t=xe(e,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(t.x,t.y,s)):(t=this.scrollX-s.x,i=this.scrollY-s.y,e.shiftKey&&!s.x&&(t=this.scrollX-s.y,i=this.scrollY),this.scroll(t,i)),e.preventDefault()}}}getBlocksBoundingBox(){const e=this.getTopBoundedElements();if(!e.length)return new Nt(0,0,0,0);const t=e[0].getBoundingRectangle();for(let s=1;s<e.length;s++){var i=e[s];i.isInsertionMarker&&i.isInsertionMarker()||(i=i.getBoundingRectangle(),i.top<t.top&&(t.top=i.top),i.bottom>t.bottom&&(t.bottom=i.bottom),i.left<t.left&&(t.left=i.left),i.right>t.right&&(t.right=i.right))}return t}cleanUp(){this.setResizesEnabled(!1);const e=l.getGroup$$module$build$src$core$events$utils();e||l.setGroup$$module$build$src$core$events$utils(!0);var t=this.getTopBlocks(!0),i=t.filter(I=>I.isMovable());const s=t.filter(I=>!I.isMovable()).map(I=>I.getBoundingRectangle());t=function(I){for(const B of s)if(I.intersects(B))return B;return null};var c=0;const m=this.renderer.getConstants().MIN_BLOCK_HEIGHT;for(const I of i){for(i=I.getBoundingRectangle(),I.moveBy(-i.left,c-i.top,["cleanup"]),I.snapToGrid(),i=I.getBoundingRectangle(),c=t(i);c!=null;)c=c.top+c.getHeight()+m,I.moveBy(0,c-i.top,["cleanup"]),I.snapToGrid(),i=I.getBoundingRectangle(),c=t(i);c=I.getRelativeToSurfaceXY().y+I.getHeightWidth().height+m}l.setGroup$$module$build$src$core$events$utils(e),this.setResizesEnabled(!0)}showContextMenu(e){if(!this.isReadOnly()&&!this.isFlyout){var t=Dt.registry.getContextMenuOptions({workspace:this,focusedNode:this},e);this.configureContextMenu&&this.configureContextMenu(t,e);var i=e instanceof PointerEvent?new Ne(e.clientX,e.clientY):vl(this,new Ne(5,5));Nu(e,t,this.RTL,this,i)}}updateToolbox(e){if(e=zr(e)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(lo(e)){if(!this.toolbox)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=e,this.toolbox.render(e)}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=e,this.flyout.show(e)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(L(this),this.getParentSvg().focus({preventScroll:!0}))}zoom(e,t,i){i=Math.pow(this.options.zoomOptions.scaleSpeed,i);const s=this.scale*i;if(this.scale!==s){s>this.options.zoomOptions.maxScale?i=this.options.zoomOptions.maxScale/this.scale:s<this.options.zoomOptions.minScale&&(i=this.options.zoomOptions.minScale/this.scale);var c=this.getCanvas().getCTM(),m=this.getParentSvg().createSVGPoint();m.x=e,m.y=t,m=m.matrixTransform(c.inverse()),e=m.x,t=m.y,c=c.translate(e*(1-i),t*(1-i)).scale(i),this.scrollX=c.e,this.scrollY=c.f,this.setScale(s)}}zoomCenter(e){var t=this.getMetrics();let i;this.flyout?(i=t.svgWidth?t.svgWidth/2:0,t=t.svgHeight?t.svgHeight/2:0):(i=t.viewWidth/2+t.absoluteLeft,t=t.viewHeight/2+t.absoluteTop),this.zoom(i,t,e)}zoomToFit(){if(this.isMovable()){var e=this.getMetrics(),t=e.viewWidth;e=e.viewHeight;var i=this.getBlocksBoundingBox(),s=cm*2,c=i.right-i.left+s;if(i=i.bottom-i.top+s,c){this.flyout&&(this.horizontalLayout?(e+=this.flyout.getHeight(),i+=this.flyout.getHeight()/this.scale):(t+=this.flyout.getWidth(),c+=this.flyout.getWidth()/this.scale)),t/=c,e/=i,l.disable$$module$build$src$core$events$utils();try{this.setScale(Math.min(t,e)),this.scrollCenter()}finally{l.enable$$module$build$src$core$events$utils()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}beginCanvasTransition(){We(this.getCanvas(),"blocklyCanvasTransitioning"),We(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}endCanvasTransition(){vt(this.getCanvas(),"blocklyCanvasTransitioning"),vt(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}scrollCenter(){if(this.isMovable()){var e=this.getMetrics(),t=(e.scrollWidth-e.viewWidth)/2,i=(e.scrollHeight-e.viewHeight)/2;t=-t-e.scrollLeft,i=-i-e.scrollTop,this.scroll(t,i)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}centerOnBlock(e,t){if(this.isMovable()){var i=e?this.getBlockById(e):null;if(i){e=i.getRelativeToSurfaceXY(),i=t?{height:i.height,width:i.width}:i.getHeightWidth();var s=this.scale;t=(e.x+(this.RTL?-1:1)*i.width/2)*s,e=(e.y+i.height/2)*s,i=this.getMetrics(),this.scroll(-(t-i.viewWidth/2),-(e-i.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}setScale(e){this.options.zoomOptions.maxScale&&e>this.options.zoomOptions.maxScale?e=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&e<this.options.zoomOptions.minScale&&(e=this.options.zoomOptions.minScale),this.scale=e,this.hideChaff(!1),(e=this.getFlyout(!1))&&e.isVisible()&&(e.reflow(),this.recordDragTargets()),this.grid&&this.grid.update(this.scale),e=this.getMetrics(),this.scrollX-=e.absoluteLeft,this.scrollY-=e.absoluteTop,e.viewLeft+=e.absoluteLeft,e.viewTop+=e.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout?this.scrollbar.resizeView(e):this.scrollbar.resizeContent(e))}getScale(){return this.scale}getAbsoluteScale(){const e=i=>{if(i.isFlyout){let s;const c=(s=i.targetWorkspace)==null?void 0:s.getFlyout();if(c instanceof cu)return c.getFlyoutScale()}return i.getScale()},t=(i,s)=>i.options.parentWorkspace&&i.options.parentWorkspace.getSvgGroup().contains(i.getSvgGroup())?t(i.options.parentWorkspace,s*e(i)):s*e(i);return t(this,1)}scroll(e,t){this.hideChaff(!0);const i=this.getMetrics();e=Math.min(e,-i.scrollLeft),t=Math.min(t,-i.scrollTop);const s=i.scrollTop+Math.max(0,i.scrollHeight-i.viewHeight);e=Math.max(e,-(i.scrollLeft+Math.max(0,i.scrollWidth-i.viewWidth))),t=Math.max(t,-s),this.scrollX=e,this.scrollY=t,this.scrollbar&&this.scrollbar.set(-(e+i.scrollLeft),-(t+i.scrollTop),!1),e+=i.absoluteLeft,t+=i.absoluteTop,this.translate(e,t)}getBlockById(e){return super.getBlockById(e)}getAllBlocks(e=!1){return super.getAllBlocks(e)}getTopBlocks(e=!1){return super.getTopBlocks(e)}addTopBlock(e){this.addTopBoundedElement(e),super.addTopBlock(e)}removeTopBlock(e){this.removeTopBoundedElement(e),super.removeTopBlock(e)}addTopComment(e){this.addTopBoundedElement(e),super.addTopComment(e)}removeTopComment(e){this.removeTopBoundedElement(e),super.removeTopComment(e)}getTopComments(e=!1){return super.getTopComments(e)}getCommentById(e){return super.getCommentById(e)}getRootWorkspace(){return super.getRootWorkspace()}addTopBoundedElement(e){this.topBoundedElements.push(e)}removeTopBoundedElement(e){Te(this.topBoundedElements,e)}getTopBoundedElements(e=!1){const t=[].concat(this.topBoundedElements);return e&&t.sort(this.sortByOrigin.bind(this)),t}setResizesEnabled(e){const t=!this.resizesEnabled&&e;this.resizesEnabled=e,t&&this.resizeContents()}clear(){this.setResizesEnabled(!1),super.clear(),this.topBoundedElements=[],this.setResizesEnabled(!0)}registerButtonCallback(e,t){if(typeof t!="function")throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(e,t)}getButtonCallback(e){let t;return(t=this.flyoutButtonCallbacks.get(e))!=null?t:null}removeButtonCallback(e){this.flyoutButtonCallbacks.delete(e)}registerToolboxCategoryCallback(e,t){if(typeof t!="function")throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(e,t)}getToolboxCategoryCallback(e){return this.toolboxCategoryCallbacks.get(e)||null}removeToolboxCategoryCallback(e){this.toolboxCategoryCallbacks.delete(e)}getGesture(e){if(this.keyboardMoveInProgress)return e.preventDefault(),e.stopPropagation(),null;const t=e.type==="pointerdown";let i;return t&&((i=this.currentGesture_)!=null&&i.hasStarted())&&(console.warn("Tried to start the same gesture twice."),this.currentGesture_.cancel()),!this.currentGesture_&&t&&(this.currentGesture_=new kh(e,this)),this.currentGesture_}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(e=!1){W(),Bi(this),Ts(),this.hideComponents(e)}hideComponents(e=!1){this.getComponentManager().getComponents(un.Capability.AUTOHIDEABLE,!0).forEach(t=>t.autoHide(e))}static setTopLevelWorkspaceMetrics(e){const t=this.getMetrics();typeof e.x=="number"&&(this.scrollX=-(t.scrollLeft+(t.scrollWidth-t.viewWidth)*e.x)),typeof e.y=="number"&&(this.scrollY=-(t.scrollTop+(t.scrollHeight-t.viewHeight)*e.y)),this.translate(this.scrollX+t.absoluteLeft,this.scrollY+t.absoluteTop)}addClass(e){this.injectionDiv&&We(this.injectionDiv,e)}removeClass(e){this.injectionDiv&&vt(this.injectionDiv,e)}setIsReadOnly(e){super.setIsReadOnly(e),e?this.addClass("blocklyReadOnly"):this.removeClass("blocklyReadOnly")}scrollBoundsIntoView(e,t=10){if(!kh.inProgress()){var i=this.getScale(),s=this.getMetricsManager().getViewMetrics(!0);if(s=new Nt(s.top,s.top+s.height,s.left,s.left+s.width),!(e.left>=s.left&&e.top>=s.top&&e.right<=s.right&&e.bottom<=s.bottom)){e=e.clone(),e.top-=t,e.bottom+=t,e.left-=t,e.right+=t;var c=t=0;e.left<s.left?t=this.RTL?Math.min(s.left-e.left,s.right-e.right):s.left-e.left:e.right>s.right&&(t=this.RTL?s.right-e.right:Math.max(s.right-e.right,s.left-e.left)),e.top<s.top?c=s.top-e.top:e.bottom>s.bottom&&(c=Math.max(s.bottom-e.bottom,s.top-e.top)),this.scroll(this.scrollX+t*i,this.scrollY+c*i)}}}getFocusableElement(){return this.svgGroup_}getFocusableTree(){return this.isMutator&&this.options.parentWorkspace||this}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getRootFocusableNode(){return this}getRestoredFocusableNode(e){if(e)return null;let t;if(e=(t=this.targetWorkspace)==null?void 0:t.getFlyout(),this.isFlyout&&e){let s,c;return(c=(s=e.getContents().find(m=>(m=m.getElement(),Zn(m)&&m.canBeFocused())))==null?void 0:s.getElement())!=null?c:null}let i;return(i=this.getTopBlocks(!0)[0])!=null?i:null}getNestedTrees(){const e=this.getAllBlocks().map(i=>i.getIcons()).flat().filter(i=>i instanceof l.MutatorIcon$$module$build$src$core$icons$mutator_icon&&i.bubbleIsVisible()).map(i=>{let s;return(s=i.getBubble())==null?void 0:s.getWorkspace()}).filter(i=>!!i),t=this.getFlyout(!0);return t&&e.push(t.getWorkspace()),e}searchForWorkspaceComment(e){for(const t of this.getTopComments())if(t instanceof As&&t.canBeFocused()&&t.getFocusableElement().id===e)return t}lookUpFocusableNode(e){var t;const i=(t=this.targetWorkspace)==null?void 0:t.getFlyout();if(this.isFlyout&&i){for(var s of i.getContents())if(t=s.getElement(),Zn(t)&&t.canBeFocused()&&t.getFocusableElement().id===e)return t}if(s=e.indexOf("_field_"),t=e.indexOf("_connection_"),s!==-1){var c=e.substring(0,s);if(c=this.getBlockById(c)){for(var m of c.getFields())if(m.canBeFocused()&&m.getFocusableElement().id===e)return m}return null}if(t!==-1){if(c=e.substring(0,t),c=this.getBlockById(c)){for(const B of c.getConnections_(!0))if(B.id===e)return B}return null}if(m=Math.max(e.indexOf(wi),e.indexOf(Cn),e.indexOf(cp)),m!==-1&&(m=e.substring(0,m),m=this.searchForWorkspaceComment(m))){if(e.indexOf(wi)>-1)return m.getEditorFocusableNode();var I;return(I=m.view.getCommentBarButtons().find(B=>B.getFocusableElement().id.includes(e)))!=null?I:null}if((I=this.getAllBlocks(!1).find(B=>B.getFocusableElement().id===e))||(I=this.searchForWorkspaceComment(e)))return I;I=this.getAllBlocks().map(B=>B.getIcons()).flat();for(c of I){if(c.canBeFocused()&&c.getFocusableElement().id===e)return c;if(Eo(c)){if((I=c.getBubble())&&I.canBeFocused()&&I.getFocusableElement().id===e)return I;if(I instanceof Ro&&I.getEditor().getFocusableElement().id===e)return I.getEditor()}}return null}onTreeFocus(e,t){}onTreeBlur(e){if(this.isFlyout&&this.targetWorkspace&&!l.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()){var t=this.targetWorkspace.getToolbox();t&&e===t||Ma(t)&&t.autoHide(!1)}}getNavigator(){return this.navigator}setNavigator(e){this.navigator=e}},af=class extends Nr{constructor(e){super(),this.isBlank=typeof e>"u",e&&(this.varId=e.getId(),this.workspaceId=e.getWorkspace().id)}toJson(){const e=super.toJson();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");return e.varId=this.varId,e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new af),t.varId=e.varId,t}},Tg=class extends af{constructor(e){super(e),this.type=ce.VAR_CREATE,e&&(this.varType=e.getType(),this.varName=e.getName())}toJson(){const e=super.toJson();if(this.varType===void 0)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new Tg),t.varType=e.varType,t.varName=e.varName,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t=t.getVariableMap(),e?t.createVariable(this.varName,this.varType,this.varId):(e=t.getVariableById(this.varId))&&t.deleteVariable(e)}};a(Re.EVENT,ce.VAR_CREATE,Tg);var Zg=class{constructor(e,t,i,s){this.workspace=e,this.name=t,this.type=i||"",this.id=s||ot()}getId(){return this.id}getName(){return this.name}setName(e){return this.name=e,this}getType(){return this.type}setType(e){return this.type=e,this}getWorkspace(){return this.workspace}save(){const e={name:this.getName(),id:this.getId()},t=this.getType();return t&&(e.type=t),e}static load(e,t){e=new this(t,e.name,e.type,e.id),t.getVariableMap().addVariable(e),Be(new(Qe(ce.VAR_CREATE))(e))}};a(Re.VARIABLE_MODEL,Po,Zg);var vg=class extends af{constructor(e){super(e),this.type=ce.VAR_DELETE,e&&(this.varType=e.getType(),this.varName=e.getName())}toJson(){const e=super.toJson();if(this.varType===void 0)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return e.varType=this.varType,e.varName=this.varName,e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new vg),t.varType=e.varType,t.varName=e.varName,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t=t.getVariableMap(),e?(e=t.getVariableById(this.varId))&&t.deleteVariable(e):t.createVariable(this.varName,this.varType,this.varId)}};a(Re.EVENT,ce.VAR_DELETE,vg);var yg=class extends af{constructor(e,t){super(e),this.type=ce.VAR_RENAME,e&&(this.oldName=e.getName(),this.newName=typeof t>"u"?"":t)}toJson(){const e=super.toJson();if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");return e.oldName=this.oldName,e.newName=this.newName,e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new yg),t.oldName=e.oldName,t.newName=e.newName,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");t=t.getVariableMap();const i=t.getVariableById(this.varId);e?i&&t.renameVariable(i,this.newName):i&&t.renameVariable(i,this.oldName)}};a(Re.EVENT,ce.VAR_RENAME,yg);var Qg=class{constructor(e,t=!1){this.workspace=e,this.potentialMap=t,this.variableMap=new Map}clear(){for(const e of this.variableMap.values())for(const t of e.values())this.deleteVariable(t);if(this.variableMap.size!==0)throw Error("Non-empty variable map")}renameVariable(e,t){if(e.getName()===t)return e;var i=e.getType();i=this.getVariable(t,i);const s=this.workspace.getAllBlocks(!1);let c="";this.potentialMap||(c=l.getGroup$$module$build$src$core$events$utils())||l.setGroup$$module$build$src$core$events$utils(!0);try{i&&i.getId()!==e.getId()?this.renameVariableWithConflict(e,t,i,s):this.renameVariableAndUses(e,t,s)}finally{this.potentialMap||l.setGroup$$module$build$src$core$events$utils(c)}return e}changeVariableType(e,t){const i=e.getType();if(i===t)return e;var s=this.variableMap.get(i);s?.delete(e.getId()),s?.size===0&&this.variableMap.delete(i),e.setType(t);let c;return s=(c=this.variableMap.get(t))!=null?c:new Map,s.set(e.getId(),e),this.variableMap.has(t)||this.variableMap.set(t,s),Be(new(Qe(ce.VAR_TYPE_CHANGE))(e,i,t)),e}renameVariableById(e,t){gn("VariableMap.renameVariableById","v12","v13","VariableMap.renameVariable");const i=this.getVariableById(e);if(!i)throw Error("Tried to rename a variable that didn't exist. ID: "+e);this.renameVariable(i,t)}renameVariableAndUses(e,t,i){for(this.potentialMap||Be(new(Qe(ce.VAR_RENAME))(e,t)),e.setName(t),t=0;t<i.length;t++)i[t].updateVarName(e)}renameVariableWithConflict(e,t,i,s){const c=e.getType(),m=i.getName();for(t!==m&&this.renameVariableAndUses(i,t,s),t=0;t<s.length;t++)s[t].renameVarById(e.getId(),i.getId());this.potentialMap||Be(new(Qe(ce.VAR_DELETE))(e));let I;(I=this.variableMap.get(c))==null||I.delete(e.getId())}createVariable(e,t,i){var s=this.getVariable(e,t);if(s){if(i&&s.getId()!==i)throw Error('Variable "'+e+'" is already in use and its id is "'+s.getId()+'" which conflicts with the passed in id, "'+i+'".');return s}if(i&&this.getVariableById(i))throw Error('Variable id, "'+i+'", is already in use.');if(s=i||ot(),t=t||"",i=D(Re.VARIABLE_MODEL,this.workspace.options,!0),!i)throw Error("No variable model is registered.");s=new i(this.workspace,e,t,s);let c;return e=(c=this.variableMap.get(t))!=null?c:new Map,e.set(s.getId(),s),this.variableMap.has(t)||this.variableMap.set(t,e),this.potentialMap||Be(new(Qe(ce.VAR_CREATE))(s)),s}addVariable(e){const t=e.getType();this.variableMap.has(t)||this.variableMap.set(t,new Map);let i;(i=this.variableMap.get(t))==null||i.set(e.getId(),e)}deleteVariable(e){const t=Es(this.workspace,e.getId());let i="";this.potentialMap||(i=l.getGroup$$module$build$src$core$events$utils())||l.setGroup$$module$build$src$core$events$utils(!0);try{for(let c=0;c<t.length;c++)t[c].dispose(!0);const s=this.variableMap.get(e.getType());s&&s.has(e.getId())&&(s.delete(e.getId()),this.potentialMap||Be(new(Qe(ce.VAR_DELETE))(e)),s.size===0&&this.variableMap.delete(e.getType()))}finally{this.potentialMap||l.setGroup$$module$build$src$core$events$utils(i)}}deleteVariableById(e){gn("VariableMap.deleteVariableById","v12","v13","Blockly.Variables.deleteVariable"),(e=this.getVariableById(e))&&l.deleteVariable$$module$build$src$core$variables(this.workspace,e)}getVariable(e,t){if(t=this.variableMap.get(t||""),!t)return null;let i;return(i=[...t.values()].find(s=>l.Names$$module$build$src$core$names.equals(s.getName(),e)))!=null?i:null}getVariableById(e){for(const t of this.variableMap.values())if(t.has(e)){let i;return(i=t.get(e))!=null?i:null}return null}getVariablesOfType(e){return(e=this.variableMap.get(e||""))?[...e.values()]:[]}getTypes(){return[...this.variableMap.keys()]}getAllVariables(){let e=[];for(const t of this.variableMap.values())e=e.concat(...t.values());return e}getAllVariableNames(){gn("VariableMap.getAllVariableNames","v12","v13","Blockly.Variables.getAllVariables");const e=[];for(const t of this.variableMap.values())for(const i of t.values())e.push(i.getName());return e}getVariableUsesById(e){return gn("VariableMap.getVariableUsesById","v12","v13","Blockly.Variables.getVariableUsesById"),Es(this.workspace,e)}};a(Re.VARIABLE_MAP,Po,Qg);var Sg=class extends tn{constructor(e,t){super(t),this.type=ce.TRASHCAN_OPEN,this.isOpen=e}toJson(){const e=super.toJson();if(this.isOpen===void 0)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new Sg),t.isOpen=e.isOpen,t}};a(Re.EVENT,ce.TRASHCAN_OPEN,Sg);var e$=class extends $c{constructor(e){super(),this.workspace=e,this.id="trashcan",this.contents=[],this.flyout=null,this.isLidOpen=!1,this.minOpenness=0,this.lidTask=this.svgLid=this.svgGroup=null,this.top=this.left=this.lidOpen=0,this.initialized=!1,this.workspace.options.maxTrashcanContents<=0||(e=this.workspace.copyOptionsForFlyout(),this.workspace.horizontalLayout?(e.toolboxPosition=this.workspace.toolboxPosition===Lt.TOP?Lt.BOTTOM:Lt.TOP,this.flyout=new(D(Re.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,!0))(e)):(e.toolboxPosition=this.workspace.toolboxPosition===Lt.RIGHT?Lt.LEFT:Lt.RIGHT,this.flyout=new(D(Re.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,!0))(e)),this.workspace.addChangeListener(this.onDelete.bind(this)))}createDom(){this.svgGroup=ae(le.G,{class:"blocklyTrash"});let e;const t=String(Math.random()).substring(2);e=ae(le.CLIPPATH,{id:"blocklyTrashBodyClipPath"+t},this.svgGroup),ae(le.RECT,{width:cf,height:dg,y:hf},e);const i=ae(le.IMAGE,{width:go.width,x:-Cg,height:go.height,y:-Rg,"clip-path":"url(#blocklyTrashBodyClipPath"+t+")"},this.svgGroup);return i.setAttributeNS(Co,"xlink:href",this.workspace.options.pathToMedia+go.url),e=ae(le.CLIPPATH,{id:"blocklyTrashLidClipPath"+t},this.svgGroup),ae(le.RECT,{width:cf,height:hf},e),this.svgLid=ae(le.IMAGE,{width:go.width,x:-Cg,height:go.height,y:-Rg,"clip-path":"url(#blocklyTrashLidClipPath"+t+")"},this.svgGroup),this.svgLid.setAttributeNS(Co,"xlink:href",this.workspace.options.pathToMedia+go.url),Le(this.svgGroup,"pointerdown",this,this.blockMouseDownWhenOpenable),Le(this.svgGroup,"pointerup",this,this.click),Le(i,"pointerover",this,this.mouseOver),Le(i,"pointerout",this,this.mouseOut),this.animateLid(),this.svgGroup}init(){if(this.workspace.options.maxTrashcanContents>0){const e=this.flyout.createDom(le.SVG);We(e,"blocklyTrashcanFlyout"),Yi(e,this.workspace.getParentSvg()),this.flyout.init(this.workspace)}this.workspace.getComponentManager().addComponent({component:this,weight:un.ComponentWeight.TRASHCAN_WEIGHT,capabilities:[un.Capability.AUTOHIDEABLE,un.Capability.DELETE_AREA,un.Capability.DRAG_TARGET,un.Capability.POSITIONABLE]}),this.initialized=!0,this.setLidOpen(!1)}dispose(){this.workspace.getComponentManager().removeComponent("trashcan"),this.svgGroup&&Wt(this.svgGroup),this.lidTask&&clearTimeout(this.lidTask)}hasContents(){return!!this.contents.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){if(!this.contentsIsOpen()){var e=this.contents.map(function(i){return JSON.parse(i)}),t=this.workspace.getParentSvg().style;t.cursor="wait",setTimeout(()=>{let i;(i=this.flyout)==null||i.show(e),t.cursor="";let s;(s=this.workspace.scrollbar)==null||s.setVisible(!1)},10),this.fireUiEvent(!0)}}closeFlyout(){if(this.contentsIsOpen()){var e;(e=this.flyout)==null||e.hide();var t;(t=this.workspace.scrollbar)==null||t.setVisible(!0),this.fireUiEvent(!1),this.workspace.recordDragTargets()}}autoHide(e){!e&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents()&&(this.contents.length=0,this.setMinOpenness(0),this.closeFlyout())}position(e,t){if(this.initialized){var i=yl(this.workspace,e);e=gs(i,new Mt(cf,dg+hf),hm,t$,e,this.workspace),t=nr(e,t$,i.vertical===ui.TOP?al.DOWN:al.UP,t),this.top=t.top,this.left=t.left;var s;(s=this.svgGroup)==null||s.setAttribute("transform","translate("+this.left+","+this.top+")");var c;(c=this.flyout)==null||c.position()}}getBoundingRectangle(){return new Nt(this.top,this.top+dg+hf,this.left,this.left+cf)}getClientRect(){if(!this.svgGroup)return null;var e=this.svgGroup.getBoundingClientRect();const t=e.top+Rg-fg;return e=e.left+Cg-fg,new Nt(t,t+hf+dg+2*fg,e,e+cf+2*fg)}onDragOver(e){this.setLidOpen(this.wouldDelete_)}onDragExit(e){this.setLidOpen(!1)}onDrop(e){setTimeout(this.setLidOpen.bind(this,!1),100)}setLidOpen(e){this.isLidOpen!==e&&(this.lidTask&&clearTimeout(this.lidTask),this.isLidOpen=e,this.animateLid())}animateLid(){const e=pm;var t=1/(e+1);this.lidOpen+=this.isLidOpen?t:-t,this.lidOpen=Math.min(Math.max(this.lidOpen,this.minOpenness),1),this.setLidAngle(this.lidOpen*i$),t=n$+this.lidOpen*(gm-n$),this.svgGroup&&(this.svgGroup.style.opacity=`${t}`),this.lidOpen>this.minOpenness&&this.lidOpen<1&&(this.lidTask=setTimeout(this.animateLid.bind(this),fm/e))}setLidAngle(e){const t=this.workspace.toolboxPosition===Lt.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;let i;(i=this.svgLid)==null||i.setAttribute("transform","rotate("+(t?-e:e)+","+(t?4:cf-4)+","+(hf-2)+")")}setMinOpenness(e){this.minOpenness=e,this.isLidOpen||this.setLidAngle(e*i$)}closeLid(){this.setLidOpen(!1)}click(){this.hasContents()&&!this.workspace.isDragging()&&this.openFlyout()}fireUiEvent(e){e=new(Qe(ce.TRASHCAN_OPEN))(e,this.workspace.id),Be(e)}blockMouseDownWhenOpenable(e){!this.contentsIsOpen()&&this.hasContents()&&e.stopPropagation()}mouseOver(){this.hasContents()&&this.setLidOpen(!0)}mouseOut(){this.setLidOpen(!1)}onDelete(e){if(!(this.workspace.options.maxTrashcanContents<=0||!Rt(e)||e.wasShadow)){if(!e.oldJson)throw Error("Encountered a delete event without proper oldJson");if(e=JSON.stringify(this.cleanBlockJson(e.oldJson)),!this.contents.includes(e)){for(this.contents.unshift(e);this.contents.length>this.workspace.options.maxTrashcanContents;)this.contents.pop();this.setMinOpenness(dm)}}}cleanBlockJson(e){function t(i){if(i){if(delete i.id,delete i.x,delete i.y,delete i.enabled,delete i.disabledReasons,i.icons&&i.icons.comment){var s=i.icons.comment;delete s.height,delete s.width,delete s.pinned}s=i.inputs;for(var c in s){var m=s[c];const I=m.block;m=m.shadow,I&&t(I),m&&t(m)}i.next&&(c=i.next,i=c.block,c=c.shadow,i&&t(i),c&&t(c))}}return e=JSON.parse(JSON.stringify(e)),t(e),Object.assign({},{kind:"BLOCK"},e)}},cf=47,dg=44,hf=16,t$=20,hm=20,fg=10,Cg=0,Rg=32,dm=.1,fm=80,pm=4,n$=.4,gm=.8,i$=45,Ap=null,wp=null,pg=void 0,El={};El.BlockPaster=ha,El.copy=Qh,El.getLastCopiedData=Gn,El.getLastCopiedLocation=td,El.getLastCopiedWorkspace=Pa,El.paste=Cr,El.registry=qu,El.setLastCopiedData=ed,El.setLastCopiedLocation=Fp,El.setLastCopiedWorkspace=Tf;var Cc={};Cc.CollapseCommentBarButton=Kd,Cc.CommentBarButton=Ch,Cc.CommentEditor=qd,Cc.CommentView=oa,Cc.DeleteCommentBarButton=eg,Cc.RenderedWorkspaceComment=As,Cc.WorkspaceComment=dc;var du;(function(e){e.ESCAPE="escape",e.DELETE="delete",e.COPY="copy",e.CUT="cut",e.PASTE="paste",e.UNDO="undo",e.REDO="redo"})(du||(du={})),eh();var fu={};fu.names=du,fu.registerCopy=Fa,fu.registerCut=Zc,fu.registerDefaultShortcuts=eh,fu.registerDelete=ni,fu.registerEscape=Qi,fu.registerPaste=Vs,fu.registerRedo=Qc,fu.registerUndo=Ua;var $m=class{constructor(e,t){this.procedureModelClass=e,this.parameterModelClass=t,this.priority=Lr}save(e){return e=e.getProcedureMap().getProcedures().map(t=>nd(t)),e.length?e:null}load(e,t){const i=t.getProcedureMap();for(const s of e)i.add(id(this.procedureModelClass,this.parameterModelClass,s,t))}clear(e){e.getProcedureMap().clear()}},gg={};gg.ProcedureSerializer=$m,gg.loadProcedure=id,gg.saveProcedure=nd;var o$=class{constructor(){this.priority=Kl}save(e){return e=e.getAllVariables().map(t=>t.save()),e.length?e:null}load(e,t){const i=O(Re.VARIABLE_MODEL,Po);e.forEach(s=>{i?.load(s,t)})}clear(e){e.getVariableMap().clear()}};Sl("variables",new o$);var s$={};s$.VariableSerializer=o$;var Ig={};Ig.load=yf,Ig.save=vf;var mm={blocks:Zu,exceptions:Vo,priorities:js,procedures:gg,registry:kd,variables:s$,workspaceComments:ql,workspaces:Ig};"Blockly"in globalThis||(globalThis.Blockly={Msg:Dd});var Og="label",r$=class{load(e,t){return e=new ji(t.getWorkspace(),t.targetWorkspace,e,!0),e.show(),new mc(e,Og)}gapForItem(e,t){return t}disposeItem(e){e=e.getElement(),e instanceof ji&&e.dispose()}getType(){return Og}};a(Re.FLYOUT_INFLATER,Og,r$);var l$=class extends he{constructor(e){super(),this.GRID_UNIT=4,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter=null,this.replacementGlowFilterId="",this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter=null,e&&(this.GRID_UNIT=e),this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_DEFAULT_WIDTH=6*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=8*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(e){super.setFontConstants_(e),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+this.FIELD_BORDER_RECT_Y_PADDING*2}init(){super.init(),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(e){super.setDynamicProperties_(e),this.SELECTED_GLOW_COLOUR=e.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;const t=Number(e.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=t&&!isNaN(t)?t:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=e.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(e=Number(e.getComponentStyle("replacementGlowSize")))&&!isNaN(e)?e:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose(),this.selectedGlowFilter&&Wt(this.selectedGlowFilter),this.replacementGlowFilter&&Wt(this.replacementGlowFilter)}makeStartHat(){const e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH,i=Do("c",[pt(25,-e),pt(71,-e),pt(t,0)]);return{height:e*.75,width:t,path:i}}makeHexagonal(){function e(i,s,c){var m=i/2;return m=m>t?t:m,c=c?-1:1,i=(s?-1:1)*i/2,Rs(-c*m,i)+Rs(c*m,i)}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width(i){return i/=2,i>t?t:i},height(i){return i},connectionOffsetY(i){return i/2},connectionOffsetX(i){return-i},pathDown(i){return e(i,!1,!1)},pathUp(i){return e(i,!0,!1)},pathRightDown(i){return e(i,!1,!0)},pathRightUp(i){return e(i,!1,!0)}}}makeRounded(){function e(s,c,m){const I=s>i?s-i:0;s=(s>i?i:s)/2;const B=m===c?"0":"1";return kn("a","0 0,"+B,s,pt((m?1:-1)*s,(c?-1:1)*s))+$t("v",(c?-1:1)*I)+kn("a","0 0,"+B,s,pt((m?-1:1)*s,(c?-1:1)*s))}const t=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,i=t*2;return{type:this.SHAPES.ROUND,isDynamic:!0,width(s){return s/=2,s>t?t:s},height(s){return s},connectionOffsetY(s){return s/2},connectionOffsetX(s){return-s},pathDown(s){return e(s,!1,!1)},pathUp(s){return e(s,!0,!1)},pathRightDown(s){return e(s,!1,!0)},pathRightUp(s){return e(s,!1,!0)}}}makeSquared(){function e(i,s,c){i-=t*2;const m=c===s?"0":"1";return kn("a","0 0,"+m,t,pt((c?1:-1)*t,(s?-1:1)*t))+$t("v",(s?-1:1)*i)+kn("a","0 0,"+m,t,pt((c?-1:1)*t,(s?-1:1)*t))}const t=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width(i){return t},height(i){return i},connectionOffsetY(i){return i/2},connectionOffsetX(i){return-i},pathDown(i){return e(i,!1,!1)},pathUp(i){return e(i,!0,!1)},pathRightDown(i){return e(i,!1,!0)},pathRightUp(i){return e(i,!1,!0)}}}shapeFor(e){let t=e.getCheck();switch(!t&&e.targetConnection&&(t=e.targetConnection.getCheck()),e.type){case lt.INPUT_VALUE:case lt.OUTPUT_VALUE:if(e=e.getSourceBlock().getOutputShape(),e!==null)switch(e){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return t&&t.includes("Boolean")?this.HEXAGONAL:t&&t.includes("Number")?this.ROUNDED:(t&&t.includes("String"),this.ROUNDED);case lt.PREVIOUS_STATEMENT:case lt.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}makeNotch(){function e(mt){return Do("c",[pt(mt*c/2,0),pt(mt*c*3/4,I/2),pt(mt*c,I)])+el([pt(mt*c,m)])+Do("c",[pt(mt*c/4,I/2),pt(mt*c/2,I),pt(mt*c,I)])+$t("h",mt*s)+Do("c",[pt(mt*c/2,0),pt(mt*c*3/4,-(I/2)),pt(mt*c,-I)])+el([pt(mt*c,-m)])+Do("c",[pt(mt*c/4,-(I/2)),pt(mt*c/2,-I),pt(mt*c,-I)])}const t=this.NOTCH_WIDTH,i=this.NOTCH_HEIGHT,s=t/3,c=s/3,m=i/2,I=m/2,B=e(1),Se=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:i,pathLeft:B,pathRight:Se}}makeInsideCorners(){const e=this.CORNER_RADIUS,t=kn("a","0 0,0",e,pt(-e,e)),i=kn("a","0 0,1",e,pt(-e,e)),s=kn("a","0 0,0",e,pt(e,e)),c=kn("a","0 0,1",e,pt(e,e));return{width:e,height:e,pathTop:t,pathBottom:s,rightWidth:e,rightHeight:e,pathTopRight:i,pathBottomRight:c}}generateSecondaryColour_(e){return Pe("#000",e,.15)||e}generateTertiaryColour_(e){return Pe("#000",e,.25)||e}createDom(e,t,i,s){super.createDom(e,t,i,s),e=ae(le.DEFS,{},e),t=ae(le.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),ae(le.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},t),i=ae(le.FECOMPONENTTRANSFER,{result:"outBlur"},t),ae(le.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},i),ae(le.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),ae(le.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.selectedGlowFilterId=t.id,this.selectedGlowFilter=t,e=ae(le.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),ae(le.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},e),t=ae(le.FECOMPONENTTRANSFER,{result:"outBlur"},e),ae(le.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),ae(le.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},e),ae(le.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),ae(le.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},e),this.replacementGlowFilterId=e.id,this.replacementGlowFilter=e,s&&(s.style.setProperty("--blocklySelectedGlowFilter",`url(#${this.selectedGlowFilterId})`),s.style.setProperty("--blocklyReplacementGlowFilter",`url(#${this.replacementGlowFilterId})`))}getCSS_(e){return[`${e} .blocklyText,`,`${e} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e} .blocklyTextInputBubble textarea {`,"font-weight: normal;","}",`${e} .blocklyText {`,"fill: #fff;","}",`${e} .blocklyNonEditableField>rect:not(.blocklyDropdownRect),`,`${e} .blocklyEditableField>rect:not(.blocklyDropdownRect) {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"}",`${e} .blocklyNonEditableField>text,`,`${e} .blocklyEditableField>text,`,`${e} .blocklyNonEditableField>g>text,`,`${e} .blocklyEditableField>g>text {`,"fill: #575E75;","}",`${e} .blocklyFlyoutLabelText {`,"fill: #575E75;","}",`${e} .blocklyText.blocklyBubbleText {`,"fill: #575E75;","}",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableField:not(.blocklyEditing):hover>rect,",`${e} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableField:not(.blocklyEditing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",`${e} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"color: #575E75;","}",`${e} .blocklyDropdownText {`,"fill: #fff !important;","}",`${e}.blocklyWidgetDiv .blocklyMenuItem,`,`${e}.blocklyDropDownDiv .blocklyMenuItem {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${e}.blocklyDropDownDiv .blocklyMenuItemContent {`,"color: #fff;","}",`${e} .blocklyHighlightedConnectionPath {`,`stroke: ${this.SELECTED_GLOW_COLOUR};`,"}",`${e} .blocklyDisabledPattern > .blocklyOutlinePath {`,"fill: var(--blocklyDisabledPattern)","}",`${e} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}",`${e} .blocklySelected>.blocklyPath.blocklyPathSelected {`,"fill: none;","filter: var(--blocklySelectedGlowFilter);","}",`${e} .blocklyReplaceable>.blocklyPath {`,"filter: var(--blocklyReplacementGlowFilter);","}"]}},u$=class extends we{constructor(e,t){super(e,t)}draw(){const e=this.block_.pathObject;e.beginDrawing(),this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),e.setPath(this.outlinePath_+`
`+this.inlinePath_),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_(),this.info_.outputConnection&&(e.outputShapeType=this.info_.outputConnection.shape.type),e.endDrawing()}drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(e){if(!(e.height<=0)){if(K.isSpacer(e)){const s=e.precedesStatement;var t=e.followsStatement;if(s||t){const c=this.constants_.INSIDE_CORNERS;var i=c.rightHeight;i=e.height-(s?i:0),t=t?c.pathBottomRight:"",e=i>0?$t("V",e.yPos+i):"",this.outlinePath_+=t+e+(s?c.pathTopRight:"");return}}this.outlinePath_+=$t("V",e.yPos+e.height)}}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"}drawFlatTop_(){const e=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=yn(e.xPos,this.info_.startY),this.outlinePath_+=$t("h",e.width)}drawFlatBottom_(){const e=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=$t("V",e.baseline),this.outlinePath_+=$t("h",-e.width)}drawInlineInput_(e){this.positionInlineInputConnection_(e);const t=e.input.name;e.connectedBlock||this.info_.isInsertionMarker||(e=Oi(e.xPos+e.connectionWidth,e.centerline-e.height/2)+this.getInlineInputPath(e),this.block_.pathObject.setOutlinePath(t,e))}getInlineInputPath(e){const t=e.width-e.connectionWidth*2,i=e.height;return $t("h",t)+e.shape.pathRightDown(i)+$t("h",-t)+e.shape.pathUp(i)+"z"}drawStatementInput_(e){var t=e.getLastInput();const i=t.xPos+t.notchOffset+t.shape.width,s=this.constants_.INSIDE_CORNERS,c=t.shape.pathRight+$t("h",-(t.notchOffset-s.width))+s.pathTop,m=e.height-2*s.height;t=s.pathBottom+$t("h",t.notchOffset-s.width)+(t.connectedBottomNextConnection?"":t.shape.pathLeft),this.outlinePath_+=$t("H",i)+c+$t("v",m)+t+$t("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}drawConnectionHighlightPath(e){const t=e.connectionModel;if(t.type===lt.NEXT_STATEMENT||t.type===lt.PREVIOUS_STATEMENT||t.type===lt.OUTPUT_VALUE&&!e.isDynamicShape)return super.drawConnectionHighlightPath(e);e=t.type===lt.INPUT_VALUE?Oi(e.connectionWidth,-e.height/2)+this.getInlineInputPath(e):Oi(e.width,-e.height/2)+e.shape.pathDown(e.height);const i=t.getSourceBlock();let s,c;return(c=(s=i.pathObject).addConnectionHighlight)==null?void 0:c.call(s,t,e,t.getOffsetInBlock(),i.RTL)}},Lh=class extends dn{constructor(e,t,i,s,c,m,I){if(super(dn.SKIP_SETUP),this.imageElement=this.clickHandler=null,this.flipRtl=this.isDirty_=this.EDITABLE=!1,this.altText="",i=Number(Ge(i)),t=Number(Ge(t)),isNaN(i)||isNaN(t))throw Error("Height and width values of an image field must cast to numbers.");if(i<=0||t<=0)throw Error("Height and width values of an image field must be greater than 0.");this.size_=new Mt(t,i+Lh.Y_PADDING),this.imageHeight=i,typeof c=="function"&&(this.clickHandler=c),e!==dn.SKIP_SETUP&&(I?this.configure_(I):(this.flipRtl=!!m,this.altText=Ge(s)||""),this.setValue(Ge(e)))}configure_(e){super.configure_(e),e.flipRtl&&(this.flipRtl=e.flipRtl),e.alt&&(this.altText=Ge(e.alt))}initView(){this.imageElement=ae(le.IMAGE,{height:this.imageHeight+"px",width:this.size_.width+"px",alt:this.altText},this.fieldGroup_),this.imageElement.setAttributeNS(Co,"xlink:href",this.value_),this.fieldGroup_&&We(this.fieldGroup_,"blocklyImageField"),this.clickHandler&&(this.imageElement.style.cursor="pointer")}updateSize_(){}doClassValidation_(e){return typeof e!="string"?null:e}doValueUpdate_(e){this.value_=e,this.imageElement&&this.imageElement.setAttributeNS(Co,"xlink:href",this.value_)}getFlipRtl(){return this.flipRtl}setAlt(e){e!==this.altText&&(this.altText=e||"",this.imageElement&&this.imageElement.setAttribute("alt",this.altText))}isClickable(){return super.isClickable()&&!!this.clickHandler}showEditor_(){this.clickHandler&&this.clickHandler(this)}setOnClickHandler(e){this.clickHandler=e}getText_(){return this.altText}static fromJson(e){if(!e.src||!e.width||!e.height)throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.");return new this(e.src,e.width,e.height,void 0,void 0,void 0,e)}};Lh.Y_PADDING=1,Ss("field_image",Lh),Lh.prototype.DEFAULT_VALUE="";var $g=14,df=class extends dn{set size_(e){super.size_=e}get size_(){const e=super.size_;return e.width<$g&&(e.width=$g),e}constructor(e,t,i){super(dn.SKIP_SETUP),this.spellcheck_=!0,this.htmlInput_=null,this.isTextValid_=this.isBeingEdited_=!1,this.onInputWrapper=this.onKeyDownWrapper=this.valueWhenEditorWasOpened_=null,this.fullBlockClickTarget_=!1,this.workspace_=null,this.SERIALIZABLE=!0,e!==dn.SKIP_SETUP&&(i&&this.configure_(i),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.spellcheck!==void 0&&(this.spellcheck_=e.spellcheck)}initView(){if(!this.getSourceBlock())throw new ai;super.initView(),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot()),this.fieldGroup_&&We(this.fieldGroup_,"blocklyInputField")}isFullBlockField(){const e=this.getSourceBlock();if(!e)throw new ai;let t;return this.fullBlockClickTarget_=!((t=this.getConstants())==null||!t.FULL_BLOCK_FIELDS)&&e.isSimpleReporter()}doValueInvalid_(e,t=!0){this.isBeingEdited_&&(this.isDirty_=!0,this.isTextValid_=!1,e=this.value_,this.value_=this.valueWhenEditorWasOpened_,this.sourceBlock_&&Ze()&&this.value_!==e&&t&&Be(new(Qe(ce.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,e,this.value_)))}doValueUpdate_(e){this.isTextValid_=this.isDirty_=!0,this.value_=e}applyColour(){const e=this.getSourceBlock();if(!e)throw new ai;this.getConstants().FULL_BLOCK_FIELDS&&this.fieldGroup_&&(!this.isFullBlockField()&&this.borderRect_?(this.borderRect_.style.display="block",this.borderRect_.setAttribute("stroke",e.getColourTertiary())):(this.borderRect_.style.display="none",e.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR)))}getSize(){let e;return(e=this.getConstants())!=null&&e.FULL_BLOCK_FIELDS&&(this.render_(),this.isDirty_=!1),super.getSize()}onLocationChange(){this.isBeingEdited_&&this.resizeEditor_()}render_(){if(super.render_(),this.isBeingEdited_){var e=this.htmlInput_;this.isTextValid_?(vt(e,"blocklyInvalidInput"),It(e,Wn.INVALID,!1)):(We(e,"blocklyInvalidInput"),It(e,Wn.INVALID,!0))}if(e=this.getSourceBlock(),!e)throw new ai;this.getConstants().FULL_BLOCK_FIELDS&&e.applyColour()}setSpellcheck(e){e!==this.spellcheck_&&(this.spellcheck_=e,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))}showEditor_(e,t=!1,i=!0){this.workspace_=this.sourceBlock_.workspace,!t&&this.workspace_.options.modalInputs&&(Wp||yd||Ka)?this.showPromptEditor():this.showInlineEditor(t,i)}showPromptEditor(){Di(l.Msg$$module$build$src$core$msg.CHANGE_VALUE_TITLE,this.getText(),e=>{e!==null&&this.setValue(this.getValueFromEditorText_(e)),this.onFinishEditing_(this.value_)})}showInlineEditor(e,t){const i=this.getSourceBlock();if(!i)throw new ai;ei(this,i.RTL,this.widgetDispose_.bind(this),this.workspace_,t),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,this.valueWhenEditorWasOpened_=this.value_,e||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())}widgetCreate_(){var e=this.getSourceBlock();if(!e)throw new ai;l.setGroup$$module$build$src$core$events$utils(!0);const t=At();var i=this.getClickTarget_();if(!i)throw Error("A click target has not been set.");We(i,"blocklyEditing"),i=document.createElement("input"),i.className="blocklyHtmlInput",i.setAttribute("spellcheck",this.spellcheck_);const s=this.workspace_.getAbsoluteScale();var c=this.getConstants().FIELD_TEXT_FONTSIZE*s+"pt";return t.style.fontSize=c,i.style.fontSize=c,c=df.BORDERRADIUS*s+"px",this.isFullBlockField()&&(c=this.getScaledBBox(),c=(c.bottom-c.top)/2+"px",e=e.getParent()?e.getParent().getColourTertiary():this.sourceBlock_.getColourTertiary(),i.style.border=1*s+"px solid "+e,t.style.borderRadius=c,t.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(t.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*s+"px")),i.style.borderRadius=c,t.appendChild(i),i.value=i.defaultValue=this.getEditorText_(this.value_),i.setAttribute("data-untyped-default-value",String(this.value_)),this.resizeEditor_(),this.bindInputEvents_(i),i}widgetDispose_(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_(this.value_),this.sourceBlock_&&Ze()&&this.valueWhenEditorWasOpened_!==null&&this.valueWhenEditorWasOpened_!==this.value_&&(Be(new(Qe(ce.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,this.valueWhenEditorWasOpened_,this.value_)),this.valueWhenEditorWasOpened_=null),l.setGroup$$module$build$src$core$events$utils(!1),this.unbindInputEvents_();var e=At().style;if(e.width="auto",e.height="auto",e.fontSize="",e.transition="",e.boxShadow="",this.htmlInput_=null,e=this.getClickTarget_(),!e)throw Error("A click target has not been set.");vt(e,"blocklyEditing")}onFinishEditing_(e){}bindInputEvents_(e){this.onKeyDownWrapper=_e(e,"keydown",this,this.onHtmlInputKeyDown_),this.onInputWrapper=_e(e,"input",this,this.onHtmlInputChange)}unbindInputEvents_(){this.onKeyDownWrapper&&(Ae(this.onKeyDownWrapper),this.onKeyDownWrapper=null),this.onInputWrapper&&(Ae(this.onInputWrapper),this.onInputWrapper=null)}onHtmlInputKeyDown_(e){if(e.key==="Enter")Dn(this),Ts();else if(e.key==="Escape")this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value"),!1),Dn(this),Ts();else if(e.key==="Tab"){e.preventDefault();var t,i=(t=this.workspace_)==null?void 0:t.getCursor();t=s=>(s instanceof df||s instanceof Rn&&s.isSimpleReporter())&&s!==this.getSourceBlock(),e=e.shiftKey?i?.getPreviousNode(this,t,!1):i?.getNextNode(this,t,!1),e=e instanceof Rn&&e.isSimpleReporter()?e.getFields().next().value:e,e instanceof df&&(Dn(this),Ts(),i=e.getSourceBlock(),e.isFullBlockField()&&i&&i instanceof Rn?l.getFocusManager$$module$build$src$core$focus_manager().focusNode(i):l.getFocusManager$$module$build$src$core$focus_manager().focusNode(e),e.showEditor())}}onHtmlInputChange(e){e=this.value_,this.setValue(this.getValueFromEditorText_(this.htmlInput_.value),!1),this.sourceBlock_&&Ze()&&this.value_!==e&&Be(new(Qe(ce.BLOCK_FIELD_INTERMEDIATE_CHANGE))(this.sourceBlock_,this.name||null,e,this.value_))}setEditorValue_(e,t=!0){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(e)),this.setValue(e,t)}resizeEditor_(){Ci().then(()=>{const e=this.getSourceBlock();if(!e)throw new ai;const t=At(),i=this.getScaledBBox();t.style.width=i.right-i.left+"px",t.style.height=i.bottom-i.top+"px";const s=i.top;t.style.left=`${e.RTL?i.right-t.offsetWidth:i.left}px`,t.style.top=`${s}px`})}repositionForWindowResize(){let e;const t=(e=this.getSourceBlock())==null?void 0:e.getRootBlock();return t instanceof Rn?(Uu(this.workspace_,this.workspace_.getMetricsManager().getViewMetrics(!0),t)||this.resizeEditor_(),!0):!1}positionTextElement_(e,t){const i=e*2+t;super.positionTextElement_(e+(i<$g?($g-i)/2:0),t)}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(e){return`${e}`}getValueFromEditorText_(e){return e}};df.BORDERRADIUS=4,l.FieldTextInput$$module$build$src$core$field_textinput=class extends df{constructor(e,t,i){super(e,t,i)}initView(){super.initView(),this.fieldGroup_&&We(this.fieldGroup_,"blocklyTextInputField")}doClassValidation_(e){return e===void 0?null:`${e}`}static fromJson(e){return new this(Ge(e.text),void 0,e)}},Ss("field_input",l.FieldTextInput$$module$build$src$core$field_textinput),l.FieldTextInput$$module$build$src$core$field_textinput.prototype.DEFAULT_VALUE="",l.FieldTextInput$$module$build$src$core$field_textinput;var a$=class extends n{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){return!!e.outputConnection}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},mg=class extends re{constructor(e,t){if(super(e,t),this.connectedBottomNextConnection=!1,this.connectedBlock){for(e=this.connectedBlock;t=e.getNextBlock();)e=t;e.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}}},c$=class extends Vr{constructor(e){super(e),this.width=this.height=0,this.type|=K.getType("RIGHT_CONNECTION")}},h$=class extends Q{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){const t=(e.hat?e.hat==="cap":this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection;return!!e.outputConnection||t}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},d$=class extends bt{constructor(e,t){super(e,t),this.isInline=!0,this.renderer_=e,this.constants_=this.renderer_.getConstants(),this.topRow=new h$(this.constants_),this.bottomRow=new a$(this.constants_),this.isMultiRow=!t.getInputsInline()||t.isCollapsed(),this.hasStatementInput=t.statementInputCount>0,this.rightSide=this.outputConnection?new c$(this.constants_):null,this.rightAlignedDummyInputs=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}shouldStartNewRow_(e,t){return t?t instanceof cs||e instanceof Yo||t instanceof Yo?!0:e instanceof l.ValueInput$$module$build$src$core$inputs$value_input||e instanceof Io||e instanceof cs?!this.isInline||this.isMultiRow:!1:!1}getDesiredRowWidth_(e){return e.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):super.getDesiredRowWidth_(e)}getInRowSpacing_(e,t){return e&&t||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!e&&t&&K.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:e&&K.isLeftRoundedCorner(e)&&t&&(K.isPreviousConnection(t)||K.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:e&&K.isLeftSquareCorner(e)&&t&&K.isHat(t)||e&&K.isField(e)&&e.width===0?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(e,t){if(K.isTopRow(e)&&K.isBottomRow(t))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;const i=K.isInputRow(e)&&e.hasStatement,s=K.isInputRow(t)&&t.hasStatement;return s||i?(e=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),s&&i?Math.max(e,this.constants_.DUMMY_INPUT_MIN_HEIGHT):e):K.isTopRow(e)?e.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):K.isBottomRow(t)?this.outputConnection?!t.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}getSpacerRowWidth_(e,t){const i=this.width-this.startX;return K.isInputRow(e)&&e.hasStatement||K.isInputRow(t)&&t.hasStatement?Math.max(i,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):i}getElemCenterline_(e,t){if(e.hasStatement&&!K.isSpacer(t)&&!K.isStatementInput(t))return e.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(K.isInlineInput(t)){const i=t.connectedBlock;if(i&&i.outputConnection&&i.nextConnection)return e.yPos+i.height/2}return super.getElemCenterline_(e,t)}addInput_(e,t){if((e instanceof Io||e instanceof cs)&&t.hasDummyInput&&t.align===l.Align$$module$build$src$core$inputs$align.LEFT&&e.align===l.Align$$module$build$src$core$inputs$align.RIGHT)this.rightAlignedDummyInputs.set(t,e);else if(e instanceof Yo){t.elements.push(new mg(this.constants_,e)),t.hasStatement=!0,t.align===null&&(t.align=e.align);return}super.addInput_(e,t)}addAlignmentPadding_(e,t){if(this.rightAlignedDummyInputs.get(e)){let i;for(let s=0;s<e.elements.length;s++){const c=e.elements[s];if(K.isSpacer(c)&&(i=c),K.isField(c)&&c.parentInput===this.rightAlignedDummyInputs.get(e))break}if(i){i.width+=t,e.width+=t;return}}super.addAlignmentPadding_(e,t)}adjustXPosition_(){const e=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH;let t=e;for(let c=2;c<this.rows.length-1;c+=2){var i=this.rows[c-1];const m=this.rows[c];var s=this.rows[c+1];if(i=c===2?!!this.topRow.hasPreviousConnection:!!i.followsStatement,s=c+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!s.precedesStatement,K.isInputRow(m)&&m.hasStatement){m.measure();let I,B;t=m.width-((B=(I=m.getLastInput())==null?void 0:I.width)!=null?B:0)+e}else if(i&&(c===2||s)&&K.isInputRow(m)&&!m.hasStatement){s=m.xPos,i=null;for(let I=0;I<m.elements.length;I++){const B=m.elements[I];K.isSpacer(B)&&(i=B),!(i&&(K.isField(B)||K.isInput(B))&&s<t)||K.isField(B)&&(B.field instanceof ua||B.field instanceof Lh)||(i.width+=t-s),s+=B.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var e=this.outputConnection.shape;if("isDynamic"in e&&e.isDynamic){for(var t=0,i=0;i<this.rows.length;i++){const s=this.rows[i];s.yPos=t,t+=s.height}this.height=t,i=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height,t=e.height(i),i=e.width(i),this.outputConnection.height=t,this.outputConnection.width=i,this.outputConnection.startX=i,this.outputConnection.connectionOffsetY=e.connectionOffsetY(t),this.outputConnection.connectionOffsetX=e.connectionOffsetX(i),e=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(e=i,this.rightSide.height=t,this.rightSide.width=e,this.rightSide.centerline=t/2,this.rightSide.xPos=this.width+e),this.startX=i,this.width+=i+e,this.widthWithChildren+=i+e}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var e=0,t=0;t<this.rows.length;t++){var i=this.rows[t];if(!K.isInputRow(i))continue;e=i.elements[i.elements.length-2];let s=this.getNegativeSpacing_(i.elements[1]),c=this.getNegativeSpacing_(e);e=s+c;const m=this.constants_.MIN_BLOCK_WIDTH+this.outputConnection.width*2;this.width-e<m&&(e=this.width-m,s=e/2,c=e/2),i.elements.unshift(new k(this.constants_,-s)),i.elements.push(new k(this.constants_,-c))}if(e)for(this.width-=e,this.widthWithChildren-=e,this.rightSide.xPos-=e,t=0;t<this.rows.length;t++)i=this.rows[t],K.isTopOrBottomRow(i)&&(i.elements[1].width-=e),i.width-=e,i.widthWithConnectedBlocks-=e}}getNegativeSpacing_(e){if(!e||!this.outputConnection)return 0;const t=this.outputConnection.width;var i=this.outputConnection.shape.type;const s=this.constants_;if(this.inputRows.length>1)switch(i){case s.SHAPES.ROUND:return i=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,i=this.height/2>i?i:this.height/2,t-i*(1-Math.sin(Math.acos((i-this.constants_.SMALL_PADDING)/i)));default:return 0}if(K.isInlineInput(e)){const c=e.connectedBlock;return e=c?c.pathObject.outputShapeType:e.shape.type,e==null||c&&c.outputConnection&&(c.statementInputCount||c.nextConnection)||i===s.SHAPES.HEXAGONAL&&i!==e?0:t-this.constants_.SHAPE_IN_SHAPE_PADDING[i][e]}return K.isField(e)?i===s.SHAPES.ROUND&&e.field instanceof l.FieldTextInput$$module$build$src$core$field_textinput?t-2.75*s.GRID_UNIT:t-this.constants_.SHAPE_IN_SHAPE_PADDING[i][0]:K.isIcon(e)?this.constants_.SMALL_PADDING:0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let s=2;s<this.rows.length-1;s+=2){const c=this.rows[s-1],m=this.rows[s],I=this.rows[s+1];var e=s===2,t=s+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!I.precedesStatement;if(e?this.topRow.hasPreviousConnection:c.followsStatement){var i=m.elements[1];if(i=m.elements.length===3&&i instanceof f&&(i.field instanceof ua||i.field instanceof Lh),!e&&i)c.height-=this.constants_.SMALL_PADDING,I.height-=this.constants_.SMALL_PADDING,m.height-=this.constants_.MEDIUM_PADDING;else if(!e&&!t)c.height+=this.constants_.SMALL_PADDING;else if(t){for(e=!1,t=0;t<m.elements.length;t++)if(i=m.elements[t],K.isInlineInput(i)&&i.connectedBlock&&!i.connectedBlock.isShadow()&&i.connectedBlock.getHeightWidth().height>=40){e=!0;break}e&&(c.height-=this.constants_.SMALL_PADDING,I.height-=this.constants_.SMALL_PADDING)}}}}finalize_(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),super.finalize_(),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},f$=class extends Zt{constructor(e,t,i){super(e,t,i),this.svgPathSelected=null,this.outlines=new Map,this.remainingOutlines=new Set,this.outputShapeType=null,this.constants=i}setPath(e){super.setPath(e),this.svgPathSelected&&this.svgPathSelected.setAttribute("d",e)}applyColour(e){super.applyColour(e);const t=e.getParent();e.isShadow()&&t&&this.svgPath.setAttribute("stroke",t.getColourTertiary());for(const i of this.outlines.values())i.setAttribute("fill",this.style.colourTertiary)}flipRTL(){super.flipRTL();for(const e of this.outlines.values())e.setAttribute("transform","scale(-1 1)")}updateSelected(e){this.setClass_("blocklySelected",e),e?this.svgPathSelected||(this.svgPathSelected=this.svgPath.cloneNode(!0),this.svgPathSelected.classList.add("blocklyPathSelected"),vt(this.svgPathSelected,Hi.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),vt(this.svgPathSelected,Hi.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME),this.svgPathSelected.removeAttribute("tabindex"),this.svgPathSelected.removeAttribute("id"),this.svgRoot.appendChild(this.svgPathSelected)):this.svgPathSelected&&(this.svgRoot.removeChild(this.svgPathSelected),this.svgPathSelected=null)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,t){e=e.getParentInput().name,(e=this.getOutlinePath(e))&&(t?e.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):e.removeAttribute("filter"))}beginDrawing(){this.remainingOutlines.clear();for(const e of this.outlines.keys())this.remainingOutlines.add(e)}endDrawing(){if(this.remainingOutlines.size)for(const e of this.remainingOutlines)this.removeOutlinePath(e);this.remainingOutlines.clear()}setOutlinePath(e,t){e=this.getOutlinePath(e),e.setAttribute("d",t),e.setAttribute("fill",this.style.colourTertiary)}getOutlinePath(e){return this.outlines.has(e)||this.outlines.set(e,ae(le.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines.delete(e),this.outlines.get(e)}removeOutlinePath(e){let t,i;(t=this.outlines.get(e))==null||(i=t.parentNode)==null||i.removeChild(this.outlines.get(e)),this.outlines.delete(e)}},Ag=class extends gt{constructor(e){super(e)}makeConstants_(){return new l$}makeRenderInfo_(e){return new d$(this,e)}makeDrawer_(e,t){return new u$(e,t)}makePathObject(e,t){return new f$(e,t,this.getConstants())}getConstants(){return this.constants_}};rs("zelos",Ag);var p$=class{constructor(e){this.staticConn=this.draggedConn=this.markerConn=this.fadedBlock=null,this.workspace=e.workspace}previewReplacement(e,t,i){l.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.fadedBlock=i,i.fadeForReplacement(!0),this.workspace.getRenderer().shouldHighlightConnection(t)&&(t.highlight(),this.staticConn=t)}finally{l.enable$$module$build$src$core$events$utils()}}previewConnection(e,t){if(e!==this.draggedConn||t!==this.staticConn){l.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.shouldUseMarkerPreview(e,t)&&(this.markerConn=this.previewMarker(e,t)),this.workspace.getRenderer().shouldHighlightConnection(t)&&t.highlight(),this.draggedConn=e,this.staticConn=t}finally{l.enable$$module$build$src$core$events$utils()}}}shouldUseMarkerPreview(e,t){return t.type===lt.PREVIOUS_STATEMENT||t.type===lt.NEXT_STATEMENT||!(this.workspace.getRenderer()instanceof Ag)}previewMarker(e,t){const i=e.getSourceBlock(),s=this.createInsertionMarker(i),c=this.getMatchingConnection(i,s,e);if(!c)return null;s.queueRender(),Zo(),c.connect(t);const m={x:t.x-c.x,y:t.y-c.y},I=c.getOffsetInBlock().clone();return Ci().then(()=>{if(!s.isDeadOrDying()){l.disable$$module$build$src$core$events$utils();try{s?.positionNearConnection(c,m,I),s?.getSvgRoot().setAttribute("visibility","visible")}finally{l.enable$$module$build$src$core$events$utils()}}}),c}serializeBlockToInsertionMarker(e){const t=Zi(e,{addCoordinates:!1,addInputBlocks:!1,addNextBlocks:!1,doFullSerialization:!1});if(!t)throw Error(`Failed to serialize source block. ${e.toDevString()}`);return t}createInsertionMarker(e){e=this.serializeBlockToInsertionMarker(e),e=bo(e,this.workspace);for(const t of e.getDescendants(!1))t.setInsertionMarker(!0);return e.initSvg(),e.getSvgRoot().setAttribute("visibility","hidden"),e}getMatchingConnection(e,t,i){if(e=e.getConnections_(!0),t=t.getConnections_(!0),e.length!==t.length)return null;for(let s=0;s<e.length;s++)if(e[s]===i)return t[s];return null}hidePreview(){l.disable$$module$build$src$core$events$utils();try{this.staticConn&&(this.staticConn.unhighlight(),this.staticConn=null),this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null),this.markerConn&&(this.hideInsertionMarker(this.markerConn),this.draggedConn=this.markerConn=null)}finally{l.enable$$module$build$src$core$events$utils()}}hideInsertionMarker(e){const t=e.getSourceBlock(),i=t.outputConnection;let s;if((s=t.previousConnection)!=null&&s.targetConnection||i!=null&&i.targetConnection)t.unplug(!0);else{let c;(c=e.targetBlock())==null||c.unplug(!1)}t.dispose()}dispose(){this.hidePreview()}};a(Re.CONNECTION_PREVIEWER,Po,p$);var Rc={};Rc.Align=l.Align$$module$build$src$core$inputs$align,Rc.DummyInput=Io,Rc.EndRowInput=cs,Rc.Input=ca,Rc.StatementInput=Yo,Rc.ValueInput=l.ValueInput$$module$build$src$core$inputs$value_input,Rc.inputTypes=l.inputTypes$$module$build$src$core$inputs$input_types;var g$=!1,$$;l.CodeGenerator$$module$build$src$core$generator=class{constructor(e){this.forBlock=Object.create(null),this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null,this.INDENT="  ",this.COMMENT_WRAP=60,this.ORDER_OVERRIDES=[],this.isInitialized=null,this.RESERVED_WORDS_="",this.definitions_=Object.create(null),this.functionNames_=Object.create(null),this.nameDB_=void 0,this.name_=e,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}workspaceToCode(e){e||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),e=v());var t=[];this.init(e),e=e.getTopBlocks(!0);for(let i=0,s;s=e[i];i++){let c=this.blockToCode(s);Array.isArray(c)&&(c=c[0]),c&&(s.outputConnection&&(c=this.scrubNakedValue(c),this.STATEMENT_PREFIX&&!s.suppressPrefixSuffix&&(c=this.injectId(this.STATEMENT_PREFIX,s)+c),this.STATEMENT_SUFFIX&&!s.suppressPrefixSuffix&&(c+=this.injectId(this.STATEMENT_SUFFIX,s))),t.push(c))}return t=t.join(`
`),t=this.finish(t),t=t.replace(/^\s+\n/,""),t=t.replace(/\n\s+$/,`
`),t=t.replace(/[ \t]+\n/g,`
`)}prefixLines(e,t){return t+e.replace(/(?!\n$)\n/g,`
`+t)}allNestedComments(e){const t=[];e=e.getDescendants(!0);for(let i=0;i<e.length;i++){const s=e[i].getCommentText();s&&t.push(s)}return t.length&&t.push(""),t.join(`
`)}blockToCode(e,t){if(this.isInitialized===!1&&console.warn("CodeGenerator init was not called before blockToCode was called."),!e)return"";if(!e.isEnabled())return t?"":this.blockToCode(e.getNextBlock());if(e.isInsertionMarker())return t?"":this.blockToCode(e.getChildren(!1)[0]);var i=this.forBlock[e.type];if(typeof i!="function")throw Error(`${this.name_} generator does not know how to generate code for block type "${e.type}".`);if(i=i.call(e,e,this),Array.isArray(i)){if(!e.outputConnection)throw TypeError("Expecting string from statement block: "+e.type);return[this.scrub_(e,i[0],t),i[1]]}if(typeof i=="string")return this.STATEMENT_PREFIX&&!e.suppressPrefixSuffix&&(i=this.injectId(this.STATEMENT_PREFIX,e)+i),this.STATEMENT_SUFFIX&&!e.suppressPrefixSuffix&&(i+=this.injectId(this.STATEMENT_SUFFIX,e)),this.scrub_(e,i,t);if(i===null)return"";throw SyntaxError("Invalid code generated: "+i)}valueToCode(e,t,i){if(isNaN(i))throw TypeError("Expecting valid order from block: "+e.type);var s=e.getInputTargetBlock(t);if(!s&&!e.getInput(t))throw ReferenceError(`Input "${t}" doesn't exist on "${e.type}"`);if(!s||(t=this.blockToCode(s),t===""))return"";if(!Array.isArray(t))throw TypeError(`Expecting tuple from value block: ${s.type} See developers.google.com/blockly/guides/create-custom-blocks/generating-code for more information`);if(e=t[0],t=t[1],isNaN(t))throw TypeError("Expecting valid order from value block: "+s.type);if(!e)return"";s=!1;var c=Math.floor(i);const m=Math.floor(t);if(c<=m&&(c!==m||c!==0&&c!==99)){for(s=!0,c=0;c<this.ORDER_OVERRIDES.length;c++)if(this.ORDER_OVERRIDES[c][0]===i&&this.ORDER_OVERRIDES[c][1]===t){s=!1;break}}return s&&(e="("+e+")"),e}statementToCode(e,t){const i=e.getInputTargetBlock(t);if(!i&&!e.getInput(t))throw ReferenceError(`Input "${t}" doesn't exist on "${e.type}"`);if(e=this.blockToCode(i),typeof e!="string")throw TypeError("Expecting code from statement block: "+(i&&i.type));return e&&(e=this.prefixLines(e,this.INDENT)),e}addLoopTrap(e,t){return this.INFINITE_LOOP_TRAP&&(e=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,t),this.INDENT)+e),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(e=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,t),this.INDENT)+e),this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(e+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,t),this.INDENT)),e}injectId(e,t){return t=t.id.replace(/\$/g,"$$$$"),e.replace(/%1/g,"'"+t+"'")}addReservedWords(e){this.RESERVED_WORDS_+=e+","}provideFunction_(e,t){if(!this.definitions_[e]){const i=this.nameDB_.getDistinctName(e,l.NameType$$module$build$src$core$names.PROCEDURE);this.functionNames_[e]=i,Array.isArray(t)&&(t=t.join(`
`)),t=t.trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,i);let s;for(;s!==t;)s=t,t=t.replace(/^(( {2})*) {2}/gm,"$1\0");t=t.replace(/\0/g,this.INDENT),this.definitions_[e]=t}return this.functionNames_[e]}getVariableName(e){return this.getName(e,l.NameType$$module$build$src$core$names.VARIABLE)}getProcedureName(e){return this.getName(e,l.NameType$$module$build$src$core$names.PROCEDURE)}getName(e,t){if(!this.nameDB_)throw Error("Name database is not defined. You must initialize `nameDB_` in your generator class and call `init` first.");return this.nameDB_.getName(e,t)}init(e){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)}scrub_(e,t,i){return t}finish(e){return this.definitions_=Object.create(null),this.functionNames_=Object.create(null),e}scrubNakedValue(e){return e}},$$={},$$.CodeGenerator=l.CodeGenerator$$module$build$src$core$generator;var wg=class extends cu{constructor(e){super(e)}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),i=t.getScrollMetrics(),s=t.getViewMetrics();t=t.getAbsoluteMetrics(),typeof e.y=="number"&&(this.workspace_.scrollY=-(i.top+(i.height-s.height)*e.y)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),i=e.getViewMetrics();return e=e.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===Lt.LEFT?e.width:i.width-this.getWidth():this.toolboxPosition_===Lt.LEFT?0:i.width:this.toolboxPosition_===Lt.LEFT?0:i.width+t.left-this.getWidth()}getY(){return 0}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=e.height;var t=this.getWidth()-this.CORNER_RADIUS;this.setBackgroundPath(t,e.height-2*this.CORNER_RADIUS),e=this.getX(),t=this.getY(),this.positionAt_(this.getWidth(),this.getHeight(),e,t)}}setBackgroundPath(e,t){const i=this.toolboxPosition_===Lt.RIGHT;var s=e+this.CORNER_RADIUS;s=["M "+(i?s:0)+",0"],s.push("h",i?-e:e),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,i?0:1,i?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),s.push("v",Math.max(0,t)),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,i?0:1,i?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),s.push("h",i?e:-e),s.push("z"),this.svgBackground_.setAttribute("d",s.join(" "))}scrollToStart(){let e;(e=this.workspace_.scrollbar)==null||e.setY(0)}wheel_(e){var t=at(e);if(t.y){const i=this.workspace_.getMetricsManager(),s=i.getScrollMetrics();t=i.getViewMetrics().top-s.top+t.y;let c;(c=this.workspace_.scrollbar)==null||c.setY(t),Bi(this.workspace_),Ts()}e.preventDefault(),e.stopPropagation()}layout_(e){this.workspace_.scale=this.targetWorkspace.scale;var t=this.MARGIN;const i=this.RTL?t:t+this.tabWidth_;for(const s of e)s.getElement().moveBy(i,t),t+=s.getElement().getBoundingRectangle().getHeight()}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<t&&e>-t||e<-180+t||e>180-t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.left;return this.toolboxPosition_===Lt.LEFT?new Nt(-1e9,1e9,-1e9,t+e.width):new Nt(-1e9,1e9,t,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=this.getContents().reduce((t,i)=>Math.max(t,i.getElement().getBoundingRectangle().getWidth()),0);if(e+=this.MARGIN*1.5+this.tabWidth_,e*=this.workspace_.scale,e+=qn.scrollbarThickness,this.getWidth()!==e){if(this.RTL)for(const t of this.getContents()){const i=t.getElement().getBoundingRectangle().left,s=e/this.workspace_.scale-t.getElement().getBoundingRectangle().getWidth()-this.MARGIN-this.tabWidth_;t.getElement().moveBy(s-i,0)}this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==Lt.LEFT||this.targetWorkspace.translate(this.targetWorkspace.scrollX+e,this.targetWorkspace.scrollY),this.width_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};wg.registryName="verticalFlyout",a(Re.FLYOUTS_VERTICAL_TOOLBOX,Po,wg);var m$=class extends cu{constructor(e){super(e),this.horizontalLayout=!0}setMetrics_(e){if(this.isVisible()){var t=this.workspace_.getMetricsManager(),i=t.getScrollMetrics(),s=t.getViewMetrics();t=t.getAbsoluteMetrics(),typeof e.x=="number"&&(this.workspace_.scrollX=-(i.left+(i.width-s.width)*e.x)),this.workspace_.translate(this.workspace_.scrollX+t.left,this.workspace_.scrollY+t.top)}}getX(){return 0}getY(){if(!this.isVisible())return 0;var e=this.targetWorkspace.getMetricsManager();const t=e.getAbsoluteMetrics(),i=e.getViewMetrics();e=e.getToolboxMetrics();const s=this.toolboxPosition_===Lt.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?s?e.height:i.height-this.getHeight():s?0:i.height:s?0:i.height+t.top-this.getHeight()}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var e=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=e.width,e=e.width-2*this.CORNER_RADIUS;var t=this.getHeight()-this.CORNER_RADIUS;this.setBackgroundPath(e,t),e=this.getX(),t=this.getY(),this.positionAt_(this.getWidth(),this.getHeight(),e,t)}}setBackgroundPath(e,t){const i=this.toolboxPosition_===Lt.TOP,s=["M 0,"+(i?0:this.CORNER_RADIUS)];i?(s.push("h",e+2*this.CORNER_RADIUS),s.push("v",t),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),s.push("h",-e),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),s.push("h",e),s.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),s.push("v",t),s.push("h",-e-2*this.CORNER_RADIUS)),s.push("z"),this.svgBackground_.setAttribute("d",s.join(" "))}scrollToStart(){let e;(e=this.workspace_.scrollbar)==null||e.setX(this.RTL?1/0:0)}wheel_(e){var t=at(e);if(t=t.x||t.y){const i=this.workspace_.getMetricsManager(),s=i.getScrollMetrics();t=i.getViewMetrics().left-s.left+t;let c;(c=this.workspace_.scrollbar)==null||c.setX(t),Bi(this.workspace_),Ts()}e.preventDefault(),e.stopPropagation()}layout_(e){this.workspace_.scale=this.targetWorkspace.scale;const t=this.MARGIN;let i=t+this.tabWidth_;this.RTL&&(e=e.reverse());for(const s of e)e=s.getElement().getBoundingRectangle(),e=this.RTL?i+e.getWidth():i,s.getElement().moveBy(e,t),i+=s.getElement().getBoundingRectangle().getWidth()}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;const t=this.dragAngleRange_;return e<90+t&&e>90-t||e>-90-t&&e<-90+t}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const e=this.svgGroup_.getBoundingClientRect(),t=e.top;return this.toolboxPosition_===Lt.TOP?new Nt(-1e9,t+e.height,-1e9,1e9):new Nt(t,1e9,-1e9,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let e=this.getContents().reduce((t,i)=>Math.max(t,i.getElement().getBoundingRectangle().getHeight()),0);e+=this.MARGIN*1.5,e*=this.workspace_.scale,e+=qn.scrollbarThickness,this.getHeight()!==e&&(this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==Lt.TOP||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+e),this.height_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets())}};a(Re.FLYOUTS_HORIZONTAL_TOOLBOX,Po,m$);var Np=class extends zi{constructor(e,t,i,s,c){super(dn.SKIP_SETUP),this.defaultType="",this.variableTypes=[],this.variable=null,this.SERIALIZABLE=!0,this.menuGenerator_=Np.dropdownCreate,this.defaultVariableName=typeof e=="string"?e:"",this.size_=new Mt(0,0),e!==dn.SKIP_SETUP&&(c?this.configure_(c):this.setTypes(i,s),t&&this.setValidator(t))}configure_(e){super.configure_(e),this.setTypes(e.variableTypes,e.defaultType)}initModel(){var e=this.getSourceBlock();if(!e)throw new ai;this.variable||(e=l.getOrCreateVariablePackage$$module$build$src$core$variables(e.workspace,null,this.defaultVariableName,this.defaultType),this.doValueUpdate_(e.getId()))}initView(){super.initView(),We(this.fieldGroup_,"blocklyVariableField")}shouldAddBorderRect_(){const e=this.getSourceBlock();if(!e)throw new ai;return super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||e.type!=="variables_get")}fromXml(e){var t=this.getSourceBlock();if(!t)throw new ai;const i=e.getAttribute("id"),s=e.textContent,c=e.getAttribute("variabletype")||e.getAttribute("variableType")||"";if(t=l.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,i,s,c),c!==null&&c!==t.getType())throw Error("Serialized variable type with id '"+t.getId()+"' had type "+t.getType()+", and does not match variable field that references it: "+xn(e)+".");this.setValue(t.getId())}toXml(e){return this.initModel(),e.id=this.variable.getId(),e.textContent=this.variable.getName(),this.variable.getType()&&e.setAttribute("variabletype",this.variable.getType()),e}saveState(e){var t=this.saveLegacyState(Np);return t!==null||(this.initModel(),t={id:this.variable.getId()},e&&(t.name=this.variable.getName(),t.type=this.variable.getType())),t}loadState(e){const t=this.getSourceBlock();if(!t)throw new ai;this.loadLegacyState(Np,e)||(e=l.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,e.id||null,e.name,e.type||""),this.setValue(e.getId()))}setSourceBlock(e){if(e.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");super.setSourceBlock(e)}getValue(){return this.variable?this.variable.getId():null}getText(){return this.variable?this.variable.getName():""}getVariable(){return this.variable}getDefaultType(){return this.defaultType}getValidator(){return this.variable?this.validator_:null}doClassValidation_(e){if(e===null)return null;var t=this.getSourceBlock();if(!t)throw new ai;return t=l.getVariable$$module$build$src$core$variables(t.workspace,e),t?(t=t.getType(),this.typeIsAllowed(t)?e:(console.warn("Variable type doesn't match this field!  Type was "+t),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+e),null)}doValueUpdate_(e){const t=this.getSourceBlock();if(!t)throw new ai;this.variable=l.getVariable$$module$build$src$core$variables(t.workspace,e),super.doValueUpdate_(e)}typeIsAllowed(e){const t=this.getVariableTypes();if(!t)return!0;for(let i=0;i<t.length;i++)if(e===t[i])return!0;return!1}getVariableTypes(){if(this.variableTypes)return this.variableTypes;if(!this.sourceBlock_||this.sourceBlock_.isDeadOrDying())return[""];let e=this.sourceBlock_.workspace.getVariableMap().getTypes();if(this.sourceBlock_.isInFlyout){const t=this.sourceBlock_.workspace.getPotentialVariableMap();if(!t)return e;e=Array.from(new Set([...e,...t.getTypes()]))}return e}setTypes(e=null,t=""){var i=this.getText();if(Array.isArray(e)){if(e.length===0)throw Error(`'variableTypes' of field variable ${i} was an empty list. If you want to include all variable types, pass 'null' instead.`);i=!1;for(let s=0;s<e.length;s++)e[s]===t&&(i=!0);if(!i)throw Error("Invalid default type '"+t+"' in the definition of a FieldVariable")}else if(e!==null)throw Error(`'variableTypes' was not an array or null in the definition of FieldVariable ${i}`);this.defaultType=t,this.variableTypes=e}refreshVariableName(){this.forceRerender()}onItemSelected_(e,t){if(e=t.getValue(),this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(e===mp&&this.variable){l.renameVariable$$module$build$src$core$variables(this.sourceBlock_.workspace,this.variable);return}if(e===_p&&this.variable){e=this.variable.getWorkspace(),l.deleteVariable$$module$build$src$core$variables(e,this.variable,this.sourceBlock_);return}}this.setValue(e)}referencesVariables(){return!0}static fromJson(e){return new this(Ge(e.variable),void 0,void 0,void 0,e)}static dropdownCreate(){if(!this.variable)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");const e=this.getText();let t=[];var i=this.getSourceBlock();if(i&&!i.isDeadOrDying()){i=i.workspace;const m=this.getVariableTypes();for(let I=0;I<m.length;I++){const B=m[I],Se=i.getVariableMap().getVariablesOfType(B);if(t=t.concat(Se),i.isFlyout){var s=void 0,c=void 0;t=t.concat((c=(s=i.getPotentialVariableMap())==null?void 0:s.getVariablesOfType(B))!=null?c:[])}}}for(t.sort(lr),s=[],c=0;c<t.length;c++)s[c]=[t[c].getName(),t[c].getId()];return s.push([l.Msg$$module$build$src$core$msg.RENAME_VARIABLE,mp]),l.Msg$$module$build$src$core$msg.DELETE_VARIABLE&&s.push([l.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",e),_p]),s}};Ss("field_variable",Np);var Ng=class extends df{constructor(e,t,i,s,c,m){super(dn.SKIP_SETUP),this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces=null,this.spellcheck_=!1,e!==dn.SKIP_SETUP&&(m?this.configure_(m):this.setConstraints(t,i,s),this.setValue(e),c&&this.setValidator(c))}configure_(e){super.configure_(e),this.setMinInternal(e.min),this.setMaxInternal(e.max),this.setPrecisionInternal(e.precision)}setConstraints(e,t,i){this.setMinInternal(e),this.setMaxInternal(t),this.setPrecisionInternal(i),this.setValue(this.getValue())}setMin(e){this.setMinInternal(e),this.setValue(this.getValue())}setMinInternal(e){e==null?this.min_=-1/0:(e=Number(e),isNaN(e)||(this.min_=e))}getMin(){return this.min_}setMax(e){this.setMaxInternal(e),this.setValue(this.getValue())}setMaxInternal(e){e==null?this.max_=1/0:(e=Number(e),isNaN(e)||(this.max_=e))}getMax(){return this.max_}setPrecision(e){this.setPrecisionInternal(e),this.setValue(this.getValue())}setPrecisionInternal(e){this.precision_=Number(e)||0;let t=String(this.precision_);t.includes("e")&&(t=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));const i=t.indexOf(".");this.decimalPlaces=i===-1?e?0:null:t.length-i-1}getPrecision(){return this.precision_}doClassValidation_(e){return e===null||(e=`${e}`.replace(/O/gi,"0"),e=e.replace(/,/g,""),e=e.replace(/infinity/i,"Infinity"),e=Number(e||0),isNaN(e))?null:(e=Math.min(Math.max(e,this.min_),this.max_),this.precision_&&isFinite(e)&&(e=Math.round(e/this.precision_)*this.precision_),this.decimalPlaces!==null&&(e=Number(e.toFixed(this.decimalPlaces))),e)}widgetCreate_(){const e=super.widgetCreate_();return this.min_>-1/0&&(e.min=`${this.min_}`,It(e,Wn.VALUEMIN,this.min_)),this.max_<1/0&&(e.max=`${this.max_}`,It(e,Wn.VALUEMAX,this.max_)),e}initView(){super.initView(),this.fieldGroup_&&We(this.fieldGroup_,"blocklyNumberField")}static fromJson(e){return new this(e.value,void 0,void 0,void 0,void 0,e)}};Ss("field_number",Ng),Ng.prototype.DEFAULT_VALUE=0;var _$=class extends ua{constructor(e,t,i){super(String(e??""),t,i),this.EDITABLE=!1,this.SERIALIZABLE=!0}static fromJson(e){return new this(Ge(e.text),void 0,e)}};Ss("field_label_serializable",_$);var Dh=class extends dn{constructor(e,t,i){super(dn.SKIP_SETUP),this.SERIALIZABLE=!0,this.value_=this.value_,this.checkChar=Dh.CHECK_CHAR,e!==dn.SKIP_SETUP&&(i&&this.configure_(i),this.setValue(e),t&&this.setValidator(t))}configure_(e){super.configure_(e),e.checkCharacter&&(this.checkChar=e.checkCharacter)}saveState(){const e=this.saveLegacyState(Dh);return e!==null?e:this.getValueBoolean()}initView(){super.initView();const e=this.getTextElement();We(this.fieldGroup_,"blocklyCheckboxField"),e.style.display=this.value_?"block":"none"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar}setCheckCharacter(e){this.checkChar=e||Dh.CHECK_CHAR,this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(e){return e===!0||e==="TRUE"?"TRUE":e===!1||e==="FALSE"?"FALSE":null}doValueUpdate_(e){this.value_=this.convertValueToBool(e),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")}getValue(){return this.value_?"TRUE":"FALSE"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool(this.value_))}convertValueToBool(e){return typeof e=="string"?e==="TRUE":!!e}static fromJson(e){return new this(e.checked,void 0,e)}};Dh.CHECK_CHAR="✓",Ss("field_checkbox",Dh),Dh.prototype.DEFAULT_VALUE=!1;var b$=class{constructor(e,t){this.draggable=e,this.workspace=t,this.dragTarget=null,this.startLoc=e.getRelativeToSurfaceXY()}onDragStart(e){l.getGroup$$module$build$src$core$events$utils()||l.setGroup$$module$build$src$core$events$utils(!0),this.draggable.startDrag(e)}onDrag(e,t){this.moveDraggable(e,t),t=this.getRoot(this.draggable),xo(t)&&t.setDeleteStyle(this.wouldDeleteDraggable(e,t)),this.updateDragTarget(e)}updateDragTarget(e){e=this.workspace.getDragTarget(e);const t=this.getRoot(this.draggable);if(this.dragTarget!==e){let i;(i=this.dragTarget)==null||i.onDragExit(t),e?.onDragEnter(t)}e?.onDragOver(t),this.dragTarget=e}moveDraggable(e,t){t=this.pixelsToWorkspaceUnits(t),t=Ne.sum(this.startLoc,t),this.draggable.drag(t,e)}wouldDeleteDraggable(e,t){return(e=this.workspace.getDragTarget(e))&&this.workspace.getComponentManager().hasCapability(e.id,un.Capability.DELETE_AREA)?e.wouldDelete(t):!1}onDragEnd(e){const t=l.getGroup$$module$build$src$core$events$utils();var i=this.workspace.getDragTarget(e);const s=this.getRoot(this.draggable);if(i){let c;(c=this.dragTarget)==null||c.onDrop(s)}this.shouldReturnToStart(e,s)&&this.draggable.revertDrag(),(i=xo(s)&&this.wouldDeleteDraggable(e,s))&&this.draggable instanceof Rn&&Tr(this.draggable.getRootBlock()),this.draggable.endDrag(e),i&&xo(s)&&(l.setGroup$$module$build$src$core$events$utils(t),s.dispose()),l.setGroup$$module$build$src$core$events$utils(!1),!i&&Zn(this.draggable)&&l.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.draggable)}getRoot(e){return e instanceof Rn?e.getRootBlock():e}shouldReturnToStart(e,t){return(e=this.workspace.getDragTarget(e))?e.shouldPreventMove(t):!1}pixelsToWorkspaceUnits(e){return e=new Ne(e.x/this.workspace.scale,e.y/this.workspace.scale),this.workspace.isMutator&&e.scale(1/this.workspace.options.parentWorkspace.scale),e}};a(Re.BLOCK_DRAGGER,Po,b$);var kp={};kp.BlockDragStrategy=Oh,kp.BubbleDragStrategy=Qd,kp.CommentDragStrategy=Qp,kp.Dragger=b$;var kg=class extends tn{constructor(e,t,i){super(e?e.workspace.id:void 0),this.type=ce.BLOCK_DRAG,e&&(this.blockId=e.id,this.isStart=t,this.blocks=i)}toJson(){const e=super.toJson();if(this.isStart===void 0)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(this.blockId===void 0)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.isStart=this.isStart,e.blockId=this.blockId,e.blocks=this.blocks,e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new kg),t.isStart=e.isStart,t.blockId=e.blockId,t.blocks=e.blocks,t}};a(Re.EVENT,ce.BLOCK_DRAG,kg);var Mg=class extends Ql{constructor(e,t,i,s){super(e),this.type=ce.BLOCK_FIELD_INTERMEDIATE_CHANGE,this.recordUndo=!1,e&&(this.name=t,this.oldValue=i,this.newValue=s)}toJson(){const e=super.toJson();if(!this.name)throw Error("The changed field name is undefined. Either pass a name to the constructor, or call fromJson.");return e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new Mg),t.name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,t}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(t=t.getBlockById(this.blockId),!t)throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");e=e?this.newValue:this.oldValue,(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name)}};a(Re.EVENT,ce.BLOCK_FIELD_INTERMEDIATE_CHANGE,Mg);var Lg=class extends Ql{constructor(e){super(e),this.type=ce.BLOCK_MOVE,e&&(e.isShadow()&&(this.recordUndo=!1),e=this.currentLocation(),this.oldParentId=e.parentId,this.oldInputName=e.inputName,this.oldCoordinate=e.coordinate)}toJson(){const e=super.toJson();return e.oldParentId=this.oldParentId,e.oldInputName=this.oldInputName,this.oldCoordinate&&(e.oldCoordinate=`${Math.round(this.oldCoordinate.x)}, ${Math.round(this.oldCoordinate.y)}`),e.newParentId=this.newParentId,e.newInputName=this.newInputName,this.newCoordinate&&(e.newCoordinate=`${Math.round(this.newCoordinate.x)}, ${Math.round(this.newCoordinate.y)}`),this.reason&&(e.reason=this.reason),this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new Lg),t.oldParentId=e.oldParentId,t.oldInputName=e.oldInputName,e.oldCoordinate&&(i=e.oldCoordinate.split(","),t.oldCoordinate=new Ne(Number(i[0]),Number(i[1]))),t.newParentId=e.newParentId,t.newInputName=e.newInputName,e.newCoordinate&&(i=e.newCoordinate.split(","),t.newCoordinate=new Ne(Number(i[0]),Number(i[1]))),e.reason!==void 0&&(t.reason=e.reason),e.recordUndo!==void 0&&(t.recordUndo=e.recordUndo),t}recordNew(){const e=this.currentLocation();this.newParentId=e.parentId,this.newInputName=e.inputName,this.newCoordinate=e.coordinate}setReason(e){this.reason=e}currentLocation(){var e=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var t=e.getBlockById(this.blockId);if(!t)throw Error("The block associated with the block move event could not be found");e={};const i=t.getParent();return i?(e.parentId=i.id,(t=i.getInputWithBlock(t))&&(e.inputName=t.name)):e.coordinate=t.getRelativeToSurfaceXY(),e}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&Ne.equals(this.oldCoordinate,this.newCoordinate)}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var i=t.getBlockById(this.blockId);if(i){var s=e?this.newParentId:this.oldParentId,c=e?this.newInputName:this.oldInputName;if(e=e?this.newCoordinate:this.oldCoordinate,s){var m=t.getBlockById(s);if(!m){console.warn("Can't connect to non-existent block: "+s);return}}if(i.getParent()&&i.unplug(),e)c=i.getRelativeToSurfaceXY(),i.moveBy(e.x-c.x,e.y-c.y,this.reason);else{t=i.outputConnection,(!t||i.previousConnection&&i.previousConnection.isConnected())&&(t=i.previousConnection);let I,B;i=(B=t)==null?void 0:B.type,c?(i=m.getInput(c))&&(I=i.connection):i===lt.PREVIOUS_STATEMENT&&(I=m.nextConnection),I&&t?t.connect(I):console.warn("Can't connect to non-existent input: "+c)}}else console.warn("Can't move non-existent block: "+this.blockId)}};a(Re.EVENT,ce.BLOCK_MOVE,Lg);var Dg=class extends tn{constructor(e,t,i){super(e?e.workspace.id:void 0),this.type=ce.BUBBLE_OPEN,e&&(this.blockId=e.id,this.isOpen=t,this.bubbleType=i)}toJson(){const e=super.toJson();if(this.isOpen===void 0)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(!this.bubbleType)throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e.bubbleType=this.bubbleType,e.blockId=this.blockId||"",e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new Dg),t.isOpen=e.isOpen,t.bubbleType=e.bubbleType,t.blockId=e.blockId,t}},xg;(function(e){e.MUTATOR="mutator",e.COMMENT="comment",e.WARNING="warning"})(xg||(xg={})),a(Re.EVENT,ce.BUBBLE_OPEN,Dg);var pu=class extends Nr{constructor(e){super(),this.isBlank=!e,e&&(this.commentId=e.id,this.workspaceId=e.workspace.id,this.group=l.getGroup$$module$build$src$core$events$utils(),this.recordUndo=_t())}toJson(){const e=super.toJson();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.commentId=this.commentId,e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new pu),t.commentId=e.commentId,t}static CommentCreateDeleteHelper(e,t){const i=e.getEventWorkspace_();if(t){if(!e.json)throw Error("Encountered a comment event without proper json");uo(e.json,i)}else{if(!e.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(t=i.getCommentById(e.commentId))?t.dispose():console.warn("Can't delete non-existent comment: "+e.commentId)}}},Bg=class extends pu{constructor(e,t,i){super(e),this.type=ce.COMMENT_CHANGE,e&&(this.oldContents_=typeof t>"u"?"":t,this.newContents_=typeof i>"u"?"":i)}toJson(){const e=super.toJson();if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newContents_)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");return e.oldContents=this.oldContents_,e.newContents=this.newContents_,e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new Bg),t.oldContents_=e.oldContents,t.newContents_=e.newContents,t}isNull(){return this.oldContents_===this.newContents_}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){var i=e?this.newContents_:this.oldContents_;if(i===void 0)throw Error(e?"The new contents is undefined. Either pass a value to the constructor, or call fromJson":"The old contents is undefined. Either pass a value to the constructor, or call fromJson");t.setText(i)}else console.warn("Can't change non-existent comment: "+this.commentId)}};a(Re.EVENT,ce.COMMENT_CHANGE,Bg);var Pg=class extends pu{constructor(e,t){super(e),this.newCollapsed=t,this.type=ce.COMMENT_COLLAPSE}toJson(){const e=super.toJson();if(this.newCollapsed===void 0)throw Error("The new collapse value undefined. Either call recordNew, or call fromJson");return e.newCollapsed=this.newCollapsed,e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new Pg),t.newCollapsed=e.newCollapsed,t}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(t=t.getCommentById(this.commentId))?t.setCollapsed(e?!!this.newCollapsed:!this.newCollapsed):console.warn("Can't collapse or uncollapse non-existent comment: "+this.commentId)}};a(Re.EVENT,ce.COMMENT_COLLAPSE,Pg);var Fg=class extends pu{constructor(e){super(e),this.type=ce.COMMENT_CREATE,e&&(this.xml=Lo(e),this.json=$s(e,{addCoordinates:!0}))}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.json)throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=xn(this.xml),e.json=this.json,e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new Fg),t.xml=l.textToDom$$module$build$src$core$utils$xml(e.xml),t.json=e.json,t}run(e){pu.CommentCreateDeleteHelper(this,e)}};a(Re.EVENT,ce.COMMENT_CREATE,Fg);var Ug=class extends pu{constructor(e){super(e),this.type=ce.COMMENT_DELETE,e&&(this.xml=Lo(e),this.json=$s(e,{addCoordinates:!0}))}run(e){pu.CommentCreateDeleteHelper(this,!e)}toJson(){const e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.json)throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson");return e.xml=xn(this.xml),e.json=this.json,e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new Ug),t.xml=l.textToDom$$module$build$src$core$utils$xml(e.xml),t.json=e.json,t}};a(Re.EVENT,ce.COMMENT_DELETE,Ug);var Hg=class extends tn{constructor(e,t){super(e?e.workspace.id:void 0),this.type=ce.COMMENT_DRAG,e&&(this.commentId=e.id,this.isStart=t)}toJson(){const e=super.toJson();if(this.isStart===void 0)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(this.commentId===void 0)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.isStart=this.isStart,e.commentId=this.commentId,e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new Hg),t.isStart=e.isStart,t.commentId=e.commentId,t}};a(Re.EVENT,ce.COMMENT_DRAG,Hg);var Gg=class extends pu{constructor(e){super(e),this.type=ce.COMMENT_MOVE,e&&(this.comment_=e,this.oldCoordinate_=e.getRelativeToSurfaceXY())}recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getRelativeToSurfaceXY()}setReason(e){this.reason=e}setOldCoordinate(e){this.oldCoordinate_=e}toJson(){const e=super.toJson();if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newCoordinate_)throw Error("The new comment position is undefined. Either call recordNew, or call fromJson");return e.oldCoordinate=`${Math.round(this.oldCoordinate_.x)}, ${Math.round(this.oldCoordinate_.y)}`,e.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y),e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new Gg),i=e.oldCoordinate.split(","),t.oldCoordinate_=new Ne(Number(i[0]),Number(i[1])),i=e.newCoordinate.split(","),t.newCoordinate_=new Ne(Number(i[0]),Number(i[1])),t}isNull(){return Ne.equals(this.oldCoordinate_,this.newCoordinate_)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(e=e?this.newCoordinate_:this.oldCoordinate_,!e)throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");t.moveTo(e)}else console.warn("Can't move non-existent comment: "+this.commentId)}};a(Re.EVENT,ce.COMMENT_MOVE,Gg);var Vg=class extends pu{constructor(e){super(e),this.type=ce.COMMENT_RESIZE,e&&(this.oldSize=e.getSize())}recordCurrentSizeAsNewSize(){if(this.newSize)throw Error("Tried to record the new size of a comment on the same event twice.");var e=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(e=e.getCommentById(this.commentId),!e)throw Error("The comment associated with the comment resize event could not be found");this.newSize=e.getSize()}toJson(){const e=super.toJson();if(!this.oldSize)throw Error("The old comment size is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newSize)throw Error("The new comment size is undefined. Either call recordCurrentSizeAsNewSize, or call fromJson");return e.oldWidth=Math.round(this.oldSize.width),e.oldHeight=Math.round(this.oldSize.height),e.newWidth=Math.round(this.newSize.width),e.newHeight=Math.round(this.newSize.height),e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new Vg),t.oldSize=new Mt(e.oldWidth,e.oldHeight),t.newSize=new Mt(e.newWidth,e.newHeight),t}isNull(){return Mt.equals(this.oldSize,this.newSize)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(e=e?this.newSize:this.oldSize,!e)throw Error("Either oldSize or newSize is undefined. Either pass a comment to the constructor and call recordCurrentSizeAsNewSize, or call fromJson");t.setSize(e)}else console.warn("Can't resize non-existent comment: "+this.commentId)}};a(Re.EVENT,ce.COMMENT_RESIZE,Vg);var zg=class extends tn{constructor(e,t,i){super(i),this.type=ce.TOOLBOX_ITEM_SELECT,this.oldItem=e??void 0,this.newItem=t??void 0}toJson(){const e=super.toJson();return e.oldItem=this.oldItem,e.newItem=this.newItem,e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new zg),t.oldItem=e.oldItem,t.newItem=e.newItem,t}};a(Re.EVENT,ce.TOOLBOX_ITEM_SELECT,zg);var Wg=class extends af{constructor(e,t,i){super(e),this.oldType=t,this.newType=i,this.type=ce.VAR_TYPE_CHANGE}toJson(){const e=super.toJson();if(!this.oldType||!this.newType)throw Error("The variable's types are undefined. Either pass them to the constructor, or call fromJson");return e.oldType=this.oldType,e.newType=this.newType,e}static fromJson(e,t,i){return t=super.fromJson(e,t,i??new Wg),t.oldType=e.oldType,t.newType=e.newType,t}run(e){const t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldType||!this.newType)throw Error("The variable's types are undefined. Either pass them to the constructor, or call fromJson");const i=t.getVariableMap().getVariableById(this.varId);i&&(e?t.getVariableMap().changeVariableType(i,this.newType):t.getVariableMap().changeVariableType(i,this.oldType))}};a(Re.EVENT,ce.VAR_TYPE_CHANGE,Wg);var E$=class extends Nr{constructor(e){super(),this.isBlank=!0,this.recordUndo=!1,this.type=ce.FINISHED_LOADING,this.isBlank=!!e,e&&(this.workspaceId=e.id)}};a(Re.EVENT,ce.FINISHED_LOADING,E$);var T$,v$,y$,S$,C$,R$,I$,O$,A$,w$,N$,k$,M$,L$,D$,x$,B$,P$,F$,U$,H$,G$,V$,z$,st;l.BLOCK_CHANGE$$module$build$src$core$events$events=ce.BLOCK_CHANGE,l.BLOCK_CREATE$$module$build$src$core$events$events=ce.BLOCK_CREATE,l.BLOCK_DELETE$$module$build$src$core$events$events=ce.BLOCK_DELETE,T$=ce.BLOCK_DRAG,l.BLOCK_MOVE$$module$build$src$core$events$events=ce.BLOCK_MOVE,v$=ce.BLOCK_FIELD_INTERMEDIATE_CHANGE,y$=ce.BUBBLE_OPEN,S$=ce.BLOCK_CHANGE,C$=ce.CLICK,R$=ce.COMMENT_CHANGE,I$=ce.COMMENT_CREATE,O$=ce.COMMENT_DELETE,A$=ce.COMMENT_MOVE,w$=ce.COMMENT_RESIZE,N$=ce.COMMENT_DRAG,k$=ce.BLOCK_CREATE,M$=ce.BLOCK_DELETE,L$=ce.FINISHED_LOADING,D$=ce.BLOCK_MOVE,x$=ce.SELECTED,B$=ce.THEME_CHANGE,P$=ce.TOOLBOX_ITEM_SELECT,F$=ce.TRASHCAN_OPEN,U$=ce.UI,H$=ce.VAR_CREATE,G$=ce.VAR_DELETE,V$=ce.VAR_RENAME,z$=ce.VIEWPORT_CHANGE,st={},st.Abstract=Nr,st.BLOCK_CHANGE=l.BLOCK_CHANGE$$module$build$src$core$events$events,st.BLOCK_CREATE=l.BLOCK_CREATE$$module$build$src$core$events$events,st.BLOCK_DELETE=l.BLOCK_DELETE$$module$build$src$core$events$events,st.BLOCK_DRAG=T$,st.BLOCK_FIELD_INTERMEDIATE_CHANGE=v$,st.BLOCK_MOVE=l.BLOCK_MOVE$$module$build$src$core$events$events,st.BUBBLE_OPEN=y$,st.BUMP_EVENTS=Hf,st.BlockBase=Ql,st.BlockChange=eu,st.BlockCreate=Jd,st.BlockDelete=gp,st.BlockDrag=kg,st.BlockFieldIntermediateChange=Mg,st.BlockMove=Lg,st.BubbleOpen=Dg,st.BubbleType=xg,st.CHANGE=S$,st.CLICK=C$,st.COMMENT_CHANGE=R$,st.COMMENT_CREATE=I$,st.COMMENT_DELETE=O$,st.COMMENT_DRAG=N$,st.COMMENT_MOVE=A$,st.COMMENT_RESIZE=w$,st.CREATE=k$,st.Click=Yf,st.ClickTarget=Kf,st.CommentBase=pu,st.CommentChange=Bg,st.CommentCollapse=Pg,st.CommentCreate=Fg,st.CommentDelete=Ug,st.CommentDrag=Hg,st.CommentMove=Gg,st.CommentResize=Vg,st.DELETE=M$,st.FINISHED_LOADING=L$,st.FinishedLoading=E$,st.MOVE=D$,st.SELECTED=x$,st.Selected=Js,st.THEME_CHANGE=B$,st.TOOLBOX_ITEM_SELECT=P$,st.TRASHCAN_OPEN=F$,st.ThemeChange=Rh,st.ToolboxItemSelect=zg,st.TrashcanOpen=Sg,st.UI=U$,st.UiBase=tn,st.VAR_CREATE=H$,st.VAR_DELETE=G$,st.VAR_RENAME=V$,st.VIEWPORT_CHANGE=z$,st.VarBase=af,st.VarCreate=Tg,st.VarDelete=vg,st.VarRename=yg,st.VarTypeChange=Wg,st.ViewportChange=dp,st.clearPendingUndo=Et,st.disable=l.disable$$module$build$src$core$events$utils,st.disableOrphans=Ni,st.enable=l.enable$$module$build$src$core$events$utils,st.filter=it,st.fire=Be,st.fromJson=tt,st.get=Qe,st.getDescendantIds=An,st.getGroup=l.getGroup$$module$build$src$core$events$utils,st.getRecordUndo=_t,st.isEnabled=Ze,st.setGroup=l.setGroup$$module$build$src$core$events$utils,st.setRecordUndo=l.setRecordUndo$$module$build$src$core$events$utils;var gu={};gu.BottomRow=a$,gu.ConstantProvider=l$,gu.Drawer=u$,gu.PathObject=f$,gu.RenderInfo=d$,gu.Renderer=Ag,gu.RightConnectionShape=c$,gu.StatementInput=mg,gu.TopRow=h$,bd();var oo={};oo.registerCleanup=rd,oo.registerCollapse=ud,oo.registerCollapseExpandBlock=nh,oo.registerComment=Va,oo.registerCommentCreate=md,oo.registerCommentDelete=gd,oo.registerCommentDuplicate=$d,oo.registerCommentOptions=Nf,oo.registerDefaultOptions=bd,oo.registerDelete=fd,oo.registerDeleteAll=Wl,oo.registerDisable=wf,oo.registerDuplicate=Ga,oo.registerExpand=ad,oo.registerHelp=pd,oo.registerInline=dd,oo.registerRedo=th,oo.registerUndo=sd;var jg="button",W$=class{load(e,t){return e=new ji(t.getWorkspace(),t.targetWorkspace,e,!1),e.show(),new mc(e,jg)}gapForItem(e,t){return t}disposeItem(e){e=e.getElement(),e instanceof ji&&e.dispose()}getType(){return jg}};a(Re.FLYOUT_INFLATER,jg,W$);var Mp={};Mp.Bubble=fn,Mp.MiniWorkspaceBubble=Fr,Mp.TextBubble=bp,Mp.TextInputBubble=Ro;var _m="WORKSPACE_AT_BLOCK_CAPACITY",Xg="block",j$=class{constructor(){this.permanentlyDisabledBlocks=new Set,this.listeners=new Map,this.capacityWrapper=this.filterFlyoutBasedOnCapacity.bind(this)}load(e,t){return this.setFlyout(t),e=this.createBlock(e,t.getWorkspace()),e.isEnabled()?this.updateStateBasedOnCapacity(e):this.permanentlyDisabledBlocks.add(e),e.getDescendants(!1).forEach(i=>i.isInFlyout=!0),this.addBlockListeners(e),new mc(e,Xg)}createBlock(e,t){return e.blockxml?(e=typeof e.blockxml=="string"?l.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,t=Zr(e,t)):(e.enabled===void 0&&(e.enabled=e.disabled!=="true"&&e.disabled!==!0),e.disabledReasons===void 0&&e.enabled===!1&&(e.disabledReasons=[wt]),"x"in e&&delete e.x,"y"in e&&delete e.y,t=ur(e,t)),t}gapForItem(e,t){let i;return e.gap?i=parseInt(String(e.gap)):e.blockxml&&(e=typeof e.blockxml=="string"?l.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,i=parseInt(e.getAttribute("gap"))),!i||isNaN(i)?t:i}disposeItem(e){e=e.getElement(),e instanceof Rn&&(this.removeListeners(e.id),e.dispose(!1,!1))}removeListeners(e){let t;((t=this.listeners.get(e))!=null?t:[]).forEach(i=>Ae(i)),this.listeners.delete(e)}setFlyout(e){if(this.flyout!==e){if(this.flyout){let i;(i=this.flyout.targetWorkspace)==null||i.removeChangeListener(this.capacityWrapper)}this.flyout=e;var t;(t=this.flyout.targetWorkspace)==null||t.addChangeListener(this.capacityWrapper)}}updateStateBasedOnCapacity(e){let t,i;const s=(t=this.flyout)==null||(i=t.targetWorkspace)==null?void 0:i.isCapacityAvailable($i(e));for(;e;)e.setDisabledReason(!s,_m),e=e.getNextBlock()}addBlockListeners(e){const t=[];t.push(_e(e.getSvgRoot(),"pointerdown",e,i=>{let s,c;const m=(s=this.flyout)==null||(c=s.targetWorkspace)==null?void 0:c.getGesture(i);m&&this.flyout&&(m.setStartBlock(e),m.handleFlyoutStart(i,this.flyout))})),t.push(Le(e.getSvgRoot(),"pointermove",null,()=>{let i,s;!((i=this.flyout)==null||(s=i.targetWorkspace)==null)&&s.isDragging()||e.addSelect()})),t.push(Le(e.getSvgRoot(),"pointerleave",null,()=>{let i,s;!((i=this.flyout)==null||(s=i.targetWorkspace)==null)&&s.isDragging()||e.removeSelect()})),this.listeners.set(e.id,t)}filterFlyoutBasedOnCapacity(e){!this.flyout||e&&e.type!==ce.BLOCK_CREATE&&e.type!==ce.BLOCK_DELETE||this.flyout.getWorkspace().getTopBlocks(!1).forEach(t=>{this.permanentlyDisabledBlocks.has(t)||this.updateStateBasedOnCapacity(t)})}getType(){return Xg}};a(Re.FLYOUT_INFLATER,Xg,j$);var X$=class extends he{constructor(){super(),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(e){return super.getCSS_(e).concat([`${e} .blocklyInsertionMarker>.blocklyPathLight,`,`${e} .blocklyInsertionMarker>.blocklyPathDark {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"])}},Y$=class{constructor(e){this.inlineSteps_=this.steps_="",this.info_=e,this.RTL_=this.info_.RTL,e=e.getRenderer(),this.constants_=e.getConstants(),this.highlightConstants_=e.getHighlightConstants(),this.highlightOffset=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+`
`+this.inlineSteps_}drawTopCorner(e){this.steps_+=yn(e.xPos,this.info_.startY);for(let t=0,i;i=e.elements[t];t++)K.isLeftSquareCorner(i)?this.steps_+=this.highlightConstants_.START_POINT:K.isLeftRoundedCorner(i)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):K.isPreviousConnection(i)?this.steps_+=this.notchPaths_.pathLeft:K.isHat(i)?this.steps_+=this.startPaths_.path(this.RTL_):K.isSpacer(i)&&i.width!==0&&(this.steps_+=$t("H",i.xPos+i.width-this.highlightOffset));this.steps_+=$t("H",e.xPos+e.width-this.highlightOffset)}drawJaggedEdge_(e){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+$t("v",e.height-this.jaggedTeethPaths_.height-this.highlightOffset))}drawValueInput(e){const t=e.getLastInput();if(this.RTL_){const i=e.height-t.connectionHeight;this.steps_+=Oi(t.xPos+t.width-this.highlightOffset,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+$t("v",i)}else this.steps_+=Oi(t.xPos+t.width,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(e){const t=e.getLastInput();if(t)if(this.RTL_){const i=e.height-2*this.insideCornerPaths_.height;this.steps_+=Oi(t.xPos,e.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+$t("v",i)+this.insideCornerPaths_.pathBottom(this.RTL_)+Rs(e.width-t.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=Oi(t.xPos,e.yPos+e.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+Rs(e.width-t.xPos-this.insideCornerPaths_.width,0)}drawRightSideRow(e){const t=e.xPos+e.width-this.highlightOffset;e instanceof yt&&e.followsStatement&&(this.steps_+=$t("H",t)),this.RTL_&&(this.steps_+=$t("H",t),e.height>this.highlightOffset&&(this.steps_+=$t("V",e.yPos+e.height-this.highlightOffset)))}drawBottomRow(e){if(this.RTL_)this.steps_+=$t("V",e.baseline-this.highlightOffset);else{const t=this.info_.bottomRow.elements[0];K.isLeftSquareCorner(t)?this.steps_+=Oi(e.xPos+this.highlightOffset,e.baseline-this.highlightOffset):K.isLeftRoundedCorner(t)&&(this.steps_+=Oi(e.xPos,e.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}}drawLeft(){var e=this.info_.outputConnection;e&&(e=e.connectionOffsetY+e.height,this.RTL_?this.steps_+=Oi(this.info_.startX,e):(this.steps_+=Oi(this.info_.startX+this.highlightOffset,this.info_.bottomRow.baseline-this.highlightOffset),this.steps_+=$t("V",e)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(e=this.info_.topRow,K.isLeftRoundedCorner(e.elements[0])?this.steps_+=$t("V",this.outsideCornerPaths_.height):this.steps_+=$t("V",e.capline+this.highlightOffset))}drawInlineInput(e){const t=this.highlightOffset,i=e.xPos+e.connectionWidth;var s=e.centerline-e.height/2;const c=e.width-e.connectionWidth,m=s+t;this.RTL_?(s=e.connectionOffsetY-t,e=e.height-(e.connectionOffsetY+e.connectionHeight)+t,this.inlineSteps_+=Oi(i-t,m)+$t("v",s)+this.puzzleTabPaths_.pathDown(this.RTL_)+$t("v",e)+$t("h",c)):this.inlineSteps_+=Oi(e.xPos+e.width+t,m)+$t("v",e.height)+$t("h",-c)+Oi(i,s+e.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},K$=class extends we{constructor(e,t){super(e,t),this.highlighter_=new Y$(t)}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights();const e=this.block_.pathObject;e.setPath(this.outlinePath_+`
`+this.inlinePath_),e.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),super.drawTop_()}drawJaggedEdge_(e){this.highlighter_.drawJaggedEdge_(e),super.drawJaggedEdge_(e)}drawValueInput_(e){this.highlighter_.drawValueInput(e),super.drawValueInput_(e)}drawStatementInput_(e){this.highlighter_.drawStatementInput(e),super.drawStatementInput_(e)}drawRightSideRow_(e){this.highlighter_.drawRightSideRow(e),this.outlinePath_+=$t("H",e.xPos+e.width)+$t("V",e.yPos+e.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow),super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft(),super.drawLeft_()}drawInlineInput_(e){this.highlighter_.drawInlineInput(e),super.drawInlineInput_(e)}positionInlineInputConnection_(e){const t=e.centerline-e.height/2;if(e.connectionModel){let i=e.xPos+e.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(i*=-1),e.connectionModel.setOffsetInBlock(i,t+e.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(e){const t=e.getLastInput();if(t!=null&&t.connectionModel){let i=e.xPos+e.statementEdge+t.notchOffset;i=this.info_.RTL?i*-1:i+this.constants_.DARK_PATH_OFFSET,t.connectionModel.setOffsetInBlock(i,e.yPos+this.constants_.DARK_PATH_OFFSET)}}positionExternalValueConnection_(e){const t=e.getLastInput();if(t&&t.connectionModel){let i=e.xPos+e.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(i*=-1),t.connectionModel.setOffsetInBlock(i,e.yPos)}}positionNextConnection_(){const e=this.info_.bottomRow;if(e.connection){const t=e.connection,i=t.xPos;t.connectionModel.setOffsetInBlock((this.info_.RTL?-i:i)+this.constants_.DARK_PATH_OFFSET/2,e.baseline+this.constants_.DARK_PATH_OFFSET)}}},q$=class{constructor(e){this.OFFSET=.5,this.constantProvider=e,this.START_POINT=yn(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()}makeInsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,i=(1-Math.SQRT1_2)*(e+t)-t,s=yn(i,i)+kn("a","0 0,0",e,pt(-i-t,e-i)),c=kn("a","0 0,0",e+t,pt(e+t,e+t)),m=yn(i,-i)+kn("a","0 0,0",e+t,pt(e-i,i+t));return{width:e+t,height:e,pathTop(I){return I?s:""},pathBottom(I){return I?c:m}}}makeOutsideCorner(){const e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,i=(1-Math.SQRT1_2)*(e-t)+t,s=yn(i,i)+kn("a","0 0,1",e-t,pt(e-i,-i+t)),c=yn(t,e)+kn("a","0 0,1",e-t,pt(e,-e+t)),m=-i,I=yn(i,m)+kn("a","0 0,1",e-t,pt(-i+t,-m-e));return{height:e,topLeft(B){return B?s:c},bottomLeft(){return I}}}makePuzzleTab(){const e=this.constantProvider.TAB_WIDTH,t=this.constantProvider.TAB_HEIGHT,i=yn(-2,-t+2.5+.9)+Rs(e*-.45,-2.1),s=$t("v",2.5)+yn(-e*.97,2.5)+Do("q",[pt(-e*.05,10),pt(e*.3,9.5)])+yn(e*.67,-1.9)+$t("v",2.5),c=$t("v",-1.5)+yn(e*-.92,-.5)+Do("q",[pt(e*-.19,-5.5),pt(0,-11)])+yn(e*.92,1),m=yn(-5,t-.7)+Rs(e*.46,-2.1);return{width:e,height:t,pathUp(I){return I?i:c},pathDown(I){return I?s:m}}}makeNotch(){return{pathLeft:$t("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:Rs(5.1,2.6)+yn(-10.2,6.8)+Rs(5.1,2.6),height:12,width:10.2}}makeStartHat(){const e=this.constantProvider.START_HAT.height,t=yn(25,-8.7)+Do("c",[pt(29.7,-6.2),pt(57.2,-.5),pt(75,8.7)]),i=Do("c",[pt(17.8,-9.2),pt(45.3,-14.9),pt(75,-8.7)])+Oi(100.5,e+.5);return{path(s){return s?t:i}}}},J$=class extends V{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},Z$=class extends re{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},Q$=class extends bt{constructor(e,t){super(e,t),this.renderer_=e}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_(),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof Yo||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(e,t){this.isInline&&e instanceof l.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new J$(this.constants_,e)),t.hasInlineInput=!0):e instanceof Yo?(t.elements.push(new Z$(this.constants_,e)),t.hasStatement=!0):e instanceof l.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new u(this.constants_,e)),t.hasExternalInput=!0):(e instanceof Io||e instanceof cs)&&(t.minHeight=Math.max(t.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),this.isInline||t.align!==null||(t.align=e.align)}addElemSpacing_(){let e=!1;for(let i=0,s;s=this.rows[i];i++)s.hasExternalInput&&(e=!0);for(let i=0,s;s=this.rows[i];i++){var t=s.elements;if(s.elements=[],s.startsWithElemSpacer()&&s.elements.push(new k(this.constants_,this.getInRowSpacing_(null,t[0]))),t.length){for(let c=0;c<t.length-1;c++){s.elements.push(t[c]);const m=this.getInRowSpacing_(t[c],t[c+1]);s.elements.push(new k(this.constants_,m))}s.elements.push(t[t.length-1]),s.endsWithElemSpacer()&&(t=this.getInRowSpacing_(t[t.length-1],null),e&&s.hasDummyInput&&(t+=this.constants_.TAB_WIDTH),s.elements.push(new k(this.constants_,t)))}}}getInRowSpacing_(e,t){if(!e)return t&&K.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&K.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&K.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!K.isInput(e)&&(!t||K.isStatementInput(t)))return K.isField(e)&&e.isEditable?e.width===0?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:K.isIcon(e)?this.constants_.LARGE_PADDING*2+1:K.isHat(e)?this.constants_.NO_PADDING:K.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:K.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:K.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(K.isInput(e)&&!t){if(K.isExternalInput(e))return this.constants_.NO_PADDING;if(K.isInlineInput(e))return this.constants_.LARGE_PADDING;if(K.isStatementInput(e))return this.constants_.NO_PADDING}if(!K.isInput(e)&&t&&K.isInput(t)){if(K.isField(e)&&e.isEditable){if(K.isInlineInput(t)||K.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(K.isInlineInput(t)||K.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(K.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(K.isIcon(e)&&t&&!K.isInput(t))return this.constants_.LARGE_PADDING;if(K.isInlineInput(e)&&t&&K.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(K.isLeftSquareCorner(e)&&t){if(K.isHat(t))return this.constants_.NO_PADDING;if(K.isPreviousConnection(t))return t.notchOffset;if(K.isNextConnection(t))return t.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(K.isLeftRoundedCorner(e)&&t){if(K.isPreviousConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS;if(K.isNextConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return K.isField(e)&&t&&K.isField(t)&&e.isEditable===t.isEditable?e.width===0?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING:t&&K.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return K.isTopRow(e)&&K.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:K.isTopRow(e)||K.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||!e.hasStatement&&t.hasDummyInput||e.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(K.isSpacer(t))return e.yPos+t.height/2;if(K.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,K.isNextConnection(t)?e+t.height/2:e-t.height/2;if(K.isTopRow(e))return K.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let i=e.yPos;return K.isField(t)||K.isIcon(t)?(i+=t.height/2,(e.hasInlineInput||e.hasStatement)&&t.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=e.height&&(i+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):i=K.isInlineInput(t)?i+t.height/2:i+e.height/2,i}alignRowElements_(){if(this.isInline){var e=0,t=new WeakMap,i=null;for(let s=this.rows.length-1,c;c=this.rows[s];s--)t.set(c,e),K.isInputRow(c)&&(c.hasStatement&&this.alignStatementRow_(c),i&&i.hasStatement&&c.width<i.width?t.set(c,i.width):e=c.hasStatement?c.width:Math.max(e,c.width),i=c);e=0;for(let s=0,c;c=this.rows[s];s++)c.hasStatement?e=this.getDesiredRowWidth_(c):K.isSpacer(c)?c.width=Math.max(e,t.get(c)):(i=c.width,e=Math.max(e,t.get(c))-i,e>0&&this.addAlignmentPadding_(c,e),e=c.width)}else super.alignRowElements_()}getDesiredRowWidth_(e){return this.isInline&&e.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:super.getDesiredRowWidth_(e)}finalize_(){let e=0,t=0;for(let s=0,c;c=this.rows[s];s++){c.yPos=t,c.xPos=this.startX,t+=c.height,e=Math.max(e,c.widthWithConnectedBlocks);var i=t-this.topRow.ascenderHeight;c===this.bottomRow&&i<this.constants_.MIN_BLOCK_HEIGHT&&(i=this.constants_.MIN_BLOCK_HEIGHT-i,this.bottomRow.height+=i,t+=i),this.recordElemPositions_(c)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(i=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,i.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=t+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline}},em=class extends Zt{constructor(e,t,i){super(e,t,i),this.constants=i,this.colourDark="#000000",this.svgPathDark=ae(le.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"}),this.svgRoot.insertBefore(this.svgPathDark,this.svgPath),this.svgPathLight=ae(le.PATH,{class:"blocklyPathLight"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e),this.svgPathDark.setAttribute("d",e)}setHighlightPath(e){this.svgPathLight.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")}applyColour(e){if(this.svgPathLight.style.display="",this.svgPathDark.style.display="",!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),super.applyColour(e),this.svgPath.setAttribute("stroke","none")}setStyle(e){this.style=e,this.colourDark=Pe("#000",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(e){super.updateHighlighted(e),this.svgPathLight.style.display=e?"none":"inline"}updateShadow_(e){if(e){if(this.svgPathLight.style.display="none",!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)}}updateDisabled_(e){super.updateDisabled_(e),e&&this.svgPath.setAttribute("stroke","none")}},tm=class extends gt{constructor(e){super(e),this.highlightConstants=null}init(e,t){super.init(e,t),this.highlightConstants=this.makeHighlightConstants_(),this.highlightConstants.init()}refreshDom(e,t,i){super.refreshDom(e,t,i),this.getHighlightConstants().init()}makeConstants_(){return new X$}makeRenderInfo_(e){return new Q$(this,e)}makeDrawer_(e,t){return new K$(e,t)}makePathObject(e,t){return new em(e,t,this.getConstants())}makeHighlightConstants_(){return new q$(this.getConstants())}getHighlightConstants(){if(!this.highlightConstants)throw Error("Cannot access the highlight constants because init has not been called");return this.highlightConstants}};rs("geras",tm);var $u={};$u.ConstantProvider=X$,$u.Drawer=K$,$u.HighlightConstantProvider=q$,$u.Highlighter=Y$,$u.InlineInput=J$,$u.PathObject=em,$u.RenderInfo=Q$,$u.Renderer=tm,$u.StatementInput=Z$;var nm=class extends bt{constructor(e,t){super(e,t)}getRenderer(){return this.renderer_}addElemSpacing_(){let e=!1;for(var t=0;t<this.rows.length;t++)if(this.rows[t].hasExternalInput){e=!0;break}for(t=0;t<this.rows.length;t++){const s=this.rows[t];var i=s.elements;if(s.elements=[],s.startsWithElemSpacer()&&s.elements.push(new k(this.constants_,this.getInRowSpacing_(null,i[0]))),i.length){for(let c=0;c<i.length-1;c++){s.elements.push(i[c]);const m=this.getInRowSpacing_(i[c],i[c+1]);s.elements.push(new k(this.constants_,m))}s.elements.push(i[i.length-1]),s.endsWithElemSpacer()&&(i=this.getInRowSpacing_(i[i.length-1],null),e&&s.hasDummyInput&&(i+=this.constants_.TAB_WIDTH),s.elements.push(new k(this.constants_,i)))}}}getInRowSpacing_(e,t){if(!e)return t&&K.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&K.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&K.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!K.isInput(e)&&!t)return K.isField(e)&&e.isEditable?e.width===0?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:K.isIcon(e)?this.constants_.LARGE_PADDING*2+1:K.isHat(e)?this.constants_.NO_PADDING:K.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:K.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:K.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(K.isInput(e)&&!t){if(K.isExternalInput(e))return this.constants_.NO_PADDING;if(K.isInlineInput(e))return this.constants_.LARGE_PADDING;if(K.isStatementInput(e))return this.constants_.NO_PADDING}if(!K.isInput(e)&&t&&K.isInput(t)){if(K.isField(e)&&e.isEditable){if(K.isInlineInput(t)||K.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(K.isInlineInput(t)||K.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(K.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(K.isIcon(e)&&t&&!K.isInput(t))return this.constants_.LARGE_PADDING;if(K.isInlineInput(e)&&t&&K.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(K.isLeftSquareCorner(e)&&t){if(K.isHat(t))return this.constants_.NO_PADDING;if(K.isPreviousConnection(t)||K.isNextConnection(t))return t.notchOffset}return K.isLeftRoundedCorner(e)&&t?t.notchOffset-this.constants_.CORNER_RADIUS:K.isField(e)&&t&&K.isField(t)&&e.isEditable===t.isEditable?e.width===0?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING:t&&K.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return K.isTopRow(e)&&K.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:K.isTopRow(e)||K.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||e.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(K.isSpacer(t))return e.yPos+t.height/2;if(K.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,K.isNextConnection(t)?e+t.height/2:e-t.height/2;if(K.isTopRow(e))return K.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let i=e.yPos;return i=K.isField(t)&&e.hasStatement?i+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+t.height/2):i+e.height/2}finalize_(){let e=0,t=0;for(var i=0;i<this.rows.length;i++){const c=this.rows[i];c.yPos=t,c.xPos=this.startX,t+=c.height,e=Math.max(e,c.widthWithConnectedBlocks);var s=t-this.topRow.ascenderHeight;c===this.bottomRow&&s<this.constants_.MIN_BLOCK_HEIGHT&&(s=this.constants_.MIN_BLOCK_HEIGHT-s,this.bottomRow.height+=s,t+=s),this.recordElemPositions_(c)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(i=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,i.getHeightWidth().width)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline}},im=class extends gt{constructor(e){super(e)}makeRenderInfo_(e){return new nm(this,e)}};rs("thrasos",im);var Yg={};Yg.RenderInfo=nm,Yg.Renderer=im;var bm={colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},Em={colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}},Tm=new sa("zelos",bm,Em),vm={Classic:Ih,Zelos:Tm},Kg=class{constructor(e,t,i){this.id_=e.toolboxitemid||ht(),this.level_=(this.parent_=i||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=e,this.parentToolbox_=t,this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return!1}isCollapsible(){return!1}dispose(){}setVisible_(e){}getFocusableElement(){const e=this.getDiv();if(!e)throw Error("Trying to access toolbox item before DOM is initialized.");if(!(e instanceof HTMLElement))throw Error("Toolbox item div is unexpectedly not an HTML element.");return e}getFocusableTree(){return this.parentToolbox_}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}},Tl=class extends Kg{constructor(e,t,i){super(e,t,i),this.colour_=this.name_="",this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_),this.parseContents_(this.toolboxItemDef_),this.createDom_(),this.toolboxItemDef_.hidden==="true"&&this.hide()}makeDefaultCssConfig_(){return{container:"blocklyToolboxCategoryContainer",row:"blocklyToolboxCategory",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyToolboxCategoryIcon",label:"blocklyToolboxCategoryLabel",contents:"blocklyToolboxCategoryGroup",selected:"blocklyToolboxSelected",openicon:"blocklyToolboxCategoryIconOpen",closedicon:"blocklyToolboxCategoryIconClosed"}}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else if(e=e.contents)for(let t=0;t<e.length;t++){const i=e[t];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(i)}}parseCategoryDef_(e){this.name_="name"in e?Ge(e.name):"",this.colour_=this.getColour_(e),Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_(),No(this.htmlDiv_,Ho.TREEITEM),It(this.htmlDiv_,Wn.SELECTED,!1),It(this.htmlDiv_,Wn.LEVEL,this.level_+1),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),No(this.iconDom_,Ho.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_);const e=this.labelDom_.getAttribute("id");return e&&It(this.htmlDiv_,Wn.LABELLEDBY,e),this.addColourBorder_(this.colour_),this.htmlDiv_}createContainer_(){const e=document.createElement("div");e.tabIndex=-1,e.id=this.getId();const t=this.cssConfig_.container;return t&&We(e,t),e}createRowContainer_(){const e=document.createElement("div");var t=this.cssConfig_.row;return t&&We(e,t),t=`${Tl.nestedPadding*this.getLevel()}px`,this.workspace_.RTL?e.style.paddingRight=t:e.style.paddingLeft=t,e}createRowContentsContainer_(){const e=document.createElement("div"),t=this.cssConfig_.rowcontentcontainer;return t&&We(e,t),e}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&We(e,t)}return e.style.display="inline-block",e}createLabelDom_(e){const t=document.createElement("span");return t.setAttribute("id",this.getId()+".label"),t.textContent=e,(e=this.cssConfig_.label)&&We(t,e),t}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)}addColourBorder_(e){e&&(e=Tl.borderWidth+"px solid "+(e||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=e:this.rowDiv_.style.borderLeft=e)}getColour_(e){const t=e.categorystyle||e.categoryStyle;if((e=e.colour)&&t)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(t)return this.getColourfromStyle(t);if(e)return this.parseColour(e)}return""}getColourfromStyle(e){var t=this.workspace_.getTheme();if(e&&t){if((t=t.categoryStyles[e])&&t.colour)return this.parseColour(t.colour);console.warn('Style "'+e+'" must exist and contain a colour value')}return""}getClickTarget(){return this.rowDiv_}parseColour(e){if(e=Ge(e),e==null||e==="")return"";var t=Number(e);return isNaN(t)?(t=ye(e))?t:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+e),""):Ye(t)}openIcon_(e){if(e){var t=this.cssConfig_.closedicon;t&&Mn(e,t),(t=this.cssConfig_.openicon)&&We(e,t)}}closeIcon_(e){if(e){var t=this.cssConfig_.openicon;t&&Mn(e,t),(t=this.cssConfig_.closedicon)&&We(e,t)}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none",this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(!1)}show(){this.setVisible_(!0)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let e=this;for(;e.getParent();)if(e=e.getParent(),!e.isExpanded())return!1;return!0}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(e){}setSelected(e){if(this.rowDiv_){var t=this.cssConfig_.selected;if(e){const i=this.parseColour(Tl.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||i,t&&We(this.rowDiv_,t)}else this.rowDiv_.style.backgroundColor="",t&&vt(this.rowDiv_,t);It(this.htmlDiv_,Wn.SELECTED,e)}}setDisabled(e){this.isDisabled_=e,this.getDiv().setAttribute("disabled",`${e}`),e?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(e){this.flyoutItems_=[],this.toolboxItemDef_=typeof e=="string"?{kind:this.toolboxItemDef_.kind,custom:e,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:rn(e),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden},this.parseContents_(this.toolboxItemDef_)}dispose(){Wt(this.htmlDiv_)}};Tl.registrationName="category",Tl.nestedPadding=19,Tl.borderWidth=8,Tl.defaultBackgroundColour="#57e",qe(`
.blocklyToolboxCategory:not(.blocklyToolboxSelected):hover {
  background-color: rgba(255, 255, 255, .2);
}

.blocklyToolbox[layout="h"] .blocklyToolboxCategoryContainer {
  margin: 1px 5px 1px 0;
}

.blocklyToolbox[dir="RTL"][layout="h"] .blocklyToolboxCategoryContainer {
  margin: 1px 0 1px 5px;
}

.blocklyToolboxCategory {
  height: 22px;
  line-height: 22px;
  margin-bottom: 3px;
  padding-right: 8px;
  white-space: nowrap;
}

.blocklyToolbox[dir="RTL"] .blocklyToolboxCategory {
  margin-left: 8px;
  padding-right: 0;
}

.blocklyToolboxCategoryIcon {
  background-image: url(<<<PATH>>>/sprites.png);
  height: 16px;
  vertical-align: middle;
  visibility: hidden;
  width: 16px;
}

.blocklyToolboxCategoryIconClosed {
  background-position: -32px -1px;
}

.blocklyToolbox[dir="RTL"] .blocklyToolboxCategoryIconClosed {
  background-position: 0 -1px;
}

.blocklyToolboxSelected>.blocklyToolboxCategoryIconClosed {
  background-position: -32px -17px;
}

.blocklyToolbox[dir="RTL"] .blocklyToolboxSelected>.blocklyToolboxCategoryIconClosed {
  background-position: 0 -17px;
}

.blocklyToolboxCategoryIconOpen {
  background-position: -16px -1px;
}

.blocklyToolboxSelected>.blocklyToolboxCategoryIconOpen {
  background-position: -16px -17px;
}

.blocklyToolboxCategoryLabel {
  cursor: default;
  font: 16px sans-serif;
  padding: 0 3px;
  vertical-align: middle;
}

.blocklyToolboxDelete .blocklyToolboxCategoryLabel {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyToolboxSelected .blocklyToolboxCategoryLabel {
  color: #fff;
}
`),a(Re.TOOLBOX_ITEM,Tl.registrationName,Tl);var Lp=class extends Kg{constructor(e,t){super(e,t),this.cssConfig_={container:"blocklyTreeSeparator"},this.htmlDiv=null,Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}init(){this.createDom_()}createDom_(){const e=document.createElement("div");e.tabIndex=-1,e.id=this.getId();const t=this.cssConfig_.container;return t&&We(e,t),this.htmlDiv=e}getDiv(){return this.htmlDiv}dispose(){Wt(this.htmlDiv)}};Lp.registrationName="sep",qe(`
.blocklyTreeSeparator {
  border-bottom: solid #e5e5e5 1px;
  height: 0;
  margin: 5px 0;
}

.blocklyToolbox[layout="h"] .blocklyTreeSeparator {
  border-right: solid #e5e5e5 1px;
  border-bottom: none;
  height: auto;
  margin: 0 5px 0 5px;
  padding: 5px 0;
  width: 0;
}
`),a(Re.TOOLBOX_ITEM,Lp.registrationName,Lp);var ff=class extends Tl{constructor(e,t,i){super(e,t,i),this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[]}makeDefaultCssConfig_(){const e=super.makeDefaultCssConfig_();return e.contents="blocklyToolboxCategoryGroup",e}parseContents_(e){if("custom"in e)this.flyoutItems_=e.custom;else{const t=e.contents;if(t){this.flyoutItems_=[],e=!0;for(let i=0;i<t.length;i++){const s=t[i];!A(Re.TOOLBOX_ITEM,s.kind)||s.kind.toLowerCase()===Lp.registrationName&&e?(this.flyoutItems_.push(s),e=!0):(this.createToolboxItem(s),e=!1)}}}}createToolboxItem(e){let t=e.kind;t.toUpperCase()==="CATEGORY"&&Kn(e)&&(t=ff.registrationName),e=new(N(Re.TOOLBOX_ITEM,t))(e,this.parentToolbox_,this),this.toolboxItems_.push(e)}init(){super.init(),this.setExpanded(this.toolboxItemDef_.expanded==="true"||this.toolboxItemDef_.expanded===!0)}createDom_(){super.createDom_();const e=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(e),No(this.subcategoriesDiv_,Ho.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.closeIcon_(this.iconDom_),It(this.htmlDiv_,Wn.EXPANDED,!1),this.htmlDiv_}createIconDom_(){const e=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const t=this.cssConfig_.icon;t&&We(e,t),e.style.visibility="visible"}return e.style.display="inline-block",e}createSubCategoriesDom_(e){const t=document.createElement("div");t.style.display="none";var i=this.cssConfig_.contents;for(i&&We(t,i),i=0;i<e.length;i++){const s=e[i];s.init();const c=s.getDiv();if(t.appendChild(c),s.getClickTarget){let m;(m=s.getClickTarget())==null||m.setAttribute("id",s.getId())}}return t}setExpanded(e){if(this.expanded_!==e){if(this.expanded_=e)this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_);else{let t;(t=this.parentToolbox_.getFlyout())==null||t.setVisible(!1),this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)}It(this.htmlDiv_,Wn.EXPANDED,e),this.parentToolbox_.handleToolboxItemResize()}}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none";const t=this.getChildToolboxItems();for(let i=0;i<t.length;i++)t[i].setVisible_(e);this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return!0}onClick(e){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}};ff.registrationName="collapsibleCategory",a(Re.TOOLBOX_ITEM,ff.registrationName,ff);var om=class extends $c{constructor(e){super(),this.id="toolbox",this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.height_=this.width_=0,this.flyout=null,this.contents=new Map,this.previouslySelectedItem_=this.selectedItem_=null,this.boundEvents_=[],this.workspace_=e,this.toolboxDef_=e.options.languageTree||{contents:[]},this.horizontalLayout=e.options.horizontalLayout,this.RTL=e.options.RTL,this.toolboxPosition=e.options.toolboxPosition}onShortcut(e){return!1}init(){var e=this.workspace_;const t=e.getParentSvg();this.flyout=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_);const i=this.flyout.createDom("svg");We(i,"blocklyToolboxFlyout"),Yi(i,t),this.setVisible(!0),this.flyout.init(e),this.render(this.toolboxDef_),e=e.getThemeManager(),e.subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),e.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:un.ComponentWeight.TOOLBOX_WEIGHT,capabilities:[un.Capability.AUTOHIDEABLE,un.Capability.DELETE_AREA,un.Capability.DRAG_TARGET]}),l.getFocusManager$$module$build$src$core$focus_manager().registerTree(this,!0)}createDom_(e){e=e.getParentSvg();const t=this.createContainer_();return t.id=ht(),this.contentsDiv_=this.createContentsContainer_(),No(this.contentsDiv_,Ho.TREE),t.appendChild(this.contentsDiv_),e.parentNode.insertBefore(t,e),this.attachEvents_(t,this.contentsDiv_),t}createContainer_(){const e=document.createElement("div");return e.setAttribute("layout",this.isHorizontal()?"h":"v"),We(e,"blocklyToolbox"),e.setAttribute("dir",this.RTL?"RTL":"LTR"),e}createContentsContainer_(){const e=document.createElement("div");return We(e,"blocklyToolboxCategoryGroup"),this.isHorizontal()&&(e.style.flexDirection="row"),e}attachEvents_(e,t){e=_e(e,"pointerdown",this,this.onClick_,!1),this.boundEvents_.push(e),t=_e(t,"keydown",this,this.onKeyDown_,!1),this.boundEvents_.push(t)}onClick_(e){if(De(e)||e.target===this.HtmlDiv)v().hideChaff(!1);else{var t=e.target.getAttribute("id");t&&(t=this.getToolboxItemById(t),t.isSelectable()&&(this.setSelectedItem(t),t.onClick(e))),v().hideChaff(!0)}Oe()}onKeyDown_(e){let t=!1;switch(e.key){case"ArrowDown":t=this.selectNext();break;case"ArrowUp":t=this.selectPrevious();break;case"ArrowLeft":t=this.selectParent();break;case"ArrowRight":t=this.selectChild();break;case"Enter":case" ":this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),t=!0);break;default:t=!1}!t&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(t=this.selectedItem_.onKeyDown(e)),t&&e.preventDefault()}createFlyout_(){const e=this.workspace_,t=e.copyOptionsForFlyout();return t.toolboxPosition=e.options.toolboxPosition,new(e.horizontalLayout?D(Re.FLYOUTS_HORIZONTAL_TOOLBOX,e.options,!0):D(Re.FLYOUTS_VERTICAL_TOOLBOX,e.options,!0))(t)}render(e){this.toolboxDef_=e,this.contents.forEach(t=>t.dispose()),this.contents.clear(),this.renderContents_(e.contents),this.position(),this.handleToolboxItemResize()}renderContents_(e){const t=document.createDocumentFragment();for(let i=0;i<e.length;i++)this.createToolboxItem(e[i],t);this.contentsDiv_.appendChild(t)}createToolboxItem(e,t){var i=e.kind;i.toUpperCase()==="CATEGORY"&&Kn(e)&&(i=ff.registrationName),(i=N(Re.TOOLBOX_ITEM,i.toLowerCase()))&&(e=new i(e,this),e.init(),this.addToolboxItem_(e),(i=e.getDiv())&&t.appendChild(i),e.getClickTarget()&&e.getClickTarget().setAttribute("id",e.getId()))}addToolboxItem_(e){if(this.contents.set(e.getId(),e),e.isCollapsible()){e=e.getChildToolboxItems();for(let t=0;t<e.length;t++)this.addToolboxItem_(e[t])}}getToolboxItems(){return[...this.contents.values()]}addStyle(e){e&&this.HtmlDiv&&We(this.HtmlDiv,e)}removeStyle(e){e&&this.HtmlDiv&&vt(this.HtmlDiv,e)}getClientRect(){if(!this.HtmlDiv||!this.isVisible_)return null;var e=this.HtmlDiv.getBoundingClientRect();const t=e.top,i=t+e.height,s=e.left;return e=s+e.width,this.toolboxPosition===Lt.TOP?new Nt(-1e7,i,-1e7,1e7):this.toolboxPosition===Lt.BOTTOM?new Nt(t,1e7,-1e7,1e7):this.toolboxPosition===Lt.LEFT?new Nt(-1e7,1e7,-1e7,e):new Nt(-1e7,1e7,s,1e7)}wouldDelete(e){return e instanceof Rn?this.updateWouldDelete_(!e.getParent()&&e.isDeletable()):this.updateWouldDelete_(xo(e)&&e.isDeletable()),this.wouldDelete_}onDragEnter(e){this.updateCursorDeleteStyle_(!0)}onDragExit(e){this.updateCursorDeleteStyle_(!1)}onDrop(e){this.updateCursorDeleteStyle_(!1)}updateWouldDelete_(e){e!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=e,this.updateCursorDeleteStyle_(!0))}updateCursorDeleteStyle_(e){const t=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";e?this.addStyle(t):this.removeStyle(t)}getToolboxItemById(e){return this.contents.get(e)||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout}position(){const e=this.workspace_.getMetrics(),t=this.HtmlDiv;t&&(this.horizontalLayout?(t.style.left="0",t.style.height="auto",t.style.width="100%",this.height_=t.offsetHeight,this.width_=e.viewWidth,this.toolboxPosition===Lt.TOP?t.style.top="0":t.style.bottom="0"):(this.toolboxPosition===Lt.RIGHT?t.style.right="0":t.style.left="0",t.style.height="100%",this.width_=t.offsetWidth,this.height_=e.viewHeight),this.flyout.position())}handleToolboxItemResize(){const e=this.workspace_;var t=this.HtmlDiv.getBoundingClientRect();const i=this.getFlyout(),s=this.toolboxPosition===Lt.LEFT?e.scrollX+t.width+(i!=null&&i.isVisible()?i.getWidth():0):e.scrollX;t=this.toolboxPosition===Lt.TOP?e.scrollY+t.height+(i!=null&&i.isVisible()?i.getHeight():0):e.scrollY,e.translate(s,t),je(e)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){this.contents.forEach(e=>{e.refreshTheme&&e.refreshTheme()})}refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout.show(this.selectedItem_.getContents())}setVisible(e){this.isVisible_!==e&&(this.HtmlDiv.style.display=e?"block":"none",this.isVisible_=e,this.workspace_.recordDragTargets())}autoHide(e){!e&&this.flyout&&this.flyout.autoClose&&this.clearSelection()}setSelectedItem(e){const t=this.selectedItem_;!e&&!t||e&&!Mf(e)||(this.shouldDeselectItem_(t,e)&&t!==null&&this.deselectItem_(t),this.shouldSelectItem_(t,e)&&e!==null&&this.selectItem_(t,e),this.updateFlyout_(t,e),this.fireSelectEvent(t,e))}shouldDeselectItem_(e,t){return e!==null&&(!e.isCollapsible()||e!==t)}shouldSelectItem_(e,t){return t!==null&&t!==e}deselectItem_(e){this.selectedItem_=null,this.previouslySelectedItem_=e,e.setSelected(!1),It(this.contentsDiv_,Wn.ACTIVEDESCENDANT,"")}selectItem_(e,t){this.selectedItem_=t,this.previouslySelectedItem_=e,t.setSelected(!0),It(this.contentsDiv_,Wn.ACTIVEDESCENDANT,t.getId())}selectItemByPosition(e){(e=this.getToolboxItems()[e])&&this.setSelectedItem(e)}updateFlyout_(e,t){t&&(e!==t||t.isCollapsible())&&t.getContents().length?(this.flyout.show(t.getContents()),this.flyout.scrollToStart()):this.flyout.hide()}fireSelectEvent(e,t){const i=e&&e.getName();let s=t&&t.getName();e===t&&(s=null),e=new(Qe(ce.TOOLBOX_ITEM_SELECT))(i,s,this.workspace_.id),Be(e)}selectParent(){return this.selectedItem_?this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),!0):this.selectedItem_.getParent()&&this.selectedItem_.getParent().isSelectable()?(this.setSelectedItem(this.selectedItem_.getParent()),!0):!1:!1}selectChild(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;const e=this.selectedItem_;return e.isExpanded()?this.selectNext():e.toggleExpanded(),!0}selectNext(){if(!this.selectedItem_)return!1;const e=[...this.contents.values()];let t=e.indexOf(this.selectedItem_)+1;if(t>-1&&t<e.length){let i=e[t];for(;i&&!i.isSelectable();)i=e[++t];if(i&&i.isSelectable())return this.setSelectedItem(i),!0}return!1}selectPrevious(){if(!this.selectedItem_)return!1;const e=[...this.contents.values()];let t=e.indexOf(this.selectedItem_)-1;if(t>-1&&t<e.length){let i=e[t];for(;i&&!i.isSelectable();)i=e[--t];if(i&&i.isSelectable())return this.setSelectedItem(i),!0}return!1}dispose(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout.dispose(),this.contents.forEach(e=>e.dispose());for(let e=0;e<this.boundEvents_.length;e++)Ae(this.boundEvents_[e]);this.boundEvents_=[],this.contents.clear(),this.HtmlDiv&&(this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),Wt(this.HtmlDiv)),l.getFocusManager$$module$build$src$core$focus_manager().unregisterTree(this)}getFocusableElement(){if(!this.HtmlDiv)throw Error("Toolbox DOM has not yet been created.");return this.HtmlDiv}getFocusableTree(){return this}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getRootFocusableNode(){return this}getRestoredFocusableNode(e){if(!e||e===this){let t;return(t=this.getToolboxItems().find(i=>i.isSelectable()))!=null?t:null}return null}getNestedTrees(){return[]}lookUpFocusableNode(e){return this.getToolboxItemById(e)}onTreeFocus(e,t){e!==this?this.getSelectedItem()!==e&&this.setSelectedItem(e):this.clearSelection()}onTreeBlur(e){let t;e&&e===((t=this.flyout)==null?void 0:t.getWorkspace())||this.autoHide(!1)}};qe(`
.blocklyToolboxDelete {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyToolboxGrab {
  cursor: url("<<<PATH>>>/handclosed.cur"), auto;
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

/* Category tree in Toolbox. */
.blocklyToolbox {
  box-sizing: border-box;
  user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
  background-color: #ddd;
  overflow-x: visible;
  overflow-y: auto;
  padding: 4px 0 4px 0;
  position: absolute;
  z-index: 70;  /* so blocks go under toolbox when dragging */
  -webkit-tap-highlight-color: transparent;  /* issue #1345 */
}

.blocklyToolboxCategoryGroup {
  display: flex;
  flex-wrap: wrap;
  flex-direction: column;
}

.blocklyToolboxCategoryGroup:focus {
  outline: none;
}
`),a(Re.TOOLBOX,Po,om);var ym="12.3.1",Sm=lt.INPUT_VALUE,Cm=lt.OUTPUT_VALUE,Rm=lt.NEXT_STATEMENT,Im=lt.PREVIOUS_STATEMENT,Om=Lt.TOP,Am=Lt.BOTTOM,wm=Lt.LEFT,Nm=Lt.RIGHT;uf.prototype.newBlock=function(e,t){return new Zs(this,e,t)},Ko.prototype.newBlock=function(e,t){return new Rn(this,e,t)},uf.prototype.newComment=function(e){return new dc(this,e)},Ko.prototype.newComment=function(e){return new As(this,e)},Ko.newTrashcan=function(e){return new e$(e)},Fr.prototype.newWorkspaceSvg=function(e){return new Ko(e)},l.Names$$module$build$src$core$names.prototype.populateProcedures=function(e){e=La(e),e=e[0].concat(e[1]);for(let t=0;t<e.length;t++)this.getName(e[t][0],l.Names$$module$build$src$core$names.NameType.PROCEDURE)};var pe={};return pe.Block=Zs,pe.BlockFlyoutInflater=j$,pe.BlockNavigationPolicy=Tp,pe.BlockSvg=Rn,pe.Blocks=Vn,pe.ButtonFlyoutInflater=W$,pe.COLLAPSED_FIELD_NAME=Gt,pe.COLLAPSED_INPUT_NAME=hn,pe.COLLAPSE_CHARS=tg,pe.CodeGenerator=l.CodeGenerator$$module$build$src$core$generator,pe.CollapsibleToolboxCategory=ff,pe.ComponentManager=un,pe.Connection=Jt,pe.ConnectionChecker=hg,pe.ConnectionDB=$l,pe.ConnectionNavigationPolicy=yp,pe.ConnectionType=lt,pe.ContextMenu=gl,pe.ContextMenuItems=oo,pe.ContextMenuRegistry=Dt,pe.Css=Yu,pe.DELETE_VARIABLE_ID=_p,pe.DeleteArea=$c,pe.DragTarget=og,pe.DropDownDiv=to,pe.Events=st,pe.Extensions=ws,pe.Field=dn,pe.FieldCheckbox=Dh,pe.FieldDropdown=zi,pe.FieldImage=Lh,pe.FieldLabel=ua,pe.FieldLabelSerializable=_$,pe.FieldNavigationPolicy=Sp,pe.FieldNumber=Ng,pe.FieldTextInput=l.FieldTextInput$$module$build$src$core$field_textinput,pe.FieldVariable=Np,pe.Flyout=cu,pe.FlyoutButton=ji,pe.FlyoutButtonNavigationPolicy=sg,pe.FlyoutItem=mc,pe.FlyoutMetricsManager=Ah,pe.FlyoutNavigationPolicy=bc,pe.FlyoutNavigator=ml,pe.FlyoutSeparator=nf,pe.FlyoutSeparatorNavigationPolicy=Ep,pe.FocusManager=Hi,pe.FocusableTreeTraverser=Ai,pe.Generator=l.CodeGenerator$$module$build$src$core$generator,pe.Gesture=kh,pe.Grid=vc,pe.HorizontalFlyout=m$,pe.INPUT_VALUE=Sm,pe.Input=ca,pe.InsertionMarkerPreviewer=p$,pe.KeyboardNavigationController=_l,pe.LabelFlyoutInflater=r$,pe.LineCursor=yc,pe.Marker=cg,pe.MarkerManager=Sc,pe.Menu=Qf,pe.MenuItem=Ld,pe.MetricsManager=_c,pe.Msg=l.Msg$$module$build$src$core$msg,pe.NEXT_STATEMENT=Rm,pe.Names=l.Names$$module$build$src$core$names,pe.Navigator=wh,pe.OPPOSITE_TYPE=aa,pe.OUTPUT_VALUE=Cm,pe.Options=qs,pe.PREVIOUS_STATEMENT=Im,pe.PROCEDURE_CATEGORY_NAME=Mh,pe.Procedures=Xi,pe.RENAME_VARIABLE_ID=mp,pe.RenderedConnection=Wi,pe.Scrollbar=qn,pe.ScrollbarPair=Gr,pe.SeparatorFlyoutInflater=Tc,pe.ShortcutItems=fu,pe.ShortcutRegistry=mn,pe.TOOLBOX_AT_BOTTOM=Am,pe.TOOLBOX_AT_LEFT=wm,pe.TOOLBOX_AT_RIGHT=Nm,pe.TOOLBOX_AT_TOP=Om,pe.Theme=sa,pe.ThemeManager=Xt,pe.Themes=vm,pe.Toast=vi,pe.Toolbox=om,pe.ToolboxCategory=Tl,pe.ToolboxItem=Kg,pe.ToolboxSeparator=Lp,pe.Tooltip=Wo,pe.Touch=jl,pe.Trashcan=e$,pe.UnattachedFieldError=ai,pe.VARIABLE_CATEGORY_NAME=gh,pe.VARIABLE_DYNAMIC_CATEGORY_NAME=on,pe.VERSION=ym,pe.VariableMap=Qg,pe.VariableModel=Zg,pe.Variables=Jn,pe.VariablesDynamic=Oo,pe.VerticalFlyout=wg,pe.WidgetDiv=us,pe.Workspace=uf,pe.WorkspaceAudio=Jg,pe.WorkspaceDragger=Op,pe.WorkspaceNavigationPolicy=Ip,pe.WorkspaceSvg=Ko,pe.Xml=no,pe.ZoomControls=Mr,pe.blockAnimations=au,pe.blockRendering=ut,pe.browserEvents=Ir,pe.bubbles=Mp,pe.bumpObjects=gc,pe.clipboard=El,pe.comments=Cc,pe.common=li,pe.config=l.config$$module$build$src$core$config,pe.constants=Sn,pe.defineBlocksWithJsonArray=M,pe.dialog=Go,pe.dragging=kp,pe.fieldRegistry=Zd,pe.geras=$u,pe.getFocusManager=l.getFocusManager$$module$build$src$core$focus_manager,pe.getMainWorkspace=v,pe.getSelected=Y,pe.hasBubble=Eo,pe.hideChaff=Hp,pe.icons=bl,pe.inject=Sf,pe.inputs=Rc,pe.isCopyable=Vu,pe.isDeletable=xo,pe.isDraggable=Gl,pe.isIcon=Wh,pe.isObservable=Yc,pe.isPaster=Ed,pe.isRenderedElement=kf,pe.isSelectable=Hn,pe.isSerializable=Ms,pe.isVariableBackedParameterModel=wn,pe.keyboardNavigationController=rf,pe.layers=_g,pe.navigateBlock=Fi,pe.navigateStacks=ss,pe.procedures=Xi,pe.registry=rl,pe.renderManagement=Ys,pe.serialization=mm,pe.setLocale=hl,pe.setParentContainer=ki,pe.svgResize=je,pe.thrasos=Yg,pe.uiPosition=Ti,pe.utils=On,pe.zelos=gu,pe.__namespace__=l,pe})})(blockly_compressed$1)),blockly_compressed$1.exports}var en$1={exports:{}},en=en$1.exports,hasRequiredEn;function requireEn(){return hasRequiredEn||(hasRequiredEn=1,(function(h,p){(function(l,a){h.exports=a()})(en,function(){var l=l||{Msg:Object.create(null)};return l.Msg.ADD_COMMENT="Add Comment",l.Msg.ALT_KEY="Alt",l.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",l.Msg.CHANGE_VALUE_TITLE="Change value:",l.Msg.CHROME_OS="ChromeOS",l.Msg.CLEAN_UP="Clean up Blocks",l.Msg.CLOSE="Close",l.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",l.Msg.COLLAPSE_ALL="Collapse Blocks",l.Msg.COLLAPSE_BLOCK="Collapse Block",l.Msg.COLOUR_BLEND_COLOUR1="colour 1",l.Msg.COLOUR_BLEND_COLOUR2="colour 2",l.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",l.Msg.COLOUR_BLEND_RATIO="ratio",l.Msg.COLOUR_BLEND_TITLE="blend",l.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",l.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",l.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",l.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",l.Msg.COLOUR_RANDOM_TITLE="random colour",l.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",l.Msg.COLOUR_RGB_BLUE="blue",l.Msg.COLOUR_RGB_GREEN="green",l.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",l.Msg.COLOUR_RGB_RED="red",l.Msg.COLOUR_RGB_TITLE="colour with",l.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",l.Msg.COMMAND_KEY="⌘ Command",l.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",l.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",l.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",l.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",l.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",l.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",l.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",l.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",l.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",l.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",l.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",l.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",l.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",l.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",l.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",l.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",l.Msg.CONTROLS_IF_MSG_ELSE="else",l.Msg.CONTROLS_IF_MSG_ELSEIF="else if",l.Msg.CONTROLS_IF_MSG_IF="if",l.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",l.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",l.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",l.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",l.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",l.Msg.CONTROLS_REPEAT_INPUT_DO="do",l.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",l.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",l.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",l.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",l.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",l.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",l.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",l.Msg.CONTROL_KEY="Ctrl",l.Msg.COPY_SHORTCUT="Copy",l.Msg.CUT_SHORTCUT="Cut",l.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",l.Msg.DELETE_BLOCK="Delete Block",l.Msg.DELETE_VARIABLE="Delete the '%1' variable",l.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",l.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",l.Msg.DIALOG_CANCEL="Cancel",l.Msg.DIALOG_OK="OK",l.Msg.DISABLE_BLOCK="Disable Block",l.Msg.DUPLICATE_BLOCK="Duplicate",l.Msg.DUPLICATE_COMMENT="Duplicate Comment",l.Msg.EDIT_BLOCK_CONTENTS="Edit Block contents",l.Msg.ENABLE_BLOCK="Enable Block",l.Msg.EXPAND_ALL="Expand Blocks",l.Msg.EXPAND_BLOCK="Expand Block",l.Msg.EXTERNAL_INPUTS="External Inputs",l.Msg.HELP="Help",l.Msg.HELP_PROMPT="Press %1 for help on keyboard controls",l.Msg.INLINE_INPUTS="Inline Inputs",l.Msg.KEYBOARD_NAV_CONSTRAINED_MOVE_HINT="Use the arrow keys to move, then %1 to accept the position",l.Msg.KEYBOARD_NAV_COPIED_HINT="Copied. Press %1 to paste.",l.Msg.KEYBOARD_NAV_CUT_HINT="Cut. Press %1 to paste.",l.Msg.KEYBOARD_NAV_UNCONSTRAINED_MOVE_HINT="Hold %1 and use arrow keys to move freely, then %2 to accept the position",l.Msg.LINUX="Linux",l.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",l.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",l.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",l.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",l.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",l.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",l.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",l.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",l.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",l.Msg.LISTS_GET_INDEX_FIRST="first",l.Msg.LISTS_GET_INDEX_FROM_END="# from end",l.Msg.LISTS_GET_INDEX_FROM_START="#",l.Msg.LISTS_GET_INDEX_GET="get",l.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",l.Msg.LISTS_GET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",l.Msg.LISTS_GET_INDEX_LAST="last",l.Msg.LISTS_GET_INDEX_RANDOM="random",l.Msg.LISTS_GET_INDEX_REMOVE="remove",l.Msg.LISTS_GET_INDEX_TAIL="",l.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",l.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",l.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",l.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",l.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",l.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",l.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",l.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",l.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",l.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",l.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",l.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",l.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",l.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",l.Msg.LISTS_GET_SUBLIST_END_LAST="to last",l.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",l.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",l.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",l.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",l.Msg.LISTS_GET_SUBLIST_TAIL="",l.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",l.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",l.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",l.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",l.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#finding-items-in-a-list",l.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",l.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",l.Msg.LISTS_INLIST="in list",l.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",l.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",l.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",l.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",l.Msg.LISTS_LENGTH_TITLE="length of %1",l.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",l.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",l.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",l.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",l.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",l.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",l.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",l.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",l.Msg.LISTS_SET_INDEX_INPUT_TO="as",l.Msg.LISTS_SET_INDEX_INSERT="insert at",l.Msg.LISTS_SET_INDEX_SET="set",l.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",l.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",l.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",l.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",l.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",l.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",l.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",l.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",l.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",l.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",l.Msg.LISTS_SORT_ORDER_DESCENDING="descending",l.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",l.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",l.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",l.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",l.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",l.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",l.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",l.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",l.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",l.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",l.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",l.Msg.LOGIC_BOOLEAN_FALSE="false",l.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",l.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",l.Msg.LOGIC_BOOLEAN_TRUE="true",l.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",l.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",l.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",l.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",l.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",l.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",l.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",l.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",l.Msg.LOGIC_NEGATE_TITLE="not %1",l.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",l.Msg.LOGIC_NULL="null",l.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",l.Msg.LOGIC_NULL_TOOLTIP="Returns null.",l.Msg.LOGIC_OPERATION_AND="and",l.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",l.Msg.LOGIC_OPERATION_OR="or",l.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",l.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",l.Msg.LOGIC_TERNARY_CONDITION="test",l.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",l.Msg.LOGIC_TERNARY_IF_FALSE="if false",l.Msg.LOGIC_TERNARY_IF_TRUE="if true",l.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",l.Msg.MAC_OS="macOS",l.Msg.MATH_ADDITION_SYMBOL="+",l.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",l.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",l.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",l.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",l.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",l.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",l.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",l.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",l.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",l.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",l.Msg.MATH_CHANGE_TITLE="change %1 by %2",l.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",l.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",l.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants: π (3.141…), e (2.718…), φ (1.618…), sqrt(2) (1.414…), sqrt(½) (0.707…), or ∞ (infinity).",l.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",l.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",l.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",l.Msg.MATH_DIVISION_SYMBOL="÷",l.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",l.Msg.MATH_IS_EVEN="is even",l.Msg.MATH_IS_NEGATIVE="is negative",l.Msg.MATH_IS_ODD="is odd",l.Msg.MATH_IS_POSITIVE="is positive",l.Msg.MATH_IS_PRIME="is prime",l.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",l.Msg.MATH_IS_WHOLE="is whole",l.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",l.Msg.MATH_MODULO_TITLE="remainder of %1 ÷ %2",l.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",l.Msg.MATH_MULTIPLICATION_SYMBOL="×",l.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",l.Msg.MATH_NUMBER_TOOLTIP="A number.",l.Msg.MATH_ONLIST_HELPURL="",l.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",l.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",l.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",l.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",l.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",l.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",l.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",l.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",l.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",l.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",l.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",l.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",l.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",l.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",l.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",l.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",l.Msg.MATH_POWER_SYMBOL="^",l.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",l.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",l.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",l.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",l.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",l.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",l.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",l.Msg.MATH_ROUND_OPERATOR_ROUND="round",l.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",l.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",l.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",l.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",l.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",l.Msg.MATH_SINGLE_OP_ROOT="square root",l.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",l.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",l.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",l.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",l.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",l.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",l.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",l.Msg.MATH_SUBTRACTION_SYMBOL="-",l.Msg.MATH_TRIG_ACOS="acos",l.Msg.MATH_TRIG_ASIN="asin",l.Msg.MATH_TRIG_ATAN="atan",l.Msg.MATH_TRIG_COS="cos",l.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",l.Msg.MATH_TRIG_SIN="sin",l.Msg.MATH_TRIG_TAN="tan",l.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",l.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",l.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",l.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",l.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",l.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",l.Msg.MOVE_BLOCK="Move Block",l.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",l.Msg.NEW_NUMBER_VARIABLE="Create number variable...",l.Msg.NEW_STRING_VARIABLE="Create string variable...",l.Msg.NEW_VARIABLE="Create variable...",l.Msg.NEW_VARIABLE_TITLE="New variable name:",l.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",l.Msg.OPTION_KEY="⌥ Option",l.Msg.ORDINAL_NUMBER_SUFFIX="",l.Msg.PASTE_SHORTCUT="Paste",l.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",l.Msg.PROCEDURES_BEFORE_PARAMS="with:",l.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",l.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",l.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",l.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",l.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",l.Msg.PROCEDURES_CALL_DISABLED_DEF_WARNING="Can't run the user-defined function '%1' because the definition block is disabled.",l.Msg.PROCEDURES_CREATE_DO="Create '%1'",l.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",l.Msg.PROCEDURES_DEFNORETURN_DO="",l.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",l.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",l.Msg.PROCEDURES_DEFNORETURN_TITLE="to",l.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",l.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",l.Msg.PROCEDURES_DEFRETURN_RETURN="return",l.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",l.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",l.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",l.Msg.PROCEDURES_IFRETURN_HELPURL="https://c2.com/cgi/wiki?GuardClause",l.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",l.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",l.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",l.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",l.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",l.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",l.Msg.REDO="Redo",l.Msg.REMOVE_COMMENT="Remove Comment",l.Msg.RENAME_VARIABLE="Rename variable...",l.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",l.Msg.SHORTCUTS_CODE_NAVIGATION="Code navigation",l.Msg.SHORTCUTS_EDITING="Editing",l.Msg.SHORTCUTS_GENERAL="General",l.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",l.Msg.TEXT_APPEND_TITLE="to %1 append text %2",l.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",l.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",l.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",l.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",l.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",l.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",l.Msg.TEXT_CHARAT_FIRST="get first letter",l.Msg.TEXT_CHARAT_FROM_END="get letter # from end",l.Msg.TEXT_CHARAT_FROM_START="get letter #",l.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",l.Msg.TEXT_CHARAT_LAST="get last letter",l.Msg.TEXT_CHARAT_RANDOM="get random letter",l.Msg.TEXT_CHARAT_TAIL="",l.Msg.TEXT_CHARAT_TITLE="in text %1 %2",l.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",l.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",l.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",l.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",l.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",l.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",l.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",l.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",l.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",l.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",l.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",l.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",l.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",l.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",l.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",l.Msg.TEXT_GET_SUBSTRING_TAIL="",l.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",l.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",l.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",l.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",l.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",l.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",l.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",l.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",l.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",l.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",l.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",l.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",l.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",l.Msg.TEXT_LENGTH_TITLE="length of %1",l.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",l.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",l.Msg.TEXT_PRINT_TITLE="print %1",l.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",l.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",l.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",l.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",l.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",l.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",l.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",l.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",l.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",l.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",l.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",l.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",l.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",l.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",l.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",l.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",l.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",l.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",l.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",l.Msg.TODAY="Today",l.Msg.UNDO="Undo",l.Msg.UNKNOWN="Unknown",l.Msg.UNNAMED_KEY="unnamed",l.Msg.VARIABLES_DEFAULT_NAME="item",l.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",l.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",l.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",l.Msg.VARIABLES_SET="set %1 to %2",l.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",l.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",l.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",l.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",l.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",l.Msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER="A variable named '%1' already exists as a parameter in the procedure '%2'.",l.Msg.WINDOWS="Windows",l.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",l.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",l.Msg.CONTROLS_FOREACH_INPUT_DO=l.Msg.CONTROLS_REPEAT_INPUT_DO,l.Msg.CONTROLS_FOR_INPUT_DO=l.Msg.CONTROLS_REPEAT_INPUT_DO,l.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=l.Msg.CONTROLS_IF_MSG_ELSEIF,l.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=l.Msg.CONTROLS_IF_MSG_ELSE,l.Msg.CONTROLS_IF_IF_TITLE_IF=l.Msg.CONTROLS_IF_MSG_IF,l.Msg.CONTROLS_IF_MSG_THEN=l.Msg.CONTROLS_REPEAT_INPUT_DO,l.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=l.Msg.CONTROLS_REPEAT_INPUT_DO,l.Msg.LISTS_CREATE_WITH_ITEM_TITLE=l.Msg.VARIABLES_DEFAULT_NAME,l.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=l.Msg.LISTS_INLIST,l.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=l.Msg.LISTS_INLIST,l.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=l.Msg.LISTS_INLIST,l.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=l.Msg.LISTS_INLIST,l.Msg.MATH_CHANGE_TITLE_ITEM=l.Msg.VARIABLES_DEFAULT_NAME,l.Msg.PROCEDURES_DEFRETURN_COMMENT=l.Msg.PROCEDURES_DEFNORETURN_COMMENT,l.Msg.PROCEDURES_DEFRETURN_DO=l.Msg.PROCEDURES_DEFNORETURN_DO,l.Msg.PROCEDURES_DEFRETURN_PROCEDURE=l.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,l.Msg.PROCEDURES_DEFRETURN_TITLE=l.Msg.PROCEDURES_DEFNORETURN_TITLE,l.Msg.TEXT_APPEND_VARIABLE=l.Msg.VARIABLES_DEFAULT_NAME,l.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=l.Msg.VARIABLES_DEFAULT_NAME,l.Msg.COLOUR_HUE="20",l.Msg.LISTS_HUE="260",l.Msg.LOGIC_HUE="210",l.Msg.LOOPS_HUE="120",l.Msg.MATH_HUE="230",l.Msg.PROCEDURES_HUE="290",l.Msg.TEXTS_HUE="160",l.Msg.VARIABLES_DYNAMIC_HUE="310",l.Msg.VARIABLES_HUE="330",l.Msg})})(en$1)),en$1.exports}var blocks_compressed$1={exports:{}},blocks_compressed=blocks_compressed$1.exports,hasRequiredBlocks_compressed;function requireBlocks_compressed(){return hasRequiredBlocks_compressed||(hasRequiredBlocks_compressed=1,(function(h,p){(function(l,a){h.exports=a(requireBlockly_compressed())})(blocks_compressed,function(l){var a=l.__namespace__,_=a.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),E={customContextMenu:function(v){if(this.isInFlyout)(this.type==="variables_get_dynamic"||this.type==="variables_get_reporter_dynamic")&&(Y={text:a.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:C(this)},F=this.getField("VAR").getText(),F={text:a.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",F),enabled:!0,callback:A(this)},v.unshift(Y),v.unshift(F));else{if(this.type==="variables_get_dynamic")var L="variables_set_dynamic",Y=a.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else L="variables_get_dynamic",Y=a.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var F=this.getField("VAR");L={type:L,fields:{VAR:F.saveState(!0)}},v.push({enabled:this.workspace.remainingCapacity()>0,text:Y.replace("%1",F.getText()),callback:a.callbackFactory$$module$build$src$core$contextmenu(this,L)})}},onchange:function(v){v=this.getFieldValue("VAR"),v=a.getVariable$$module$build$src$core$variables(this.workspace,v),this.type==="variables_get_dynamic"?this.outputConnection.setCheck(v.getType()):this.getInput("VALUE").connection.setCheck(v.getType())}},C=function(v){return function(){const L=v.workspace,Y=v.getField("VAR").getVariable();a.renameVariable$$module$build$src$core$variables(L,Y)}},A=function(v){return function(){const L=v.getField("VAR").getVariable();L&&a.deleteVariable$$module$build$src$core$variables(L.getWorkspace(),L,v)}};a.registerMixin$$module$build$src$core$extensions("contextMenu_variableDynamicSetterGetter",E),a.defineBlocks$$module$build$src$core$common(_);var N={blocks:_},O=a.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),H={customContextMenu:function(v){if(this.isInFlyout)(this.type==="variables_get"||this.type==="variables_get_reporter")&&(Y={text:a.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:D(this)},F=this.getField("VAR").getText(),F={text:a.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",F),enabled:!0,callback:j(this)},v.unshift(Y),v.unshift(F));else{if(this.type==="variables_get")var L="variables_set",Y=a.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else L="variables_get",Y=a.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var F=this.getField("VAR");L={type:L,fields:{VAR:F.saveState(!0)}},v.push({enabled:this.workspace.remainingCapacity()>0,text:Y.replace("%1",F.getText()),callback:a.callbackFactory$$module$build$src$core$contextmenu(this,L)})}}},D=function(v){return function(){const L=v.workspace,Y=v.getField("VAR").getVariable();a.renameVariable$$module$build$src$core$variables(L,Y)}},j=function(v){return function(){const L=v.getField("VAR").getVariable();L&&a.deleteVariable$$module$build$src$core$variables(L.getWorkspace(),L,v)}};a.registerMixin$$module$build$src$core$extensions("contextMenu_variableSetterGetter",H),a.defineBlocks$$module$build$src$core$common(O);var be={blocks:O},Oe=a.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]),ve={init:function(){this.WHERE_OPTIONS_1=[[a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT);const v=L=>{const Y=a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+L]});return Y.setValidator(function(F){const Fe=this.getValue();F=F==="FROM_START"||F==="FROM_END",F!==(Fe==="FROM_START"||Fe==="FROM_END")&&this.getSourceBlock().updateAt_(L,F)}),Y};this.appendDummyInput("WHERE1_INPUT").appendField(v(1),"WHERE1"),this.appendDummyInput("AT1"),this.appendDummyInput("WHERE2_INPUT").appendField(v(2),"WHERE2"),this.appendDummyInput("AT2"),a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){const v=a.createElement$$module$build$src$core$utils$xml("mutation");var L=this.getInput("AT1")instanceof a.ValueInput$$module$build$src$core$inputs$value_input;return v.setAttribute("at1",`${L}`),L=this.getInput("AT2")instanceof a.ValueInput$$module$build$src$core$inputs$value_input,v.setAttribute("at2",`${L}`),v},domToMutation:function(v){const L=v.getAttribute("at1")==="true";v=v.getAttribute("at2")==="true",this.updateAt_(1,L),this.updateAt_(2,v)},updateAt_:function(v,L){this.removeInput("AT"+v),this.removeInput("ORDINAL"+v,!0),L?(this.appendValueInput("AT"+v).setCheck("Number"),a.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+v).appendField(a.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+v),v===2&&a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL)),v===1&&(this.moveInputBefore("AT1","WHERE2_INPUT"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","WHERE2_INPUT"))}};Oe.text_getSubstring=ve,Oe.text_changeCase={init:function(){const v=[[a.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[a.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[a.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(a.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:v}),"CASE"),this.setOutput(!0,"String"),this.setTooltip(a.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_TOOLTIP)}},Oe.text_trim={init:function(){const v=[[a.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[a.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[a.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(a.Msg$$module$build$src$core$msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:v}),"MODE"),this.setOutput(!0,"String"),this.setTooltip(a.Msg$$module$build$src$core$msg.TEXT_TRIM_TOOLTIP)}},Oe.text_print={init:function(){this.jsonInit({message0:a.Msg$$module$build$src$core$msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:a.Msg$$module$build$src$core$msg.TEXT_PRINT_TOOLTIP,helpUrl:a.Msg$$module$build$src$core$msg.TEXT_PRINT_HELPURL})}};var Xe={updateType_:function(v){this.outputConnection.setCheck(v==="NUMBER"?"Number":"String")},mutationToDom:function(){const v=a.createElement$$module$build$src$core$utils$xml("mutation");return v.setAttribute("type",this.getFieldValue("TYPE")),v},domToMutation:function(v){this.updateType_(v.getAttribute("type"))}};Oe.text_prompt_ext=Object.assign({},Xe,{init:function(){var v=[[a.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[a.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(a.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),v=a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:v}),v.setValidator(L=>{this.updateType_(L)}),this.appendValueInput("TEXT").appendField(v,"TYPE"),this.setOutput(!0,"String"),this.setTooltip(()=>this.getFieldValue("TYPE")==="TEXT"?a.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:a.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}}),Oe.text_prompt=Object.assign({},Xe,{init:function(){this.mixin(Ke);var v=[[a.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[a.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(a.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),v=a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:v}),v.setValidator(L=>{this.updateType_(L)}),this.appendDummyInput().appendField(v,"TYPE").appendField(this.newQuote_(!0)).appendField(a.fromJson$$module$build$src$core$field_registry({type:"field_input",text:""}),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip(()=>this.getFieldValue("TYPE")==="TEXT"?a.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:a.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}}),Oe.text_count={init:function(){this.jsonInit({message0:a.Msg$$module$build$src$core$msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:a.Msg$$module$build$src$core$msg.TEXT_COUNT_TOOLTIP,helpUrl:a.Msg$$module$build$src$core$msg.TEXT_COUNT_HELPURL})}},Oe.text_replace={init:function(){this.jsonInit({message0:a.Msg$$module$build$src$core$msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:a.Msg$$module$build$src$core$msg.TEXT_REPLACE_TOOLTIP,helpUrl:a.Msg$$module$build$src$core$msg.TEXT_REPLACE_HELPURL})}},Oe.text_reverse={init:function(){this.jsonInit({message0:a.Msg$$module$build$src$core$msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:a.Msg$$module$build$src$core$msg.TEXT_REVERSE_TOOLTIP,helpUrl:a.Msg$$module$build$src$core$msg.TEXT_REVERSE_HELPURL})}};var Ke={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(v){for(let L=0,Y;Y=this.inputList[L];L++)for(let F=0,Fe;Fe=Y.fieldRow[F];F++)if(v===Fe.name){Y.insertFieldAt(F,this.newQuote_(!0)),Y.insertFieldAt(F+2,this.newQuote_(!1));return}console.warn('field named "'+v+'" not found in '+this.toDevString())},newQuote_:function(v){return v=this.RTL?!v:v,a.fromJson$$module$build$src$core$field_registry({type:"field_image",src:v?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,width:this.QUOTE_IMAGE_WIDTH,height:this.QUOTE_IMAGE_HEIGHT,alt:v?"“":"”"})}},_e=function(){this.mixin(Ke),this.quoteField_("TEXT")},Le={itemCount_:0,mutationToDom:function(){const v=a.createElement$$module$build$src$core$utils$xml("mutation");return v.setAttribute("items",`${this.itemCount_}`),v},domToMutation:function(v){this.itemCount_=parseInt(v.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(v){this.itemCount_=v.itemCount,this.updateShape_()},decompose:function(v){const L=v.newBlock("text_create_join_container");L.initSvg();let Y=L.getInput("STACK").connection;for(let F=0;F<this.itemCount_;F++){const Fe=v.newBlock("text_create_join_item");Fe.initSvg(),Y.connect(Fe.previousConnection),Y=Fe.nextConnection}return L},compose:function(v){var L=v.getInputTargetBlock("STACK");for(v=[];L;)L.isInsertionMarker()||v.push(L.valueConnection_),L=L.getNextBlock();for(L=0;L<this.itemCount_;L++){const Y=this.getInput("ADD"+L).connection.targetConnection;Y&&!v.includes(Y)&&Y.disconnect()}for(this.itemCount_=v.length,this.updateShape_(),L=0;L<this.itemCount_;L++){let Y;(Y=v[L])==null||Y.reconnect(this,"ADD"+L)}},saveConnections:function(v){v=v.getInputTargetBlock("STACK");let L=0;for(;v;){if(v.isInsertionMarker()){v=v.getNextBlock();continue}const Y=this.getInput("ADD"+L);v.valueConnection_=Y&&Y.connection.targetConnection,v=v.getNextBlock(),L++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var v=0;v<this.itemCount_;v++)if(!this.getInput("ADD"+v)){const L=this.appendValueInput("ADD"+v).setAlign(a.Align$$module$build$src$core$inputs$align.RIGHT);v===0&&L.appendField(a.Msg$$module$build$src$core$msg.TEXT_JOIN_TITLE_CREATEWITH)}for(v=this.itemCount_;this.getInput("ADD"+v);v++)this.removeInput("ADD"+v)}},Ae=function(){this.mixin(Ke),this.itemCount_=2,this.updateShape_(),this.setMutator(new a.MutatorIcon$$module$build$src$core$icons$mutator_icon(["text_create_join_item"],this))};a.register$$module$build$src$core$extensions("text_append_tooltip",a.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_TEXT_APPEND_TOOLTIP}","VAR"));var rt=function(){this.setTooltip(()=>a.Msg$$module$build$src$core$msg.TEXT_INDEXOF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))},De={isAt_:!1,mutationToDom:function(){const v=a.createElement$$module$build$src$core$utils$xml("mutation");return v.setAttribute("at",`${this.isAt_}`),v},domToMutation:function(v){v=v.getAttribute("at")!=="false",this.updateAt_(v)},updateAt_:function(v){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),v&&(this.appendValueInput("AT").setCheck("Number"),a.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(a.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)),a.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(a.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL)),this.isAt_=v}},xe=function(){this.getField("WHERE").setValidator(function(v){v=v==="FROM_START"||v==="FROM_END";const L=this.getSourceBlock();v!==L.isAt_&&L.updateAt_(v)}),this.updateAt_(!0),this.setTooltip(()=>{var v=this.getFieldValue("WHERE");let L=a.Msg$$module$build$src$core$msg.TEXT_CHARAT_TOOLTIP;return(v==="FROM_START"||v==="FROM_END")&&(v=v==="FROM_START"?a.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:a.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(L+="  "+v.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),L})};a.register$$module$build$src$core$extensions("text_indexOf_tooltip",rt),a.register$$module$build$src$core$extensions("text_quotes",_e),a.registerMixin$$module$build$src$core$extensions("quote_image_mixin",Ke),a.registerMutator$$module$build$src$core$extensions("text_join_mutator",Le,Ae),a.registerMutator$$module$build$src$core$extensions("text_charAt_mutator",De,xe),a.defineBlocks$$module$build$src$core$common(Oe);var at={blocks:Oe},ht={},ot={setStatements_:function(v){this.hasStatements_!==v&&(v?(this.appendStatementInput("STACK").appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=v)},updateParams_:function(){let v="";this.arguments_.length&&(v=a.Msg$$module$build$src$core$msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),a.disable$$module$build$src$core$events$utils();try{this.setFieldValue(v,"PARAMS")}finally{a.enable$$module$build$src$core$events$utils()}},mutationToDom:function(v){const L=a.createElement$$module$build$src$core$utils$xml("mutation");v&&L.setAttribute("name",this.getFieldValue("NAME"));for(let Y=0;Y<this.argumentVarModels_.length;Y++){const F=a.createElement$$module$build$src$core$utils$xml("arg"),Fe=this.argumentVarModels_[Y];F.setAttribute("name",Fe.getName()),F.setAttribute("varid",Fe.getId()),v&&this.paramIds_&&F.setAttribute("paramId",this.paramIds_[Y]),L.appendChild(F)}return this.hasStatements_||L.setAttribute("statements","false"),L},domToMutation:function(v){this.arguments_=[],this.argumentVarModels_=[];for(let Y=0,F;F=v.childNodes[Y];Y++)if(F.nodeName.toLowerCase()==="arg"){var L=F;const Fe=L.getAttribute("name");L=L.getAttribute("varid")||L.getAttribute("varId"),this.arguments_.push(Fe),L=a.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,L,Fe,""),L!==null?this.argumentVarModels_.push(L):console.log(`Failed to create a variable named "${Fe}", ignoring.`)}this.updateParams_(),a.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_(v.getAttribute("statements")!=="false")},saveExtraState:function(){if(!this.argumentVarModels_.length&&this.hasStatements_)return null;const v=Object.create(null);if(this.argumentVarModels_.length){v.params=[];for(let L=0;L<this.argumentVarModels_.length;L++)v.params.push({name:this.argumentVarModels_[L].getName(),id:this.argumentVarModels_[L].getId()})}return this.hasStatements_||(v.hasStatements=!1),v},loadExtraState:function(v){if(this.arguments_=[],this.argumentVarModels_=[],v.params)for(let Y=0;Y<v.params.length;Y++){var L=v.params[Y];L=a.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,L.id,L.name,""),this.arguments_.push(L.getName()),this.argumentVarModels_.push(L)}this.updateParams_(),a.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_(v.hasStatements!==!1)},decompose:function(v){const L=a.createElement$$module$build$src$core$utils$xml("block");L.setAttribute("type","procedures_mutatorcontainer");var Y=a.createElement$$module$build$src$core$utils$xml("statement");Y.setAttribute("name","STACK"),L.appendChild(Y);for(let Fe=0;Fe<this.arguments_.length;Fe++){const Ft=a.createElement$$module$build$src$core$utils$xml("block");Ft.setAttribute("type","procedures_mutatorarg");var F=a.createElement$$module$build$src$core$utils$xml("field");F.setAttribute("name","NAME");const ki=a.createTextNode$$module$build$src$core$utils$xml(this.arguments_[Fe]);F.appendChild(ki),Ft.appendChild(F),F=a.createElement$$module$build$src$core$utils$xml("next"),Ft.appendChild(F),Y.appendChild(Ft),Y=F}return v=a.domToBlock$$module$build$src$core$xml(L,v),this.type==="procedures_defreturn"?v.setFieldValue(this.hasStatements_,"STATEMENTS"):v.removeInput("STATEMENT_INPUT"),a.mutateCallers$$module$build$src$core$procedures(this),v},compose:function(v){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];let L=v.getInputTargetBlock("STACK");for(;L&&!L.isInsertionMarker();){var Y=L.getFieldValue("NAME");this.arguments_.push(Y),Y=this.workspace.getVariable(Y,""),this.argumentVarModels_.push(Y),this.paramIds_.push(L.id),L=L.nextConnection&&L.nextConnection.targetBlock()}if(this.updateParams_(),a.mutateCallers$$module$build$src$core$procedures(this),v=v.getFieldValue("STATEMENTS"),v!==null&&(v=v==="TRUE",this.hasStatements_!==v))if(v){this.setStatements_(!0);var F;(F=this.statementConnection_)==null||F.reconnect(this,"STACK"),this.statementConnection_=null}else F=this.getInput("STACK").connection,(this.statementConnection_=F.targetConnection)&&(F=F.targetBlock(),F.unplug(),F.bumpNeighbours()),this.setStatements_(!1)},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(v,L){var Y=this.workspace.getVariableById(v);if(Y.getType()===""){Y=Y.getName(),L=this.workspace.getVariableById(L);var F=!1;for(let Fe=0;Fe<this.argumentVarModels_.length;Fe++)this.argumentVarModels_[Fe].getId()===v&&(this.arguments_[Fe]=L.getName(),this.argumentVarModels_[Fe]=L,F=!0);F&&(this.displayRenamedVar_(Y,L.getName()),a.mutateCallers$$module$build$src$core$procedures(this))}},updateVarName:function(v){const L=v.getName();let Y=!1,F;for(let Fe=0;Fe<this.argumentVarModels_.length;Fe++)this.argumentVarModels_[Fe].getId()===v.getId()&&(F=this.arguments_[Fe],this.arguments_[Fe]=L,Y=!0);Y&&(this.displayRenamedVar_(F,L),a.mutateCallers$$module$build$src$core$procedures(this))},displayRenamedVar_:function(v,L){this.updateParams_();var Y=this.getIcon(a.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE);if(Y&&Y.bubbleIsVisible()){Y=Y.getWorkspace().getAllBlocks(!1);for(let F=0,Fe;Fe=Y[F];F++)Fe.type==="procedures_mutatorarg"&&a.Names$$module$build$src$core$names.equals(v,Fe.getFieldValue("NAME"))&&Fe.setFieldValue(L,"NAME")}},customContextMenu:function(v){if(!this.isInFlyout){var L=this.getFieldValue("NAME"),Y={type:this.callType_,extraState:{name:L,params:this.arguments_}};if(v.push({enabled:!0,text:a.Msg$$module$build$src$core$msg.PROCEDURES_CREATE_DO.replace("%1",L),callback:a.callbackFactory$$module$build$src$core$contextmenu(this,Y)}),!this.isCollapsed())for(L=0;L<this.argumentVarModels_.length;L++){Y=this.argumentVarModels_[L];const F={type:"variables_get",fields:{VAR:{name:Y.getName(),id:Y.getId(),type:Y.getType()}}};v.push({enabled:!0,text:a.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",Y.getName()),callback:a.callbackFactory$$module$build$src$core$contextmenu(this,F)})}}}};ht.procedures_defnoreturn=Object.assign({},ot,{init:function(){var v=a.findLegalName$$module$build$src$core$procedures("",this);v=a.fromJson$$module$build$src$core$field_registry({type:"field_input",text:v}),v.setValidator(a.rename$$module$build$src$core$procedures),v.setSpellcheck(!1),this.appendDummyInput().appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TITLE).appendField(v,"NAME").appendField("","PARAMS"),this.setMutator(new a.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&a.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},callType_:"procedures_callnoreturn"}),ht.procedures_defreturn=Object.assign({},ot,{init:function(){var v=a.findLegalName$$module$build$src$core$procedures("",this);v=a.fromJson$$module$build$src$core$field_registry({type:"field_input",text:v}),v.setValidator(a.rename$$module$build$src$core$procedures),v.setSpellcheck(!1),this.appendDummyInput().appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TITLE).appendField(v,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(a.Align$$module$build$src$core$inputs$align.RIGHT).appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new a.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&a.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},callType_:"procedures_callreturn"});var Je={init:function(){this.appendDummyInput().appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_ALLOW_STATEMENTS).appendField(a.fromJson$$module$build$src$core$field_registry({type:"field_checkbox",checked:!0}),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(a.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}};ht.procedures_mutatorcontainer=Je;var Rt=class extends a.FieldTextInput$$module$build$src$core$field_textinput{constructor(){super(...arguments),this.editingInteractively=!1}showEditor_(v){super.showEditor_(v),this.editingInteractively=!0,this.editingVariable=void 0}onFinishEditing_(v){super.onFinishEditing_(v),this.editingInteractively=!1}},Bt={init:function(){const v=new Rt(a.DEFAULT_ARG$$module$build$src$core$procedures,this.validator_);this.appendDummyInput().appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TITLE).appendField(v,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(a.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1},validator_:function(v){var L=this.getSourceBlock();const Y=L.workspace.getRootWorkspace();if(v=v.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,""),!v)return null;const F=(L.workspace.targetWorkspace||L.workspace).getAllBlocks(!1),Fe=v.toLowerCase();for(let Ft=0;Ft<F.length;Ft++){if(F[Ft].id===this.getSourceBlock().id)continue;const ki=F[Ft].getFieldValue("NAME");if(ki&&ki.toLowerCase()===Fe)return null}return L.isInFlyout||((L=Y.getVariable(v,""))&&L.getName()!==v&&Y.renameVariableById(L.getId(),v),L||(this.editingInteractively?this.editingVariable?Y.renameVariableById(this.editingVariable.getId(),v):this.editingVariable=Y.createVariable(v,""):Y.createVariable(v,""))),v}};ht.procedures_mutatorarg=Bt;var Yt="DISABLED_PROCEDURE_DEFINITION",kt={getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(v,L){a.Names$$module$build$src$core$names.equals(v,this.getProcedureCall())&&(this.setFieldValue(L,"NAME"),this.setTooltip((this.outputConnection?a.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_TOOLTIP:a.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",L)))},setProcedureParameters_:function(v,L){var Y=a.getDefinition$$module$build$src$core$procedures(this.getProcedureCall(),this.workspace);if((Y=(Y=Y&&Y.getIcon(a.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE))&&Y.bubbleIsVisible())?this.setCollapsed(!1):(this.quarkConnections_={},this.quarkIds_=null),v.join(`
`)===this.arguments_.join(`
`))this.quarkIds_=L;else{if(L.length!==v.length)throw RangeError("paramNames and paramIds must be the same length.");this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]);for(let Fe=0;Fe<this.arguments_.length;Fe++){var F=this.getInput("ARG"+Fe);F&&(F=F.connection.targetConnection,this.quarkConnections_[this.quarkIds_[Fe]]=F,Y&&F&&!L.includes(this.quarkIds_[Fe])&&(F.disconnect(),F.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(v),this.argumentVarModels_=[],v=0;v<this.arguments_.length;v++)Y=a.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,null,this.arguments_[v],""),this.argumentVarModels_.push(Y);if(this.updateShape_(),this.quarkIds_=L){for(L=0;L<this.arguments_.length;L++)if(v=this.quarkIds_[L],v in this.quarkConnections_){let Fe;(Fe=this.quarkConnections_[v])!=null&&Fe.reconnect(this,"ARG"+L)||delete this.quarkConnections_[v]}}}},updateShape_:function(){for(var v=0;v<this.arguments_.length;v++){var L=this.getField("ARGNAME"+v);if(L){a.disable$$module$build$src$core$events$utils();try{L.setValue(this.arguments_[v])}finally{a.enable$$module$build$src$core$events$utils()}}else L=a.fromJson$$module$build$src$core$field_registry({type:"field_label",text:this.arguments_[v]}),this.appendValueInput("ARG"+v).setAlign(a.Align$$module$build$src$core$inputs$align.RIGHT).appendField(L,"ARGNAME"+v)}for(v=this.arguments_.length;this.getInput("ARG"+v);v++)this.removeInput("ARG"+v);(v=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||v.appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"):this.getField("WITH")&&v.removeField("WITH"))},mutationToDom:function(){const v=a.createElement$$module$build$src$core$utils$xml("mutation");v.setAttribute("name",this.getProcedureCall());for(let L=0;L<this.arguments_.length;L++){const Y=a.createElement$$module$build$src$core$utils$xml("arg");Y.setAttribute("name",this.arguments_[L]),v.appendChild(Y)}return v},domToMutation:function(v){var L=v.getAttribute("name");this.renameProcedure(this.getProcedureCall(),L),L=[];const Y=[];for(let F=0,Fe;Fe=v.childNodes[F];F++)Fe.nodeName.toLowerCase()==="arg"&&(L.push(Fe.getAttribute("name")),Y.push(Fe.getAttribute("paramId")));this.setProcedureParameters_(L,Y)},saveExtraState:function(){const v=Object.create(null);return v.name=this.getProcedureCall(),this.arguments_.length&&(v.params=this.arguments_),v},loadExtraState:function(v){if(this.renameProcedure(this.getProcedureCall(),v.name),v=v.params){const L=[];L.length=v.length,L.fill(null),this.setProcedureParameters_(v,L)}},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(v){if(this.workspace&&!this.workspace.isFlyout&&v.recordUndo)if(v.type===a.BLOCK_CREATE$$module$build$src$core$events$events&&v.ids.includes(this.id)){var L=this.getProcedureCall(),Y=a.getDefinition$$module$build$src$core$procedures(L,this.workspace);if(!Y||Y.type===this.defType_&&JSON.stringify(Y.getVars())===JSON.stringify(this.arguments_)||(Y=null),Y)Y.isEnabled()||(this.setDisabledReason(!0,Yt),this.setWarningText(a.Msg$$module$build$src$core$msg.PROCEDURES_CALL_DISABLED_DEF_WARNING.replace("%1",L)));else{a.setGroup$$module$build$src$core$events$utils(v.group),v=a.createElement$$module$build$src$core$utils$xml("xml"),L=a.createElement$$module$build$src$core$utils$xml("block"),L.setAttribute("type",this.defType_),Y=this.getRelativeToSurfaceXY();var F=Y.y+a.config$$module$build$src$core$config.snapRadius*2;L.setAttribute("x",`${Y.x+a.config$$module$build$src$core$config.snapRadius*(this.RTL?-1:1)}`),L.setAttribute("y",`${F}`),Y=this.mutationToDom(),L.appendChild(Y),Y=a.createElement$$module$build$src$core$utils$xml("field"),Y.setAttribute("name","NAME"),F=this.getProcedureCall();const Fe=a.findLegalName$$module$build$src$core$procedures(F,this);F!==Fe&&this.renameProcedure(F,Fe),Y.appendChild(a.createTextNode$$module$build$src$core$utils$xml(F)),L.appendChild(Y),v.appendChild(L),a.domToWorkspace$$module$build$src$core$xml(v,this.workspace),a.setGroup$$module$build$src$core$events$utils(!1)}}else v.type===a.BLOCK_DELETE$$module$build$src$core$events$events?(L=this.getProcedureCall(),a.getDefinition$$module$build$src$core$procedures(L,this.workspace)||(a.setGroup$$module$build$src$core$events$utils(v.group),this.dispose(!0),a.setGroup$$module$build$src$core$events$utils(!1))):v.type===a.BLOCK_CHANGE$$module$build$src$core$events$events&&v.element==="disabled"&&(L=this.getProcedureCall(),(F=a.getDefinition$$module$build$src$core$procedures(L,this.workspace))&&F.id===v.blockId&&((Y=a.getGroup$$module$build$src$core$events$utils())&&console.log("Saw an existing group while responding to a definition change"),a.setGroup$$module$build$src$core$events$utils(v.group),v=F.isEnabled(),this.setDisabledReason(!v,Yt),this.setWarningText(v?null:a.Msg$$module$build$src$core$msg.PROCEDURES_CALL_DISABLED_DEF_WARNING.replace("%1",L)),a.setGroup$$module$build$src$core$events$utils(Y)))},customContextMenu:function(v){if(this.workspace.isMovable()){var L=this.getProcedureCall(),Y=this.workspace;v.push({enabled:!0,text:a.Msg$$module$build$src$core$msg.PROCEDURES_HIGHLIGHT_DEF,callback:function(){const F=a.getDefinition$$module$build$src$core$procedures(L,Y);F&&(Y.centerOnBlock(F.id),a.getFocusManager$$module$build$src$core$focus_manager().focusNode(F))}})}}};ht.procedures_callnoreturn=Object.assign({},kt,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(a.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},defType_:"procedures_defnoreturn"}),ht.procedures_callreturn=Object.assign({},kt,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(a.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},defType_:"procedures_defreturn"});var de="UNPARENTED_IFRETURN",Ve={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(a.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(a.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(a.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){const v=a.createElement$$module$build$src$core$utils$xml("mutation");return v.setAttribute("value",String(Number(this.hasReturnValue_))),v},domToMutation:function(v){this.hasReturnValue_=v.getAttribute("value")==="1",this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(v){if(!(this.workspace.isDragging&&this.workspace.isDragging()||v.type!==a.BLOCK_MOVE$$module$build$src$core$events$events&&v.type!==a.BLOCK_CREATE$$module$build$src$core$events$events)){v=!1;var L=this;do{if(this.FUNCTION_TYPES.includes(L.type)){v=!0;break}L=L.getSurroundParent()}while(L);if(v?(L.type==="procedures_defnoreturn"&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):L.type!=="procedures_defreturn"||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null)):this.setWarningText(a.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_WARNING),!this.isInFlyout)try{a.setRecordUndo$$module$build$src$core$events$utils(!1),this.setDisabledReason(!v,de)}finally{a.setRecordUndo$$module$build$src$core$events$utils(!0)}}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]};ht.procedures_ifreturn=Ve,a.defineBlocks$$module$build$src$core$common(ht);var ft={blocks:ht},_t=a.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["π","PI"],["e","E"],["φ","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(½)","SQRT1_2"],["∞","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]),Be={ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"};a.register$$module$build$src$core$extensions("math_op_tooltip",a.buildTooltipForDropdown$$module$build$src$core$extensions("OP",Be));var J={mutationToDom:function(){const v=a.createElement$$module$build$src$core$utils$xml("mutation"),L=this.getFieldValue("PROPERTY")==="DIVISIBLE_BY";return v.setAttribute("divisor_input",String(L)),v},domToMutation:function(v){v=v.getAttribute("divisor_input")==="true",this.updateShape_(v)},updateShape_:function(v){const L=this.getInput("DIVISOR");v?L||this.appendValueInput("DIVISOR").setCheck("Number"):L&&this.removeInput("DIVISOR")}},Ce=function(){this.getField("PROPERTY").setValidator(function(v){v=v==="DIVISIBLE_BY",this.getSourceBlock().updateShape_(v)})};a.registerMutator$$module$build$src$core$extensions("math_is_divisibleby_mutator",J,Ce),a.register$$module$build$src$core$extensions("math_change_tooltip",a.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_MATH_CHANGE_TOOLTIP}","VAR"));var He={updateType_:function(v){v==="MODE"?this.outputConnection.setCheck("Array"):this.outputConnection.setCheck("Number")},mutationToDom:function(){const v=a.createElement$$module$build$src$core$utils$xml("mutation");return v.setAttribute("op",this.getFieldValue("OP")),v},domToMutation:function(v){if(v=v.getAttribute("op"),v===null)throw new TypeError("xmlElement had no op attribute");this.updateType_(v)}},it=function(){this.getField("OP").setValidator((function(v){this.updateType_(v)}).bind(this))};a.registerMutator$$module$build$src$core$extensions("math_modes_of_list_mutator",He,it),a.defineBlocks$$module$build$src$core$common(_t);var Et={blocks:_t},Ze=a.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]),Pt={WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"};a.register$$module$build$src$core$extensions("controls_whileUntil_tooltip",a.buildTooltipForDropdown$$module$build$src$core$extensions("MODE",Pt));var An={BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"};a.register$$module$build$src$core$extensions("controls_flow_tooltip",a.buildTooltipForDropdown$$module$build$src$core$extensions("FLOW",An));var tt={customContextMenu:function(v){if(!this.isInFlyout){var L=this.getField("VAR"),Y=L.getVariable().getName();this.isCollapsed()||Y===null||(L={type:"variables_get",fields:{VAR:L.saveState(!0)}},v.push({enabled:!0,text:a.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",Y),callback:a.callbackFactory$$module$build$src$core$contextmenu(this,L)}))}}};a.registerMixin$$module$build$src$core$extensions("contextMenu_newGetVariableBlock",tt),a.register$$module$build$src$core$extensions("controls_for_tooltip",a.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),a.register$$module$build$src$core$extensions("controls_forEach_tooltip",a.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR"));var Qe=new Set(["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"]),Ni="CONTROL_FLOW_NOT_IN_LOOP",ae={getSurroundLoop:function(){let v=this;do{if(Qe.has(v.type))return v;v=v.getSurroundParent()}while(v);return null},onchange:function(v){const L=this.workspace;if(L.isDragging&&!L.isDragging()&&(v.type===a.BLOCK_MOVE$$module$build$src$core$events$events||v.type===a.BLOCK_CREATE$$module$build$src$core$events$events)&&(v=!!this.getSurroundLoop(),this.setWarningText(v?null:a.Msg$$module$build$src$core$msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout))try{a.setRecordUndo$$module$build$src$core$events$utils(!1),this.setDisabledReason(!v,Ni)}finally{a.setRecordUndo$$module$build$src$core$events$utils(!0)}}};a.registerMixin$$module$build$src$core$extensions("controls_flow_in_loop_check",ae),a.defineBlocks$$module$build$src$core$common(Ze);var We={blocks:Ze,loopTypes:Qe},Mn=a.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["≠","NEQ"],["‏<","LT"],["‏≤","LTE"],["‏>","GT"],["‏≥","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]},{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]),vt={EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"};a.register$$module$build$src$core$extensions("logic_op_tooltip",a.buildTooltipForDropdown$$module$build$src$core$extensions("OP",vt));var Si={elseifCount_:0,elseCount_:0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const v=a.createElement$$module$build$src$core$utils$xml("mutation");return this.elseifCount_&&v.setAttribute("elseif",String(this.elseifCount_)),this.elseCount_&&v.setAttribute("else","1"),v},domToMutation:function(v){this.elseifCount_=parseInt(v.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(v.getAttribute("else"),10)||0,this.rebuildShape_()},saveExtraState:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const v=Object.create(null);return this.elseifCount_&&(v.elseIfCount=this.elseifCount_),this.elseCount_&&(v.hasElse=!0),v},loadExtraState:function(v){this.elseifCount_=v.elseIfCount||0,this.elseCount_=v.hasElse?1:0,this.updateShape_()},decompose:function(v){const L=v.newBlock("controls_if_if");L.initSvg();let Y=L.nextConnection;for(let F=1;F<=this.elseifCount_;F++){const Fe=v.newBlock("controls_if_elseif");Fe.initSvg(),Y.connect(Fe.previousConnection),Y=Fe.nextConnection}return this.elseCount_&&(v=v.newBlock("controls_if_else"),v.initSvg(),Y.connect(v.previousConnection)),L},compose:function(v){v=v.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;const L=[null],Y=[null];let F=null;for(;v;){if(!v.isInsertionMarker())switch(v.type){case"controls_if_elseif":this.elseifCount_++,L.push(v.valueConnection_),Y.push(v.statementConnection_);break;case"controls_if_else":this.elseCount_++,F=v.statementConnection_;break;default:throw TypeError("Unknown block type: "+v.type)}v=v.getNextBlock()}this.updateShape_(),this.reconnectChildBlocks_(L,Y,F)},saveConnections:function(v){v=v.nextConnection.targetBlock();let L=1;for(;v;){if(!v.isInsertionMarker())switch(v.type){case"controls_if_elseif":var Y=this.getInput("IF"+L);const F=this.getInput("DO"+L);v.valueConnection_=Y&&Y.connection.targetConnection,v.statementConnection_=F&&F.connection.targetConnection,L++;break;case"controls_if_else":Y=this.getInput("ELSE"),v.statementConnection_=Y&&Y.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+v.type)}v=v.getNextBlock()}},rebuildShape_:function(){const v=[null],L=[null];let Y=null;this.getInput("ELSE")&&(Y=this.getInput("ELSE").connection.targetConnection);for(let F=1;this.getInput("IF"+F);F++){const Fe=this.getInput("IF"+F),Ft=this.getInput("DO"+F);v.push(Fe.connection.targetConnection),L.push(Ft.connection.targetConnection)}this.updateShape_(),this.reconnectChildBlocks_(v,L,Y)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var v=1;this.getInput("IF"+v);v++)this.removeInput("IF"+v),this.removeInput("DO"+v);for(v=1;v<=this.elseifCount_;v++)this.appendValueInput("IF"+v).setCheck("Boolean").appendField(a.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+v).appendField(a.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(a.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(v,L,Y){for(let F=1;F<=this.elseifCount_;F++){let Fe;(Fe=v[F])==null||Fe.reconnect(this,"IF"+F);let Ft;(Ft=L[F])==null||Ft.reconnect(this,"DO"+F)}Y?.reconnect(this,"ELSE")}};a.registerMutator$$module$build$src$core$extensions("controls_if_mutator",Si,null,["controls_if_elseif","controls_if_else"]);var Wt=function(){this.setTooltip((function(){if(this.elseifCount_||this.elseCount_){if(!this.elseifCount_&&this.elseCount_)return a.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_2;if(this.elseifCount_&&!this.elseCount_)return a.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_3;if(this.elseifCount_&&this.elseCount_)return a.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_4}else return a.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_1;return""}).bind(this))};a.register$$module$build$src$core$extensions("controls_if_tooltip",Wt);var Yi={onchange:function(v){this.prevBlocks_||(this.prevBlocks_=[null,null]);var L=this.getInputTargetBlock("A");const Y=this.getInputTargetBlock("B");L&&Y&&!this.workspace.connectionChecker.doTypeChecks(L.outputConnection,Y.outputConnection)&&(a.setGroup$$module$build$src$core$events$utils(v.group),v=this.prevBlocks_[0],v!==L&&(L.unplug(),!v||v.isDisposed()||v.isShadow()||this.getInput("A").connection.connect(v.outputConnection)),L=this.prevBlocks_[1],L!==Y&&(Y.unplug(),!L||L.isDisposed()||L.isShadow()||this.getInput("B").connection.connect(L.outputConnection)),this.bumpNeighbours(),a.setGroup$$module$build$src$core$events$utils(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}},Ki=function(){this.mixin(Yi)};a.register$$module$build$src$core$extensions("logic_compare",Ki);var Ln={prevParentConnection_:null,onchange:function(v){const L=this.getInputTargetBlock("THEN"),Y=this.getInputTargetBlock("ELSE"),F=this.outputConnection.targetConnection;if((L||Y)&&F)for(let Fe=0;Fe<2;Fe++){const Ft=Fe===1?L:Y;Ft&&!Ft.workspace.connectionChecker.doTypeChecks(Ft.outputConnection,F)&&(a.setGroup$$module$build$src$core$events$utils(v.group),F===this.prevParentConnection_?(this.unplug(),F.getSourceBlock().bumpNeighbours()):(Ft.unplug(),Ft.bumpNeighbours()),a.setGroup$$module$build$src$core$events$utils(!1))}this.prevParentConnection_=F}};a.registerMixin$$module$build$src$core$extensions("logic_ternary",Ln),a.defineBlocks$$module$build$src$core$common(Mn);var _n={blocks:Mn},bn=a.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),so={init:function(){this.setHelpUrl(a.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new a.MutatorIcon$$module$build$src$core$icons$mutator_icon(["lists_create_with_item"],this)),this.setTooltip(a.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){const v=a.createElement$$module$build$src$core$utils$xml("mutation");return v.setAttribute("items",String(this.itemCount_)),v},domToMutation:function(v){if(v=v.getAttribute("items"),!v)throw new TypeError("element did not have items");this.itemCount_=parseInt(v,10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(v){this.itemCount_=v.itemCount,this.updateShape_()},decompose:function(v){const L=v.newBlock("lists_create_with_container");L.initSvg();let Y=L.getInput("STACK").connection;for(let F=0;F<this.itemCount_;F++){const Fe=v.newBlock("lists_create_with_item");if(Fe.initSvg(),!Fe.previousConnection)throw Error("itemBlock has no previousConnection");Y.connect(Fe.previousConnection),Y=Fe.nextConnection}return L},compose:function(v){var L=v.getInputTargetBlock("STACK");for(v=[];L;)L.isInsertionMarker()||v.push(L.valueConnection_),L=L.getNextBlock();for(L=0;L<this.itemCount_;L++){const Y=this.getInput("ADD"+L).connection.targetConnection;Y&&!v.includes(Y)&&Y.disconnect()}for(this.itemCount_=v.length,this.updateShape_(),L=0;L<this.itemCount_;L++){let Y;(Y=v[L])==null||Y.reconnect(this,"ADD"+L)}},saveConnections:function(v){v=v.getInputTargetBlock("STACK");let L=0;for(;v;){if(v.isInsertionMarker()){v=v.getNextBlock();continue}const Y=this.getInput("ADD"+L);let F;v.valueConnection_=(F=Y)==null?void 0:F.connection.targetConnection,v=v.getNextBlock(),L++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(a.Msg$$module$build$src$core$msg.LISTS_CREATE_EMPTY_TITLE);for(var v=0;v<this.itemCount_;v++)if(!this.getInput("ADD"+v)){const L=this.appendValueInput("ADD"+v).setAlign(a.Align$$module$build$src$core$inputs$align.RIGHT);v===0&&L.appendField(a.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_INPUT_WITH)}for(v=this.itemCount_;this.getInput("ADD"+v);v++)this.removeInput("ADD"+v)}};bn.lists_create_with=so;var In={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(a.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(a.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}};bn.lists_create_with_container=In;var X={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(a.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(a.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}};bn.lists_create_with_item=X;var Zn={init:function(){var v=[[a.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_FIRST,"FIRST"],[a.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_LAST,"LAST"]];if(this.setHelpUrl(a.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(a.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_INPUT_IN_LIST),v=a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:v}),!v)throw Error("field_dropdown not found");this.appendValueInput("FIND").appendField(v,"END"),this.setInputsInline(!0),this.setTooltip(()=>a.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))}};bn.lists_indexOf=Zn;var Hn={init:function(){var v=[[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET,"GET"],[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),v=a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:v}),v.setValidator(function(L){L=L==="REMOVE",this.getSourceBlock().updateStatement_(L)}),this.appendValueInput("VALUE").setCheck("Array").appendField(a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(v,"MODE").appendField("","SPACE"),v=a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS}),v.setValidator(function(L){const Y=this.getValue();L=L==="FROM_START"||L==="FROM_END",L!==(Y==="FROM_START"||Y==="FROM_END")&&this.getSourceBlock().updateAt_(L)}),this.appendDummyInput().appendField(v,"WHERE"),this.appendDummyInput("AT"),a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0),this.setTooltip(()=>{const L=this.getFieldValue("MODE"),Y=this.getFieldValue("WHERE");let F="";switch(L+" "+Y){case"GET FROM_START":case"GET FROM_END":F=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":F=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":F=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":F=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":F=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":F=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":F=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":F=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":F=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":F=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":F=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":F=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return(Y==="FROM_START"||Y==="FROM_END")&&(F+="  "+(Y==="FROM_START"?a.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:a.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),F})},mutationToDom:function(){const v=a.createElement$$module$build$src$core$utils$xml("mutation");v.setAttribute("statement",String(!this.outputConnection));const L=this.getInput("AT")instanceof a.ValueInput$$module$build$src$core$inputs$value_input;return v.setAttribute("at",String(L)),v},domToMutation:function(v){const L=v.getAttribute("statement")==="true";this.updateStatement_(L),v=v.getAttribute("at")!=="false",this.updateAt_(v)},saveExtraState:function(){return this.outputConnection?null:{isStatement:!0}},loadExtraState:function(v){v.isStatement?this.updateStatement_(!0):typeof v=="string"&&this.domToMutation(a.textToDom$$module$build$src$core$utils$xml(v))},updateStatement_:function(v){v!==!this.outputConnection&&(this.unplug(!0,!0),v?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(v){this.removeInput("AT"),this.removeInput("ORDINAL",!0),v?(this.appendValueInput("AT").setCheck("Number"),a.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(a.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"),a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}};bn.lists_getIndex=Hn;var Ht={init:function(){var v=[[a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_SET,"SET"],[a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_IN_LIST),v=a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:v}),this.appendDummyInput().appendField(v,"MODE").appendField("","SPACE"),v=a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS}),v.setValidator(function(L){const Y=this.getValue();L=L==="FROM_START"||L==="FROM_END",L!==(Y==="FROM_START"||Y==="FROM_END")&&this.getSourceBlock().updateAt_(L)}),this.appendDummyInput().appendField(v,"WHERE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0),this.setTooltip(()=>{const L=this.getFieldValue("MODE"),Y=this.getFieldValue("WHERE");let F="";switch(L+" "+Y){case"SET FROM_START":case"SET FROM_END":F=a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":F=a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":F=a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":F=a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":F=a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":F=a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":F=a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":F=a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return(Y==="FROM_START"||Y==="FROM_END")&&(F+="  "+a.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),F})},mutationToDom:function(){const v=a.createElement$$module$build$src$core$utils$xml("mutation"),L=this.getInput("AT")instanceof a.ValueInput$$module$build$src$core$inputs$value_input;return v.setAttribute("at",String(L)),v},domToMutation:function(v){v=v.getAttribute("at")!=="false",this.updateAt_(v)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(v){this.removeInput("AT"),this.removeInput("ORDINAL",!0),v?(this.appendValueInput("AT").setCheck("Number"),a.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(a.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"),this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO")}};bn.lists_setIndex=Ht;var sn={init:function(){this.WHERE_OPTIONS_1=[[a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_INPUT_IN_LIST);const v=L=>{const Y=a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+L]});return Y.setValidator(function(F){const Fe=this.getValue();F=F==="FROM_START"||F==="FROM_END",F!==(Fe==="FROM_START"||Fe==="FROM_END")&&this.getSourceBlock().updateAt_(L,F)}),Y};this.appendDummyInput("WHERE1_INPUT").appendField(v(1),"WHERE1"),this.appendDummyInput("AT1"),this.appendDummyInput("WHERE2_INPUT").appendField(v(2),"WHERE2"),this.appendDummyInput("AT2"),a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){const v=a.createElement$$module$build$src$core$utils$xml("mutation");var L=this.getInput("AT1")instanceof a.ValueInput$$module$build$src$core$inputs$value_input;return v.setAttribute("at1",String(L)),L=this.getInput("AT2")instanceof a.ValueInput$$module$build$src$core$inputs$value_input,v.setAttribute("at2",String(L)),v},domToMutation:function(v){const L=v.getAttribute("at1")==="true";v=v.getAttribute("at2")==="true",this.updateAt_(1,L),this.updateAt_(2,v)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(v,L){this.removeInput("AT"+v),this.removeInput("ORDINAL"+v,!0),L?(this.appendValueInput("AT"+v).setCheck("Number"),a.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+v).appendField(a.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+v),v===1&&(this.moveInputBefore("AT1","WHERE2_INPUT"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","WHERE2_INPUT")),a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}};bn.lists_getSublist=sn,bn.lists_sort={init:function(){this.jsonInit({message0:"%{BKY_LISTS_SORT_TITLE}",args0:[{type:"field_dropdown",name:"TYPE",options:[["%{BKY_LISTS_SORT_TYPE_NUMERIC}","NUMERIC"],["%{BKY_LISTS_SORT_TYPE_TEXT}","TEXT"],["%{BKY_LISTS_SORT_TYPE_IGNORECASE}","IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[["%{BKY_LISTS_SORT_ORDER_ASCENDING}","1"],["%{BKY_LISTS_SORT_ORDER_DESCENDING}","-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_SORT_TOOLTIP}",helpUrl:"%{BKY_LISTS_SORT_HELPURL}"})}},bn.lists_split={init:function(){const v=a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:[[a.Msg$$module$build$src$core$msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[a.Msg$$module$build$src$core$msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]]});if(!v)throw Error("field_dropdown not found");v.setValidator(L=>{this.updateType_(L)}),this.setHelpUrl(a.Msg$$module$build$src$core$msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(v,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(a.Msg$$module$build$src$core$msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip(()=>{const L=this.getFieldValue("MODE");if(L==="SPLIT")return a.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_SPLIT;if(L==="JOIN")return a.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+L)})},updateType_:function(v){if(this.getFieldValue("MODE")!==v){const L=this.getInput("INPUT").connection;L.setShadowDom(null);const Y=L.targetBlock();Y&&(L.disconnect(),Y.isShadow()?Y.dispose(!1):this.bumpNeighbours())}v==="SPLIT"?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){const v=a.createElement$$module$build$src$core$utils$xml("mutation");return v.setAttribute("mode",this.getFieldValue("MODE")),v},domToMutation:function(v){this.updateType_(v.getAttribute("mode"))},saveExtraState:function(){return{mode:this.getFieldValue("MODE")}},loadExtraState:function(v){this.updateType_(v.mode)}},a.defineBlocks$$module$build$src$core$common(bn);var Xn={blocks:bn},qt=Object.assign({},bn,Mn,Ze,_t,ht,Oe,O,_),Yn={blocks:qt,lists:Xn,logic:_n,loops:We,math:Et,procedures:ft,texts:at,variables:be,variablesDynamic:N};return Yn.__namespace__=a,Yn})})(blocks_compressed$1)),blocks_compressed$1.exports}var blockly=blockly$1.exports,hasRequiredBlockly;function requireBlockly(){return hasRequiredBlockly||(hasRequiredBlockly=1,(function(h,p){(function(l,a){h.exports=a(requireBlockly_compressed(),requireEn(),requireBlocks_compressed())})(blockly,function(l,a,_){return l.setLocale(a),l})})(blockly$1)),blockly$1.exports}var blocklyExports=requireBlockly();const Blockly=getDefaultExportFromCjs(blocklyExports),{Block,BlockFlyoutInflater,BlockNavigationPolicy,BlockSvg,Blocks,ButtonFlyoutInflater,COLLAPSED_FIELD_NAME,COLLAPSED_INPUT_NAME,COLLAPSE_CHARS,CodeGenerator,CollapsibleToolboxCategory,ComponentManager,Connection,ConnectionChecker,ConnectionDB,ConnectionNavigationPolicy,ConnectionType,ContextMenu,ContextMenuItems,ContextMenuRegistry,Css,DELETE_VARIABLE_ID,DeleteArea,DragTarget,DropDownDiv,Events,Extensions,Field,FieldCheckbox,FieldDropdown,FieldImage,FieldLabel,FieldLabelSerializable,FieldNavigationPolicy,FieldNumber,FieldTextInput,FieldVariable,Flyout,FlyoutButton,FlyoutButtonNavigationPolicy,FlyoutItem,FlyoutMetricsManager,FlyoutNavigationPolicy,FlyoutNavigator,FlyoutSeparator,FlyoutSeparatorNavigationPolicy,FocusManager,FocusableTreeTraverser,Generator,Gesture,Grid,HorizontalFlyout,INPUT_VALUE,Input,InsertionMarkerPreviewer,KeyboardNavigationController,LabelFlyoutInflater,LineCursor,Marker,MarkerManager,Menu,MenuItem,MetricsManager,Msg,NEXT_STATEMENT,Names,Navigator,OPPOSITE_TYPE,OUTPUT_VALUE,Options,PREVIOUS_STATEMENT,PROCEDURE_CATEGORY_NAME,Procedures,RENAME_VARIABLE_ID,RenderedConnection,Scrollbar,ScrollbarPair,SeparatorFlyoutInflater,ShortcutItems,ShortcutRegistry,TOOLBOX_AT_BOTTOM,TOOLBOX_AT_LEFT,TOOLBOX_AT_RIGHT,TOOLBOX_AT_TOP,Theme,ThemeManager,Themes,Toast,Toolbox,ToolboxCategory,ToolboxItem,ToolboxSeparator,Tooltip,Touch,Trashcan,UnattachedFieldError,VARIABLE_CATEGORY_NAME,VARIABLE_DYNAMIC_CATEGORY_NAME,VERSION,VariableMap,VariableModel,Variables,VariablesDynamic,VerticalFlyout,WidgetDiv,Workspace,WorkspaceAudio,WorkspaceDragger,WorkspaceNavigationPolicy,WorkspaceSvg,Xml,ZoomControls,blockAnimations,blockRendering,browserEvents,bubbles,bumpObjects,clipboard,comments,common,config,constants,defineBlocksWithJsonArray,dialog,dragging,fieldRegistry,geras,getFocusManager,getMainWorkspace,getSelected,hasBubble,hideChaff,icons,inject,inputs,isCopyable,isDeletable,isDraggable,isIcon,isObservable,isPaster,isRenderedElement,isSelectable,isSerializable,isVariableBackedParameterModel,keyboardNavigationController,layers,navigateBlock,navigateStacks,procedures,registry,renderManagement,serialization,setLocale,setParentContainer,svgResize,thrasos,uiPosition,utils,zelos}=Blockly;var javascript_compressed$1={exports:{}},javascript_compressed=javascript_compressed$1.exports,hasRequiredJavascript_compressed;function requireJavascript_compressed(){return hasRequiredJavascript_compressed||(hasRequiredJavascript_compressed=1,(function(h,p){(function(l,a){h.exports=a(requireBlockly_compressed())})(javascript_compressed,function(l){var a=l.__namespace__,_=function(T,M){return["[]",X.ATOMIC]},E=function(T,M){const G=Array(T.itemCount_);for(let ee=0;ee<T.itemCount_;ee++)G[ee]=M.valueToCode(T,"ADD"+ee,X.NONE)||"null";return["["+G.join(", ")+"]",X.ATOMIC]},C=function(T,M){const G=M.provideFunction_("listsRepeat",`
function ${M.FUNCTION_NAME_PLACEHOLDER_}(value, n) {
  var array = [];
  for (var i = 0; i < n; i++) {
    array[i] = value;
  }
  return array;
}
`),ee=M.valueToCode(T,"ITEM",X.NONE)||"null";return T=M.valueToCode(T,"NUM",X.NONE)||"0",[G+"("+ee+", "+T+")",X.FUNCTION_CALL]},A=function(T,M){return[(M.valueToCode(T,"VALUE",X.MEMBER)||"[]")+".length",X.MEMBER]},N=function(T,M){return["!"+(M.valueToCode(T,"VALUE",X.MEMBER)||"[]")+".length",X.LOGICAL_NOT]},O=function(T,M){const G=T.getFieldValue("END")==="FIRST"?"indexOf":"lastIndexOf",ee=M.valueToCode(T,"FIND",X.NONE)||"''";return M=(M.valueToCode(T,"VALUE",X.MEMBER)||"[]")+"."+G+"("+ee+")",T.workspace.options.oneBasedIndex?[M+" + 1",X.ADDITION]:[M,X.FUNCTION_CALL]},H=function(T,M){const G=T.getFieldValue("MODE")||"GET",ee=T.getFieldValue("WHERE")||"FROM_START";var Te=M.valueToCode(T,"VALUE",ee==="RANDOM"?X.NONE:X.MEMBER)||"[]";switch(ee){case"FIRST":if(G==="GET")return[Te+"[0]",X.MEMBER];if(G==="GET_REMOVE")return[Te+".shift()",X.MEMBER];if(G==="REMOVE")return Te+`.shift();
`;break;case"LAST":if(G==="GET")return[Te+".slice(-1)[0]",X.MEMBER];if(G==="GET_REMOVE")return[Te+".pop()",X.MEMBER];if(G==="REMOVE")return Te+`.pop();
`;break;case"FROM_START":if(T=M.getAdjusted(T,"AT"),G==="GET")return[Te+"["+T+"]",X.MEMBER];if(G==="GET_REMOVE")return[Te+".splice("+T+", 1)[0]",X.FUNCTION_CALL];if(G==="REMOVE")return Te+".splice("+T+`, 1);
`;break;case"FROM_END":if(T=M.getAdjusted(T,"AT",1,!0),G==="GET")return[Te+".slice("+T+")[0]",X.FUNCTION_CALL];if(G==="GET_REMOVE")return[Te+".splice("+T+", 1)[0]",X.FUNCTION_CALL];if(G==="REMOVE")return Te+".splice("+T+", 1);";break;case"RANDOM":if(Te=M.provideFunction_("listsGetRandomItem",`
function ${M.FUNCTION_NAME_PLACEHOLDER_}(list, remove) {
  var x = Math.floor(Math.random() * list.length);
  if (remove) {
    return list.splice(x, 1)[0];
  } else {
    return list[x];
  }
}
`)+"("+Te+", "+(G!=="GET")+")",G==="GET"||G==="GET_REMOVE")return[Te,X.FUNCTION_CALL];if(G==="REMOVE")return Te+`;
`}throw Error("Unhandled combination (lists_getIndex).")},D=function(T,M){function G(){if(ee.match(/^\w+$/))return"";const Qt=M.nameDB_.getDistinctName("tmpList",a.NameType$$module$build$src$core$names.VARIABLE),En="var "+Qt+" = "+ee+`;
`;return ee=Qt,En}let ee=M.valueToCode(T,"LIST",X.MEMBER)||"[]";const Te=T.getFieldValue("MODE")||"GET";var qe=T.getFieldValue("WHERE")||"FROM_START";const dt=M.valueToCode(T,"TO",X.ASSIGNMENT)||"null";switch(qe){case"FIRST":if(Te==="SET")return ee+"[0] = "+dt+`;
`;if(Te==="INSERT")return ee+".unshift("+dt+`);
`;break;case"LAST":if(Te==="SET")return G()+(ee+"["+ee+".length - 1] = "+dt+`;
`);if(Te==="INSERT")return ee+".push("+dt+`);
`;break;case"FROM_START":if(T=M.getAdjusted(T,"AT"),Te==="SET")return ee+"["+T+"] = "+dt+`;
`;if(Te==="INSERT")return ee+".splice("+T+", 0, "+dt+`);
`;break;case"FROM_END":if(T=M.getAdjusted(T,"AT",1,!1,X.SUBTRACTION),qe=G(),Te==="SET")return qe+(ee+"["+ee+".length - "+T+"] = "+dt+`;
`);if(Te==="INSERT")return qe+(ee+".splice("+ee+".length - "+T+", 0, "+dt+`);
`);break;case"RANDOM":if(T=G(),qe=M.nameDB_.getDistinctName("tmpX",a.NameType$$module$build$src$core$names.VARIABLE),T+="var "+qe+" = Math.floor(Math.random() * "+ee+`.length);
`,Te==="SET")return T+(ee+"["+qe+"] = "+dt+`;
`);if(Te==="INSERT")return T+(ee+".splice("+qe+", 0, "+dt+`);
`)}throw Error("Unhandled combination (lists_setIndex).")},j=function(T,M){var G={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"},ee=M.valueToCode(T,"LIST",X.MEMBER)||"[]";const Te=T.getFieldValue("WHERE1"),qe=T.getFieldValue("WHERE2");if(Te==="FIRST"&&qe==="LAST")ee+=".slice(0)";else if(ee.match(/^\w+$/)||Te!=="FROM_END"&&qe==="FROM_START"){switch(Te){case"FROM_START":G=M.getAdjusted(T,"AT1");break;case"FROM_END":G=M.getAdjusted(T,"AT1",1,!1,X.SUBTRACTION),G=ee+".length - "+G;break;case"FIRST":G="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(qe){case"FROM_START":M=M.getAdjusted(T,"AT2",1);break;case"FROM_END":M=M.getAdjusted(T,"AT2",0,!1,X.SUBTRACTION),M=ee+".length - "+M;break;case"LAST":M=ee+".length";break;default:throw Error("Unhandled option (lists_getSublist).")}ee=ee+".slice("+G+", "+M+")"}else{const dt=M.getAdjusted(T,"AT1");T=M.getAdjusted(T,"AT2"),ee=M.provideFunction_("subsequence"+G[Te]+G[qe],`
function ${M.FUNCTION_NAME_PLACEHOLDER_}(sequence${Te==="FROM_END"||Te==="FROM_START"?", at1":""}${qe==="FROM_END"||qe==="FROM_START"?", at2":""}) {
  var start = ${Hn("sequence",Te,"at1")};
  var end = ${Hn("sequence",qe,"at2")} + 1;
  return sequence.slice(start, end);
}
`)+"("+ee+(Te==="FROM_END"||Te==="FROM_START"?", "+dt:"")+(qe==="FROM_END"||qe==="FROM_START"?", "+T:"")+")"}return[ee,X.FUNCTION_CALL]},be=function(T,M){const G=M.valueToCode(T,"LIST",X.FUNCTION_CALL)||"[]",ee=T.getFieldValue("DIRECTION")==="1"?1:-1;return T=T.getFieldValue("TYPE"),M=M.provideFunction_("listsGetSortCompare",`
function ${M.FUNCTION_NAME_PLACEHOLDER_}(type, direction) {
  var compareFuncs = {
    'NUMERIC': function(a, b) {
        return Number(a) - Number(b); },
    'TEXT': function(a, b) {
        return String(a) > String(b) ? 1 : -1; },
    'IGNORE_CASE': function(a, b) {
        return String(a).toLowerCase() > String(b).toLowerCase() ? 1 : -1; },
  };
  var compare = compareFuncs[type];
  return function(a, b) { return compare(a, b) * direction; };
}
      `),[G+".slice().sort("+M+'("'+T+'", '+ee+"))",X.FUNCTION_CALL]},Oe=function(T,M){let G=M.valueToCode(T,"INPUT",X.MEMBER);if(M=M.valueToCode(T,"DELIM",X.NONE)||"''",T=T.getFieldValue("MODE"),T==="SPLIT")G||(G="''"),T="split";else if(T==="JOIN")G||(G="[]"),T="join";else throw Error("Unknown mode: "+T);return[G+"."+T+"("+M+")",X.FUNCTION_CALL]},ve=function(T,M){return[(M.valueToCode(T,"LIST",X.FUNCTION_CALL)||"[]")+".slice().reverse()",X.FUNCTION_CALL]},Xe=function(T,M){var G=0;let ee="";M.STATEMENT_PREFIX&&(ee+=M.injectId(M.STATEMENT_PREFIX,T));do{const Te=M.valueToCode(T,"IF"+G,X.NONE)||"false";let qe=M.statementToCode(T,"DO"+G);M.STATEMENT_SUFFIX&&(qe=M.prefixLines(M.injectId(M.STATEMENT_SUFFIX,T),M.INDENT)+qe),ee+=(G>0?" else ":"")+"if ("+Te+`) {
`+qe+"}",G++}while(T.getInput("IF"+G));return(T.getInput("ELSE")||M.STATEMENT_SUFFIX)&&(G=T.getInput("ELSE")?M.statementToCode(T,"ELSE"):"",M.STATEMENT_SUFFIX&&(G=M.prefixLines(M.injectId(M.STATEMENT_SUFFIX,T),M.INDENT)+G),ee+=` else {
`+G+"}"),ee+`
`},Ke=function(T,M){const G={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[T.getFieldValue("OP")],ee=G==="=="||G==="!="?X.EQUALITY:X.RELATIONAL,Te=M.valueToCode(T,"A",ee)||"0";return T=M.valueToCode(T,"B",ee)||"0",[Te+" "+G+" "+T,ee]},_e=function(T,M){const G=T.getFieldValue("OP")==="AND"?"&&":"||",ee=G==="&&"?X.LOGICAL_AND:X.LOGICAL_OR;let Te=M.valueToCode(T,"A",ee);return T=M.valueToCode(T,"B",ee),Te||T?(M=G==="&&"?"true":"false",Te||(Te=M),T||(T=M)):T=Te="false",[Te+" "+G+" "+T,ee]},Le=function(T,M){const G=X.LOGICAL_NOT;return["!"+(M.valueToCode(T,"BOOL",G)||"true"),G]},Ae=function(T,M){return[T.getFieldValue("BOOL")==="TRUE"?"true":"false",X.ATOMIC]},rt=function(T,M){return["null",X.ATOMIC]},De=function(T,M){const G=M.valueToCode(T,"IF",X.CONDITIONAL)||"false",ee=M.valueToCode(T,"THEN",X.CONDITIONAL)||"null";return T=M.valueToCode(T,"ELSE",X.CONDITIONAL)||"null",[G+" ? "+ee+" : "+T,X.CONDITIONAL]},xe=function(T,M){let G;G=T.getField("TIMES")?String(Number(T.getFieldValue("TIMES"))):M.valueToCode(T,"TIMES",X.ASSIGNMENT)||"0";let ee=M.statementToCode(T,"DO");ee=M.addLoopTrap(ee,T),T="";const Te=M.nameDB_.getDistinctName("count",a.NameType$$module$build$src$core$names.VARIABLE);let qe=G;return G.match(/^\w+$/)||a.isNumber$$module$build$src$core$utils$string(G)||(qe=M.nameDB_.getDistinctName("repeat_end",a.NameType$$module$build$src$core$names.VARIABLE),T+="var "+qe+" = "+G+`;
`),T+("for (var "+Te+" = 0; "+Te+" < "+qe+"; "+Te+`++) {
`+ee+`}
`)},at=function(T,M){const G=T.getFieldValue("MODE")==="UNTIL";let ee=M.valueToCode(T,"BOOL",G?X.LOGICAL_NOT:X.NONE)||"false",Te=M.statementToCode(T,"DO");return Te=M.addLoopTrap(Te,T),G&&(ee="!"+ee),"while ("+ee+`) {
`+Te+`}
`},ht=function(T,M){var G=M.getVariableName(T.getFieldValue("VAR")),ee=M.valueToCode(T,"FROM",X.ASSIGNMENT)||"0",Te=M.valueToCode(T,"TO",X.ASSIGNMENT)||"0";const qe=M.valueToCode(T,"BY",X.ASSIGNMENT)||"1";let dt=M.statementToCode(T,"DO");if(dt=M.addLoopTrap(dt,T),a.isNumber$$module$build$src$core$utils$string(ee)&&a.isNumber$$module$build$src$core$utils$string(Te)&&a.isNumber$$module$build$src$core$utils$string(qe))M=Number(ee)<=Number(Te),T="for ("+G+" = "+ee+"; "+G+(M?" <= ":" >= ")+Te+"; "+G,G=Math.abs(Number(qe)),T=G===1?T+(M?"++":"--"):T+((M?" += ":" -= ")+G),T+=`) {
`+dt+`}
`;else{T="";let Qt=ee;ee.match(/^\w+$/)||a.isNumber$$module$build$src$core$utils$string(ee)||(Qt=M.nameDB_.getDistinctName(G+"_start",a.NameType$$module$build$src$core$names.VARIABLE),T+="var "+Qt+" = "+ee+`;
`),ee=Te,Te.match(/^\w+$/)||a.isNumber$$module$build$src$core$utils$string(Te)||(ee=M.nameDB_.getDistinctName(G+"_end",a.NameType$$module$build$src$core$names.VARIABLE),T+="var "+ee+" = "+Te+`;
`),Te=M.nameDB_.getDistinctName(G+"_inc",a.NameType$$module$build$src$core$names.VARIABLE),T+="var "+Te+" = ",T=a.isNumber$$module$build$src$core$utils$string(qe)?T+(Math.abs(Number(qe))+`;
`):T+("Math.abs("+qe+`);
`),T+="if ("+Qt+" > "+ee+`) {
`,T+=M.INDENT+Te+" = -"+Te+`;
`,T=T+`}
for (`+(G+" = "+Qt+"; "+Te+" >= 0 ? "+G+" <= "+ee+" : "+G+" >= "+ee+"; "+G+" += "+Te+`) {
`+dt+`}
`)}return T},ot=function(T,M){const G=M.getVariableName(T.getFieldValue("VAR"));var ee=M.valueToCode(T,"LIST",X.ASSIGNMENT)||"[]";let Te=M.statementToCode(T,"DO");Te=M.addLoopTrap(Te,T),T="";let qe=ee;return ee.match(/^\w+$/)||(qe=M.nameDB_.getDistinctName(G+"_list",a.NameType$$module$build$src$core$names.VARIABLE),T+="var "+qe+" = "+ee+`;
`),ee=M.nameDB_.getDistinctName(G+"_index",a.NameType$$module$build$src$core$names.VARIABLE),Te=M.INDENT+G+" = "+qe+"["+ee+`];
`+Te,T+("for (var "+ee+" in "+qe+`) {
`+Te+`}
`)},Je=function(T,M){let G="";if(M.STATEMENT_PREFIX&&(G+=M.injectId(M.STATEMENT_PREFIX,T)),M.STATEMENT_SUFFIX&&(G+=M.injectId(M.STATEMENT_SUFFIX,T)),M.STATEMENT_PREFIX){const ee=T.getSurroundLoop();ee&&!ee.suppressPrefixSuffix&&(G+=M.injectId(M.STATEMENT_PREFIX,ee))}switch(T.getFieldValue("FLOW")){case"BREAK":return G+`break;
`;case"CONTINUE":return G+`continue;
`}throw Error("Unknown flow statement.")},Rt=function(T,M){return T=Number(T.getFieldValue("NUM")),[String(T),T>=0?X.ATOMIC:X.UNARY_NEGATION]},Bt=function(T,M){var G={ADD:[" + ",X.ADDITION],MINUS:[" - ",X.SUBTRACTION],MULTIPLY:[" * ",X.MULTIPLICATION],DIVIDE:[" / ",X.DIVISION],POWER:[null,X.NONE]}[T.getFieldValue("OP")];const ee=G[0];G=G[1];const Te=M.valueToCode(T,"A",G)||"0";return T=M.valueToCode(T,"B",G)||"0",ee?[Te+ee+T,G]:["Math.pow("+Te+", "+T+")",X.FUNCTION_CALL]},Yt=function(T,M){const G=T.getFieldValue("OP");let ee;if(G==="NEG")return T=M.valueToCode(T,"NUM",X.UNARY_NEGATION)||"0",T[0]==="-"&&(T=" "+T),["-"+T,X.UNARY_NEGATION];switch(T=G==="SIN"||G==="COS"||G==="TAN"?M.valueToCode(T,"NUM",X.DIVISION)||"0":M.valueToCode(T,"NUM",X.NONE)||"0",G){case"ABS":ee="Math.abs("+T+")";break;case"ROOT":ee="Math.sqrt("+T+")";break;case"LN":ee="Math.log("+T+")";break;case"EXP":ee="Math.exp("+T+")";break;case"POW10":ee="Math.pow(10,"+T+")";break;case"ROUND":ee="Math.round("+T+")";break;case"ROUNDUP":ee="Math.ceil("+T+")";break;case"ROUNDDOWN":ee="Math.floor("+T+")";break;case"SIN":ee="Math.sin("+T+" / 180 * Math.PI)";break;case"COS":ee="Math.cos("+T+" / 180 * Math.PI)";break;case"TAN":ee="Math.tan("+T+" / 180 * Math.PI)"}if(ee)return[ee,X.FUNCTION_CALL];switch(G){case"LOG10":ee="Math.log("+T+") / Math.log(10)";break;case"ASIN":ee="Math.asin("+T+") / Math.PI * 180";break;case"ACOS":ee="Math.acos("+T+") / Math.PI * 180";break;case"ATAN":ee="Math.atan("+T+") / Math.PI * 180";break;default:throw Error("Unknown math operator: "+G)}return[ee,X.DIVISION]},kt=function(T,M){return{PI:["Math.PI",X.MEMBER],E:["Math.E",X.MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",X.DIVISION],SQRT2:["Math.SQRT2",X.MEMBER],SQRT1_2:["Math.SQRT1_2",X.MEMBER],INFINITY:["Infinity",X.ATOMIC]}[T.getFieldValue("CONSTANT")]},de=function(T,M){var G={EVEN:[" % 2 === 0",X.MODULUS,X.EQUALITY],ODD:[" % 2 === 1",X.MODULUS,X.EQUALITY],WHOLE:[" % 1 === 0",X.MODULUS,X.EQUALITY],POSITIVE:[" > 0",X.RELATIONAL,X.RELATIONAL],NEGATIVE:[" < 0",X.RELATIONAL,X.RELATIONAL],DIVISIBLE_BY:[null,X.MODULUS,X.EQUALITY],PRIME:[null,X.NONE,X.FUNCTION_CALL]};const ee=T.getFieldValue("PROPERTY"),[Te,qe,dt]=G[ee];return G=M.valueToCode(T,"NUMBER_TO_CHECK",qe)||"0",ee==="PRIME"?T=M.provideFunction_("mathIsPrime",`
function ${M.FUNCTION_NAME_PLACEHOLDER_}(n) {
  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods
  if (n == 2 || n == 3) {
    return true;
  }
  // False if n is NaN, negative, is 1, or not whole.
  // And false if n is divisible by 2 or 3.
  if (isNaN(n) || n <= 1 || n % 1 !== 0 || n % 2 === 0 || n % 3 === 0) {
    return false;
  }
  // Check all the numbers of form 6k +/- 1, up to sqrt(n).
  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {
    if (n % (x - 1) === 0 || n % (x + 1) === 0) {
      return false;
    }
  }
  return true;
}
`)+"("+G+")":ee==="DIVISIBLE_BY"?(T=M.valueToCode(T,"DIVISOR",X.MODULUS)||"0",T=G+" % "+T+" === 0"):T=G+Te,[T,dt]},Ve=function(T,M){const G=M.valueToCode(T,"DELTA",X.ADDITION)||"0";return T=M.getVariableName(T.getFieldValue("VAR")),T+" = (typeof "+T+" === 'number' ? "+T+" : 0) + "+G+`;
`},ft=function(T,M){var G=T.getFieldValue("OP");switch(G){case"SUM":T=M.valueToCode(T,"LIST",X.MEMBER)||"[]",T+=".reduce(function(x, y) {return x + y;}, 0)";break;case"MIN":T=M.valueToCode(T,"LIST",X.NONE)||"[]",T="Math.min.apply(null, "+T+")";break;case"MAX":T=M.valueToCode(T,"LIST",X.NONE)||"[]",T="Math.max.apply(null, "+T+")";break;case"AVERAGE":G=M.provideFunction_("mathMean",`
function ${M.FUNCTION_NAME_PLACEHOLDER_}(myList) {
  return myList.reduce(function(x, y) {return x + y;}, 0) / myList.length;
}
`),T=M.valueToCode(T,"LIST",X.NONE)||"[]",T=G+"("+T+")";break;case"MEDIAN":G=M.provideFunction_("mathMedian",`
function ${M.FUNCTION_NAME_PLACEHOLDER_}(myList) {
  var localList = myList.filter(function (x) {return typeof x === 'number';});
  if (!localList.length) return null;
  localList.sort(function(a, b) {return b - a;});
  if (localList.length % 2 === 0) {
    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;
  } else {
    return localList[(localList.length - 1) / 2];
  }
}
`),T=M.valueToCode(T,"LIST",X.NONE)||"[]",T=G+"("+T+")";break;case"MODE":G=M.provideFunction_("mathModes",`
function ${M.FUNCTION_NAME_PLACEHOLDER_}(values) {
  var modes = [];
  var counts = [];
  var maxCount = 0;
  for (var i = 0; i < values.length; i++) {
    var value = values[i];
    var found = false;
    var thisCount;
    for (var j = 0; j < counts.length; j++) {
      if (counts[j][0] === value) {
        thisCount = ++counts[j][1];
        found = true;
        break;
      }
    }
    if (!found) {
      counts.push([value, 1]);
      thisCount = 1;
    }
    maxCount = Math.max(thisCount, maxCount);
  }
  for (var j = 0; j < counts.length; j++) {
    if (counts[j][1] === maxCount) {
      modes.push(counts[j][0]);
    }
  }
  return modes;
}
`),T=M.valueToCode(T,"LIST",X.NONE)||"[]",T=G+"("+T+")";break;case"STD_DEV":G=M.provideFunction_("mathStandardDeviation",`
function ${M.FUNCTION_NAME_PLACEHOLDER_}(numbers) {
  var n = numbers.length;
  if (!n) return null;
  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;
  var variance = 0;
  for (var j = 0; j < n; j++) {
    variance += Math.pow(numbers[j] - mean, 2);
  }
  variance /= n;
  return Math.sqrt(variance);
}
`),T=M.valueToCode(T,"LIST",X.NONE)||"[]",T=G+"("+T+")";break;case"RANDOM":G=M.provideFunction_("mathRandomList",`
function ${M.FUNCTION_NAME_PLACEHOLDER_}(list) {
  var x = Math.floor(Math.random() * list.length);
  return list[x];
}
`),T=M.valueToCode(T,"LIST",X.NONE)||"[]",T=G+"("+T+")";break;default:throw Error("Unknown operator: "+G)}return[T,X.FUNCTION_CALL]},_t=function(T,M){const G=M.valueToCode(T,"DIVIDEND",X.MODULUS)||"0";return T=M.valueToCode(T,"DIVISOR",X.MODULUS)||"0",[G+" % "+T,X.MODULUS]},Be=function(T,M){const G=M.valueToCode(T,"VALUE",X.NONE)||"0",ee=M.valueToCode(T,"LOW",X.NONE)||"0";return T=M.valueToCode(T,"HIGH",X.NONE)||"Infinity",["Math.min(Math.max("+G+", "+ee+"), "+T+")",X.FUNCTION_CALL]},J=function(T,M){const G=M.valueToCode(T,"FROM",X.NONE)||"0";return T=M.valueToCode(T,"TO",X.NONE)||"0",[M.provideFunction_("mathRandomInt",`
function ${M.FUNCTION_NAME_PLACEHOLDER_}(a, b) {
  if (a > b) {
    // Swap a and b to ensure a is smaller.
    var c = a;
    a = b;
    b = c;
  }
  return Math.floor(Math.random() * (b - a + 1) + a);
}
`)+"("+G+", "+T+")",X.FUNCTION_CALL]},Ce=function(T,M){return["Math.random()",X.FUNCTION_CALL]},He=function(T,M){const G=M.valueToCode(T,"X",X.NONE)||"0";return["Math.atan2("+(M.valueToCode(T,"Y",X.NONE)||"0")+", "+G+") / Math.PI * 180",X.DIVISION]},it=function(T,M){const G=M.getProcedureName(T.getFieldValue("NAME"));var ee="";M.STATEMENT_PREFIX&&(ee+=M.injectId(M.STATEMENT_PREFIX,T)),M.STATEMENT_SUFFIX&&(ee+=M.injectId(M.STATEMENT_SUFFIX,T)),ee&&(ee=M.prefixLines(ee,M.INDENT));let Te="";M.INFINITE_LOOP_TRAP&&(Te=M.prefixLines(M.injectId(M.INFINITE_LOOP_TRAP,T),M.INDENT));let qe="";T.getInput("STACK")&&(qe=M.statementToCode(T,"STACK"));let dt="";T.getInput("RETURN")&&(dt=M.valueToCode(T,"RETURN",X.NONE)||"");let Qt="";qe&&dt&&(Qt=ee),dt&&(dt=M.INDENT+"return "+dt+`;
`);const En=[],hi=T.getVars();for(let St=0;St<hi.length;St++)En[St]=M.getVariableName(hi[St]);return ee="function "+G+"("+En.join(", ")+`) {
`+ee+Te+qe+Qt+dt+"}",ee=M.scrub_(T,ee),M.definitions_["%"+G]=ee,null},Et=function(T,M){const G=M.getProcedureName(T.getFieldValue("NAME")),ee=[],Te=T.getVars();for(let qe=0;qe<Te.length;qe++)ee[qe]=M.valueToCode(T,"ARG"+qe,X.NONE)||"null";return[G+"("+ee.join(", ")+")",X.FUNCTION_CALL]},Ze=function(T,M){return M.forBlock.procedures_callreturn(T,M)[0]+`;
`},Pt=function(T,M){let G="if ("+(M.valueToCode(T,"CONDITION",X.NONE)||"false")+`) {
`;return M.STATEMENT_SUFFIX&&(G+=M.prefixLines(M.injectId(M.STATEMENT_SUFFIX,T),M.INDENT)),T.hasReturnValue_?(T=M.valueToCode(T,"VALUE",X.NONE)||"null",G+=M.INDENT+"return "+T+`;
`):G+=M.INDENT+`return;
`,G+`}
`},An=function(T,M){return[M.quote_(T.getFieldValue("TEXT")),X.ATOMIC]},tt=function(T,M){switch(T.itemCount_){case 0:return["''",X.ATOMIC];case 1:return T=M.valueToCode(T,"ADD0",X.NONE)||"''",L(T);case 2:var G=M.valueToCode(T,"ADD0",X.NONE)||"''";return T=M.valueToCode(T,"ADD1",X.NONE)||"''",[L(G)[0]+" + "+L(T)[0],X.ADDITION];default:G=Array(T.itemCount_);for(let ee=0;ee<T.itemCount_;ee++)G[ee]=M.valueToCode(T,"ADD"+ee,X.NONE)||"''";return["["+G.join(",")+"].join('')",X.FUNCTION_CALL]}},Qe=function(T,M){const G=M.getVariableName(T.getFieldValue("VAR"));return T=M.valueToCode(T,"TEXT",X.NONE)||"''",G+" += "+L(T)[0]+`;
`},Ni=function(T,M){return[(M.valueToCode(T,"VALUE",X.MEMBER)||"''")+".length",X.MEMBER]},ae=function(T,M){return["!"+(M.valueToCode(T,"VALUE",X.MEMBER)||"''")+".length",X.LOGICAL_NOT]},We=function(T,M){const G=T.getFieldValue("END")==="FIRST"?"indexOf":"lastIndexOf",ee=M.valueToCode(T,"FIND",X.NONE)||"''";return M=(M.valueToCode(T,"VALUE",X.MEMBER)||"''")+"."+G+"("+ee+")",T.workspace.options.oneBasedIndex?[M+" + 1",X.ADDITION]:[M,X.FUNCTION_CALL]},Mn=function(T,M){const G=T.getFieldValue("WHERE")||"FROM_START",ee=M.valueToCode(T,"VALUE",G==="RANDOM"?X.NONE:X.MEMBER)||"''";switch(G){case"FIRST":return[ee+".charAt(0)",X.FUNCTION_CALL];case"LAST":return[ee+".slice(-1)",X.FUNCTION_CALL];case"FROM_START":return T=M.getAdjusted(T,"AT"),[ee+".charAt("+T+")",X.FUNCTION_CALL];case"FROM_END":return T=M.getAdjusted(T,"AT",1,!0),[ee+".slice("+T+").charAt(0)",X.FUNCTION_CALL];case"RANDOM":return[M.provideFunction_("textRandomLetter",`
function ${M.FUNCTION_NAME_PLACEHOLDER_}(text) {
  var x = Math.floor(Math.random() * text.length);
  return text[x];
}
`)+"("+ee+")",X.FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},vt=function(T,M){var G={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};const ee=T.getFieldValue("WHERE1"),Te=T.getFieldValue("WHERE2");var qe=ee!=="FROM_END"&&ee!=="LAST"&&Te!=="FROM_END"&&Te!=="LAST",dt=M.valueToCode(T,"STRING",qe?X.MEMBER:X.NONE)||"''";if(ee==="FIRST"&&Te==="LAST")return[dt,X.NONE];if(dt.match(/^'?\w+'?$/)||qe){switch(ee){case"FROM_START":G=M.getAdjusted(T,"AT1");break;case"FROM_END":G=M.getAdjusted(T,"AT1",1,!1,X.SUBTRACTION),G=dt+".length - "+G;break;case"FIRST":G="0";break;default:throw Error("Unhandled option (text_getSubstring).")}switch(Te){case"FROM_START":M=M.getAdjusted(T,"AT2",1);break;case"FROM_END":M=M.getAdjusted(T,"AT2",0,!1,X.SUBTRACTION),M=dt+".length - "+M;break;case"LAST":M=dt+".length";break;default:throw Error("Unhandled option (text_getSubstring).")}dt=dt+".slice("+G+", "+M+")"}else qe=M.getAdjusted(T,"AT1"),T=M.getAdjusted(T,"AT2"),dt=M.provideFunction_("subsequence"+G[ee]+G[Te],`
function ${M.FUNCTION_NAME_PLACEHOLDER_}(sequence${ee==="FROM_END"||ee==="FROM_START"?", at1":""}${Te==="FROM_END"||Te==="FROM_START"?", at2":""}) {
  var start = ${Y("sequence",ee,"at1")};
  var end = ${Y("sequence",Te,"at2")} + 1;
  return sequence.slice(start, end);
}
`)+"("+dt+(ee==="FROM_END"||ee==="FROM_START"?", "+qe:"")+(Te==="FROM_END"||Te==="FROM_START"?", "+T:"")+")";return[dt,X.FUNCTION_CALL]},Si=function(T,M){const G={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[T.getFieldValue("CASE")];return T=M.valueToCode(T,"TEXT",G?X.MEMBER:X.NONE)||"''",[G?T+G:M.provideFunction_("textToTitleCase",`
function ${M.FUNCTION_NAME_PLACEHOLDER_}(str) {
  return str.replace(/\\S+/g,
      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});
}
`)+"("+T+")",X.FUNCTION_CALL]},Wt=function(T,M){const G={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[T.getFieldValue("MODE")];return[(M.valueToCode(T,"TEXT",X.MEMBER)||"''")+G,X.FUNCTION_CALL]},Yi=function(T,M){return"window.alert("+(M.valueToCode(T,"TEXT",X.NONE)||"''")+`);
`},Ki=function(T,M){return M="window.prompt("+(T.getField("TEXT")?M.quote_(T.getFieldValue("TEXT")):M.valueToCode(T,"TEXT",X.NONE)||"''")+")",T.getFieldValue("TYPE")==="NUMBER"&&(M="Number("+M+")"),[M,X.FUNCTION_CALL]},Ln=function(T,M){const G=M.valueToCode(T,"TEXT",X.NONE)||"''";return T=M.valueToCode(T,"SUB",X.NONE)||"''",[M.provideFunction_("textCount",`
function ${M.FUNCTION_NAME_PLACEHOLDER_}(haystack, needle) {
  if (needle.length === 0) {
    return haystack.length + 1;
  } else {
    return haystack.split(needle).length - 1;
  }
}
`)+"("+G+", "+T+")",X.FUNCTION_CALL]},_n=function(T,M){const G=M.valueToCode(T,"TEXT",X.NONE)||"''",ee=M.valueToCode(T,"FROM",X.NONE)||"''";return T=M.valueToCode(T,"TO",X.NONE)||"''",[M.provideFunction_("textReplace",`
function ${M.FUNCTION_NAME_PLACEHOLDER_}(haystack, needle, replacement) {
  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g, '\\\\$1')
                 .replace(/\\x08/g, '\\\\x08');
  return haystack.replace(new RegExp(needle, 'g'), replacement);
}
`)+"("+G+", "+ee+", "+T+")",X.FUNCTION_CALL]},bn=function(T,M){return[(M.valueToCode(T,"TEXT",X.MEMBER)||"''")+".split('').reverse().join('')",X.FUNCTION_CALL]},so=function(T,M){return[M.getVariableName(T.getFieldValue("VAR")),X.ATOMIC]},In=function(T,M){const G=M.valueToCode(T,"VALUE",X.ASSIGNMENT)||"0";return M.getVariableName(T.getFieldValue("VAR"))+" = "+G+`;
`},X;(function(T){T[T.ATOMIC=0]="ATOMIC",T[T.NEW=1.1]="NEW",T[T.MEMBER=1.2]="MEMBER",T[T.FUNCTION_CALL=2]="FUNCTION_CALL",T[T.INCREMENT=3]="INCREMENT",T[T.DECREMENT=3]="DECREMENT",T[T.BITWISE_NOT=4.1]="BITWISE_NOT",T[T.UNARY_PLUS=4.2]="UNARY_PLUS",T[T.UNARY_NEGATION=4.3]="UNARY_NEGATION",T[T.LOGICAL_NOT=4.4]="LOGICAL_NOT",T[T.TYPEOF=4.5]="TYPEOF",T[T.VOID=4.6]="VOID",T[T.DELETE=4.7]="DELETE",T[T.AWAIT=4.8]="AWAIT",T[T.EXPONENTIATION=5]="EXPONENTIATION",T[T.MULTIPLICATION=5.1]="MULTIPLICATION",T[T.DIVISION=5.2]="DIVISION",T[T.MODULUS=5.3]="MODULUS",T[T.SUBTRACTION=6.1]="SUBTRACTION",T[T.ADDITION=6.2]="ADDITION",T[T.BITWISE_SHIFT=7]="BITWISE_SHIFT",T[T.RELATIONAL=8]="RELATIONAL",T[T.IN=8]="IN",T[T.INSTANCEOF=8]="INSTANCEOF",T[T.EQUALITY=9]="EQUALITY",T[T.BITWISE_AND=10]="BITWISE_AND",T[T.BITWISE_XOR=11]="BITWISE_XOR",T[T.BITWISE_OR=12]="BITWISE_OR",T[T.LOGICAL_AND=13]="LOGICAL_AND",T[T.LOGICAL_OR=14]="LOGICAL_OR",T[T.CONDITIONAL=15]="CONDITIONAL",T[T.ASSIGNMENT=16]="ASSIGNMENT",T[T.YIELD=17]="YIELD",T[T.COMMA=18]="COMMA",T[T.NONE=99]="NONE"})(X||(X={}));var Zn=class extends a.CodeGenerator$$module$build$src$core$generator{constructor(T="JavaScript"){super(T),this.ORDER_OVERRIDES=[[X.FUNCTION_CALL,X.MEMBER],[X.FUNCTION_CALL,X.FUNCTION_CALL],[X.MEMBER,X.MEMBER],[X.MEMBER,X.FUNCTION_CALL],[X.LOGICAL_NOT,X.LOGICAL_NOT],[X.MULTIPLICATION,X.MULTIPLICATION],[X.ADDITION,X.ADDITION],[X.LOGICAL_AND,X.LOGICAL_AND],[X.LOGICAL_OR,X.LOGICAL_OR]],this.isInitialized=!1;for(const M in X)T=X[M],typeof T!="string"&&(this["ORDER_"+M]=T);this.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(globalThis).join(","))}init(T){super.init(T),this.nameDB_?this.nameDB_.reset():this.nameDB_=new a.Names$$module$build$src$core$names(this.RESERVED_WORDS_),this.nameDB_.setVariableMap(T.getVariableMap()),this.nameDB_.populateVariables(T),this.nameDB_.populateProcedures(T);const M=[];var G=a.allDeveloperVariables$$module$build$src$core$variables(T);for(let ee=0;ee<G.length;ee++)M.push(this.nameDB_.getName(G[ee],a.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE));for(T=a.allUsedVarModels$$module$build$src$core$variables(T),G=0;G<T.length;G++)M.push(this.nameDB_.getName(T[G].getId(),a.NameType$$module$build$src$core$names.VARIABLE));M.length&&(this.definitions_.variables="var "+M.join(", ")+";"),this.isInitialized=!0}finish(T){const M=Object.values(this.definitions_);return super.finish(T),this.isInitialized=!1,this.nameDB_.reset(),M.join(`

`)+`


`+T}scrubNakedValue(T){return T+`;
`}quote_(T){return T=T.replace(/\\/g,"\\\\").replace(/\n/g,`\\
`).replace(/'/g,"\\'"),"'"+T+"'"}multiline_quote_(T){return T.split(/\n/g).map(this.quote_).join(` + '\\n' +
`)}scrub_(T,M,G=!1){let ee="";if(!T.outputConnection||!T.outputConnection.targetConnection){var Te=T.getCommentText();Te&&(Te=a.wrap$$module$build$src$core$utils$string(Te,this.COMMENT_WRAP-3),ee+=this.prefixLines(Te+`
`,"// "));for(let qe=0;qe<T.inputList.length;qe++)T.inputList[qe].type===a.inputTypes$$module$build$src$core$inputs$input_types.VALUE&&(Te=T.inputList[qe].connection.targetBlock())&&(Te=this.allNestedComments(Te))&&(ee+=this.prefixLines(Te,"// "))}return T=T.nextConnection&&T.nextConnection.targetBlock(),G=G?"":this.blockToCode(T),ee+M+G}getAdjusted(T,M,G=0,ee=!1,Te=X.NONE){T.workspace.options.oneBasedIndex&&G--;const qe=T.workspace.options.oneBasedIndex?"1":"0";let dt=Te;return G>0?dt=X.ADDITION:G<0?dt=X.SUBTRACTION:ee&&(dt=X.UNARY_NEGATION),T=this.valueToCode(T,M,dt)||qe,G===0&&!ee?T:a.isNumber$$module$build$src$core$utils$string(T)?(T=String(Number(T)+G),ee&&(T=String(-Number(T))),T):(G>0?T=`${T} + ${G}`:G<0&&(T=`${T} - ${-G}`),ee&&(T=G?`-(${T})`:`-${T}`),Math.floor(Te)>=Math.floor(dt)&&(T=`(${T})`),T)}},Hn=function(T,M,G){return M==="FIRST"?"0":M==="FROM_END"?T+".length - 1 - "+G:M==="LAST"?T+".length - 1":G},Ht={};Ht.lists_create_empty=_,Ht.lists_create_with=E,Ht.lists_getIndex=H,Ht.lists_getSublist=j,Ht.lists_indexOf=O,Ht.lists_isEmpty=N,Ht.lists_length=A,Ht.lists_repeat=C,Ht.lists_reverse=ve,Ht.lists_setIndex=D,Ht.lists_sort=be,Ht.lists_split=Oe;var sn={};sn.controls_if=Xe,sn.controls_ifelse=Xe,sn.logic_boolean=Ae,sn.logic_compare=Ke,sn.logic_negate=Le,sn.logic_null=rt,sn.logic_operation=_e,sn.logic_ternary=De;var Xn={};Xn.controls_flow_statements=Je,Xn.controls_for=ht,Xn.controls_forEach=ot,Xn.controls_repeat=xe,Xn.controls_repeat_ext=xe,Xn.controls_whileUntil=at;var qt={};qt.math_arithmetic=Bt,qt.math_atan2=He,qt.math_change=Ve,qt.math_constant=kt,qt.math_constrain=Be,qt.math_modulo=_t,qt.math_number=Rt,qt.math_number_property=de,qt.math_on_list=ft,qt.math_random_float=Ce,qt.math_random_int=J,qt.math_round=Yt,qt.math_single=Yt,qt.math_trig=Yt;var Yn={};Yn.procedures_callnoreturn=Ze,Yn.procedures_callreturn=Et,Yn.procedures_defnoreturn=it,Yn.procedures_defreturn=it,Yn.procedures_ifreturn=Pt;var v=/^\s*'([^']|\\')*'\s*$/,L=function(T){return v.test(T)?[T,X.ATOMIC]:["String("+T+")",X.FUNCTION_CALL]},Y=function(T,M,G){return M==="FIRST"?"0":M==="FROM_END"?T+".length - 1 - "+G:M==="LAST"?T+".length - 1":G},F={};F.text=An,F.text_append=Qe,F.text_changeCase=Si,F.text_charAt=Mn,F.text_count=Ln,F.text_getSubstring=vt,F.text_indexOf=We,F.text_isEmpty=ae,F.text_join=tt,F.text_length=Ni,F.text_print=Yi,F.text_prompt=Ki,F.text_prompt_ext=Ki,F.text_replace=_n,F.text_reverse=bn,F.text_trim=Wt;var Fe={};Fe.variables_get=so,Fe.variables_set=In;var Ft={};Ft.variables_get_dynamic=so,Ft.variables_set_dynamic=In;var ki=new Zn,je=Object.assign({},Ht,sn,Xn,qt,Yn,F,Fe,Ft);for(const T in je)ki.forBlock[T]=je[T];var $i={};return $i.JavascriptGenerator=Zn,$i.Order=X,$i.javascriptGenerator=ki,$i.__namespace__=a,$i})})(javascript_compressed$1)),javascript_compressed$1.exports}var javascript_compressedExports=requireJavascript_compressed();const javascript=getDefaultExportFromCjs(javascript_compressedExports),{JavascriptGenerator,Order,javascriptGenerator}=javascript;function BlocklyPlayground({onCreateBlock}){const blocklyDivRef=reactExports.useRef(null),workspaceRef=reactExports.useRef(null),[output,setOutput]=reactExports.useState(""),[error,setError]=reactExports.useState(null);reactExports.useEffect(()=>{if(!blocklyDivRef.current)return;const h={kind:"categoryToolbox",contents:[{kind:"category",name:"すうじ",colour:"#5C81A6",contents:[{kind:"block",type:"math_number"}]},{kind:"category",name:"けいさん",colour:"#5CA65C",contents:[{kind:"block",type:"math_arithmetic"}]},{kind:"category",name:"へんすう",colour:"#A55C9C",contents:[{kind:"block",type:"variables_set"},{kind:"block",type:"variables_get"}]}]},p=inject(blocklyDivRef.current,{toolbox:h,grid:{spacing:20,length:3,colour:"#ccc",snap:!0},zoom:{controls:!0,wheel:!0,startScale:1,maxScale:3,minScale:.3,scaleSpeed:1.2},trashcan:!0});workspaceRef.current=p;const l=()=>{svgResize(p)};return setTimeout(l,100),window.addEventListener("resize",l),()=>{window.removeEventListener("resize",l),p.dispose()}},[]);const handleRun=()=>{if(workspaceRef.current)try{setError(null);const code=javascriptGenerator.workspaceToCode(workspaceRef.current);if(!code||code.trim()===""){setError("ブロックをくみたててね！");return}const result=eval(code);typeof result=="number"?(setOutput(result.toString()),onCreateBlock(result.toString())):setError("けいさんできませんでした")}catch(h){setError(`エラー: ${h instanceof Error?h.message:"けいさんできませんでした"}`)}},handleClear=()=>{workspaceRef.current&&(workspaceRef.current.clear(),setOutput(""),setError(null))};return jsxRuntimeExports.jsxs("div",{className:"blockly-playground",children:[jsxRuntimeExports.jsxs("div",{className:"blockly-header",children:[jsxRuntimeExports.jsx("h2",{children:"ブロックプログラミング"}),jsxRuntimeExports.jsx("p",{children:"ブロックをくみたてて、けいさんしてみよう！"})]}),jsxRuntimeExports.jsxs("div",{className:"blockly-content",children:[jsxRuntimeExports.jsx("div",{ref:blocklyDivRef,className:"blockly-workspace"}),jsxRuntimeExports.jsxs("div",{className:"blockly-controls",children:[jsxRuntimeExports.jsx("button",{className:"blockly-btn blockly-btn-run",onClick:handleRun,children:"▶ じっこう"}),jsxRuntimeExports.jsx("button",{className:"blockly-btn blockly-btn-clear",onClick:handleClear,children:"🗑️ クリア"})]}),output&&jsxRuntimeExports.jsxs("div",{className:"blockly-output",children:[jsxRuntimeExports.jsx("h3",{children:"けっか:"}),jsxRuntimeExports.jsx("div",{className:"output-value",children:output})]}),error&&jsxRuntimeExports.jsx("div",{className:"blockly-error",children:error})]}),jsxRuntimeExports.jsxs("div",{className:"blockly-guide",children:[jsxRuntimeExports.jsx("h3",{children:"つかいかた:"}),jsxRuntimeExports.jsxs("ol",{children:[jsxRuntimeExports.jsx("li",{children:"ひだりから「すうじ」ブロックをドラッグ"}),jsxRuntimeExports.jsx("li",{children:"「けいさん」ブロックをつかって、しきをくむ"}),jsxRuntimeExports.jsx("li",{children:"「じっこう」ボタンでけいさん！"}),jsxRuntimeExports.jsx("li",{children:"けっかがマグネットになってでてくるよ"})]})]})]})}var dexie_min$1={exports:{}},dexie_min=dexie_min$1.exports,hasRequiredDexie_min;function requireDexie_min(){return hasRequiredDexie_min||(hasRequiredDexie_min=1,(function(h,p){(function(l,a){h.exports=a()})(dexie_min,function(){var l=function(d,g){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,y){b.__proto__=y}||function(b,y){for(var R in y)Object.prototype.hasOwnProperty.call(y,R)&&(b[R]=y[R])})(d,g)},a=function(){return(a=Object.assign||function(d){for(var g,b=1,y=arguments.length;b<y;b++)for(var R in g=arguments[b])Object.prototype.hasOwnProperty.call(g,R)&&(d[R]=g[R]);return d}).apply(this,arguments)};function _(d,g,b){for(var y,R=0,w=g.length;R<w;R++)!y&&R in g||((y=y||Array.prototype.slice.call(g,0,R))[R]=g[R]);return d.concat(y||Array.prototype.slice.call(g))}var E=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:commonjsGlobal,C=Object.keys,A=Array.isArray;function N(d,g){return typeof g!="object"||C(g).forEach(function(b){d[b]=g[b]}),d}typeof Promise>"u"||E.Promise||(E.Promise=Promise);var O=Object.getPrototypeOf,H={}.hasOwnProperty;function D(d,g){return H.call(d,g)}function j(d,g){typeof g=="function"&&(g=g(O(d))),(typeof Reflect>"u"?C:Reflect.ownKeys)(g).forEach(function(b){Oe(d,b,g[b])})}var be=Object.defineProperty;function Oe(d,g,b,y){be(d,g,N(b&&D(b,"get")&&typeof b.get=="function"?{get:b.get,set:b.set,configurable:!0}:{value:b,configurable:!0,writable:!0},y))}function ve(d){return{from:function(g){return d.prototype=Object.create(g.prototype),Oe(d.prototype,"constructor",d),{extend:j.bind(null,d.prototype)}}}}var Xe=Object.getOwnPropertyDescriptor,Ke=[].slice;function _e(d,g,b){return Ke.call(d,g,b)}function Le(d,g){return g(d)}function Ae(d){if(!d)throw new Error("Assertion Failed")}function rt(d){E.setImmediate?setImmediate(d):setTimeout(d,0)}function De(d,g){if(typeof g=="string"&&D(d,g))return d[g];if(!g)return d;if(typeof g!="string"){for(var b=[],y=0,R=g.length;y<R;++y){var w=De(d,g[y]);b.push(w)}return b}var x=g.indexOf(".");if(x!==-1){var U=d[g.substr(0,x)];return U==null?void 0:De(U,g.substr(x+1))}}function xe(d,g,b){if(d&&g!==void 0&&!("isFrozen"in Object&&Object.isFrozen(d)))if(typeof g!="string"&&"length"in g){Ae(typeof b!="string"&&"length"in b);for(var y=0,R=g.length;y<R;++y)xe(d,g[y],b[y])}else{var w,x,U=g.indexOf(".");U!==-1?(w=g.substr(0,U),(x=g.substr(U+1))===""?b===void 0?A(d)&&!isNaN(parseInt(w))?d.splice(w,1):delete d[w]:d[w]=b:xe(U=!(U=d[w])||!D(d,w)?d[w]={}:U,x,b)):b===void 0?A(d)&&!isNaN(parseInt(g))?d.splice(g,1):delete d[g]:d[g]=b}}function at(d){var g,b={};for(g in d)D(d,g)&&(b[g]=d[g]);return b}var ht=[].concat;function ot(d){return ht.apply([],d)}var Zn="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(ot([8,16,32,64].map(function(d){return["Int","Uint","Float"].map(function(g){return g+d+"Array"})}))).filter(function(d){return E[d]}),Je=new Set(Zn.map(function(d){return E[d]})),Rt=null;function Bt(d){return Rt=new WeakMap,d=(function g(b){if(!b||typeof b!="object")return b;var y=Rt.get(b);if(y)return y;if(A(b)){y=[],Rt.set(b,y);for(var R=0,w=b.length;R<w;++R)y.push(g(b[R]))}else if(Je.has(b.constructor))y=b;else{var x,U=O(b);for(x in y=U===Object.prototype?{}:Object.create(U),Rt.set(b,y),b)D(b,x)&&(y[x]=g(b[x]))}return y})(d),Rt=null,d}var Yt={}.toString;function kt(d){return Yt.call(d).slice(8,-1)}var de=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Ve=typeof de=="symbol"?function(d){var g;return d!=null&&(g=d[de])&&g.apply(d)}:function(){return null};function ft(d,g){return g=d.indexOf(g),0<=g&&d.splice(g,1),0<=g}var _t={};function Be(d){var g,b,y,R;if(arguments.length===1){if(A(d))return d.slice();if(this===_t&&typeof d=="string")return[d];if(R=Ve(d)){for(b=[];!(y=R.next()).done;)b.push(y.value);return b}if(d==null)return[d];if(typeof(g=d.length)!="number")return[d];for(b=new Array(g);g--;)b[g]=d[g];return b}for(g=arguments.length,b=new Array(g);g--;)b[g]=arguments[g];return b}var J=typeof Symbol<"u"?function(d){return d[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},X=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],ho=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(X),Ce={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function He(d,g){this.name=d,this.message=g}function it(d,g){return d+". Errors: "+Object.keys(g).map(function(b){return g[b].toString()}).filter(function(b,y,R){return R.indexOf(b)===y}).join(`
`)}function Et(d,g,b,y){this.failures=g,this.failedKeys=y,this.successCount=b,this.message=it(d,g)}function Ze(d,g){this.name="BulkError",this.failures=Object.keys(g).map(function(b){return g[b]}),this.failuresByPos=g,this.message=it(d,this.failures)}ve(He).from(Error).extend({toString:function(){return this.name+": "+this.message}}),ve(Et).from(He),ve(Ze).from(He);var Pt=ho.reduce(function(d,g){return d[g]=g+"Error",d},{}),An=He,tt=ho.reduce(function(d,g){var b=g+"Error";function y(R,w){this.name=b,R?typeof R=="string"?(this.message="".concat(R).concat(w?`
 `+w:""),this.inner=w||null):typeof R=="object"&&(this.message="".concat(R.name," ").concat(R.message),this.inner=R):(this.message=Ce[g]||b,this.inner=null)}return ve(y).from(An),d[g]=y,d},{});tt.Syntax=SyntaxError,tt.Type=TypeError,tt.Range=RangeError;var Qe=X.reduce(function(d,g){return d[g+"Error"]=tt[g],d},{}),Ni=ho.reduce(function(d,g){return["Syntax","Type","Range"].indexOf(g)===-1&&(d[g+"Error"]=tt[g]),d},{});function ae(){}function We(d){return d}function Mn(d,g){return d==null||d===We?g:function(b){return g(d(b))}}function vt(d,g){return function(){d.apply(this,arguments),g.apply(this,arguments)}}function Si(d,g){return d===ae?g:function(){var b=d.apply(this,arguments);b!==void 0&&(arguments[0]=b);var y=this.onsuccess,R=this.onerror;this.onsuccess=null,this.onerror=null;var w=g.apply(this,arguments);return y&&(this.onsuccess=this.onsuccess?vt(y,this.onsuccess):y),R&&(this.onerror=this.onerror?vt(R,this.onerror):R),w!==void 0?w:b}}function Wt(d,g){return d===ae?g:function(){d.apply(this,arguments);var b=this.onsuccess,y=this.onerror;this.onsuccess=this.onerror=null,g.apply(this,arguments),b&&(this.onsuccess=this.onsuccess?vt(b,this.onsuccess):b),y&&(this.onerror=this.onerror?vt(y,this.onerror):y)}}function Yi(d,g){return d===ae?g:function(b){var y=d.apply(this,arguments);N(b,y);var R=this.onsuccess,w=this.onerror;return this.onsuccess=null,this.onerror=null,b=g.apply(this,arguments),R&&(this.onsuccess=this.onsuccess?vt(R,this.onsuccess):R),w&&(this.onerror=this.onerror?vt(w,this.onerror):w),y===void 0?b===void 0?void 0:b:N(y,b)}}function Ki(d,g){return d===ae?g:function(){return g.apply(this,arguments)!==!1&&d.apply(this,arguments)}}function Ln(d,g){return d===ae?g:function(){var b=d.apply(this,arguments);if(b&&typeof b.then=="function"){for(var y=this,R=arguments.length,w=new Array(R);R--;)w[R]=arguments[R];return b.then(function(){return g.apply(y,w)})}return g.apply(this,arguments)}}Ni.ModifyError=Et,Ni.DexieError=He,Ni.BulkError=Ze;var _n=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function bn(d){_n=d}var so={},In=100,Zn=typeof Promise>"u"?[]:(function(){var d=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[d,O(d),d];var g=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[g,O(g),d]})(),X=Zn[0],ho=Zn[1],Zn=Zn[2],ho=ho&&ho.then,Hn=X&&X.constructor,Ht=!!Zn,sn=function(d,g){Fe.push([d,g]),qt&&(queueMicrotask(qe),qt=!1)},Xn=!0,qt=!0,Yn=[],v=[],L=We,Y={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:ae,pgp:!1,env:{},finalize:ae},F=Y,Fe=[],Ft=0,ki=[];function je(d){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var g=this._PSD=F;if(typeof d!="function"){if(d!==so)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&M(this,this._value))}this._state=null,this._value=null,++g.ref,(function b(y,R){try{R(function(w){if(y._state===null){if(w===y)throw new TypeError("A promise cannot be resolved with itself.");var x=y._lib&&dt();w&&typeof w.then=="function"?b(y,function(U,W){w instanceof je?w._then(U,W):w.then(U,W)}):(y._state=!0,y._value=w,G(y)),x&&Qt()}},M.bind(null,y))}catch(w){M(y,w)}})(this,d)}var $i={get:function(){var d=F,g=mo;function b(y,R){var w=this,x=!d.global&&(d!==F||g!==mo),U=x&&!qi(),W=new je(function(q,ie){ee(w,new T(zr(y,d,x,U),zr(R,d,x,U),q,ie,d))});return this._consoleTask&&(W._consoleTask=this._consoleTask),W}return b.prototype=so,b},set:function(d){Oe(this,"then",d&&d.prototype===so?$i:{get:function(){return d},set:$i.set})}};function T(d,g,b,y,R){this.onFulfilled=typeof d=="function"?d:null,this.onRejected=typeof g=="function"?g:null,this.resolve=b,this.reject=y,this.psd=R}function M(d,g){var b,y;v.push(g),d._state===null&&(b=d._lib&&dt(),g=L(g),d._state=!1,d._value=g,y=d,Yn.some(function(R){return R._value===y._value})||Yn.push(y),G(d),b&&Qt())}function G(d){var g=d._listeners;d._listeners=[];for(var b=0,y=g.length;b<y;++b)ee(d,g[b]);var R=d._PSD;--R.ref||R.finalize(),Ft===0&&(++Ft,sn(function(){--Ft==0&&En()},[]))}function ee(d,g){if(d._state!==null){var b=d._state?g.onFulfilled:g.onRejected;if(b===null)return(d._state?g.resolve:g.reject)(d._value);++g.psd.ref,++Ft,sn(Te,[b,d,g])}else d._listeners.push(g)}function Te(d,g,b){try{var y,R=g._value;!g._state&&v.length&&(v=[]),y=_n&&g._consoleTask?g._consoleTask.run(function(){return d(R)}):d(R),g._state||v.indexOf(R)!==-1||(function(w){for(var x=Yn.length;x;)if(Yn[--x]._value===w._value)return Yn.splice(x,1)})(g),b.resolve(y)}catch(w){b.reject(w)}finally{--Ft==0&&En(),--b.psd.ref||b.psd.finalize()}}function qe(){wo(Y,function(){dt()&&Qt()})}function dt(){var d=Xn;return qt=Xn=!1,d}function Qt(){var d,g,b;do for(;0<Fe.length;)for(d=Fe,Fe=[],b=d.length,g=0;g<b;++g){var y=d[g];y[0].apply(null,y[1])}while(0<Fe.length);qt=Xn=!0}function En(){var d=Yn;Yn=[],d.forEach(function(y){y._PSD.onunhandled.call(null,y._value,y)});for(var g=ki.slice(0),b=g.length;b;)g[--b]()}function hi(d){return new je(so,!1,d)}function St(d,g){var b=F;return function(){var y=dt(),R=F;try{return Ns(b,!0),d.apply(this,arguments)}catch(w){g&&g(w)}finally{Ns(R,!1),y&&Qt()}}}j(je.prototype,{then:$i,_then:function(d,g){ee(this,new T(null,null,d,g,F))},catch:function(d){if(arguments.length===1)return this.then(null,d);var g=d,b=arguments[1];return typeof g=="function"?this.then(null,function(y){return(y instanceof g?b:hi)(y)}):this.then(null,function(y){return(y&&y.name===g?b:hi)(y)})},finally:function(d){return this.then(function(g){return je.resolve(d()).then(function(){return g})},function(g){return je.resolve(d()).then(function(){return hi(g)})})},timeout:function(d,g){var b=this;return d<1/0?new je(function(y,R){var w=setTimeout(function(){return R(new tt.Timeout(g))},d);b.then(y,R).finally(clearTimeout.bind(null,w))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&Oe(je.prototype,Symbol.toStringTag,"Dexie.Promise"),Y.env=Qs(),j(je,{all:function(){var d=Be.apply(null,arguments).map(fs);return new je(function(g,b){d.length===0&&g([]);var y=d.length;d.forEach(function(R,w){return je.resolve(R).then(function(x){d[w]=x,--y||g(d)},b)})})},resolve:function(d){return d instanceof je?d:d&&typeof d.then=="function"?new je(function(g,b){d.then(g,b)}):new je(so,!0,d)},reject:hi,race:function(){var d=Be.apply(null,arguments).map(fs);return new je(function(g,b){d.map(function(y){return je.resolve(y).then(g,b)})})},PSD:{get:function(){return F},set:function(d){return F=d}},totalEchoes:{get:function(){return mo}},newPSD:Tn,usePSD:wo,scheduler:{get:function(){return sn},set:function(d){sn=d}},rejectionMapper:{get:function(){return L},set:function(d){L=d}},follow:function(d,g){return new je(function(b,y){return Tn(function(R,w){var x=F;x.unhandleds=[],x.onunhandled=w,x.finalize=vt(function(){var U,W=this;U=function(){W.unhandleds.length===0?R():w(W.unhandleds[0])},ki.push(function q(){U(),ki.splice(ki.indexOf(q),1)}),++Ft,sn(function(){--Ft==0&&En()},[])},x.finalize),d()},g,b,y)})}}),Hn&&(Hn.allSettled&&Oe(je,"allSettled",function(){var d=Be.apply(null,arguments).map(fs);return new je(function(g){d.length===0&&g([]);var b=d.length,y=new Array(b);d.forEach(function(R,w){return je.resolve(R).then(function(x){return y[w]={status:"fulfilled",value:x}},function(x){return y[w]={status:"rejected",reason:x}}).then(function(){return--b||g(y)})})})}),Hn.any&&typeof AggregateError<"u"&&Oe(je,"any",function(){var d=Be.apply(null,arguments).map(fs);return new je(function(g,b){d.length===0&&b(new AggregateError([]));var y=d.length,R=new Array(y);d.forEach(function(w,x){return je.resolve(w).then(function(U){return g(U)},function(U){R[x]=U,--y||b(new AggregateError(R))})})})}),Hn.withResolvers&&(je.withResolvers=Hn.withResolvers));var jt={awaits:0,echoes:0,id:0},qo=0,ro=[],Mi=0,mo=0,Li=0;function Tn(d,g,b,y){var R=F,w=Object.create(R);return w.parent=R,w.ref=0,w.global=!1,w.id=++Li,Y.env,w.env=Ht?{Promise:je,PromiseProp:{value:je,configurable:!0,writable:!0},all:je.all,race:je.race,allSettled:je.allSettled,any:je.any,resolve:je.resolve,reject:je.reject}:{},g&&N(w,g),++R.ref,w.finalize=function(){--this.parent.ref||this.parent.finalize()},y=wo(w,d,b,y),w.ref===0&&w.finalize(),y}function Qn(){return jt.id||(jt.id=++qo),++jt.awaits,jt.echoes+=In,jt.id}function qi(){return!!jt.awaits&&(--jt.awaits==0&&(jt.id=0),jt.echoes=jt.awaits*In,!0)}function fs(d){return jt.echoes&&d&&d.constructor===Hn?(Qn(),d.then(function(g){return qi(),g},function(g){return qi(),rn(g)})):d}function vl(){var d=ro[ro.length-1];ro.pop(),Ns(d,!1)}function Ns(d,g){var b,y=F;(g?!jt.echoes||Mi++&&d===F:!Mi||--Mi&&d===F)||queueMicrotask(g?(function(R){++mo,jt.echoes&&--jt.echoes!=0||(jt.echoes=jt.awaits=jt.id=0),ro.push(F),Ns(R,!0)}).bind(null,d):vl),d!==F&&(F=d,y===Y&&(Y.env=Qs()),Ht&&(b=Y.env.Promise,g=d.env,(y.global||d.global)&&(Object.defineProperty(E,"Promise",g.PromiseProp),b.all=g.all,b.race=g.race,b.resolve=g.resolve,b.reject=g.reject,g.allSettled&&(b.allSettled=g.allSettled),g.any&&(b.any=g.any))))}function Qs(){var d=E.Promise;return Ht?{Promise:d,PromiseProp:Object.getOwnPropertyDescriptor(E,"Promise"),all:d.all,race:d.race,allSettled:d.allSettled,any:d.any,resolve:d.resolve,reject:d.reject}:{}}function wo(d,g,b,y,R){var w=F;try{return Ns(d,!0),g(b,y,R)}finally{Ns(w,!1)}}function zr(d,g,b,y){return typeof d!="function"?d:function(){var R=F;b&&Qn(),Ns(g,!0);try{return d.apply(this,arguments)}finally{Ns(R,!1),y&&queueMicrotask(qi)}}}function ks(d){Promise===Hn&&jt.echoes===0?Mi===0?d():enqueueNativeMicroTask(d):setTimeout(d,0)}(""+ho).indexOf("[native code]")===-1&&(Qn=qi=ae);var rn=je.reject,lo="￿",Ji="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Kn="String expected.",er=[],tr="__dbnames",Jo="readonly",ps="readwrite";function gs(d,g){return d?g?function(){return d.apply(this,arguments)&&g.apply(this,arguments)}:d:g}var yl={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function nr(d){return typeof d!="string"||/\./.test(d)?function(g){return g}:function(g){return g[d]===void 0&&d in g&&delete(g=Bt(g))[d],g}}function Sl(){throw tt.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Ut(d,g){try{var b=$s(d),y=$s(g);if(b!==y)return b==="Array"?1:y==="Array"?-1:b==="binary"?1:y==="binary"?-1:b==="string"?1:y==="string"?-1:b==="Date"?1:y!=="Date"?NaN:-1;switch(b){case"number":case"Date":case"string":return g<d?1:d<g?-1:0;case"binary":return(function(R,w){for(var x=R.length,U=w.length,W=x<U?x:U,q=0;q<W;++q)if(R[q]!==w[q])return R[q]<w[q]?-1:1;return x===U?0:x<U?-1:1})(uo(d),uo(g));case"Array":return(function(R,w){for(var x=R.length,U=w.length,W=x<U?x:U,q=0;q<W;++q){var ie=Ut(R[q],w[q]);if(ie!==0)return ie}return x===U?0:x<U?-1:1})(d,g)}}catch{}return NaN}function $s(d){var g=typeof d;return g!="object"?g:ArrayBuffer.isView(d)?"binary":(d=kt(d),d==="ArrayBuffer"?"binary":d)}function uo(d){return d instanceof Uint8Array?d:ArrayBuffer.isView(d)?new Uint8Array(d.buffer,d.byteOffset,d.byteLength):new Uint8Array(d)}function mi(d,g,b){var y=d.schema.yProps;return y?(g&&0<b.numFailures&&(g=g.filter(function(R,w){return!b.failures[w]})),Promise.all(y.map(function(R){return R=R.updatesTable,g?d.db.table(R).where("k").anyOf(g).delete():d.db.table(R).clear()})).then(function(){return b})):b}var Wr=(Ic.prototype.execute=function(d){var g=this["@@propmod"];if(g.add!==void 0){var b=g.add;if(A(b))return _(_([],A(d)?d:[],!0),b).sort();if(typeof b=="number")return(Number(d)||0)+b;if(typeof b=="bigint")try{return BigInt(d)+b}catch{return BigInt(0)+b}throw new TypeError("Invalid term ".concat(b))}if(g.remove!==void 0){var y=g.remove;if(A(y))return A(d)?d.filter(function(R){return!y.includes(R)}).sort():[];if(typeof y=="number")return Number(d)-y;if(typeof y=="bigint")try{return BigInt(d)-y}catch{return BigInt(0)-y}throw new TypeError("Invalid subtrahend ".concat(y))}return b=(b=g.replacePrefix)===null||b===void 0?void 0:b[0],b&&typeof d=="string"&&d.startsWith(b)?g.replacePrefix[1]+d.substring(b.length):d},Ic);function Ic(d){this["@@propmod"]=d}function _u(d,g){for(var b=C(g),y=b.length,R=!1,w=0;w<y;++w){var x=b[w],U=g[x],W=De(d,x);U instanceof Wr?(xe(d,x,U.execute(W)),R=!0):W!==U&&(xe(d,x,U),R=!0)}return R}var No=(It.prototype._trans=function(d,g,b){var y=this._tx||F.trans,R=this.name,w=_n&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(d==="readonly"?"read":"write"," ").concat(this.name));function x(q,ie,z){if(!z.schema[R])throw new tt.NotFound("Table "+R+" not part of transaction");return g(z.idbtrans,z)}var U=dt();try{var W=y&&y.db._novip===this.db._novip?y===F.trans?y._promise(d,x,b):Tn(function(){return y._promise(d,x,b)},{trans:y,transless:F.transless||F}):(function q(ie,z,se,Z){if(ie.idbdb&&(ie._state.openComplete||F.letThrough||ie._vip)){var te=ie._createTransaction(z,se,ie._dbSchema);try{te.create(),ie._state.PR1398_maxLoop=3}catch(ne){return ne.name===Pt.InvalidState&&ie.isOpen()&&0<--ie._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),ie.close({disableAutoOpen:!1}),ie.open().then(function(){return q(ie,z,se,Z)})):rn(ne)}return te._promise(z,function(ne,oe){return Tn(function(){return F.trans=te,Z(ne,oe,te)})}).then(function(ne){if(z==="readwrite")try{te.idbtrans.commit()}catch{}return z==="readonly"?ne:te._completion.then(function(){return ne})})}if(ie._state.openComplete)return rn(new tt.DatabaseClosed(ie._state.dbOpenError));if(!ie._state.isBeingOpened){if(!ie._state.autoOpen)return rn(new tt.DatabaseClosed);ie.open().catch(ae)}return ie._state.dbReadyPromise.then(function(){return q(ie,z,se,Z)})})(this.db,d,[this.name],x);return w&&(W._consoleTask=w,W=W.catch(function(q){return console.trace(q),rn(q)})),W}finally{U&&Qt()}},It.prototype.get=function(d,g){var b=this;return d&&d.constructor===Object?this.where(d).first(g):d==null?rn(new tt.Type("Invalid argument to Table.get()")):this._trans("readonly",function(y){return b.core.get({trans:y,key:d}).then(function(R){return b.hook.reading.fire(R)})}).then(g)},It.prototype.where=function(d){if(typeof d=="string")return new this.db.WhereClause(this,d);if(A(d))return new this.db.WhereClause(this,"[".concat(d.join("+"),"]"));var g=C(d);if(g.length===1)return this.where(g[0]).equals(d[g[0]]);var b=this.schema.indexes.concat(this.schema.primKey).filter(function(U){if(U.compound&&g.every(function(q){return 0<=U.keyPath.indexOf(q)})){for(var W=0;W<g.length;++W)if(g.indexOf(U.keyPath[W])===-1)return!1;return!0}return!1}).sort(function(U,W){return U.keyPath.length-W.keyPath.length})[0];if(b&&this.db._maxKey!==lo){var w=b.keyPath.slice(0,g.length);return this.where(w).equals(w.map(function(W){return d[W]}))}!b&&_n&&console.warn("The query ".concat(JSON.stringify(d)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(g.join("+"),"]"));var y=this.schema.idxByName;function R(U,W){return Ut(U,W)===0}var x=g.reduce(function(z,W){var q=z[0],ie=z[1],z=y[W],se=d[W];return[q||z,q||!z?gs(ie,z&&z.multi?function(Z){return Z=De(Z,W),A(Z)&&Z.some(function(te){return R(se,te)})}:function(Z){return R(se,De(Z,W))}):ie]},[null,null]),w=x[0],x=x[1];return w?this.where(w.name).equals(d[w.keyPath]).filter(x):b?this.filter(x):this.where(g).equals("")},It.prototype.filter=function(d){return this.toCollection().and(d)},It.prototype.count=function(d){return this.toCollection().count(d)},It.prototype.offset=function(d){return this.toCollection().offset(d)},It.prototype.limit=function(d){return this.toCollection().limit(d)},It.prototype.each=function(d){return this.toCollection().each(d)},It.prototype.toArray=function(d){return this.toCollection().toArray(d)},It.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},It.prototype.orderBy=function(d){return new this.db.Collection(new this.db.WhereClause(this,A(d)?"[".concat(d.join("+"),"]"):d))},It.prototype.reverse=function(){return this.toCollection().reverse()},It.prototype.mapToClass=function(d){var g,b=this.db,y=this.name;function R(){return g!==null&&g.apply(this,arguments)||this}(this.schema.mappedClass=d).prototype instanceof Sl&&((function(W,q){if(typeof q!="function"&&q!==null)throw new TypeError("Class extends value "+String(q)+" is not a constructor or null");function ie(){this.constructor=W}l(W,q),W.prototype=q===null?Object.create(q):(ie.prototype=q.prototype,new ie)})(R,g=d),Object.defineProperty(R.prototype,"db",{get:function(){return b},enumerable:!1,configurable:!0}),R.prototype.table=function(){return y},d=R);for(var w=new Set,x=d.prototype;x;x=O(x))Object.getOwnPropertyNames(x).forEach(function(W){return w.add(W)});function U(W){if(!W)return W;var q,ie=Object.create(d.prototype);for(q in W)if(!w.has(q))try{ie[q]=W[q]}catch{}return ie}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=U,this.hook("reading",U),d},It.prototype.defineClass=function(){return this.mapToClass(function(d){N(this,d)})},It.prototype.add=function(d,g){var b=this,y=this.schema.primKey,R=y.auto,w=y.keyPath,x=d;return w&&R&&(x=nr(w)(d)),this._trans("readwrite",function(U){return b.core.mutate({trans:U,type:"add",keys:g!=null?[g]:null,values:[x]})}).then(function(U){return U.numFailures?je.reject(U.failures[0]):U.lastResult}).then(function(U){if(w)try{xe(d,w,U)}catch{}return U})},It.prototype.upsert=function(d,g){var b=this,y=this.schema.primKey.keyPath;return this._trans("readwrite",function(R){return b.core.get({trans:R,key:d}).then(function(w){var x=w??{};return _u(x,g),y&&xe(x,y,d),b.core.mutate({trans:R,type:"put",values:[x],keys:[d],upsert:!0,updates:{keys:[d],changeSpecs:[g]}}).then(function(U){return U.numFailures?je.reject(U.failures[0]):!!w})})})},It.prototype.update=function(d,g){return typeof d!="object"||A(d)?this.where(":id").equals(d).modify(g):(d=De(d,this.schema.primKey.keyPath),d===void 0?rn(new tt.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(d).modify(g))},It.prototype.put=function(d,g){var b=this,y=this.schema.primKey,R=y.auto,w=y.keyPath,x=d;return w&&R&&(x=nr(w)(d)),this._trans("readwrite",function(U){return b.core.mutate({trans:U,type:"put",values:[x],keys:g!=null?[g]:null})}).then(function(U){return U.numFailures?je.reject(U.failures[0]):U.lastResult}).then(function(U){if(w)try{xe(d,w,U)}catch{}return U})},It.prototype.delete=function(d){var g=this;return this._trans("readwrite",function(b){return g.core.mutate({trans:b,type:"delete",keys:[d]}).then(function(y){return mi(g,[d],y)}).then(function(y){return y.numFailures?je.reject(y.failures[0]):void 0})})},It.prototype.clear=function(){var d=this;return this._trans("readwrite",function(g){return d.core.mutate({trans:g,type:"deleteRange",range:yl}).then(function(b){return mi(d,null,b)})}).then(function(g){return g.numFailures?je.reject(g.failures[0]):void 0})},It.prototype.bulkGet=function(d){var g=this;return this._trans("readonly",function(b){return g.core.getMany({keys:d,trans:b}).then(function(y){return y.map(function(R){return g.hook.reading.fire(R)})})})},It.prototype.bulkAdd=function(d,g,b){var y=this,R=Array.isArray(g)?g:void 0,w=(b=b||(R?void 0:g))?b.allKeys:void 0;return this._trans("readwrite",function(x){var q=y.schema.primKey,U=q.auto,q=q.keyPath;if(q&&R)throw new tt.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(R&&R.length!==d.length)throw new tt.InvalidArgument("Arguments objects and keys must have the same length");var W=d.length,q=q&&U?d.map(nr(q)):d;return y.core.mutate({trans:x,type:"add",keys:R,values:q,wantResults:w}).then(function(te){var z=te.numFailures,se=te.results,Z=te.lastResult,te=te.failures;if(z===0)return w?se:Z;throw new Ze("".concat(y.name,".bulkAdd(): ").concat(z," of ").concat(W," operations failed"),te)})})},It.prototype.bulkPut=function(d,g,b){var y=this,R=Array.isArray(g)?g:void 0,w=(b=b||(R?void 0:g))?b.allKeys:void 0;return this._trans("readwrite",function(x){var q=y.schema.primKey,U=q.auto,q=q.keyPath;if(q&&R)throw new tt.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(R&&R.length!==d.length)throw new tt.InvalidArgument("Arguments objects and keys must have the same length");var W=d.length,q=q&&U?d.map(nr(q)):d;return y.core.mutate({trans:x,type:"put",keys:R,values:q,wantResults:w}).then(function(te){var z=te.numFailures,se=te.results,Z=te.lastResult,te=te.failures;if(z===0)return w?se:Z;throw new Ze("".concat(y.name,".bulkPut(): ").concat(z," of ").concat(W," operations failed"),te)})})},It.prototype.bulkUpdate=function(d){var g=this,b=this.core,y=d.map(function(x){return x.key}),R=d.map(function(x){return x.changes}),w=[];return this._trans("readwrite",function(x){return b.getMany({trans:x,keys:y,cache:"clone"}).then(function(U){var W=[],q=[];d.forEach(function(z,se){var Z=z.key,te=z.changes,ne=U[se];if(ne){for(var oe=0,ue=Object.keys(te);oe<ue.length;oe++){var $e=ue[oe],ye=te[$e];if($e===g.schema.primKey.keyPath){if(Ut(ye,Z)!==0)throw new tt.Constraint("Cannot update primary key in bulkUpdate()")}else xe(ne,$e,ye)}w.push(se),W.push(Z),q.push(ne)}});var ie=W.length;return b.mutate({trans:x,type:"put",keys:W,values:q,updates:{keys:y,changeSpecs:R}}).then(function(z){var se=z.numFailures,Z=z.failures;if(se===0)return ie;for(var te=0,ne=Object.keys(Z);te<ne.length;te++){var oe,ue=ne[te],$e=w[Number(ue)];$e!=null&&(oe=Z[ue],delete Z[ue],Z[$e]=oe)}throw new Ze("".concat(g.name,".bulkUpdate(): ").concat(se," of ").concat(ie," operations failed"),Z)})})})},It.prototype.bulkDelete=function(d){var g=this,b=d.length;return this._trans("readwrite",function(y){return g.core.mutate({trans:y,type:"delete",keys:d}).then(function(R){return mi(g,d,R)})}).then(function(x){var R=x.numFailures,w=x.lastResult,x=x.failures;if(R===0)return w;throw new Ze("".concat(g.name,".bulkDelete(): ").concat(R," of ").concat(b," operations failed"),x)})},It);function It(){}function Ms(d){function g(x,U){if(U){for(var W=arguments.length,q=new Array(W-1);--W;)q[W-1]=arguments[W];return b[x].subscribe.apply(null,q),d}if(typeof x=="string")return b[x]}var b={};g.addEventType=w;for(var y=1,R=arguments.length;y<R;++y)w(arguments[y]);return g;function w(x,U,W){if(typeof x!="object"){var q;U=U||Ki;var ie={subscribers:[],fire:W=W||ae,subscribe:function(z){ie.subscribers.indexOf(z)===-1&&(ie.subscribers.push(z),ie.fire=U(ie.fire,z))},unsubscribe:function(z){ie.subscribers=ie.subscribers.filter(function(se){return se!==z}),ie.fire=ie.subscribers.reduce(U,W)}};return b[x]=g[x]=ie}C(q=x).forEach(function(z){var se=q[z];if(A(se))w(z,q[z][0],q[z][1]);else{if(se!=="asap")throw new tt.InvalidArgument("Invalid event config");var Z=w(z,We,function(){for(var te=arguments.length,ne=new Array(te);te--;)ne[te]=arguments[te];Z.subscribers.forEach(function(oe){rt(function(){oe.apply(null,ne)})})})}})}}function _i(d,g){return ve(g).from({prototype:d}),g}function Ci(d,g){return!(d.filter||d.algorithm||d.or)&&(g?d.justLimit:!d.replayFilter)}function Zo(d,g){d.filter=gs(d.filter,g)}function Cl(d,g,b){var y=d.replayFilter;d.replayFilter=y?function(){return gs(y(),g())}:g,d.justLimit=b&&!y}function Qo(d,g){if(d.isPrimKey)return g.primaryKey;var b=g.getIndexByKeyPath(d.index);if(!b)throw new tt.Schema("KeyPath "+d.index+" on object store "+g.name+" is not indexed");return b}function Rl(d,g,b){var y=Qo(d,g.schema);return g.openCursor({trans:b,values:!d.keysOnly,reverse:d.dir==="prev",unique:!!d.unique,query:{index:y,range:d.range}})}function jr(d,g,b,y){var R=d.replayFilter?gs(d.filter,d.replayFilter()):d.filter;if(d.or){var w={},x=function(U,W,q){var ie,z;R&&!R(W,q,function(se){return W.stop(se)},function(se){return W.fail(se)})||((z=""+(ie=W.primaryKey))=="[object ArrayBuffer]"&&(z=""+new Uint8Array(ie)),D(w,z)||(w[z]=!0,g(U,W,q)))};return Promise.all([d.or._iterate(x,b),ir(Rl(d,y,b),d.algorithm,x,!d.keysOnly&&d.valueMapper)])}return ir(Rl(d,y,b),gs(d.algorithm,R),g,!d.keysOnly&&d.valueMapper)}function ir(d,g,b,y){var R=St(y?function(w,x,U){return b(y(w),x,U)}:b);return d.then(function(w){if(w)return w.start(function(){var x=function(){return w.continue()};g&&!g(w,function(U){return x=U},function(U){w.stop(U),x=ae},function(U){w.fail(U),x=ae})||R(w.value,w,function(U){return x=U}),x()})})}var Oc=(zt.prototype._read=function(d,g){var b=this._ctx;return b.error?b.table._trans(null,rn.bind(null,b.error)):b.table._trans("readonly",d).then(g)},zt.prototype._write=function(d){var g=this._ctx;return g.error?g.table._trans(null,rn.bind(null,g.error)):g.table._trans("readwrite",d,"locked")},zt.prototype._addAlgorithm=function(d){var g=this._ctx;g.algorithm=gs(g.algorithm,d)},zt.prototype._iterate=function(d,g){return jr(this._ctx,d,g,this._ctx.table.core)},zt.prototype.clone=function(d){var g=Object.create(this.constructor.prototype),b=Object.create(this._ctx);return d&&N(b,d),g._ctx=b,g},zt.prototype.raw=function(){return this._ctx.valueMapper=null,this},zt.prototype.each=function(d){var g=this._ctx;return this._read(function(b){return jr(g,d,b,g.table.core)})},zt.prototype.count=function(d){var g=this;return this._read(function(b){var y=g._ctx,R=y.table.core;if(Ci(y,!0))return R.count({trans:b,query:{index:Qo(y,R.schema),range:y.range}}).then(function(x){return Math.min(x,y.limit)});var w=0;return jr(y,function(){return++w,!1},b,R).then(function(){return w})}).then(d)},zt.prototype.sortBy=function(d,g){var b=d.split(".").reverse(),y=b[0],R=b.length-1;function w(W,q){return q?w(W[b[q]],q-1):W[y]}var x=this._ctx.dir==="next"?1:-1;function U(W,q){return Ut(w(W,R),w(q,R))*x}return this.toArray(function(W){return W.sort(U)}).then(g)},zt.prototype.toArray=function(d){var g=this;return this._read(function(b){var y=g._ctx;if(y.dir==="next"&&Ci(y,!0)&&0<y.limit){var R=y.valueMapper,w=Qo(y,y.table.core.schema);return y.table.core.query({trans:b,limit:y.limit,values:!0,query:{index:w,range:y.range}}).then(function(U){return U=U.result,R?U.map(R):U})}var x=[];return jr(y,function(U){return x.push(U)},b,y.table.core).then(function(){return x})},d)},zt.prototype.offset=function(d){var g=this._ctx;return d<=0||(g.offset+=d,Ci(g)?Cl(g,function(){var b=d;return function(y,R){return b===0||(b===1?--b:R(function(){y.advance(b),b=0}),!1)}}):Cl(g,function(){var b=d;return function(){return--b<0}})),this},zt.prototype.limit=function(d){return this._ctx.limit=Math.min(this._ctx.limit,d),Cl(this._ctx,function(){var g=d;return function(b,y,R){return--g<=0&&y(R),0<=g}},!0),this},zt.prototype.until=function(d,g){return Zo(this._ctx,function(b,y,R){return!d(b.value)||(y(R),g)}),this},zt.prototype.first=function(d){return this.limit(1).toArray(function(g){return g[0]}).then(d)},zt.prototype.last=function(d){return this.reverse().first(d)},zt.prototype.filter=function(d){var g;return Zo(this._ctx,function(b){return d(b.value)}),(g=this._ctx).isMatch=gs(g.isMatch,d),this},zt.prototype.and=function(d){return this.filter(d)},zt.prototype.or=function(d){return new this.db.WhereClause(this._ctx.table,d,this)},zt.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},zt.prototype.desc=function(){return this.reverse()},zt.prototype.eachKey=function(d){var g=this._ctx;return g.keysOnly=!g.isMatch,this.each(function(b,y){d(y.key,y)})},zt.prototype.eachUniqueKey=function(d){return this._ctx.unique="unique",this.eachKey(d)},zt.prototype.eachPrimaryKey=function(d){var g=this._ctx;return g.keysOnly=!g.isMatch,this.each(function(b,y){d(y.primaryKey,y)})},zt.prototype.keys=function(d){var g=this._ctx;g.keysOnly=!g.isMatch;var b=[];return this.each(function(y,R){b.push(R.key)}).then(function(){return b}).then(d)},zt.prototype.primaryKeys=function(d){var g=this._ctx;if(g.dir==="next"&&Ci(g,!0)&&0<g.limit)return this._read(function(y){var R=Qo(g,g.table.core.schema);return g.table.core.query({trans:y,values:!1,limit:g.limit,query:{index:R,range:g.range}})}).then(function(y){return y.result}).then(d);g.keysOnly=!g.isMatch;var b=[];return this.each(function(y,R){b.push(R.primaryKey)}).then(function(){return b}).then(d)},zt.prototype.uniqueKeys=function(d){return this._ctx.unique="unique",this.keys(d)},zt.prototype.firstKey=function(d){return this.limit(1).keys(function(g){return g[0]}).then(d)},zt.prototype.lastKey=function(d){return this.reverse().firstKey(d)},zt.prototype.distinct=function(){var d=this._ctx,d=d.index&&d.table.schema.idxByName[d.index];if(!d||!d.multi)return this;var g={};return Zo(this._ctx,function(R){var y=R.primaryKey.toString(),R=D(g,y);return g[y]=!0,!R}),this},zt.prototype.modify=function(d){var g=this,b=this._ctx;return this._write(function(y){var R=typeof d=="function"?d:function(ne){return _u(ne,d)},w=b.table.core,q=w.schema.primaryKey,x=q.outbound,U=q.extractKey,W=200,q=g.db._options.modifyChunkSize;q&&(W=typeof q=="object"?q[w.name]||q["*"]||200:q);function ie(ne,$e){var ue=$e.failures,$e=$e.numFailures;se+=ne-$e;for(var ye=0,ke=C(ue);ye<ke.length;ye++){var ze=ke[ye];z.push(ue[ze])}}var z=[],se=0,Z=[],te=d===pa;return g.clone().primaryKeys().then(function(ne){function oe($e){var ye=Math.min(W,ne.length-$e),ke=ne.slice($e,$e+ye);return(te?Promise.resolve([]):w.getMany({trans:y,keys:ke,cache:"immutable"})).then(function(ze){var nt=[],Pe=[],Ye=x?[]:null,et=te?ke:[];if(!te)for(var Ue=0;Ue<ye;++Ue){var Ge=ze[Ue],Tt={value:Bt(Ge),primKey:ne[$e+Ue]};R.call(Tt,Tt.value,Tt)!==!1&&(Tt.value==null?et.push(ne[$e+Ue]):x||Ut(U(Ge),U(Tt.value))===0?(Pe.push(Tt.value),x&&Ye.push(ne[$e+Ue])):(et.push(ne[$e+Ue]),nt.push(Tt.value)))}return Promise.resolve(0<nt.length&&w.mutate({trans:y,type:"add",values:nt}).then(function(Ct){for(var At in Ct.failures)et.splice(parseInt(At),1);ie(nt.length,Ct)})).then(function(){return(0<Pe.length||ue&&typeof d=="object")&&w.mutate({trans:y,type:"put",keys:Ye,values:Pe,criteria:ue,changeSpec:typeof d!="function"&&d,isAdditionalChunk:0<$e}).then(function(Ct){return ie(Pe.length,Ct)})}).then(function(){return(0<et.length||ue&&te)&&w.mutate({trans:y,type:"delete",keys:et,criteria:ue,isAdditionalChunk:0<$e}).then(function(Ct){return mi(b.table,et,Ct)}).then(function(Ct){return ie(et.length,Ct)})}).then(function(){return ne.length>$e+ye&&oe($e+W)})})}var ue=Ci(b)&&b.limit===1/0&&(typeof d!="function"||te)&&{index:b.index,range:b.range};return oe(0).then(function(){if(0<z.length)throw new Et("Error modifying one or more objects",z,se,Z);return ne.length})})})},zt.prototype.delete=function(){var d=this._ctx,g=d.range;return!Ci(d)||d.table.schema.yProps||!d.isPrimKey&&g.type!==3?this.modify(pa):this._write(function(b){var y=d.table.core.schema.primaryKey,R=g;return d.table.core.count({trans:b,query:{index:y,range:R}}).then(function(w){return d.table.core.mutate({trans:b,type:"deleteRange",range:R}).then(function(W){var U=W.failures,W=W.numFailures;if(W)throw new Et("Could not delete some values",Object.keys(U).map(function(q){return U[q]}),w-W);return w-W})})})},zt);function zt(){}var pa=function(d,g){return g.value=null};function Il(d,g){return d<g?-1:d===g?0:1}function xh(d,g){return g<d?-1:d===g?0:1}function Di(d,g,b){return d=d instanceof or?new d.Collection(d):d,d._ctx.error=new(b||TypeError)(g),d}function ms(d){return new d.Collection(d,function(){return Ls("")}).limit(0)}function _o(d,g,b,y){var R,w,x,U,W,q,ie,z=b.length;if(!b.every(function(te){return typeof te=="string"}))return Di(d,Kn);function se(te){R=te==="next"?function(oe){return oe.toUpperCase()}:function(oe){return oe.toLowerCase()},w=te==="next"?function(oe){return oe.toLowerCase()}:function(oe){return oe.toUpperCase()},x=te==="next"?Il:xh;var ne=b.map(function(oe){return{lower:w(oe),upper:R(oe)}}).sort(function(oe,ue){return x(oe.lower,ue.lower)});U=ne.map(function(oe){return oe.upper}),W=ne.map(function(oe){return oe.lower}),ie=(q=te)==="next"?"":y}se("next"),d=new d.Collection(d,function(){return es(U[0],W[z-1]+y)}),d._ondirectionchange=function(te){se(te)};var Z=0;return d._addAlgorithm(function(te,ne,oe){var ue=te.key;if(typeof ue!="string")return!1;var $e=w(ue);if(g($e,W,Z))return!0;for(var ye=null,ke=Z;ke<z;++ke){var ze=(function(nt,Pe,Ye,et,Ue,Ge){for(var Tt=Math.min(nt.length,et.length),Ct=-1,At=0;At<Tt;++At){var Ii=Pe[At];if(Ii!==et[At])return Ue(nt[At],Ye[At])<0?nt.substr(0,At)+Ye[At]+Ye.substr(At+1):Ue(nt[At],et[At])<0?nt.substr(0,At)+et[At]+Ye.substr(At+1):0<=Ct?nt.substr(0,Ct)+Pe[Ct]+Ye.substr(Ct+1):null;Ue(nt[At],Ii)<0&&(Ct=At)}return Tt<et.length&&Ge==="next"?nt+Ye.substr(nt.length):Tt<nt.length&&Ge==="prev"?nt.substr(0,Ye.length):Ct<0?null:nt.substr(0,Ct)+et[Ct]+Ye.substr(Ct+1)})(ue,$e,U[ke],W[ke],x,q);ze===null&&ye===null?Z=ke+1:(ye===null||0<x(ye,ze))&&(ye=ze)}return ne(ye!==null?function(){te.continue(ye+ie)}:oe),!1}),d}function es(d,g,b,y){return{type:2,lower:d,upper:g,lowerOpen:b,upperOpen:y}}function Ls(d){return{type:1,lower:d,upper:d}}var or=(Object.defineProperty(wn.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),wn.prototype.between=function(d,g,b,y){b=b!==!1,y=y===!0;try{return 0<this._cmp(d,g)||this._cmp(d,g)===0&&(b||y)&&(!b||!y)?ms(this):new this.Collection(this,function(){return es(d,g,!b,!y)})}catch{return Di(this,Ji)}},wn.prototype.equals=function(d){return d==null?Di(this,Ji):new this.Collection(this,function(){return Ls(d)})},wn.prototype.above=function(d){return d==null?Di(this,Ji):new this.Collection(this,function(){return es(d,void 0,!0)})},wn.prototype.aboveOrEqual=function(d){return d==null?Di(this,Ji):new this.Collection(this,function(){return es(d,void 0,!1)})},wn.prototype.below=function(d){return d==null?Di(this,Ji):new this.Collection(this,function(){return es(void 0,d,!1,!0)})},wn.prototype.belowOrEqual=function(d){return d==null?Di(this,Ji):new this.Collection(this,function(){return es(void 0,d)})},wn.prototype.startsWith=function(d){return typeof d!="string"?Di(this,Kn):this.between(d,d+lo,!0,!0)},wn.prototype.startsWithIgnoreCase=function(d){return d===""?this.startsWith(d):_o(this,function(g,b){return g.indexOf(b[0])===0},[d],lo)},wn.prototype.equalsIgnoreCase=function(d){return _o(this,function(g,b){return g===b[0]},[d],"")},wn.prototype.anyOfIgnoreCase=function(){var d=Be.apply(_t,arguments);return d.length===0?ms(this):_o(this,function(g,b){return b.indexOf(g)!==-1},d,"")},wn.prototype.startsWithAnyOfIgnoreCase=function(){var d=Be.apply(_t,arguments);return d.length===0?ms(this):_o(this,function(g,b){return b.some(function(y){return g.indexOf(y)===0})},d,lo)},wn.prototype.anyOf=function(){var d=this,g=Be.apply(_t,arguments),b=this._cmp;try{g.sort(b)}catch{return Di(this,Ji)}if(g.length===0)return ms(this);var y=new this.Collection(this,function(){return es(g[0],g[g.length-1])});y._ondirectionchange=function(w){b=w==="next"?d._ascending:d._descending,g.sort(b)};var R=0;return y._addAlgorithm(function(w,x,U){for(var W=w.key;0<b(W,g[R]);)if(++R===g.length)return x(U),!1;return b(W,g[R])===0||(x(function(){w.continue(g[R])}),!1)}),y},wn.prototype.notEqual=function(d){return this.inAnyRange([[-1/0,d],[d,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},wn.prototype.noneOf=function(){var d=Be.apply(_t,arguments);if(d.length===0)return new this.Collection(this);try{d.sort(this._ascending)}catch{return Di(this,Ji)}var g=d.reduce(function(b,y){return b?b.concat([[b[b.length-1][1],y]]):[[-1/0,y]]},null);return g.push([d[d.length-1],this.db._maxKey]),this.inAnyRange(g,{includeLowers:!1,includeUppers:!1})},wn.prototype.inAnyRange=function(ue,g){var b=this,y=this._cmp,R=this._ascending,w=this._descending,x=this._min,U=this._max;if(ue.length===0)return ms(this);if(!ue.every(function($e){return $e[0]!==void 0&&$e[1]!==void 0&&R($e[0],$e[1])<=0}))return Di(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",tt.InvalidArgument);var W=!g||g.includeLowers!==!1,q=g&&g.includeUppers===!0,ie,z=R;function se($e,ye){return z($e[0],ye[0])}try{(ie=ue.reduce(function($e,ye){for(var ke=0,ze=$e.length;ke<ze;++ke){var nt=$e[ke];if(y(ye[0],nt[1])<0&&0<y(ye[1],nt[0])){nt[0]=x(nt[0],ye[0]),nt[1]=U(nt[1],ye[1]);break}}return ke===ze&&$e.push(ye),$e},[])).sort(se)}catch{return Di(this,Ji)}var Z=0,te=q?function($e){return 0<R($e,ie[Z][1])}:function($e){return 0<=R($e,ie[Z][1])},ne=W?function($e){return 0<w($e,ie[Z][0])}:function($e){return 0<=w($e,ie[Z][0])},oe=te,ue=new this.Collection(this,function(){return es(ie[0][0],ie[ie.length-1][1],!W,!q)});return ue._ondirectionchange=function($e){z=$e==="next"?(oe=te,R):(oe=ne,w),ie.sort(se)},ue._addAlgorithm(function($e,ye,ke){for(var ze,nt=$e.key;oe(nt);)if(++Z===ie.length)return ye(ke),!1;return!te(ze=nt)&&!ne(ze)||(b._cmp(nt,ie[Z][1])===0||b._cmp(nt,ie[Z][0])===0||ye(function(){z===R?$e.continue(ie[Z][0]):$e.continue(ie[Z][1])}),!1)}),ue},wn.prototype.startsWithAnyOf=function(){var d=Be.apply(_t,arguments);return d.every(function(g){return typeof g=="string"})?d.length===0?ms(this):this.inAnyRange(d.map(function(g){return[g,g+lo]})):Di(this,"startsWithAnyOf() only works with strings")},wn);function wn(){}function gn(d){return St(function(g){return _s(g),d(g.target.error),!1})}function _s(d){d.stopPropagation&&d.stopPropagation(),d.preventDefault&&d.preventDefault()}var sr="storagemutated",bs="x-storagemutated-1",di=Ms(null,sr),ga=(xi.prototype._lock=function(){return Ae(!F.global),++this._reculock,this._reculock!==1||F.global||(F.lockOwnerFor=this),this},xi.prototype._unlock=function(){if(Ae(!F.global),--this._reculock==0)for(F.global||(F.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var d=this._blockedFuncs.shift();try{wo(d[1],d[0])}catch{}}return this},xi.prototype._locked=function(){return this._reculock&&F.lockOwnerFor!==this},xi.prototype.create=function(d){var g=this;if(!this.mode)return this;var b=this.db.idbdb,y=this.db._state.dbOpenError;if(Ae(!this.idbtrans),!d&&!b)switch(y&&y.name){case"DatabaseClosedError":throw new tt.DatabaseClosed(y);case"MissingAPIError":throw new tt.MissingAPI(y.message,y);default:throw new tt.OpenFailed(y)}if(!this.active)throw new tt.TransactionInactive;return Ae(this._completion._state===null),(d=this.idbtrans=d||(this.db.core||b).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=St(function(R){_s(R),g._reject(d.error)}),d.onabort=St(function(R){_s(R),g.active&&g._reject(new tt.Abort(d.error)),g.active=!1,g.on("abort").fire(R)}),d.oncomplete=St(function(){g.active=!1,g._resolve(),"mutatedParts"in d&&di.storagemutated.fire(d.mutatedParts)}),this},xi.prototype._promise=function(d,g,b){var y=this;if(d==="readwrite"&&this.mode!=="readwrite")return rn(new tt.ReadOnly("Transaction is readonly"));if(!this.active)return rn(new tt.TransactionInactive);if(this._locked())return new je(function(w,x){y._blockedFuncs.push([function(){y._promise(d,g,b).then(w,x)},F])});if(b)return Tn(function(){var w=new je(function(x,U){y._lock();var W=g(x,U,y);W&&W.then&&W.then(x,U)});return w.finally(function(){return y._unlock()}),w._lib=!0,w});var R=new je(function(w,x){var U=g(w,x,y);U&&U.then&&U.then(w,x)});return R._lib=!0,R},xi.prototype._root=function(){return this.parent?this.parent._root():this},xi.prototype.waitFor=function(d){var g,b=this._root(),y=je.resolve(d);b._waitingFor?b._waitingFor=b._waitingFor.then(function(){return y}):(b._waitingFor=y,b._waitingQueue=[],g=b.idbtrans.objectStore(b.storeNames[0]),(function w(){for(++b._spinCount;b._waitingQueue.length;)b._waitingQueue.shift()();b._waitingFor&&(g.get(-1/0).onsuccess=w)})());var R=b._waitingFor;return new je(function(w,x){y.then(function(U){return b._waitingQueue.push(St(w.bind(null,U)))},function(U){return b._waitingQueue.push(St(x.bind(null,U)))}).finally(function(){b._waitingFor===R&&(b._waitingFor=null)})})},xi.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new tt.Abort))},xi.prototype.table=function(d){var g=this._memoizedTables||(this._memoizedTables={});if(D(g,d))return g[d];var b=this.schema[d];if(!b)throw new tt.NotFound("Table "+d+" not part of transaction");return b=new this.db.Table(d,b,this),b.core=this.db.core.table(d),g[d]=b},xi);function xi(){}function ko(d,g,b,y,R,w,x,U){return{name:d,keyPath:g,unique:b,multi:y,auto:R,compound:w,src:(b&&!x?"&":"")+(y?"*":"")+(R?"++":"")+bu(g),type:U}}function bu(d){return typeof d=="string"?d:d?"["+[].join.call(d,"+")+"]":""}function Ds(d,g,b){return{name:d,primKey:g,indexes:b,mappedClass:null,idxByName:(y=function(R){return[R.name,R]},b.reduce(function(R,w,x){return x=y(w,x),x&&(R[x[0]]=x[1]),R},{}))};var y}var Mo=function(d){try{return d.only([[]]),Mo=function(){return[[]]},[[]]}catch{return Mo=function(){return lo},lo}};function xs(d){return d==null?function(){}:typeof d=="string"?(g=d).split(".").length===1?function(b){return b[g]}:function(b){return De(b,g)}:function(b){return De(b,d)};var g}function Ol(d){return[].slice.call(d)}var $a=0;function oi(d){return d==null?":id":typeof d=="string"?d:"[".concat(d.join("+"),"]")}function rr(d,g,W){function y(oe){if(oe.type===3)return null;if(oe.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var Z=oe.lower,te=oe.upper,ne=oe.lowerOpen,oe=oe.upperOpen;return Z===void 0?te===void 0?null:g.upperBound(te,!!oe):te===void 0?g.lowerBound(Z,!!ne):g.bound(Z,te,!!ne,!!oe)}function R(se){var Z,te=se.name;return{name:te,schema:se,mutate:function(ne){var oe=ne.trans,ue=ne.type,$e=ne.keys,ye=ne.values,ke=ne.range;return new Promise(function(ze,nt){ze=St(ze);var Pe=oe.objectStore(te),Ye=Pe.keyPath==null,et=ue==="put"||ue==="add";if(!et&&ue!=="delete"&&ue!=="deleteRange")throw new Error("Invalid operation type: "+ue);var Ue,Ge=($e||ye||{length:1}).length;if($e&&ye&&$e.length!==ye.length)throw new Error("Given keys array must have same length as given values array.");if(Ge===0)return ze({numFailures:0,failures:{},results:[],lastResult:void 0});function Tt(Dn){++Ii,_s(Dn)}var Ct=[],At=[],Ii=0;if(ue==="deleteRange"){if(ke.type===4)return ze({numFailures:Ii,failures:At,results:[],lastResult:void 0});ke.type===3?Ct.push(Ue=Pe.clear()):Ct.push(Ue=Pe.delete(y(ke)))}else{var Ye=et?Ye?[ye,$e]:[ye,null]:[$e,null],Ot=Ye[0],ei=Ye[1];if(et)for(var vn=0;vn<Ge;++vn)Ct.push(Ue=ei&&ei[vn]!==void 0?Pe[ue](Ot[vn],ei[vn]):Pe[ue](Ot[vn])),Ue.onerror=Tt;else for(vn=0;vn<Ge;++vn)Ct.push(Ue=Pe[ue](Ot[vn])),Ue.onerror=Tt}function qr(Dn){Dn=Dn.target.result,Ct.forEach(function(Bi,wu){return Bi.error!=null&&(At[wu]=Bi.error)}),ze({numFailures:Ii,failures:At,results:ue==="delete"?$e:Ct.map(function(Bi){return Bi.result}),lastResult:Dn})}Ue.onerror=function(Dn){Tt(Dn),qr(Dn)},Ue.onsuccess=qr})},getMany:function(ne){var oe=ne.trans,ue=ne.keys;return new Promise(function($e,ye){$e=St($e);for(var ke,ze=oe.objectStore(te),nt=ue.length,Pe=new Array(nt),Ye=0,et=0,Ue=function(Ct){Ct=Ct.target,Pe[Ct._pos]=Ct.result,++et===Ye&&$e(Pe)},Ge=gn(ye),Tt=0;Tt<nt;++Tt)ue[Tt]!=null&&((ke=ze.get(ue[Tt]))._pos=Tt,ke.onsuccess=Ue,ke.onerror=Ge,++Ye);Ye===0&&$e(Pe)})},get:function(ne){var oe=ne.trans,ue=ne.key;return new Promise(function($e,ye){$e=St($e);var ke=oe.objectStore(te).get(ue);ke.onsuccess=function(ze){return $e(ze.target.result)},ke.onerror=gn(ye)})},query:(Z=q,function(ne){return new Promise(function(oe,ue){oe=St(oe);var $e,ye,ke,Ye=ne.trans,ze=ne.values,nt=ne.limit,Ue=ne.query,Pe=nt===1/0?void 0:nt,et=Ue.index,Ue=Ue.range,Ye=Ye.objectStore(te),et=et.isPrimaryKey?Ye:Ye.index(et.name),Ue=y(Ue);if(nt===0)return oe({result:[]});Z?((Pe=ze?et.getAll(Ue,Pe):et.getAllKeys(Ue,Pe)).onsuccess=function(Ge){return oe({result:Ge.target.result})},Pe.onerror=gn(ue)):($e=0,ye=!ze&&"openKeyCursor"in et?et.openKeyCursor(Ue):et.openCursor(Ue),ke=[],ye.onsuccess=function(Ge){var Tt=ye.result;return Tt?(ke.push(ze?Tt.value:Tt.primaryKey),++$e===nt?oe({result:ke}):void Tt.continue()):oe({result:ke})},ye.onerror=gn(ue))})}),openCursor:function(ne){var oe=ne.trans,ue=ne.values,$e=ne.query,ye=ne.reverse,ke=ne.unique;return new Promise(function(ze,nt){ze=St(ze);var et=$e.index,Pe=$e.range,Ye=oe.objectStore(te),Ye=et.isPrimaryKey?Ye:Ye.index(et.name),et=ye?ke?"prevunique":"prev":ke?"nextunique":"next",Ue=!ue&&"openKeyCursor"in Ye?Ye.openKeyCursor(y(Pe),et):Ye.openCursor(y(Pe),et);Ue.onerror=gn(nt),Ue.onsuccess=St(function(Ge){var Tt,Ct,At,Ii,Ot=Ue.result;Ot?(Ot.___id=++$a,Ot.done=!1,Tt=Ot.continue.bind(Ot),Ct=(Ct=Ot.continuePrimaryKey)&&Ct.bind(Ot),At=Ot.advance.bind(Ot),Ii=function(){throw new Error("Cursor not stopped")},Ot.trans=oe,Ot.stop=Ot.continue=Ot.continuePrimaryKey=Ot.advance=function(){throw new Error("Cursor not started")},Ot.fail=St(nt),Ot.next=function(){var ei=this,vn=1;return this.start(function(){return vn--?ei.continue():ei.stop()}).then(function(){return ei})},Ot.start=function(ei){function vn(){if(Ue.result)try{ei()}catch(Dn){Ot.fail(Dn)}else Ot.done=!0,Ot.start=function(){throw new Error("Cursor behind last entry")},Ot.stop()}var qr=new Promise(function(Dn,Bi){Dn=St(Dn),Ue.onerror=gn(Bi),Ot.fail=Bi,Ot.stop=function(wu){Ot.stop=Ot.continue=Ot.continuePrimaryKey=Ot.advance=Ii,Dn(wu)}});return Ue.onsuccess=St(function(Dn){Ue.onsuccess=vn,vn()}),Ot.continue=Tt,Ot.continuePrimaryKey=Ct,Ot.advance=At,vn(),qr},ze(Ot)):ze(null)},nt)})},count:function(ne){var oe=ne.query,ue=ne.trans,$e=oe.index,ye=oe.range;return new Promise(function(ke,ze){var nt=ue.objectStore(te),Pe=$e.isPrimaryKey?nt:nt.index($e.name),nt=y(ye),Pe=nt?Pe.count(nt):Pe.count();Pe.onsuccess=St(function(Ye){return ke(Ye.target.result)}),Pe.onerror=gn(ze)})}}}var w,x,U,ie=(x=W,U=Ol((w=d).objectStoreNames),{schema:{name:w.name,tables:U.map(function(se){return x.objectStore(se)}).map(function(se){var Z=se.keyPath,oe=se.autoIncrement,te=A(Z),ne={},oe={name:se.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:Z==null,compound:te,keyPath:Z,autoIncrement:oe,unique:!0,extractKey:xs(Z)},indexes:Ol(se.indexNames).map(function(ue){return se.index(ue)}).map(function(ke){var $e=ke.name,ye=ke.unique,ze=ke.multiEntry,ke=ke.keyPath,ze={name:$e,compound:A(ke),keyPath:ke,unique:ye,multiEntry:ze,extractKey:xs(ke)};return ne[oi(ke)]=ze}),getIndexByKeyPath:function(ue){return ne[oi(ue)]}};return ne[":id"]=oe.primaryKey,Z!=null&&(ne[oi(Z)]=oe.primaryKey),oe})},hasGetAll:0<U.length&&"getAll"in x.objectStore(U[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),W=ie.schema,q=ie.hasGetAll,ie=W.tables.map(R),z={};return ie.forEach(function(se){return z[se.name]=se}),{stack:"dbcore",transaction:d.transaction.bind(d),table:function(se){if(!z[se])throw new Error("Table '".concat(se,"' not found"));return z[se]},MIN_KEY:-1/0,MAX_KEY:Mo(g),schema:W}}function Eu(d,g,b,y){var R=b.IDBKeyRange;return b.indexedDB,{dbcore:(y=rr(g,R,y),d.dbcore.reduce(function(w,x){return x=x.create,a(a({},w),x(w))},y))}}function ao(d,y){var b=y.db,y=Eu(d._middlewares,b,d._deps,y);d.core=y.dbcore,d.tables.forEach(function(R){var w=R.name;d.core.schema.tables.some(function(x){return x.name===w})&&(R.core=d.core.table(w),d[w]instanceof d.Table&&(d[w].core=R.core))})}function Tu(d,g,b,y){b.forEach(function(R){var w=y[R];g.forEach(function(x){var U=(function W(q,ie){return Xe(q,ie)||(q=O(q))&&W(q,ie)})(x,R);(!U||"value"in U&&U.value===void 0)&&(x===d.Transaction.prototype||x instanceof d.Transaction?Oe(x,R,{get:function(){return this.table(R)},set:function(W){be(this,R,{value:W,writable:!0,configurable:!0,enumerable:!0})}}):x[R]=new d.Table(R,w))})})}function Bs(d,g){g.forEach(function(b){for(var y in b)b[y]instanceof d.Table&&delete b[y]})}function lr(d,g){return d._cfg.version-g._cfg.version}function Es(d,g,b,y){var R=d._dbSchema;b.objectStoreNames.contains("$meta")&&!R.$meta&&(R.$meta=Ds("$meta",wc("")[0],[]),d._storeNames.push("$meta"));var w=d._createTransaction("readwrite",d._storeNames,R);w.create(b),w._completion.catch(y);var x=w._reject.bind(w),U=F.transless||F;Tn(function(){return F.trans=w,F.transless=U,g!==0?(ao(d,b),q=g,((W=w).storeNames.includes("$meta")?W.table("$meta").get("version").then(function(ie){return ie??q}):je.resolve(q)).then(function(ie){return se=ie,Z=w,te=b,ne=[],ie=(z=d)._versions,oe=z._dbSchema=Xr(0,z.idbdb,te),(ie=ie.filter(function(ue){return ue._cfg.version>=se})).length!==0?(ie.forEach(function(ue){ne.push(function(){var $e=oe,ye=ue._cfg.dbschema;Su(z,$e,te),Su(z,ye,te),oe=z._dbSchema=ye;var ke=vu($e,ye);ke.add.forEach(function(et){ma(te,et[0],et[1].primKey,et[1].indexes)}),ke.change.forEach(function(et){if(et.recreate)throw new tt.Upgrade("Not yet support for changing primary key");var Ue=te.objectStore(et.name);et.add.forEach(function(Ge){return yu(Ue,Ge)}),et.change.forEach(function(Ge){Ue.deleteIndex(Ge.name),yu(Ue,Ge)}),et.del.forEach(function(Ge){return Ue.deleteIndex(Ge)})});var ze=ue._cfg.contentUpgrade;if(ze&&ue._cfg.version>se){ao(z,te),Z._memoizedTables={};var nt=at(ye);ke.del.forEach(function(et){nt[et]=$e[et]}),Bs(z,[z.Transaction.prototype]),Tu(z,[z.Transaction.prototype],C(nt),nt),Z.schema=nt;var Pe,Ye=J(ze);return Ye&&Qn(),ke=je.follow(function(){var et;(Pe=ze(Z))&&Ye&&(et=qi.bind(null,null),Pe.then(et,et))}),Pe&&typeof Pe.then=="function"?je.resolve(Pe):ke.then(function(){return Pe})}}),ne.push(function($e){var ye,ke,ze=ue._cfg.dbschema;ye=ze,ke=$e,[].slice.call(ke.db.objectStoreNames).forEach(function(nt){return ye[nt]==null&&ke.db.deleteObjectStore(nt)}),Bs(z,[z.Transaction.prototype]),Tu(z,[z.Transaction.prototype],z._storeNames,z._dbSchema),Z.schema=z._dbSchema}),ne.push(function($e){z.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(z.idbdb.version/10)===ue._cfg.version?(z.idbdb.deleteObjectStore("$meta"),delete z._dbSchema.$meta,z._storeNames=z._storeNames.filter(function(ye){return ye!=="$meta"})):$e.objectStore("$meta").put(ue._cfg.version,"version"))})}),(function ue(){return ne.length?je.resolve(ne.shift()(Z.idbtrans)).then(ue):je.resolve()})().then(function(){Ac(oe,te)})):je.resolve();var z,se,Z,te,ne,oe}).catch(x)):(C(R).forEach(function(ie){ma(b,ie,R[ie].primKey,R[ie].indexes)}),ao(d,b),void je.follow(function(){return d.on.populate.fire(w)}).catch(x));var W,q})}function Zi(d,g){Ac(d._dbSchema,g),g.db.version%10!=0||g.objectStoreNames.contains("$meta")||g.db.createObjectStore("$meta").add(Math.ceil(g.db.version/10-1),"version");var b=Xr(0,d.idbdb,g);Su(d,d._dbSchema,g);for(var y=0,R=vu(b,d._dbSchema).change;y<R.length;y++){var w=(function(x){if(x.change.length||x.recreate)return console.warn("Unable to patch indexes of table ".concat(x.name," because it has changes on the type of index or primary key.")),{value:void 0};var U=g.objectStore(x.name);x.add.forEach(function(W){_n&&console.debug("Dexie upgrade patch: Creating missing index ".concat(x.name,".").concat(W.src)),yu(U,W)})})(R[y]);if(typeof w=="object")return w.value}}function vu(d,g){var b,y={del:[],add:[],change:[]};for(b in d)g[b]||y.del.push(b);for(b in g){var R=d[b],w=g[b];if(R){var x={name:b,def:w,recreate:!1,del:[],add:[],change:[]};if(""+(R.primKey.keyPath||"")!=""+(w.primKey.keyPath||"")||R.primKey.auto!==w.primKey.auto)x.recreate=!0,y.change.push(x);else{var U=R.idxByName,W=w.idxByName,q=void 0;for(q in U)W[q]||x.del.push(q);for(q in W){var ie=U[q],z=W[q];ie?ie.src!==z.src&&x.change.push(z):x.add.push(z)}(0<x.del.length||0<x.add.length||0<x.change.length)&&y.change.push(x)}}else y.add.push([b,w])}return y}function ma(d,g,b,y){var R=d.db.createObjectStore(g,b.keyPath?{keyPath:b.keyPath,autoIncrement:b.auto}:{autoIncrement:b.auto});return y.forEach(function(w){return yu(R,w)}),R}function Ac(d,g){C(d).forEach(function(b){g.db.objectStoreNames.contains(b)||(_n&&console.debug("Dexie: Creating missing table",b),ma(g,b,d[b].primKey,d[b].indexes))})}function yu(d,g){d.createIndex(g.name,g.keyPath,{unique:g.unique,multiEntry:g.multi})}function Xr(d,g,b){var y={};return _e(g.objectStoreNames,0).forEach(function(R){for(var w=b.objectStore(R),x=ko(bu(q=w.keyPath),q||"",!0,!1,!!w.autoIncrement,q&&typeof q!="string",!0),U=[],W=0;W<w.indexNames.length;++W){var ie=w.index(w.indexNames[W]),q=ie.keyPath,ie=ko(ie.name,q,!!ie.unique,!!ie.multiEntry,!1,q&&typeof q!="string",!1);U.push(ie)}y[R]=Ds(R,x,U)}),y}function Su(d,g,b){for(var y=b.db.objectStoreNames,R=0;R<y.length;++R){var w=y[R],x=b.objectStore(w);d._hasGetAll="getAll"in x;for(var U=0;U<x.indexNames.length;++U){var W=x.indexNames[U],q=x.index(W).keyPath,ie=typeof q=="string"?q:"["+_e(q).join("+")+"]";!g[w]||(q=g[w].idxByName[ie])&&(q.name=W,delete g[w].idxByName[ie],g[w].idxByName[W]=q)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&E.WorkerGlobalScope&&E instanceof E.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(d._hasGetAll=!1)}function wc(d){return d.split(",").map(function(g,b){var w=g.split(":"),y=(R=w[1])===null||R===void 0?void 0:R.trim(),R=(g=w[0].trim()).replace(/([&*]|\+\+)/g,""),w=/^\[/.test(R)?R.match(/^\[(.*)\]$/)[1].split("+"):R;return ko(R,w||null,/\&/.test(g),/\*/.test(g),/\+\+/.test(g),A(w),b===0,y)})}var Nc=(bo.prototype._createTableSchema=Ds,bo.prototype._parseIndexSyntax=wc,bo.prototype._parseStoresSpec=function(d,g){var b=this;C(d).forEach(function(y){if(d[y]!==null){var R=b._parseIndexSyntax(d[y]),w=R.shift();if(!w)throw new tt.Schema("Invalid schema for table "+y+": "+d[y]);if(w.unique=!0,w.multi)throw new tt.Schema("Primary key cannot be multiEntry*");R.forEach(function(x){if(x.auto)throw new tt.Schema("Only primary key can be marked as autoIncrement (++)");if(!x.keyPath)throw new tt.Schema("Index must have a name and cannot be an empty string")}),R=b._createTableSchema(y,w,R),g[y]=R}})},bo.prototype.stores=function(b){var g=this.db;this._cfg.storesSource=this._cfg.storesSource?N(this._cfg.storesSource,b):b;var b=g._versions,y={},R={};return b.forEach(function(w){N(y,w._cfg.storesSource),R=w._cfg.dbschema={},w._parseStoresSpec(y,R)}),g._dbSchema=R,Bs(g,[g._allTables,g,g.Transaction.prototype]),Tu(g,[g._allTables,g,g.Transaction.prototype,this._cfg.tables],C(R),R),g._storeNames=C(R),this},bo.prototype.upgrade=function(d){return this._cfg.contentUpgrade=Ln(this._cfg.contentUpgrade||ae,d),this},bo);function bo(){}function ur(d,g){var b=d._dbNamesDB;return b||(b=d._dbNamesDB=new co(tr,{addons:[],indexedDB:d,IDBKeyRange:g})).version(1).stores({dbnames:"name"}),b.table("dbnames")}function Al(d){return d&&typeof d.databases=="function"}function _a(d){return Tn(function(){return F.letThrough=!0,d()})}function ba(d){return!("from"in d)}var Ri=function(d,g){if(!this){var b=new Ri;return d&&"d"in d&&N(b,d),b}N(this,arguments.length?{d:1,from:d,to:1<arguments.length?g:d}:{d:0})};function wl(d,g,b){var y=Ut(g,b);if(!isNaN(y)){if(0<y)throw RangeError();if(ba(d))return N(d,{from:g,to:b,d:1});var R=d.l,y=d.r;if(Ut(b,d.from)<0)return R?wl(R,g,b):d.l={from:g,to:b,d:1,l:null,r:null},Mc(d);if(0<Ut(g,d.to))return y?wl(y,g,b):d.r={from:g,to:b,d:1,l:null,r:null},Mc(d);Ut(g,d.from)<0&&(d.from=g,d.l=null,d.d=y?y.d+1:1),0<Ut(b,d.to)&&(d.to=b,d.r=null,d.d=d.l?d.l.d+1:1),b=!d.r,R&&!d.l&&ar(d,R),y&&b&&ar(d,y)}}function ar(d,g){ba(g)||(function b(y,W){var w=W.from,x=W.to,U=W.l,W=W.r;wl(y,w,x),U&&b(y,U),W&&b(y,W)})(d,g)}function kc(d,g){var b=Cu(g),y=b.next();if(y.done)return!1;for(var R=y.value,w=Cu(d),x=w.next(R.from),U=x.value;!y.done&&!x.done;){if(Ut(U.from,R.to)<=0&&0<=Ut(U.to,R.from))return!0;Ut(R.from,U.from)<0?R=(y=b.next(U.from)).value:U=(x=w.next(R.from)).value}return!1}function Cu(d){var g=ba(d)?null:{s:0,n:d};return{next:function(b){for(var y=0<arguments.length;g;)switch(g.s){case 0:if(g.s=1,y)for(;g.n.l&&Ut(b,g.n.from)<0;)g={up:g,n:g.n.l,s:1};else for(;g.n.l;)g={up:g,n:g.n.l,s:1};case 1:if(g.s=2,!y||Ut(b,g.n.to)<=0)return{value:g.n,done:!1};case 2:if(g.n.r){g.s=3,g={up:g,n:g.n.r,s:0};continue}case 3:g=g.up}return{done:!0}}}}function Mc(d){var g,b,y=(((g=d.r)===null||g===void 0?void 0:g.d)||0)-(((b=d.l)===null||b===void 0?void 0:b.d)||0),R=1<y?"r":y<-1?"l":"";R&&(g=R=="r"?"l":"r",b=a({},d),y=d[R],d.from=y.from,d.to=y.to,d[R]=y[R],b[R]=y[g],(d[g]=b).d=Ea(b)),d.d=Ea(d)}function Ea(b){var g=b.r,b=b.l;return(g?b?Math.max(g.d,b.d):g.d:b?b.d:0)+1}function Nl(d,g){return C(g).forEach(function(b){d[b]?ar(d[b],g[b]):d[b]=(function y(R){var w,x,U={};for(w in R)D(R,w)&&(x=R[w],U[w]=!x||typeof x!="object"||Je.has(x.constructor)?x:y(x));return U})(g[b])}),d}function Ta(d,g){return d.all||g.all||Object.keys(d).some(function(b){return g[b]&&kc(g[b],d[b])})}j(Ri.prototype,((ho={add:function(d){return ar(this,d),this},addKey:function(d){return wl(this,d,d),this},addKeys:function(d){var g=this;return d.forEach(function(b){return wl(g,b,b)}),this},hasKey:function(d){var g=Cu(this).next(d).value;return g&&Ut(g.from,d)<=0&&0<=Ut(g.to,d)}})[de]=function(){return Cu(this)},ho));var Eo={},kl={},va=!1;function Ps(d){Nl(kl,d),va||(va=!0,setTimeout(function(){va=!1,Ml(kl,!(kl={}))},0))}function Ml(d,g){g===void 0&&(g=!1);var b=new Set;if(d.all)for(var y=0,R=Object.values(Eo);y<R.length;y++)ya(x=R[y],d,b,g);else for(var w in d){var x,U=/^idb\:\/\/(.*)\/(.*)\//.exec(w);U&&(w=U[1],U=U[2],(x=Eo["idb://".concat(w,"/").concat(U)])&&ya(x,d,b,g))}b.forEach(function(W){return W()})}function ya(d,g,b,y){for(var R=[],w=0,x=Object.entries(d.queries.query);w<x.length;w++){for(var U=x[w],W=U[0],q=[],ie=0,z=U[1];ie<z.length;ie++){var se=z[ie];Ta(g,se.obsSet)?se.subscribers.forEach(function(oe){return b.add(oe)}):y&&q.push(se)}y&&R.push([W,q])}if(y)for(var Z=0,te=R;Z<te.length;Z++){var ne=te[Z],W=ne[0],q=ne[1];d.queries.query[W]=q}}function Lc(d){var g=d._state,b=d._deps.indexedDB;if(g.isBeingOpened||d.idbdb)return g.dbReadyPromise.then(function(){return g.dbOpenError?rn(g.dbOpenError):d});g.isBeingOpened=!0,g.dbOpenError=null,g.openComplete=!1;var y=g.openCanceller,R=Math.round(10*d.verno),w=!1;function x(){if(g.openCanceller!==y)throw new tt.DatabaseClosed("db.open() was cancelled")}function U(){return new je(function(se,Z){if(x(),!b)throw new tt.MissingAPI;var te=d.name,ne=g.autoSchema||!R?b.open(te):b.open(te,R);if(!ne)throw new tt.MissingAPI;ne.onerror=gn(Z),ne.onblocked=St(d._fireOnBlocked),ne.onupgradeneeded=St(function(oe){var ue;ie=ne.transaction,g.autoSchema&&!d._options.allowEmptyDB?(ne.onerror=_s,ie.abort(),ne.result.close(),(ue=b.deleteDatabase(te)).onsuccess=ue.onerror=St(function(){Z(new tt.NoSuchDatabase("Database ".concat(te," doesnt exist")))})):(ie.onerror=gn(Z),oe=oe.oldVersion>Math.pow(2,62)?0:oe.oldVersion,z=oe<1,d.idbdb=ne.result,w&&Zi(d,ie),Es(d,oe/10,ie,Z))},Z),ne.onsuccess=St(function(){ie=null;var oe,ue,$e,ye,ke,ze=d.idbdb=ne.result,nt=_e(ze.objectStoreNames);if(0<nt.length)try{var Pe=ze.transaction((ye=nt).length===1?ye[0]:ye,"readonly");if(g.autoSchema)ue=ze,$e=Pe,(oe=d).verno=ue.version/10,$e=oe._dbSchema=Xr(0,ue,$e),oe._storeNames=_e(ue.objectStoreNames,0),Tu(oe,[oe._allTables],C($e),$e);else if(Su(d,d._dbSchema,Pe),((ke=vu(Xr(0,(ke=d).idbdb,Pe),ke._dbSchema)).add.length||ke.change.some(function(Ye){return Ye.add.length||Ye.change.length}))&&!w)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),ze.close(),R=ze.version+1,w=!0,se(U());ao(d,Pe)}catch{}er.push(d),ze.onversionchange=St(function(Ye){g.vcFired=!0,d.on("versionchange").fire(Ye)}),ze.onclose=St(function(){d.close({disableAutoOpen:!1})}),z&&(ke=d._deps,Pe=te,ze=ke.indexedDB,ke=ke.IDBKeyRange,Al(ze)||Pe===tr||ur(ze,ke).put({name:Pe}).catch(ae)),se()},Z)}).catch(function(se){switch(se?.name){case"UnknownError":if(0<g.PR1398_maxLoop)return g.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),U();break;case"VersionError":if(0<R)return R=0,U()}return je.reject(se)})}var W,q=g.dbReadyResolve,ie=null,z=!1;return je.race([y,(typeof navigator>"u"?je.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(se){function Z(){return indexedDB.databases().finally(se)}W=setInterval(Z,100),Z()}).finally(function(){return clearInterval(W)}):Promise.resolve()).then(U)]).then(function(){return x(),g.onReadyBeingFired=[],je.resolve(_a(function(){return d.on.ready.fire(d.vip)})).then(function se(){if(0<g.onReadyBeingFired.length){var Z=g.onReadyBeingFired.reduce(Ln,ae);return g.onReadyBeingFired=[],je.resolve(_a(function(){return Z(d.vip)})).then(se)}})}).finally(function(){g.openCanceller===y&&(g.onReadyBeingFired=null,g.isBeingOpened=!1)}).catch(function(se){g.dbOpenError=se;try{ie&&ie.abort()}catch{}return y===g.openCanceller&&d._close(),rn(se)}).finally(function(){g.openComplete=!0,q()}).then(function(){var se;return z&&(se={},d.tables.forEach(function(Z){Z.schema.indexes.forEach(function(te){te.name&&(se["idb://".concat(d.name,"/").concat(Z.name,"/").concat(te.name)]=new Ri(-1/0,[[[]]]))}),se["idb://".concat(d.name,"/").concat(Z.name,"/")]=se["idb://".concat(d.name,"/").concat(Z.name,"/:dels")]=new Ri(-1/0,[[[]]])}),di(sr).fire(se),Ml(se,!0)),d})}function cr(d){function g(w){return d.next(w)}var b=R(g),y=R(function(w){return d.throw(w)});function R(w){return function(W){var U=w(W),W=U.value;return U.done?W:W&&typeof W.then=="function"?W.then(b,y):A(W)?Promise.all(W).then(b,y):b(W)}}return R(g)()}function ts(d,g,b){for(var y=A(d)?d.slice():[d],R=0;R<b;++R)y.push(g);return y}var Dc={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(d){return a(a({},d),{table:function(g){var b=d.table(g),y=b.schema,R={},w=[];function x(z,se,Z){var te=oi(z),ne=R[te]=R[te]||[],oe=z==null?0:typeof z=="string"?1:z.length,ue=0<se,ue=a(a({},Z),{name:ue?"".concat(te,"(virtual-from:").concat(Z.name,")"):Z.name,lowLevelIndex:Z,isVirtual:ue,keyTail:se,keyLength:oe,extractKey:xs(z),unique:!ue&&Z.unique});return ne.push(ue),ue.isPrimaryKey||w.push(ue),1<oe&&x(oe===2?z[0]:z.slice(0,oe-1),se+1,Z),ne.sort(function($e,ye){return $e.keyTail-ye.keyTail}),ue}g=x(y.primaryKey.keyPath,0,y.primaryKey),R[":id"]=[g];for(var U=0,W=y.indexes;U<W.length;U++){var q=W[U];x(q.keyPath,0,q)}function ie(z){var se,Z=z.query.index;return Z.isVirtual?a(a({},z),{query:{index:Z.lowLevelIndex,range:(se=z.query.range,Z=Z.keyTail,{type:se.type===1?2:se.type,lower:ts(se.lower,se.lowerOpen?d.MAX_KEY:d.MIN_KEY,Z),lowerOpen:!0,upper:ts(se.upper,se.upperOpen?d.MIN_KEY:d.MAX_KEY,Z),upperOpen:!0})}}):z}return a(a({},b),{schema:a(a({},y),{primaryKey:g,indexes:w,getIndexByKeyPath:function(z){return(z=R[oi(z)])&&z[0]}}),count:function(z){return b.count(ie(z))},query:function(z){return b.query(ie(z))},openCursor:function(z){var se=z.query.index,Z=se.keyTail,te=se.isVirtual,ne=se.keyLength;return te?b.openCursor(ie(z)).then(function(ue){return ue&&oe(ue)}):b.openCursor(z);function oe(ue){return Object.create(ue,{continue:{value:function($e){$e!=null?ue.continue(ts($e,z.reverse?d.MAX_KEY:d.MIN_KEY,Z)):z.unique?ue.continue(ue.key.slice(0,ne).concat(z.reverse?d.MIN_KEY:d.MAX_KEY,Z)):ue.continue()}},continuePrimaryKey:{value:function($e,ye){ue.continuePrimaryKey(ts($e,d.MAX_KEY,Z),ye)}},primaryKey:{get:function(){return ue.primaryKey}},key:{get:function(){var $e=ue.key;return ne===1?$e[0]:$e.slice(0,ne)}},value:{get:function(){return ue.value}}})}}})}})}};function Ru(d,g,b,y){return b=b||{},y=y||"",C(d).forEach(function(R){var w,x,U;D(g,R)?(w=d[R],x=g[R],typeof w=="object"&&typeof x=="object"&&w&&x?(U=kt(w))!==kt(x)?b[y+R]=g[R]:U==="Object"?Ru(w,x,b,y+R+"."):w!==x&&(b[y+R]=g[R]):w!==x&&(b[y+R]=g[R])):b[y+R]=void 0}),C(g).forEach(function(R){D(d,R)||(b[y+R]=g[R])}),b}function Ll(d,g){return g.type==="delete"?g.keys:g.keys||g.values.map(d.extractKey)}var Sa={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(d){return a(a({},d),{table:function(g){var b=d.table(g),y=b.schema.primaryKey;return a(a({},b),{mutate:function(R){var w=F.trans,x=w.table(g).hook,U=x.deleting,W=x.creating,q=x.updating;switch(R.type){case"add":if(W.fire===ae)break;return w._promise("readwrite",function(){return ie(R)},!0);case"put":if(W.fire===ae&&q.fire===ae)break;return w._promise("readwrite",function(){return ie(R)},!0);case"delete":if(U.fire===ae)break;return w._promise("readwrite",function(){return ie(R)},!0);case"deleteRange":if(U.fire===ae)break;return w._promise("readwrite",function(){return(function z(se,Z,te){return b.query({trans:se,values:!1,query:{index:y,range:Z},limit:te}).then(function(ne){var oe=ne.result;return ie({type:"delete",keys:oe,trans:se}).then(function(ue){return 0<ue.numFailures?Promise.reject(ue.failures[0]):oe.length<te?{failures:[],numFailures:0,lastResult:void 0}:z(se,a(a({},Z),{lower:oe[oe.length-1],lowerOpen:!0}),te)})})})(R.trans,R.range,1e4)},!0)}return b.mutate(R);function ie(z){var se,Z,te,ne=F.trans,oe=z.keys||Ll(y,z);if(!oe)throw new Error("Keys missing");return(z=z.type==="add"||z.type==="put"?a(a({},z),{keys:oe}):a({},z)).type!=="delete"&&(z.values=_([],z.values)),z.keys&&(z.keys=_([],z.keys)),se=b,te=oe,((Z=z).type==="add"?Promise.resolve([]):se.getMany({trans:Z.trans,keys:te,cache:"immutable"})).then(function(ue){var $e=oe.map(function(ye,ke){var ze,nt,Pe,Ye=ue[ke],et={onerror:null,onsuccess:null};return z.type==="delete"?U.fire.call(et,ye,Ye,ne):z.type==="add"||Ye===void 0?(ze=W.fire.call(et,ye,z.values[ke],ne),ye==null&&ze!=null&&(z.keys[ke]=ye=ze,y.outbound||xe(z.values[ke],y.keyPath,ye))):(ze=Ru(Ye,z.values[ke]),(nt=q.fire.call(et,ze,ye,Ye,ne))&&(Pe=z.values[ke],Object.keys(nt).forEach(function(Ue){D(Pe,Ue)?Pe[Ue]=nt[Ue]:xe(Pe,Ue,nt[Ue])}))),et});return b.mutate(z).then(function(ye){for(var ke=ye.failures,ze=ye.results,nt=ye.numFailures,ye=ye.lastResult,Pe=0;Pe<oe.length;++Pe){var Ye=(ze||oe)[Pe],et=$e[Pe];Ye==null?et.onerror&&et.onerror(ke[Pe]):et.onsuccess&&et.onsuccess(z.type==="put"&&ue[Pe]?z.values[Pe]:Ye)}return{failures:ke,results:ze,numFailures:nt,lastResult:ye}}).catch(function(ye){return $e.forEach(function(ke){return ke.onerror&&ke.onerror(ye)}),Promise.reject(ye)})})}}})}})}};function Iu(d,g,b){try{if(!g||g.keys.length<d.length)return null;for(var y=[],R=0,w=0;R<g.keys.length&&w<d.length;++R)Ut(g.keys[R],d[w])===0&&(y.push(b?Bt(g.values[R]):g.values[R]),++w);return y.length===d.length?y:null}catch{return null}}var Ca={stack:"dbcore",level:-1,create:function(d){return{table:function(g){var b=d.table(g);return a(a({},b),{getMany:function(y){if(!y.cache)return b.getMany(y);var R=Iu(y.keys,y.trans._cache,y.cache==="clone");return R?je.resolve(R):b.getMany(y).then(function(w){return y.trans._cache={keys:y.keys,values:y.cache==="clone"?Bt(w):w},w})},mutate:function(y){return y.type!=="add"&&(y.trans._cache=null),b.mutate(y)}})}}}};function Fs(d,g){return d.trans.mode==="readonly"&&!!d.subscr&&!d.trans.explicit&&d.trans.db._options.cache!=="disabled"&&!g.schema.primaryKey.outbound}function Ra(d,g){switch(d){case"query":return g.values&&!g.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var xc={stack:"dbcore",level:0,name:"Observability",create:function(d){var g=d.schema.name,b=new Ri(d.MIN_KEY,d.MAX_KEY);return a(a({},d),{transaction:function(y,R,w){if(F.subscr&&R!=="readonly")throw new tt.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(F.querier));return d.transaction(y,R,w)},table:function(y){var R=d.table(y),w=R.schema,x=w.primaryKey,z=w.indexes,U=x.extractKey,W=x.outbound,q=x.autoIncrement&&z.filter(function(Z){return Z.compound&&Z.keyPath.includes(x.keyPath)}),ie=a(a({},R),{mutate:function(Z){function te(Ue){return Ue="idb://".concat(g,"/").concat(y,"/").concat(Ue),ye[Ue]||(ye[Ue]=new Ri)}var ne,oe,ue,$e=Z.trans,ye=Z.mutatedParts||(Z.mutatedParts={}),ke=te(""),ze=te(":dels"),nt=Z.type,et=Z.type==="deleteRange"?[Z.range]:Z.type==="delete"?[Z.keys]:Z.values.length<50?[Ll(x,Z).filter(function(Ue){return Ue}),Z.values]:[],Pe=et[0],Ye=et[1],et=Z.trans._cache;return A(Pe)?(ke.addKeys(Pe),(et=nt==="delete"||Pe.length===Ye.length?Iu(Pe,et):null)||ze.addKeys(Pe),(et||Ye)&&(ne=te,oe=et,ue=Ye,w.indexes.forEach(function(Ue){var Ge=ne(Ue.name||"");function Tt(At){return At!=null?Ue.extractKey(At):null}function Ct(At){return Ue.multiEntry&&A(At)?At.forEach(function(Ii){return Ge.addKey(Ii)}):Ge.addKey(At)}(oe||ue).forEach(function(At,ei){var Ot=oe&&Tt(oe[ei]),ei=ue&&Tt(ue[ei]);Ut(Ot,ei)!==0&&(Ot!=null&&Ct(Ot),ei!=null&&Ct(ei))})}))):Pe?(Ye={from:(Ye=Pe.lower)!==null&&Ye!==void 0?Ye:d.MIN_KEY,to:(Ye=Pe.upper)!==null&&Ye!==void 0?Ye:d.MAX_KEY},ze.add(Ye),ke.add(Ye)):(ke.add(b),ze.add(b),w.indexes.forEach(function(Ue){return te(Ue.name).add(b)})),R.mutate(Z).then(function(Ue){return!Pe||Z.type!=="add"&&Z.type!=="put"||(ke.addKeys(Ue.results),q&&q.forEach(function(Ge){for(var Tt=Z.values.map(function(Ot){return Ge.extractKey(Ot)}),Ct=Ge.keyPath.findIndex(function(Ot){return Ot===x.keyPath}),At=0,Ii=Ue.results.length;At<Ii;++At)Tt[At][Ct]=Ue.results[At];te(Ge.name).addKeys(Tt)})),$e.mutatedParts=Nl($e.mutatedParts||{},ye),Ue})}}),z=function(te){var ne=te.query,te=ne.index,ne=ne.range;return[te,new Ri((te=ne.lower)!==null&&te!==void 0?te:d.MIN_KEY,(ne=ne.upper)!==null&&ne!==void 0?ne:d.MAX_KEY)]},se={get:function(Z){return[x,new Ri(Z.key)]},getMany:function(Z){return[x,new Ri().addKeys(Z.keys)]},count:z,query:z,openCursor:z};return C(se).forEach(function(Z){ie[Z]=function(te){var ne=F.subscr,oe=!!ne,ue=Fs(F,R)&&Ra(Z,te)?te.obsSet={}:ne;if(oe){var $e=function(Ye){return Ye="idb://".concat(g,"/").concat(y,"/").concat(Ye),ue[Ye]||(ue[Ye]=new Ri)},ye=$e(""),ke=$e(":dels"),ne=se[Z](te),oe=ne[0],ne=ne[1];if((Z==="query"&&oe.isPrimaryKey&&!te.values?ke:$e(oe.name||"")).add(ne),!oe.isPrimaryKey){if(Z!=="count"){var ze=Z==="query"&&W&&te.values&&R.query(a(a({},te),{values:!1}));return R[Z].apply(this,arguments).then(function(Ye){if(Z==="query"){if(W&&te.values)return ze.then(function(Tt){return Tt=Tt.result,ye.addKeys(Tt),Ye});var et=te.values?Ye.result.map(U):Ye.result;(te.values?ye:ke).addKeys(et)}else if(Z==="openCursor"){var Ue=Ye,Ge=te.values;return Ue&&Object.create(Ue,{key:{get:function(){return ke.addKey(Ue.primaryKey),Ue.key}},primaryKey:{get:function(){var Tt=Ue.primaryKey;return ke.addKey(Tt),Tt}},value:{get:function(){return Ge&&ye.addKey(Ue.primaryKey),Ue.value}}})}return Ye})}ke.add(b)}}return R[Z].apply(this,arguments)}}),ie}})}};function Bc(d,g,b){if(b.numFailures===0)return g;if(g.type==="deleteRange")return null;var y=g.keys?g.keys.length:"values"in g&&g.values?g.values.length:1;return b.numFailures===y?null:(g=a({},g),A(g.keys)&&(g.keys=g.keys.filter(function(R,w){return!(w in b.failures)})),"values"in g&&A(g.values)&&(g.values=g.values.filter(function(R,w){return!(w in b.failures)})),g)}function hr(d,g){return b=d,((y=g).lower===void 0||(y.lowerOpen?0<Ut(b,y.lower):0<=Ut(b,y.lower)))&&(d=d,(g=g).upper===void 0||(g.upperOpen?Ut(d,g.upper)<0:Ut(d,g.upper)<=0));var b,y}function Ou(d,g,se,y,R,w){if(!se||se.length===0)return d;var x=g.query.index,U=x.multiEntry,W=g.query.range,q=y.schema.primaryKey.extractKey,ie=x.extractKey,z=(x.lowLevelIndex||x).extractKey,se=se.reduce(function(Z,te){var ne=Z,oe=[];if(te.type==="add"||te.type==="put")for(var ue=new Ri,$e=te.values.length-1;0<=$e;--$e){var ye,ke=te.values[$e],ze=q(ke);ue.hasKey(ze)||(ye=ie(ke),(U&&A(ye)?ye.some(function(Ue){return hr(Ue,W)}):hr(ye,W))&&(ue.addKey(ze),oe.push(ke)))}switch(te.type){case"add":var nt=new Ri().addKeys(g.values?Z.map(function(Ge){return q(Ge)}):Z),ne=Z.concat(g.values?oe.filter(function(Ge){return Ge=q(Ge),!nt.hasKey(Ge)&&(nt.addKey(Ge),!0)}):oe.map(function(Ge){return q(Ge)}).filter(function(Ge){return!nt.hasKey(Ge)&&(nt.addKey(Ge),!0)}));break;case"put":var Pe=new Ri().addKeys(te.values.map(function(Ge){return q(Ge)}));ne=Z.filter(function(Ge){return!Pe.hasKey(g.values?q(Ge):Ge)}).concat(g.values?oe:oe.map(function(Ge){return q(Ge)}));break;case"delete":var Ye=new Ri().addKeys(te.keys);ne=Z.filter(function(Ge){return!Ye.hasKey(g.values?q(Ge):Ge)});break;case"deleteRange":var et=te.range;ne=Z.filter(function(Ge){return!hr(q(Ge),et)})}return ne},d);return se===d?d:(se.sort(function(Z,te){return Ut(z(Z),z(te))||Ut(q(Z),q(te))}),g.limit&&g.limit<1/0&&(se.length>g.limit?se.length=g.limit:d.length===g.limit&&se.length<g.limit&&(R.dirty=!0)),w?Object.freeze(se):se)}function Us(d,g){return Ut(d.lower,g.lower)===0&&Ut(d.upper,g.upper)===0&&!!d.lowerOpen==!!g.lowerOpen&&!!d.upperOpen==!!g.upperOpen}function dr(d,g){return(function(b,y,R,w){if(b===void 0)return y!==void 0?-1:0;if(y===void 0)return 1;if((y=Ut(b,y))===0){if(R&&w)return 0;if(R)return 1;if(w)return-1}return y})(d.lower,g.lower,d.lowerOpen,g.lowerOpen)<=0&&0<=(function(b,y,R,w){if(b===void 0)return y!==void 0?1:0;if(y===void 0)return-1;if((y=Ut(b,y))===0){if(R&&w)return 0;if(R)return-1;if(w)return 1}return y})(d.upper,g.upper,d.upperOpen,g.upperOpen)}function Ts(d,g,b,y){d.subscribers.add(b),y.addEventListener("abort",function(){var R,w;d.subscribers.delete(b),d.subscribers.size===0&&(R=d,w=g,setTimeout(function(){R.subscribers.size===0&&ft(w,R)},3e3))})}var Dl={stack:"dbcore",level:0,name:"Cache",create:function(d){var g=d.schema.name;return a(a({},d),{transaction:function(b,y,R){var w,x,U=d.transaction(b,y,R);return y==="readwrite"&&(x=(w=new AbortController).signal,R=function(W){return function(){if(w.abort(),y==="readwrite"){for(var q=new Set,ie=0,z=b;ie<z.length;ie++){var se=z[ie],Z=Eo["idb://".concat(g,"/").concat(se)];if(Z){var te=d.table(se),ne=Z.optimisticOps.filter(function(Ge){return Ge.trans===U});if(U._explicit&&W&&U.mutatedParts)for(var oe=0,ue=Object.values(Z.queries.query);oe<ue.length;oe++)for(var $e=0,ye=(nt=ue[oe]).slice();$e<ye.length;$e++)Ta((Pe=ye[$e]).obsSet,U.mutatedParts)&&(ft(nt,Pe),Pe.subscribers.forEach(function(Ge){return q.add(Ge)}));else if(0<ne.length){Z.optimisticOps=Z.optimisticOps.filter(function(Ge){return Ge.trans!==U});for(var ke=0,ze=Object.values(Z.queries.query);ke<ze.length;ke++)for(var nt,Pe,Ye,et=0,Ue=(nt=ze[ke]).slice();et<Ue.length;et++)(Pe=Ue[et]).res!=null&&U.mutatedParts&&(W&&!Pe.dirty?(Ye=Object.isFrozen(Pe.res),Ye=Ou(Pe.res,Pe.req,ne,te,Pe,Ye),Pe.dirty?(ft(nt,Pe),Pe.subscribers.forEach(function(Ge){return q.add(Ge)})):Ye!==Pe.res&&(Pe.res=Ye,Pe.promise=je.resolve({result:Ye}))):(Pe.dirty&&ft(nt,Pe),Pe.subscribers.forEach(function(Ge){return q.add(Ge)})))}}}q.forEach(function(Ge){return Ge()})}}},U.addEventListener("abort",R(!1),{signal:x}),U.addEventListener("error",R(!1),{signal:x}),U.addEventListener("complete",R(!0),{signal:x})),U},table:function(b){var y=d.table(b),R=y.schema.primaryKey;return a(a({},y),{mutate:function(w){var x=F.trans;if(R.outbound||x.db._options.cache==="disabled"||x.explicit||x.idbtrans.mode!=="readwrite")return y.mutate(w);var U=Eo["idb://".concat(g,"/").concat(b)];return U?(x=y.mutate(w),w.type!=="add"&&w.type!=="put"||!(50<=w.values.length||Ll(R,w).some(function(W){return W==null}))?(U.optimisticOps.push(w),w.mutatedParts&&Ps(w.mutatedParts),x.then(function(W){0<W.numFailures&&(ft(U.optimisticOps,w),(W=Bc(0,w,W))&&U.optimisticOps.push(W),w.mutatedParts&&Ps(w.mutatedParts))}),x.catch(function(){ft(U.optimisticOps,w),w.mutatedParts&&Ps(w.mutatedParts)})):x.then(function(W){var q=Bc(0,a(a({},w),{values:w.values.map(function(ie,z){var se;return W.failures[z]?ie:(ie=(se=R.keyPath)!==null&&se!==void 0&&se.includes(".")?Bt(ie):a({},ie),xe(ie,R.keyPath,W.results[z]),ie)})}),W);U.optimisticOps.push(q),queueMicrotask(function(){return w.mutatedParts&&Ps(w.mutatedParts)})}),x):y.mutate(w)},query:function(w){if(!Fs(F,y)||!Ra("query",w))return y.query(w);var x=((q=F.trans)===null||q===void 0?void 0:q.db._options.cache)==="immutable",z=F,U=z.requery,W=z.signal,q=(function(te,ne,oe,ue){var $e=Eo["idb://".concat(te,"/").concat(ne)];if(!$e)return[];if(!(ne=$e.queries[oe]))return[null,!1,$e,null];var ye=ne[(ue.query?ue.query.index.name:null)||""];if(!ye)return[null,!1,$e,null];switch(oe){case"query":var ke=ye.find(function(ze){return ze.req.limit===ue.limit&&ze.req.values===ue.values&&Us(ze.req.query.range,ue.query.range)});return ke?[ke,!0,$e,ye]:[ye.find(function(ze){return("limit"in ze.req?ze.req.limit:1/0)>=ue.limit&&(!ue.values||ze.req.values)&&dr(ze.req.query.range,ue.query.range)}),!1,$e,ye];case"count":return ke=ye.find(function(ze){return Us(ze.req.query.range,ue.query.range)}),[ke,!!ke,$e,ye]}})(g,b,"query",w),ie=q[0],z=q[1],se=q[2],Z=q[3];return ie&&z?ie.obsSet=w.obsSet:(z=y.query(w).then(function(te){var ne=te.result;if(ie&&(ie.res=ne),x){for(var oe=0,ue=ne.length;oe<ue;++oe)Object.freeze(ne[oe]);Object.freeze(ne)}else te.result=Bt(ne);return te}).catch(function(te){return Z&&ie&&ft(Z,ie),Promise.reject(te)}),ie={obsSet:w.obsSet,promise:z,subscribers:new Set,type:"query",req:w,dirty:!1},Z?Z.push(ie):(Z=[ie],(se=se||(Eo["idb://".concat(g,"/").concat(b)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[w.query.index.name||""]=Z)),Ts(ie,Z,U,W),ie.promise.then(function(te){return{result:Ou(te.result,w,se?.optimisticOps,y,ie,x)}})}})}})}};function Yr(d,g){return new Proxy(d,{get:function(b,y,R){return y==="db"?g:Reflect.get(b,y,R)}})}var co=(Nn.prototype.version=function(d){if(isNaN(d)||d<.1)throw new tt.Type("Given version is not a positive number");if(d=Math.round(10*d)/10,this.idbdb||this._state.isBeingOpened)throw new tt.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,d);var g=this._versions,b=g.filter(function(y){return y._cfg.version===d})[0];return b||(b=new this.Version(d),g.push(b),g.sort(lr),b.stores({}),this._state.autoSchema=!1,b)},Nn.prototype._whenReady=function(d){var g=this;return this.idbdb&&(this._state.openComplete||F.letThrough||this._vip)?d():new je(function(b,y){if(g._state.openComplete)return y(new tt.DatabaseClosed(g._state.dbOpenError));if(!g._state.isBeingOpened){if(!g._state.autoOpen)return void y(new tt.DatabaseClosed);g.open().catch(ae)}g._state.dbReadyPromise.then(b,y)}).then(d)},Nn.prototype.use=function(d){var g=d.stack,b=d.create,y=d.level,R=d.name;return R&&this.unuse({stack:g,name:R}),d=this._middlewares[g]||(this._middlewares[g]=[]),d.push({stack:g,create:b,level:y??10,name:R}),d.sort(function(w,x){return w.level-x.level}),this},Nn.prototype.unuse=function(d){var g=d.stack,b=d.name,y=d.create;return g&&this._middlewares[g]&&(this._middlewares[g]=this._middlewares[g].filter(function(R){return y?R.create!==y:!!b&&R.name!==b})),this},Nn.prototype.open=function(){var d=this;return wo(Y,function(){return Lc(d)})},Nn.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var d=this._state,g=er.indexOf(this);if(0<=g&&er.splice(g,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}d.isBeingOpened||(d.dbReadyPromise=new je(function(b){d.dbReadyResolve=b}),d.openCanceller=new je(function(b,y){d.cancelOpen=y}))},Nn.prototype.close=function(b){var g=(b===void 0?{disableAutoOpen:!0}:b).disableAutoOpen,b=this._state;g?(b.isBeingOpened&&b.cancelOpen(new tt.DatabaseClosed),this._close(),b.autoOpen=!1,b.dbOpenError=new tt.DatabaseClosed):(this._close(),b.autoOpen=this._options.autoOpen||b.isBeingOpened,b.openComplete=!1,b.dbOpenError=null)},Nn.prototype.delete=function(d){var g=this;d===void 0&&(d={disableAutoOpen:!0});var b=0<arguments.length&&typeof arguments[0]!="object",y=this._state;return new je(function(R,w){function x(){g.close(d);var U=g._deps.indexedDB.deleteDatabase(g.name);U.onsuccess=St(function(){var W,q,ie;W=g._deps,q=g.name,ie=W.indexedDB,W=W.IDBKeyRange,Al(ie)||q===tr||ur(ie,W).delete(q).catch(ae),R()}),U.onerror=gn(w),U.onblocked=g._fireOnBlocked}if(b)throw new tt.InvalidArgument("Invalid closeOptions argument to db.delete()");y.isBeingOpened?y.dbReadyPromise.then(x):x()})},Nn.prototype.backendDB=function(){return this.idbdb},Nn.prototype.isOpen=function(){return this.idbdb!==null},Nn.prototype.hasBeenClosed=function(){var d=this._state.dbOpenError;return d&&d.name==="DatabaseClosed"},Nn.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Nn.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Nn.prototype,"tables",{get:function(){var d=this;return C(this._allTables).map(function(g){return d._allTables[g]})},enumerable:!1,configurable:!0}),Nn.prototype.transaction=function(){var d=(function(g,b,y){var R=arguments.length;if(R<2)throw new tt.InvalidArgument("Too few arguments");for(var w=new Array(R-1);--R;)w[R-1]=arguments[R];return y=w.pop(),[g,ot(w),y]}).apply(this,arguments);return this._transaction.apply(this,d)},Nn.prototype._transaction=function(d,g,b){var y=this,R=F.trans;R&&R.db===this&&d.indexOf("!")===-1||(R=null);var w,x,U=d.indexOf("?")!==-1;d=d.replace("!","").replace("?","");try{if(x=g.map(function(q){if(q=q instanceof y.Table?q.name:q,typeof q!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return q}),d=="r"||d===Jo)w=Jo;else{if(d!="rw"&&d!=ps)throw new tt.InvalidArgument("Invalid transaction mode: "+d);w=ps}if(R){if(R.mode===Jo&&w===ps){if(!U)throw new tt.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");R=null}R&&x.forEach(function(q){if(R&&R.storeNames.indexOf(q)===-1){if(!U)throw new tt.SubTransaction("Table "+q+" not included in parent transaction.");R=null}}),U&&R&&!R.active&&(R=null)}}catch(q){return R?R._promise(null,function(ie,z){z(q)}):rn(q)}var W=(function q(ie,z,se,Z,te){return je.resolve().then(function(){var ne=F.transless||F,oe=ie._createTransaction(z,se,ie._dbSchema,Z);if(oe.explicit=!0,ne={trans:oe,transless:ne},Z)oe.idbtrans=Z.idbtrans;else try{oe.create(),oe.idbtrans._explicit=!0,ie._state.PR1398_maxLoop=3}catch(ye){return ye.name===Pt.InvalidState&&ie.isOpen()&&0<--ie._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),ie.close({disableAutoOpen:!1}),ie.open().then(function(){return q(ie,z,se,null,te)})):rn(ye)}var ue,$e=J(te);return $e&&Qn(),ne=je.follow(function(){var ye;(ue=te.call(oe,oe))&&($e?(ye=qi.bind(null,null),ue.then(ye,ye)):typeof ue.next=="function"&&typeof ue.throw=="function"&&(ue=cr(ue)))},ne),(ue&&typeof ue.then=="function"?je.resolve(ue).then(function(ye){return oe.active?ye:rn(new tt.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):ne.then(function(){return ue})).then(function(ye){return Z&&oe._resolve(),oe._completion.then(function(){return ye})}).catch(function(ye){return oe._reject(ye),rn(ye)})})}).bind(null,this,w,x,R,b);return R?R._promise(w,W,"lock"):F.trans?wo(F.transless,function(){return y._whenReady(W)}):this._whenReady(W)},Nn.prototype.table=function(d){if(!D(this._allTables,d))throw new tt.InvalidTable("Table ".concat(d," does not exist"));return this._allTables[d]},Nn);function Nn(d,g){var b=this;this._middlewares={},this.verno=0;var y=Nn.dependencies;this._options=g=a({addons:Nn.addons,autoOpen:!0,indexedDB:y.indexedDB,IDBKeyRange:y.IDBKeyRange,cache:"cloned"},g),this._deps={indexedDB:g.indexedDB,IDBKeyRange:g.IDBKeyRange},y=g.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var R,w,x,U,W,q={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:ae,dbReadyPromise:null,cancelOpen:ae,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:g.autoOpen};q.dbReadyPromise=new je(function(z){q.dbReadyResolve=z}),q.openCanceller=new je(function(z,se){q.cancelOpen=se}),this._state=q,this.name=d,this.on=Ms(this,"populate","blocked","versionchange","close",{ready:[Ln,ae]}),this.once=function(z,se){var Z=function(){for(var te=[],ne=0;ne<arguments.length;ne++)te[ne]=arguments[ne];b.on(z).unsubscribe(Z),se.apply(b,te)};return b.on(z,Z)},this.on.ready.subscribe=Le(this.on.ready.subscribe,function(z){return function(se,Z){Nn.vip(function(){var te,ne=b._state;ne.openComplete?(ne.dbOpenError||je.resolve().then(se),Z&&z(se)):ne.onReadyBeingFired?(ne.onReadyBeingFired.push(se),Z&&z(se)):(z(se),te=b,Z||z(function oe(){te.on.ready.unsubscribe(se),te.on.ready.unsubscribe(oe)}))})}}),this.Collection=(R=this,_i(Oc.prototype,function(ue,oe){this.db=R;var Z=yl,te=null;if(oe)try{Z=oe()}catch($e){te=$e}var ne=ue._ctx,oe=ne.table,ue=oe.hook.reading.fire;this._ctx={table:oe,index:ne.index,isPrimKey:!ne.index||oe.schema.primKey.keyPath&&ne.index===oe.schema.primKey.name,range:Z,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:te,or:ne.or,valueMapper:ue!==We?ue:null}})),this.Table=(w=this,_i(No.prototype,function(z,se,Z){this.db=w,this._tx=Z,this.name=z,this.schema=se,this.hook=w._allTables[z]?w._allTables[z].hook:Ms(null,{creating:[Si,ae],reading:[Mn,We],updating:[Yi,ae],deleting:[Wt,ae]})})),this.Transaction=(x=this,_i(ga.prototype,function(z,se,Z,te,ne){var oe=this;z!=="readonly"&&se.forEach(function(ue){ue=(ue=Z[ue])===null||ue===void 0?void 0:ue.yProps,ue&&(se=se.concat(ue.map(function($e){return $e.updatesTable})))}),this.db=x,this.mode=z,this.storeNames=se,this.schema=Z,this.chromeTransactionDurability=te,this.idbtrans=null,this.on=Ms(this,"complete","error","abort"),this.parent=ne||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new je(function(ue,$e){oe._resolve=ue,oe._reject=$e}),this._completion.then(function(){oe.active=!1,oe.on.complete.fire()},function(ue){var $e=oe.active;return oe.active=!1,oe.on.error.fire(ue),oe.parent?oe.parent._reject(ue):$e&&oe.idbtrans&&oe.idbtrans.abort(),rn(ue)})})),this.Version=(U=this,_i(Nc.prototype,function(z){this.db=U,this._cfg={version:z,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(W=this,_i(or.prototype,function(z,se,Z){if(this.db=W,this._ctx={table:z,index:se===":id"?null:se,or:Z},this._cmp=this._ascending=Ut,this._descending=function(te,ne){return Ut(ne,te)},this._max=function(te,ne){return 0<Ut(te,ne)?te:ne},this._min=function(te,ne){return Ut(te,ne)<0?te:ne},this._IDBKeyRange=W._deps.IDBKeyRange,!this._IDBKeyRange)throw new tt.MissingAPI})),this.on("versionchange",function(z){0<z.newVersion?console.warn("Another connection wants to upgrade database '".concat(b.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(b.name,"'. Closing db now to resume the delete request.")),b.close({disableAutoOpen:!1})}),this.on("blocked",function(z){!z.newVersion||z.newVersion<z.oldVersion?console.warn("Dexie.delete('".concat(b.name,"') was blocked")):console.warn("Upgrade '".concat(b.name,"' blocked by other connection holding version ").concat(z.oldVersion/10))}),this._maxKey=Mo(g.IDBKeyRange),this._createTransaction=function(z,se,Z,te){return new b.Transaction(z,se,Z,b._options.chromeTransactionDurability,te)},this._fireOnBlocked=function(z){b.on("blocked").fire(z),er.filter(function(se){return se.name===b.name&&se!==b&&!se._state.vcFired}).map(function(se){return se.on("versionchange").fire(z)})},this.use(Ca),this.use(Dl),this.use(xc),this.use(Dc),this.use(Sa);var ie=new Proxy(this,{get:function(z,se,Z){if(se==="_vip")return!0;if(se==="table")return function(ne){return Yr(b.table(ne),ie)};var te=Reflect.get(z,se,Z);return te instanceof No?Yr(te,ie):se==="tables"?te.map(function(ne){return Yr(ne,ie)}):se==="_createTransaction"?function(){return Yr(te.apply(this,arguments),ie)}:te}});this.vip=ie,y.forEach(function(z){return z(b)})}var fr,ho=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",Au=(xl.prototype.subscribe=function(d,g,b){return this._subscribe(d&&typeof d!="function"?d:{next:d,error:g,complete:b})},xl.prototype[ho]=function(){return this},xl);function xl(d){this._subscribe=d}try{fr={indexedDB:E.indexedDB||E.mozIndexedDB||E.webkitIndexedDB||E.msIndexedDB,IDBKeyRange:E.IDBKeyRange||E.webkitIDBKeyRange}}catch{fr={indexedDB:null,IDBKeyRange:null}}function Pc(d){var g,b=!1,y=new Au(function(R){var w=J(d),x,U=!1,W={},q={},ie={get closed(){return U},unsubscribe:function(){U||(U=!0,x&&x.abort(),z&&di.storagemutated.unsubscribe(Z))}};R.start&&R.start(ie);var z=!1,se=function(){return ks(te)},Z=function(ne){Nl(W,ne),Ta(q,W)&&se()},te=function(){var ne,oe,ue;!U&&fr.indexedDB&&(W={},ne={},x&&x.abort(),x=new AbortController,ue=(function($e){var ye=dt();try{w&&Qn();var ke=Tn(d,$e);return ke=w?ke.finally(qi):ke}finally{ye&&Qt()}})(oe={subscr:ne,signal:x.signal,requery:se,querier:d,trans:null}),Promise.resolve(ue).then(function($e){b=!0,g=$e,U||oe.signal.aborted||(W={},(function(ye){for(var ke in ye)if(D(ye,ke))return;return 1})(q=ne)||z||(di(sr,Z),z=!0),ks(function(){return!U&&R.next&&R.next($e)}))},function($e){b=!1,["DatabaseClosedError","AbortError"].includes($e?.name)||U||ks(function(){U||R.error&&R.error($e)})}))};return setTimeout(se,0),ie});return y.hasValue=function(){return b},y.getValue=function(){return g},y}var pr=co;function Ia(d){var g=Hs;try{Hs=!0,di.storagemutated.fire(d),Ml(d,!0)}finally{Hs=g}}j(pr,a(a({},Ni),{delete:function(d){return new pr(d,{addons:[]}).delete()},exists:function(d){return new pr(d,{addons:[]}).open().then(function(g){return g.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(d){try{return g=pr.dependencies,b=g.indexedDB,g=g.IDBKeyRange,(Al(b)?Promise.resolve(b.databases()).then(function(y){return y.map(function(R){return R.name}).filter(function(R){return R!==tr})}):ur(b,g).toCollection().primaryKeys()).then(d)}catch{return rn(new tt.MissingAPI)}var g,b},defineClass:function(){return function(d){N(this,d)}},ignoreTransaction:function(d){return F.trans?wo(F.transless,d):d()},vip:_a,async:function(d){return function(){try{var g=cr(d.apply(this,arguments));return g&&typeof g.then=="function"?g:je.resolve(g)}catch(b){return rn(b)}}},spawn:function(d,g,b){try{var y=cr(d.apply(b,g||[]));return y&&typeof y.then=="function"?y:je.resolve(y)}catch(R){return rn(R)}},currentTransaction:{get:function(){return F.trans||null}},waitFor:function(d,g){return g=je.resolve(typeof d=="function"?pr.ignoreTransaction(d):d).timeout(g||6e4),F.trans?F.trans.waitFor(g):g},Promise:je,debug:{get:function(){return _n},set:function(d){bn(d)}},derive:ve,extend:N,props:j,override:Le,Events:Ms,on:di,liveQuery:Pc,extendObservabilitySet:Nl,getByKeyPath:De,setByKeyPath:xe,delByKeyPath:function(d,g){typeof g=="string"?xe(d,g,void 0):"length"in g&&[].map.call(g,function(b){xe(d,b,void 0)})},shallowClone:at,deepClone:Bt,getObjectDiff:Ru,cmp:Ut,asap:rt,minKey:-1/0,addons:[],connections:er,errnames:Pt,dependencies:fr,cache:Eo,semVer:"4.2.1",version:"4.2.1".split(".").map(function(d){return parseInt(d)}).reduce(function(d,g,b){return d+g/Math.pow(10,2*b)})})),pr.maxKey=Mo(pr.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(di(sr,function(d){Hs||(d=new CustomEvent(bs,{detail:d}),Hs=!0,dispatchEvent(d),Hs=!1)}),addEventListener(bs,function(d){d=d.detail,Hs||Ia(d)}));var Kr,Hs=!1,fi=function(){};return typeof BroadcastChannel<"u"&&((fi=function(){(Kr=new BroadcastChannel(bs)).onmessage=function(d){return d.data&&Ia(d.data)}})(),typeof Kr.unref=="function"&&Kr.unref(),di(sr,function(d){Hs||Kr.postMessage(d)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(d){if(!co.disableBfCache&&d.persisted){_n&&console.debug("Dexie: handling persisted pagehide"),Kr?.close();for(var g=0,b=er;g<b.length;g++)b[g].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(d){!co.disableBfCache&&d.persisted&&(_n&&console.debug("Dexie: handling persisted pageshow"),fi(),Ia({all:new Ri(-1/0,[[]])}))})),je.rejectionMapper=function(d,g){return!d||d instanceof He||d instanceof TypeError||d instanceof SyntaxError||!d.name||!Qe[d.name]?d:(g=new Qe[d.name](g||d.message,d),"stack"in d&&Oe(g,"stack",{get:function(){return this.inner.stack}}),g)},bn(_n),a(co,Object.freeze({__proto__:null,Dexie:co,liveQuery:Pc,Entity:Sl,cmp:Ut,PropModification:Wr,replacePrefix:function(d,g){return new Wr({replacePrefix:[d,g]})},add:function(d){return new Wr({add:d})},remove:function(d){return new Wr({remove:d})},default:co,RangeSet:Ri,mergeRanges:ar,rangesOverlap:kc}),{default:co}),co})})(dexie_min$1)),dexie_min$1.exports}var dexie_minExports=requireDexie_min();const _Dexie=getDefaultExportFromCjs(dexie_minExports),DexieSymbol=Symbol.for("Dexie"),Dexie=globalThis[DexieSymbol]||(globalThis[DexieSymbol]=_Dexie);if(_Dexie.semVer!==Dexie.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${_Dexie.semVer} and ${Dexie.semVer}`);const{liveQuery,mergeRanges,rangesOverlap,RangeSet,cmp,Entity,PropModification,replacePrefix,add,remove,DexieYProvider}=Dexie;class NovaCalcDatabase extends Dexie{blocks;sessions;settings;constructor(){super("NovaCalcDB"),this.version(1).stores({blocks:"blockId, type, createdAt, updatedAt, *parentIds, *childIds",sessions:"sessionId, createdAt, updatedAt",settings:"++id"})}async initializeSettings(){await this.settings.count()===0&&await this.settings.add({currencySymbol:"¥",showCurrencySymbol:!1,useThousandsSeparator:!0,decimalPlaces:2,taxRates:[{id:"standard",name:"標準税率",rate:.1,isDefault:!0},{id:"reduced",name:"軽減税率",rate:.08,isDefault:!1}],defaultTaxRateId:"standard",showDependencyLines:!0,showUpdateAnimation:!0,soundEnabled:!0,volume:50})}async getSettings(){return await this.settings.toCollection().first()}async updateSettings(p){await this.getSettings()&&await this.settings.update(1,p)}async createBlock(p){return await this.blocks.add(p),p.blockId}async getBlock(p){return await this.blocks.get(p)}async updateBlock(p,l){await this.blocks.update(p,{...l,updatedAt:Date.now()})}async deleteBlock(p){await this.blocks.delete(p)}async getAllBlocks(){return await this.blocks.toArray()}async getBlocksByParent(p){return await this.blocks.where("parentIds").equals(p).toArray()}async getBlocksByChild(p){return await this.blocks.where("childIds").equals(p).toArray()}async addDependency(p,l){const a=await this.getBlock(p),_=await this.getBlock(l);if(!a||!_)throw new Error("Block not found");a.parentIds.includes(l)||(a.parentIds.push(l),await this.updateBlock(p,{parentIds:a.parentIds})),_.childIds.includes(p)||(_.childIds.push(p),await this.updateBlock(l,{childIds:_.childIds}))}async removeDependency(p,l){const a=await this.getBlock(p),_=await this.getBlock(l);a&&(a.parentIds=a.parentIds.filter(E=>E!==l),await this.updateBlock(p,{parentIds:a.parentIds})),_&&(_.childIds=_.childIds.filter(E=>E!==p),await this.updateBlock(l,{childIds:_.childIds}))}async hasCircularDependency(p,l){const a=new Set,_=[l];for(;_.length>0;){const E=_.shift();if(E===p)return!0;if(a.has(E))continue;a.add(E);const C=await this.getBlock(E);C&&_.push(...C.parentIds)}return!1}async getCurrentSession(){const p=await this.sessions.toArray();if(p.length===0){const l={sessionId:crypto.randomUUID(),blocks:[],viewportX:0,viewportY:0,zoom:1,createdAt:Date.now(),updatedAt:Date.now()};return await this.sessions.add(l),l}return p.sort((l,a)=>a.updatedAt-l.updatedAt)[0]}async updateSession(p,l){await this.sessions.update(p,{...l,updatedAt:Date.now()})}async clearAllData(){await this.blocks.clear(),await this.sessions.clear(),await this.settings.clear(),await this.initializeSettings()}}const db=new NovaCalcDatabase;db.initializeSettings().catch(console.error);class DependencyGraph{async getDescendants(p){const l=new Set,a=[p],_=new Set;for(;a.length>0;){const E=a.shift();if(_.has(E))continue;_.add(E);const C=await db.getBlock(E);if(C)for(const A of C.childIds)l.add(A),a.push(A)}return Array.from(l)}async getAncestors(p){const l=new Set,a=[p],_=new Set;for(;a.length>0;){const E=a.shift();if(_.has(E))continue;_.add(E);const C=await db.getBlock(E);if(C)for(const A of C.parentIds)l.add(A),a.push(A)}return Array.from(l)}async topologicalSort(p){const l=new Map,a=new Map;for(const C of p){const A=await db.getBlock(C);if(A){l.has(C)||l.set(C,0);for(const N of A.childIds)p.includes(N)&&(a.has(C)||a.set(C,[]),a.get(C).push(N),l.set(N,(l.get(N)||0)+1))}}const _=[],E=[];for(const[C,A]of l.entries())A===0&&_.push(C);for(;_.length>0;){const C=_.shift();E.push(C);const A=a.get(C)||[];for(const N of A){const O=l.get(N)-1;l.set(N,O),O===0&&_.push(N)}}if(E.length!==p.length)throw new Error("Circular dependency detected");return E}async recalculateBlock(p){const l=await db.getBlock(p);if(!l)return{success:!1,error:"Block not found"};try{const a=new Map;for(const E of l.parentIds){const C=await db.getBlock(E);if(C)a.set(E,C.value);else return{success:!1,error:`Referenced block ${E} not found`}}const _=calculateFormula(l.formulaString,a);return _.success&&_.value?(await db.updateBlock(p,{value:_.value,updatedAt:Date.now()}),{success:!0,value:_.value,affectedBlocks:[p]}):_}catch(a){return{success:!1,error:a instanceof Error?a.message:"Calculation error"}}}async cascadeRecalculation(p){const l=[],a=[];try{const _=await this.getDescendants(p);if(_.length===0)return{success:!0,affectedBlocks:[],errors:[]};const E=await this.topologicalSort(_);for(const C of E){const A=await this.recalculateBlock(C);A.success?l.push(C):a.push({blockId:C,error:A.error||"Unknown error"})}return{success:a.length===0,affectedBlocks:l,errors:a}}catch(_){return{success:!1,affectedBlocks:l,errors:[{blockId:p,error:_ instanceof Error?_.message:"Unknown error"}]}}}async updateBlockFormula(p,l){const a=await db.getBlock(p);if(!a)return{success:!1,error:"Block not found"};try{const _=extractBlockReferences(l);for(const A of _)if(await db.hasCircularDependency(p,A))return{success:!1,error:"Circular dependency detected"};for(const A of a.parentIds)_.includes(A)||await db.removeDependency(p,A);for(const A of _)a.parentIds.includes(A)||await db.addDependency(p,A);await db.updateBlock(p,{formulaString:l,parentIds:_});const E=await this.recalculateBlock(p);if(!E.success)return E;const C=await this.cascadeRecalculation(p);return{success:C.success,value:E.value,affectedBlocks:[p,...C.affectedBlocks]}}catch(_){return{success:!1,error:_ instanceof Error?_.message:"Update failed"}}}async deleteBlock(p){const l=await db.getBlock(p);if(!l)return{success:!1,error:"Block not found"};if(l.childIds.length>0)return{success:!1,error:"Cannot delete: other blocks depend on this one",affectedChildren:l.childIds};for(const a of l.parentIds)await db.removeDependency(p,a);return await db.deleteBlock(p),{success:!0}}}const dependencyGraph=new DependencyGraph;function useBlocks(){const[h,p]=reactExports.useState([]),[l,a]=reactExports.useState(!0),_=reactExports.useCallback(async()=>{try{const D=await db.getAllBlocks();p(D)}catch(D){console.error("Failed to load blocks:",D)}finally{a(!1)}},[]);reactExports.useEffect(()=>{_()},[_]);const E=reactExports.useCallback(async(D,j=BlockType.STANDARD,be={x:100,y:100})=>{try{const Oe=extractBlockReferences(D),ve=new Map;for(const _e of Oe){const Le=await db.getBlock(_e);Le&&ve.set(_e,Le.value)}const Xe=calculateFormula(D,ve);if(!Xe.success)return console.error("Calculation failed:",Xe.error),null;const Ke={blockId:crypto.randomUUID(),type:j,value:Xe.value||"0",formulaString:D,parentIds:Oe,childIds:[],positionX:be.x,positionY:be.y,createdAt:Date.now(),updatedAt:Date.now()};await db.createBlock(Ke);for(const _e of Oe)await db.addDependency(Ke.blockId,_e);return await _(),Ke}catch(Oe){return console.error("Failed to create block:",Oe),null}},[_]),C=reactExports.useCallback(async(D,j)=>{try{const be=await dependencyGraph.updateBlockFormula(D,j);return be.success?(await _(),!0):(console.error("Update failed:",be.error),!1)}catch(be){return console.error("Failed to update block:",be),!1}},[_]),A=reactExports.useCallback(async(D,j,be)=>{try{await db.updateBlock(D,{positionX:j,positionY:be}),await _()}catch(Oe){console.error("Failed to update block position:",Oe)}},[_]),N=reactExports.useCallback(async(D,j)=>{try{await db.updateBlock(D,{memoText:j}),await _()}catch(be){console.error("Failed to update block memo:",be)}},[_]),O=reactExports.useCallback(async D=>{try{const j=await dependencyGraph.deleteBlock(D);return j.success?(await _(),{success:!0}):{success:!1,error:j.error}}catch(j){return console.error("Failed to delete block:",j),{success:!1,error:j instanceof Error?j.message:"Delete failed"}}},[_]),H=reactExports.useCallback(D=>h.find(j=>j.blockId===D),[h]);return{blocks:h,loading:l,createBlock:E,updateBlock:C,updateBlockPosition:A,updateBlockMemo:N,deleteBlock:O,getBlock:H,refreshBlocks:_}}function useSettings(){const[h,p]=reactExports.useState(null),[l,a]=reactExports.useState(!0),_=reactExports.useCallback(async()=>{try{const C=await db.getSettings();C&&p(C)}catch(C){console.error("Failed to load settings:",C)}finally{a(!1)}},[]);reactExports.useEffect(()=>{_()},[_]);const E=reactExports.useCallback(async C=>{try{await db.updateSettings(C),await _()}catch(A){console.error("Failed to update settings:",A)}},[_]);return{settings:h,loading:l,updateSettings:E}}function App(){const[h,p]=reactExports.useState(BlockType.STANDARD),[l,a]=reactExports.useState(!1),[_,E]=reactExports.useState(!1),{blocks:C,loading:A,createBlock:N,updateBlockPosition:O,updateBlockMemo:H,deleteBlock:D}=useBlocks(),{settings:j,loading:be,updateSettings:Oe}=useSettings(),ve=reactExports.useMemo(()=>{const Ae=new Map;return C.forEach(rt=>{Ae.set(rt.blockId,rt.value)}),Ae},[C]),Xe=reactExports.useCallback(async Ae=>{const rt=calculateNewBlockPosition(C,window.innerWidth,window.innerHeight);await N(Ae,h,rt)},[C,N,h]),Ke=Ae=>{p(Ae)},_e=reactExports.useCallback(async Ae=>{const rt=await D(Ae);rt.success||alert(rt.error||"Failed to delete block")},[D]),Le=reactExports.useCallback(async()=>{if(C.length===0){alert("マグネットがありません");return}const Ae=C.reduce((De,xe)=>{const at=parseFloat(xe.value);return De+(isNaN(at)?0:at)},0),rt=C.map(De=>De.value).join("+");await Xe(rt),alert(`${C.length}このマグネットをまとめました！ごうけい: ${Ae}`)},[C,Xe]);return A||be?jsxRuntimeExports.jsx("div",{className:"app",children:jsxRuntimeExports.jsx("div",{className:"loading",children:"よみこみ中..."})}):jsxRuntimeExports.jsxs("div",{className:"app",children:[jsxRuntimeExports.jsxs("header",{className:"app-header",children:[jsxRuntimeExports.jsx("h1",{className:"app-title",children:"電卓ver2"}),jsxRuntimeExports.jsxs("div",{className:"mode-selector",children:[jsxRuntimeExports.jsx("button",{className:`mode-btn ${h===BlockType.STANDARD?"active":""}`,onClick:()=>Ke(BlockType.STANDARD),children:"ふつうのけいさん"}),jsxRuntimeExports.jsx("button",{className:`mode-btn ${h===BlockType.DATE?"active":""}`,onClick:()=>Ke(BlockType.DATE),children:"日づけ"}),jsxRuntimeExports.jsx("button",{className:`mode-btn ${h===BlockType.ZODIAC?"active":""}`,onClick:()=>Ke(BlockType.ZODIAC),children:"十二支"}),jsxRuntimeExports.jsx("button",{className:`mode-btn ${h===BlockType.UNIT?"active":""}`,onClick:()=>Ke(BlockType.UNIT),children:"たんい"})]}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center"},children:[jsxRuntimeExports.jsx("button",{className:"currency-toggle-btn",onClick:()=>Oe({showCurrencySymbol:!j?.showCurrencySymbol}),title:"えんマークひょうじ",style:{backgroundColor:j?.showCurrencySymbol?"#95e1d3":"#ddd",color:j?.showCurrencySymbol?"white":"#666"},children:"¥"}),jsxRuntimeExports.jsx("button",{className:"blockly-link-btn",onClick:()=>E(!_),title:"ブロックプログラミング",children:"🧩 ブロック"}),jsxRuntimeExports.jsx("button",{className:"help-btn",onClick:()=>a(!l),title:"つかいかた",children:"？"})]})]}),l&&jsxRuntimeExports.jsx("div",{className:"help-overlay",onClick:()=>a(!1),children:jsxRuntimeExports.jsxs("div",{className:"help-modal",onClick:Ae=>Ae.stopPropagation(),children:[jsxRuntimeExports.jsx("button",{className:"help-close",onClick:()=>a(!1),children:"✕"}),jsxRuntimeExports.jsx("h2",{children:"けいさんノートのつかいかた"}),jsxRuntimeExports.jsxs("div",{className:"help-section",children:[jsxRuntimeExports.jsx("h3",{children:"📱 きほんのけいさん"}),jsxRuntimeExports.jsxs("ul",{children:[jsxRuntimeExports.jsx("li",{children:"すうじをおして、+、-、×、÷でけいさんしよう"}),jsxRuntimeExports.jsx("li",{children:"=ボタンか、Enterキーを2かいれんぞくでおすと、けっかがでるよ"}),jsxRuntimeExports.jsx("li",{children:"Cボタンか、Escキーでクリアできるよ"})]})]}),jsxRuntimeExports.jsxs("div",{className:"help-section",children:[jsxRuntimeExports.jsx("h3",{children:"🧲 マグネットのつかいかた"}),jsxRuntimeExports.jsxs("ul",{children:[jsxRuntimeExports.jsx("li",{children:"けいさんけっかがマグネットになって、みぎがわにでてくるよ"}),jsxRuntimeExports.jsx("li",{children:"マグネットをクリックして、えらんだり、うごかしたりできるよ"}),jsxRuntimeExports.jsx("li",{children:"えんぴつボタンで、メモをかけるよ（Ctrl+Enterでほぞん）"}),jsxRuntimeExports.jsx("li",{children:"ゴミばこボタンで、マグネットをけせるよ"})]})]}),jsxRuntimeExports.jsxs("div",{className:"help-section",children:[jsxRuntimeExports.jsx("h3",{children:"⌨️ キーボードそうさ"}),jsxRuntimeExports.jsxs("ul",{children:[jsxRuntimeExports.jsx("li",{children:"すうじキー：すうじをにゅうりょく"}),jsxRuntimeExports.jsx("li",{children:"+、-、*、/：えんざんし"}),jsxRuntimeExports.jsx("li",{children:"Enter 2かい：けいさんじっこう"}),jsxRuntimeExports.jsx("li",{children:"Esc：クリア / せんたくかいじょ"}),jsxRuntimeExports.jsx("li",{children:"Ctrl+クリック：ふくすうせんたく"}),jsxRuntimeExports.jsx("li",{children:"Ctrl+A：ぜんぶせんたく"}),jsxRuntimeExports.jsx("li",{children:"Delete：せんたくしたマグネットをけす"})]})]}),jsxRuntimeExports.jsxs("div",{className:"help-section",children:[jsxRuntimeExports.jsx("h3",{children:"🎨 モードのせつめい"}),jsxRuntimeExports.jsxs("ul",{children:[jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"ふつうのけいさん："}),"すうじのけいさんができるよ"]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"日づけ："}),"じゅんびちゅう"]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"十二支："}),"じゅんびちゅう"]}),jsxRuntimeExports.jsxs("li",{children:[jsxRuntimeExports.jsx("strong",{children:"たんい："}),"じゅんびちゅう"]})]})]})]})}),_&&jsxRuntimeExports.jsx("div",{className:"help-overlay",onClick:()=>E(!1),children:jsxRuntimeExports.jsxs("div",{className:"blockly-modal",onClick:Ae=>Ae.stopPropagation(),children:[jsxRuntimeExports.jsx("button",{className:"help-close",onClick:()=>E(!1),children:"✕"}),jsxRuntimeExports.jsx(BlocklyPlayground,{onCreateBlock:Xe})]})}),jsxRuntimeExports.jsxs("main",{className:"app-main",children:[jsxRuntimeExports.jsx(Calculator,{mode:h,onCreateBlock:Xe,blockValues:ve}),jsxRuntimeExports.jsx(Canvas,{blocks:C,onUpdateBlockPosition:O,onUpdateBlockMemo:H,onDeleteBlock:_e,onCondenseAll:Le,settings:j})]})]})}clientExports.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(reactExports.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));
//# sourceMappingURL=index-99oKt57g.js.map
